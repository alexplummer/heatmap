!function(){function t(t){return t&&(t.ownerDocument||t.document||t).documentElement}function e(t){return t&&(t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView)}function n(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function i(t){return null===t?NaN:+t}function r(t){return!isNaN(t)}function o(t){return{left:function(e,n,i,r){for(arguments.length<3&&(i=0),arguments.length<4&&(r=e.length);i<r;){var o=i+r>>>1;t(e[o],n)<0?i=o+1:r=o}return i},right:function(e,n,i,r){for(arguments.length<3&&(i=0),arguments.length<4&&(r=e.length);i<r;){var o=i+r>>>1;t(e[o],n)>0?r=o:i=o+1}return i}}}function a(t){return t.length}function s(t){for(var e=1;t*e%1;)e*=10;return e}function l(t,e){for(var n in e)Object.defineProperty(t.prototype,n,{value:e[n],enumerable:!1})}function u(){this._=Object.create(null)}function c(t){return(t+="")===$o||t[0]===ta?ta+t:t}function h(t){return(t+="")[0]===ta?t.slice(1):t}function d(t){return c(t)in this._}function f(t){return(t=c(t))in this._&&delete this._[t]}function p(){var t=[];for(var e in this._)t.push(h(e));return t}function g(){var t=0;for(var e in this._)++t;return t}function _(){for(var t in this._)return!1;return!0}function v(){this._=Object.create(null)}function y(t){return t}function m(t,e,n){return function(){var i=n.apply(e,arguments);return i===e?t:i}}function x(t,e){if(e in t)return e;e=e.charAt(0).toUpperCase()+e.slice(1);for(var n=0,i=ea.length;n<i;++n){var r=ea[n]+e;if(r in t)return r}}function S(){}function E(){}function T(t){function e(){for(var e,i=n,r=-1,o=i.length;++r<o;)(e=i[r].on)&&e.apply(this,arguments);return t}var n=[],i=new u;return e.on=function(e,r){var o,a=i.get(e);return arguments.length<2?a&&a.on:(a&&(a.on=null,n=n.slice(0,o=n.indexOf(a)).concat(n.slice(o+1)),i.remove(e)),r&&n.push(i.set(e,{on:r})),t)},e}function w(){zo.event.preventDefault()}function C(){for(var t,e=zo.event;t=e.sourceEvent;)e=t;return e}function b(t){for(var e=new E,n=0,i=arguments.length;++n<i;)e[arguments[n]]=T(e);return e.of=function(n,i){return function(r){try{var o=r.sourceEvent=zo.event;r.target=t,zo.event=r,e[r.type].apply(n,i)}finally{zo.event=o}}},e}function A(t){return ia(t,sa),t}function R(t){return"function"==typeof t?t:function(){return ra(t,this)}}function L(t){return"function"==typeof t?t:function(){return oa(t,this)}}function I(t,e){return t=zo.ns.qualify(t),null==e?t.local?function(){this.removeAttributeNS(t.space,t.local)}:function(){this.removeAttribute(t)}:"function"==typeof e?t.local?function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}:function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}:t.local?function(){this.setAttributeNS(t.space,t.local,e)}:function(){this.setAttribute(t,e)}}function P(t){return t.trim().replace(/\s+/g," ")}function M(t){return new RegExp("(?:^|\\s+)"+zo.requote(t)+"(?:\\s+|$)","g")}function O(t){return(t+"").trim().split(/^|\s+/)}function D(t,e){var n=(t=O(t).map(F)).length;return"function"==typeof e?function(){for(var i=-1,r=e.apply(this,arguments);++i<n;)t[i](this,r)}:function(){for(var i=-1;++i<n;)t[i](this,e)}}function F(t){var e=M(t);return function(n,i){if(r=n.classList)return i?r.add(t):r.remove(t);var r=n.getAttribute("class")||"";i?(e.lastIndex=0,e.test(r)||n.setAttribute("class",P(r+" "+t))):n.setAttribute("class",P(r.replace(e," ")))}}function k(t,e,n){return null==e?function(){this.style.removeProperty(t)}:"function"==typeof e?function(){var i=e.apply(this,arguments);null==i?this.style.removeProperty(t):this.style.setProperty(t,i,n)}:function(){this.style.setProperty(t,e,n)}}function N(t,e){return null==e?function(){delete this[t]}:"function"==typeof e?function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}:function(){this[t]=e}}function G(t){return"function"==typeof t?t:(t=zo.ns.qualify(t)).local?function(){return this.ownerDocument.createElementNS(t.space,t.local)}:function(){var e=this.ownerDocument,n=this.namespaceURI;return n===la&&e.documentElement.namespaceURI===la?e.createElement(t):e.createElementNS(n,t)}}function V(){var t=this.parentNode;t&&t.removeChild(this)}function U(t){return{__data__:t}}function B(t){return function(){return aa(this,t)}}function z(t){return arguments.length||(t=n),function(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}}function X(t,e){for(var n=0,i=t.length;n<i;n++)for(var r,o=t[n],a=0,s=o.length;a<s;a++)(r=o[a])&&e(r,a,n);return t}function H(t){return ia(t,ca),t}function W(t){var e,n;return function(i,r,o){var a,s=t[o].update,l=s.length;for(o!=n&&(n=o,e=0),r>=e&&(e=r+1);!(a=s[e])&&++e<l;);return a}}function Y(t,e,n){function i(){var e=this[r];e&&(this.removeEventListener(t,e,e.$),delete this[r])}var r="__on"+t,o=t.indexOf("."),a=j;o>0&&(t=t.slice(0,o));var s=ha.get(t);return s&&(t=s,a=K),o?e?function(){var o=a(e,Ho(arguments));i.call(this),this.addEventListener(t,this[r]=o,o.$=n),o._=e}:i:e?S:function(){var e,n=new RegExp("^__on([^.]+)"+zo.requote(t)+"$");for(var i in this)if(e=i.match(n)){var r=this[i];this.removeEventListener(e[1],r,r.$),delete this[i]}}}function j(t,e){return function(n){var i=zo.event;zo.event=n,e[0]=this.__data__;try{t.apply(this,e)}finally{zo.event=i}}}function K(t,e){var n=j(t,e);return function(t){var e=this,i=t.relatedTarget;i&&(i===e||8&i.compareDocumentPosition(e))||n.call(e,t)}}function q(n){var i=".dragsuppress-"+ ++fa,r="click"+i,o=zo.select(e(n)).on("touchmove"+i,w).on("dragstart"+i,w).on("selectstart"+i,w);if(null==da&&(da=!("onselectstart"in n)&&x(n.style,"userSelect")),da){var a=t(n).style,s=a[da];a[da]="none"}return function(t){if(o.on(i,null),da&&(a[da]=s),t){var e=function(){o.on(r,null)};o.on(r,function(){w(),e()},!0),setTimeout(e,0)}}}function Z(t,n){n.changedTouches&&(n=n.changedTouches[0]);var i=t.ownerSVGElement||t;if(i.createSVGPoint){var r=i.createSVGPoint();if(pa<0){var o=e(t);if(o.scrollX||o.scrollY){var a=(i=zo.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important"))[0][0].getScreenCTM();pa=!(a.f||a.e),i.remove()}}return pa?(r.x=n.pageX,r.y=n.pageY):(r.x=n.clientX,r.y=n.clientY),r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}var s=t.getBoundingClientRect();return[n.clientX-s.left-t.clientLeft,n.clientY-s.top-t.clientTop]}function Q(){return zo.event.changedTouches[0].identifier}function J(t){return t>0?1:t<0?-1:0}function $(t,e,n){return(e[0]-t[0])*(n[1]-t[1])-(e[1]-t[1])*(n[0]-t[0])}function tt(t){return t>1?0:t<-1?va:Math.acos(t)}function et(t){return t>1?xa:t<-1?-xa:Math.asin(t)}function nt(t){return((t=Math.exp(t))-1/t)/2}function it(t){return((t=Math.exp(t))+1/t)/2}function rt(t){return((t=Math.exp(2*t))-1)/(t+1)}function ot(t){return(t=Math.sin(t/2))*t}function at(){}function st(t,e,n){return this instanceof st?(this.h=+t,this.s=+e,void(this.l=+n)):arguments.length<2?t instanceof st?new st(t.h,t.s,t.l):St(""+t,Et,st):new st(t,e,n)}function lt(t,e,n){function i(t){return t>360?t-=360:t<0&&(t+=360),t<60?o+(a-o)*t/60:t<180?a:t<240?o+(a-o)*(240-t)/60:o}function r(t){return Math.round(255*i(t))}var o,a;return t=isNaN(t)?0:(t%=360)<0?t+360:t,e=isNaN(e)?0:e<0?0:e>1?1:e,n=n<0?0:n>1?1:n,a=n<=.5?n*(1+e):n+e-n*e,o=2*n-a,new vt(r(t+120),r(t),r(t-120))}function ut(t,e,n){return this instanceof ut?(this.h=+t,this.c=+e,void(this.l=+n)):arguments.length<2?t instanceof ut?new ut(t.h,t.c,t.l):t instanceof ht?ft(t.l,t.a,t.b):ft((t=Tt((t=zo.rgb(t)).r,t.g,t.b)).l,t.a,t.b):new ut(t,e,n)}function ct(t,e,n){return isNaN(t)&&(t=0),isNaN(e)&&(e=0),new ht(n,Math.cos(t*=Sa)*e,Math.sin(t)*e)}function ht(t,e,n){return this instanceof ht?(this.l=+t,this.a=+e,void(this.b=+n)):arguments.length<2?t instanceof ht?new ht(t.l,t.a,t.b):t instanceof ut?ct(t.h,t.c,t.l):Tt((t=vt(t)).r,t.g,t.b):new ht(t,e,n)}function dt(t,e,n){var i=(t+16)/116,r=i+e/500,o=i-n/200;return r=pt(r)*Ia,i=pt(i)*Pa,o=pt(o)*Ma,new vt(_t(3.2404542*r-1.5371385*i-.4985314*o),_t(-.969266*r+1.8760108*i+.041556*o),_t(.0556434*r-.2040259*i+1.0572252*o))}function ft(t,e,n){return t>0?new ut(Math.atan2(n,e)*Ea,Math.sqrt(e*e+n*n),t):new ut(NaN,NaN,t)}function pt(t){return t>.206893034?t*t*t:(t-4/29)/7.787037}function gt(t){return t>.008856?Math.pow(t,1/3):7.787037*t+4/29}function _t(t){return Math.round(255*(t<=.00304?12.92*t:1.055*Math.pow(t,1/2.4)-.055))}function vt(t,e,n){return this instanceof vt?(this.r=~~t,this.g=~~e,void(this.b=~~n)):arguments.length<2?t instanceof vt?new vt(t.r,t.g,t.b):St(""+t,vt,lt):new vt(t,e,n)}function yt(t){return new vt(t>>16,t>>8&255,255&t)}function mt(t){return yt(t)+""}function xt(t){return t<16?"0"+Math.max(0,t).toString(16):Math.min(255,t).toString(16)}function St(t,e,n){var i,r,o,a=0,s=0,l=0;if(i=/([a-z]+)\((.*)\)/.exec(t=t.toLowerCase()))switch(r=i[2].split(","),i[1]){case"hsl":return n(parseFloat(r[0]),parseFloat(r[1])/100,parseFloat(r[2])/100);case"rgb":return e(Ct(r[0]),Ct(r[1]),Ct(r[2]))}return(o=Fa.get(t))?e(o.r,o.g,o.b):(null==t||"#"!==t.charAt(0)||isNaN(o=parseInt(t.slice(1),16))||(4===t.length?(a=(3840&o)>>4,a|=a>>4,s=240&o,s|=s>>4,l=15&o,l|=l<<4):7===t.length&&(a=(16711680&o)>>16,s=(65280&o)>>8,l=255&o)),e(a,s,l))}function Et(t,e,n){var i,r,o=Math.min(t/=255,e/=255,n/=255),a=Math.max(t,e,n),s=a-o,l=(a+o)/2;return s?(r=l<.5?s/(a+o):s/(2-a-o),i=t==a?(e-n)/s+(e<n?6:0):e==a?(n-t)/s+2:(t-e)/s+4,i*=60):(i=NaN,r=l>0&&l<1?0:i),new st(i,r,l)}function Tt(t,e,n){var i=gt((.4124564*(t=wt(t))+.3575761*(e=wt(e))+.1804375*(n=wt(n)))/Ia),r=gt((.2126729*t+.7151522*e+.072175*n)/Pa);return ht(116*r-16,500*(i-r),200*(r-gt((.0193339*t+.119192*e+.9503041*n)/Ma)))}function wt(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Ct(t){var e=parseFloat(t);return"%"===t.charAt(t.length-1)?Math.round(2.55*e):e}function bt(t){return"function"==typeof t?t:function(){return t}}function At(t){return function(e,n,i){return 2===arguments.length&&"function"==typeof n&&(i=n,n=null),Rt(e,n,t,i)}}function Rt(t,e,n,i){function r(){var t,e=l.status;if(!e&&It(l)||e>=200&&e<300||304===e){try{t=n.call(o,l)}catch(t){return void a.error.call(o,t)}a.load.call(o,t)}else a.error.call(o,l)}var o={},a=zo.dispatch("beforesend","progress","load","error"),s={},l=new XMLHttpRequest,u=null;return!this.XDomainRequest||"withCredentials"in l||!/^(http(s)?:)?\/\//.test(t)||(l=new XDomainRequest),"onload"in l?l.onload=l.onerror=r:l.onreadystatechange=function(){l.readyState>3&&r()},l.onprogress=function(t){var e=zo.event;zo.event=t;try{a.progress.call(o,l)}finally{zo.event=e}},o.header=function(t,e){return t=(t+"").toLowerCase(),arguments.length<2?s[t]:(null==e?delete s[t]:s[t]=e+"",o)},o.mimeType=function(t){return arguments.length?(e=null==t?null:t+"",o):e},o.responseType=function(t){return arguments.length?(u=t,o):u},o.response=function(t){return n=t,o},["get","post"].forEach(function(t){o[t]=function(){return o.send.apply(o,[t].concat(Ho(arguments)))}}),o.send=function(n,i,r){if(2===arguments.length&&"function"==typeof i&&(r=i,i=null),l.open(n,t,!0),null==e||"accept"in s||(s.accept=e+",*/*"),l.setRequestHeader)for(var c in s)l.setRequestHeader(c,s[c]);return null!=e&&l.overrideMimeType&&l.overrideMimeType(e),null!=u&&(l.responseType=u),null!=r&&o.on("error",r).on("load",function(t){r(null,t)}),a.beforesend.call(o,l),l.send(null==i?null:i),o},o.abort=function(){return l.abort(),o},zo.rebind(o,a,"on"),null==i?o:o.get(Lt(i))}function Lt(t){return 1===t.length?function(e,n){t(null==e?n:null)}:t}function It(t){var e=t.responseType;return e&&"text"!==e?t.response:t.responseText}function Pt(t,e,n){var i=arguments.length;i<2&&(e=0),i<3&&(n=Date.now());var r={c:t,t:n+e,n:null};return Na?Na.n=r:ka=r,Na=r,Ga||(Va=clearTimeout(Va),Ga=1,Ua(Mt)),r}function Mt(){var t=Ot(),e=Dt()-t;e>24?(isFinite(e)&&(clearTimeout(Va),Va=setTimeout(Mt,e)),Ga=0):(Ga=1,Ua(Mt))}function Ot(){for(var t=Date.now(),e=ka;e;)t>=e.t&&e.c(t-e.t)&&(e.c=null),e=e.n;return t}function Dt(){for(var t,e=ka,n=1/0;e;)e.c?(e.t<n&&(n=e.t),e=(t=e).n):e=t?t.n=e.n:ka=e.n;return Na=t,n}function Ft(t,e){return e-(t?Math.ceil(Math.log(t)/Math.LN10):1)}function kt(t){var e=t.decimal,n=t.thousands,i=t.grouping,r=t.currency,o=i&&n?function(t,e){for(var r=t.length,o=[],a=0,s=i[0],l=0;r>0&&s>0&&(l+s+1>e&&(s=Math.max(1,e-l)),o.push(t.substring(r-=s,r+s)),!((l+=s+1)>e));)s=i[a=(a+1)%i.length];return o.reverse().join(n)}:y;return function(t){var n=za.exec(t),i=n[1]||" ",a=n[2]||">",s=n[3]||"-",l=n[4]||"",u=n[5],c=+n[6],h=n[7],d=n[8],f=n[9],p=1,g="",_="",v=!1,y=!0;switch(d&&(d=+d.substring(1)),(u||"0"===i&&"="===a)&&(u=i="0",a="="),f){case"n":h=!0,f="g";break;case"%":p=100,_="%",f="f";break;case"p":p=100,_="%",f="r";break;case"b":case"o":case"x":case"X":"#"===l&&(g="0"+f.toLowerCase());case"c":y=!1;case"d":v=!0,d=0;break;case"s":p=-1,f="r"}"$"===l&&(g=r[0],_=r[1]),"r"!=f||d||(f="g"),null!=d&&("g"==f?d=Math.max(1,Math.min(21,d)):"e"!=f&&"f"!=f||(d=Math.max(0,Math.min(20,d)))),f=Xa.get(f)||Nt;var m=u&&h;return function(t){var n=_;if(v&&t%1)return"";var r=t<0||0===t&&1/t<0?(t=-t,"-"):"-"===s?"":s;if(p<0){var l=zo.formatPrefix(t,d);t=l.scale(t),n=l.symbol+_}else t*=p;var x,S,E=(t=f(t,d)).lastIndexOf(".");if(E<0){var T=y?t.lastIndexOf("e"):-1;T<0?(x=t,S=""):(x=t.substring(0,T),S=t.substring(T))}else x=t.substring(0,E),S=e+t.substring(E+1);!u&&h&&(x=o(x,1/0));var w=g.length+x.length+S.length+(m?0:r.length),C=w<c?new Array(w=c-w+1).join(i):"";return m&&(x=o(C+x,C.length?c-S.length:1/0)),r+=g,t=x+S,("<"===a?r+t+C:">"===a?C+r+t:"^"===a?C.substring(0,w>>=1)+r+t+C.substring(w):r+(m?t:C+t))+n}}}function Nt(t){return t+""}function Gt(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}function Vt(t,e,n){function i(e){var n=t(e),i=o(n,1);return e-n<i-e?n:i}function r(n){return e(n=t(new Wa(n-1)),1),n}function o(t,n){return e(t=new Wa(+t),n),t}function a(t,i,o){var a=r(t),s=[];if(o>1)for(;a<i;)n(a)%o||s.push(new Date(+a)),e(a,1);else for(;a<i;)s.push(new Date(+a)),e(a,1);return s}t.floor=t,t.round=i,t.ceil=r,t.offset=o,t.range=a;var s=t.utc=Ut(t);return s.floor=s,s.round=Ut(i),s.ceil=Ut(r),s.offset=Ut(o),s.range=function(t,e,n){try{Wa=Gt;var i=new Gt;return i._=t,a(i,e,n)}finally{Wa=Date}},t}function Ut(t){return function(e,n){try{Wa=Gt;var i=new Gt;return i._=e,t(i,n)._}finally{Wa=Date}}}function Bt(t){function e(t){function e(e){for(var n,r,o,a=[],s=-1,l=0;++s<i;)37===t.charCodeAt(s)&&(a.push(t.slice(l,s)),null!=(r=ja[n=t.charAt(++s)])&&(n=t.charAt(++s)),(o=x[n])&&(n=o(e,null==r?"e"===n?" ":"0":r)),a.push(n),l=s+1);return a.push(t.slice(l,s)),a.join("")}var i=t.length;return e.parse=function(e){var i={y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null};if(n(i,t,e,0)!=e.length)return null;"p"in i&&(i.H=i.H%12+12*i.p);var r=null!=i.Z&&Wa!==Gt,o=new(r?Gt:Wa);return"j"in i?o.setFullYear(i.y,0,i.j):"W"in i||"U"in i?("w"in i||(i.w="W"in i?1:0),o.setFullYear(i.y,0,1),o.setFullYear(i.y,0,"W"in i?(i.w+6)%7+7*i.W-(o.getDay()+5)%7:i.w+7*i.U-(o.getDay()+6)%7)):o.setFullYear(i.y,i.m,i.d),o.setHours(i.H+(i.Z/100|0),i.M+i.Z%100,i.S,i.L),r?o._:o},e.toString=function(){return t},e}function n(t,e,n,i){for(var r,o,a,s=0,l=e.length,u=n.length;s<l;){if(i>=u)return-1;if(37===(r=e.charCodeAt(s++))){if(a=e.charAt(s++),!(o=S[a in ja?e.charAt(s++):a])||(i=o(t,n,i))<0)return-1}else if(r!=n.charCodeAt(i++))return-1}return i}var i=t.dateTime,r=t.date,o=t.time,a=t.periods,s=t.days,l=t.shortDays,u=t.months,c=t.shortMonths;e.multi=(e.utc=function(t){function n(t){try{var e=new(Wa=Gt);return e._=t,i(e)}finally{Wa=Date}}var i=e(t);return n.parse=function(t){try{Wa=Gt;var e=i.parse(t);return e&&e._}finally{Wa=Date}},n.toString=i.toString,n}).multi=se;var h=zo.map(),d=Xt(s),f=Ht(s),p=Xt(l),g=Ht(l),_=Xt(u),v=Ht(u),y=Xt(c),m=Ht(c);a.forEach(function(t,e){h.set(t.toLowerCase(),e)});var x={a:function(t){return l[t.getDay()]},A:function(t){return s[t.getDay()]},b:function(t){return c[t.getMonth()]},B:function(t){return u[t.getMonth()]},c:e(i),d:function(t,e){return zt(t.getDate(),e,2)},e:function(t,e){return zt(t.getDate(),e,2)},H:function(t,e){return zt(t.getHours(),e,2)},I:function(t,e){return zt(t.getHours()%12||12,e,2)},j:function(t,e){return zt(1+Ha.dayOfYear(t),e,3)},L:function(t,e){return zt(t.getMilliseconds(),e,3)},m:function(t,e){return zt(t.getMonth()+1,e,2)},M:function(t,e){return zt(t.getMinutes(),e,2)},p:function(t){return a[+(t.getHours()>=12)]},S:function(t,e){return zt(t.getSeconds(),e,2)},U:function(t,e){return zt(Ha.sundayOfYear(t),e,2)},w:function(t){return t.getDay()},W:function(t,e){return zt(Ha.mondayOfYear(t),e,2)},x:e(r),X:e(o),y:function(t,e){return zt(t.getFullYear()%100,e,2)},Y:function(t,e){return zt(t.getFullYear()%1e4,e,4)},Z:oe,"%":function(){return"%"}},S={a:function(t,e,n){p.lastIndex=0;var i=p.exec(e.slice(n));return i?(t.w=g.get(i[0].toLowerCase()),n+i[0].length):-1},A:function(t,e,n){d.lastIndex=0;var i=d.exec(e.slice(n));return i?(t.w=f.get(i[0].toLowerCase()),n+i[0].length):-1},b:function(t,e,n){y.lastIndex=0;var i=y.exec(e.slice(n));return i?(t.m=m.get(i[0].toLowerCase()),n+i[0].length):-1},B:function(t,e,n){_.lastIndex=0;var i=_.exec(e.slice(n));return i?(t.m=v.get(i[0].toLowerCase()),n+i[0].length):-1},c:function(t,e,i){return n(t,x.c.toString(),e,i)},d:$t,e:$t,H:ee,I:ee,j:te,L:re,m:Jt,M:ne,p:function(t,e,n){var i=h.get(e.slice(n,n+=2).toLowerCase());return null==i?-1:(t.p=i,n)},S:ie,U:Yt,w:Wt,W:jt,x:function(t,e,i){return n(t,x.x.toString(),e,i)},X:function(t,e,i){return n(t,x.X.toString(),e,i)},y:qt,Y:Kt,Z:Zt,"%":ae};return e}function zt(t,e,n){var i=t<0?"-":"",r=(i?-t:t)+"",o=r.length;return i+(o<n?new Array(n-o+1).join(e)+r:r)}function Xt(t){return new RegExp("^(?:"+t.map(zo.requote).join("|")+")","i")}function Ht(t){for(var e=new u,n=-1,i=t.length;++n<i;)e.set(t[n].toLowerCase(),n);return e}function Wt(t,e,n){Ka.lastIndex=0;var i=Ka.exec(e.slice(n,n+1));return i?(t.w=+i[0],n+i[0].length):-1}function Yt(t,e,n){Ka.lastIndex=0;var i=Ka.exec(e.slice(n));return i?(t.U=+i[0],n+i[0].length):-1}function jt(t,e,n){Ka.lastIndex=0;var i=Ka.exec(e.slice(n));return i?(t.W=+i[0],n+i[0].length):-1}function Kt(t,e,n){Ka.lastIndex=0;var i=Ka.exec(e.slice(n,n+4));return i?(t.y=+i[0],n+i[0].length):-1}function qt(t,e,n){Ka.lastIndex=0;var i=Ka.exec(e.slice(n,n+2));return i?(t.y=Qt(+i[0]),n+i[0].length):-1}function Zt(t,e,n){return/^[+-]\d{4}$/.test(e=e.slice(n,n+5))?(t.Z=-e,n+5):-1}function Qt(t){return t+(t>68?1900:2e3)}function Jt(t,e,n){Ka.lastIndex=0;var i=Ka.exec(e.slice(n,n+2));return i?(t.m=i[0]-1,n+i[0].length):-1}function $t(t,e,n){Ka.lastIndex=0;var i=Ka.exec(e.slice(n,n+2));return i?(t.d=+i[0],n+i[0].length):-1}function te(t,e,n){Ka.lastIndex=0;var i=Ka.exec(e.slice(n,n+3));return i?(t.j=+i[0],n+i[0].length):-1}function ee(t,e,n){Ka.lastIndex=0;var i=Ka.exec(e.slice(n,n+2));return i?(t.H=+i[0],n+i[0].length):-1}function ne(t,e,n){Ka.lastIndex=0;var i=Ka.exec(e.slice(n,n+2));return i?(t.M=+i[0],n+i[0].length):-1}function ie(t,e,n){Ka.lastIndex=0;var i=Ka.exec(e.slice(n,n+2));return i?(t.S=+i[0],n+i[0].length):-1}function re(t,e,n){Ka.lastIndex=0;var i=Ka.exec(e.slice(n,n+3));return i?(t.L=+i[0],n+i[0].length):-1}function oe(t){var e=t.getTimezoneOffset(),n=e>0?"-":"+",i=Jo(e)/60|0,r=Jo(e)%60;return n+zt(i,"0",2)+zt(r,"0",2)}function ae(t,e,n){qa.lastIndex=0;var i=qa.exec(e.slice(n,n+1));return i?n+i[0].length:-1}function se(t){for(var e=t.length,n=-1;++n<e;)t[n][0]=this(t[n][0]);return function(e){for(var n=0,i=t[n];!i[1](e);)i=t[++n];return i[0](e)}}function le(){}function ue(t,e,n){var i=n.s=t+e,r=i-t,o=i-r;n.t=t-o+(e-r)}function ce(t,e){t&&$a.hasOwnProperty(t.type)&&$a[t.type](t,e)}function he(t,e,n){var i,r=-1,o=t.length-n;for(e.lineStart();++r<o;)i=t[r],e.point(i[0],i[1],i[2]);e.lineEnd()}function de(t,e){var n=-1,i=t.length;for(e.polygonStart();++n<i;)he(t[n],e,1);e.polygonEnd()}function fe(){function t(t,e){e=e*Sa/2+va/4;var n=(t*=Sa)-i,a=n>=0?1:-1,s=a*n,l=Math.cos(e),u=Math.sin(e),c=o*u,h=r*l+c*Math.cos(s),d=c*a*Math.sin(s);es.add(Math.atan2(d,h)),i=t,r=l,o=u}var e,n,i,r,o;ns.point=function(a,s){ns.point=t,i=(e=a)*Sa,r=Math.cos(s=(n=s)*Sa/2+va/4),o=Math.sin(s)},ns.lineEnd=function(){t(e,n)}}function pe(t){var e=t[0],n=t[1],i=Math.cos(n);return[i*Math.cos(e),i*Math.sin(e),Math.sin(n)]}function ge(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function _e(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function ve(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function ye(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function me(t){var e=Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function xe(t){return[Math.atan2(t[1],t[0]),et(t[2])]}function Se(t,e){return Jo(t[0]-e[0])<ga&&Jo(t[1]-e[1])<ga}function Ee(t,e){t*=Sa;var n=Math.cos(e*=Sa);Te(n*Math.cos(t),n*Math.sin(t),Math.sin(e))}function Te(t,e,n){os+=(t-os)/++is,as+=(e-as)/is,ss+=(n-ss)/is}function we(){function t(t,r){t*=Sa;var o=Math.cos(r*=Sa),a=o*Math.cos(t),s=o*Math.sin(t),l=Math.sin(r),u=Math.atan2(Math.sqrt((u=n*l-i*s)*u+(u=i*a-e*l)*u+(u=e*s-n*a)*u),e*a+n*s+i*l);rs+=u,ls+=u*(e+(e=a)),us+=u*(n+(n=s)),cs+=u*(i+(i=l)),Te(e,n,i)}var e,n,i;ps.point=function(r,o){r*=Sa;var a=Math.cos(o*=Sa);e=a*Math.cos(r),n=a*Math.sin(r),i=Math.sin(o),ps.point=t,Te(e,n,i)}}function Ce(){ps.point=Ee}function be(){function t(t,e){t*=Sa;var n=Math.cos(e*=Sa),a=n*Math.cos(t),s=n*Math.sin(t),l=Math.sin(e),u=r*l-o*s,c=o*a-i*l,h=i*s-r*a,d=Math.sqrt(u*u+c*c+h*h),f=i*a+r*s+o*l,p=d&&-tt(f)/d,g=Math.atan2(d,f);hs+=p*u,ds+=p*c,fs+=p*h,rs+=g,ls+=g*(i+(i=a)),us+=g*(r+(r=s)),cs+=g*(o+(o=l)),Te(i,r,o)}var e,n,i,r,o;ps.point=function(a,s){e=a,n=s,ps.point=t,a*=Sa;var l=Math.cos(s*=Sa);i=l*Math.cos(a),r=l*Math.sin(a),o=Math.sin(s),Te(i,r,o)},ps.lineEnd=function(){t(e,n),ps.lineEnd=Ce,ps.point=Ee}}function Ae(t,e){function n(n,i){return n=t(n,i),e(n[0],n[1])}return t.invert&&e.invert&&(n.invert=function(n,i){return(n=e.invert(n,i))&&t.invert(n[0],n[1])}),n}function Re(){return!0}function Le(t,e,n,i,r){var o=[],a=[];if(t.forEach(function(t){if(!((e=t.length-1)<=0)){var e,n=t[0],i=t[e];if(Se(n,i)){r.lineStart();for(var s=0;s<e;++s)r.point((n=t[s])[0],n[1]);r.lineEnd()}else{var l=new Pe(n,t,null,!0),u=new Pe(n,null,l,!1);l.o=u,o.push(l),a.push(u),u=new Pe(i,null,l=new Pe(i,t,null,!1),!0),l.o=u,o.push(l),a.push(u)}}}),a.sort(e),Ie(o),Ie(a),o.length){for(var s=0,l=n,u=a.length;s<u;++s)a[s].e=l=!l;for(var c,h,d=o[0];;){for(var f=d,p=!0;f.v;)if((f=f.n)===d)return;c=f.z,r.lineStart();do{if(f.v=f.o.v=!0,f.e){if(p)for(var s=0,u=c.length;s<u;++s)r.point((h=c[s])[0],h[1]);else i(f.x,f.n.x,1,r);f=f.n}else{if(p)for(s=(c=f.p.z).length-1;s>=0;--s)r.point((h=c[s])[0],h[1]);else i(f.x,f.p.x,-1,r);f=f.p}c=(f=f.o).z,p=!p}while(!f.v);r.lineEnd()}}}function Ie(t){if(e=t.length){for(var e,n,i=0,r=t[0];++i<e;)r.n=n=t[i],n.p=r,r=n;r.n=n=t[0],n.p=r}}function Pe(t,e,n,i){this.x=t,this.z=e,this.o=n,this.e=i,this.v=!1,this.n=this.p=null}function Me(t,e,n,i){return function(r,o){function a(e,n){var i=r(e,n);t(e=i[0],n=i[1])&&o.point(e,n)}function s(t,e){var n=r(t,e);_.point(n[0],n[1])}function l(){y.point=s,_.lineStart()}function u(){y.point=a,_.lineEnd()}function c(t,e){g.push([t,e]);var n=r(t,e);x.point(n[0],n[1])}function h(){x.lineStart(),g=[]}function d(){c(g[0][0],g[0][1]),x.lineEnd();var t,e=x.clean(),n=m.buffer(),i=n.length;if(g.pop(),p.push(g),g=null,i)if(1&e){var r,a=-1;if((i=(t=n[0]).length-1)>0){for(S||(o.polygonStart(),S=!0),o.lineStart();++a<i;)o.point((r=t[a])[0],r[1]);o.lineEnd()}}else i>1&&2&e&&n.push(n.pop().concat(n.shift())),f.push(n.filter(Oe))}var f,p,g,_=e(o),v=r.invert(i[0],i[1]),y={point:a,lineStart:l,lineEnd:u,polygonStart:function(){y.point=c,y.lineStart=h,y.lineEnd=d,f=[],p=[]},polygonEnd:function(){y.point=a,y.lineStart=l,y.lineEnd=u,f=zo.merge(f);var t=Ne(v,p);f.length?(S||(o.polygonStart(),S=!0),Le(f,Fe,t,n,o)):t&&(S||(o.polygonStart(),S=!0),o.lineStart(),n(null,null,1,o),o.lineEnd()),S&&(o.polygonEnd(),S=!1),f=p=null},sphere:function(){o.polygonStart(),o.lineStart(),n(null,null,1,o),o.lineEnd(),o.polygonEnd()}},m=De(),x=e(m),S=!1;return y}}function Oe(t){return t.length>1}function De(){var t,e=[];return{lineStart:function(){e.push(t=[])},point:function(e,n){t.push([e,n])},lineEnd:S,buffer:function(){var n=e;return e=[],t=null,n},rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))}}}function Fe(t,e){return((t=t.x)[0]<0?t[1]-xa-ga:xa-t[1])-((e=e.x)[0]<0?e[1]-xa-ga:xa-e[1])}function ke(t,e,n,i){var r,o,a=Math.sin(t-n);return Jo(a)>ga?Math.atan((Math.sin(e)*(o=Math.cos(i))*Math.sin(n)-Math.sin(i)*(r=Math.cos(e))*Math.sin(t))/(r*o*a)):(e+i)/2}function Ne(t,e){var n=t[0],i=t[1],r=[Math.sin(n),-Math.cos(n),0],o=0,a=0;es.reset();for(var s=0,l=e.length;s<l;++s){var u=e[s],c=u.length;if(c)for(var h=u[0],d=h[0],f=h[1]/2+va/4,p=Math.sin(f),g=Math.cos(f),_=1;;){_===c&&(_=0);var v=(t=u[_])[0],y=t[1]/2+va/4,m=Math.sin(y),x=Math.cos(y),S=v-d,E=S>=0?1:-1,T=E*S,w=T>va,C=p*m;if(es.add(Math.atan2(C*E*Math.sin(T),g*x+C*Math.cos(T))),o+=w?S+E*ya:S,w^d>=n^v>=n){var b=_e(pe(h),pe(t));me(b);var A=_e(r,b);me(A);var R=(w^S>=0?-1:1)*et(A[2]);(i>R||i===R&&(b[0]||b[1]))&&(a+=w^S>=0?1:-1)}if(!_++)break;d=v,p=m,g=x,h=t}}return(o<-ga||o<ga&&es<-ga)^1&a}function Ge(t){function e(t,e){return Math.cos(t)*Math.cos(e)>r}function n(t,e,n){var i=[1,0,0],o=_e(pe(t),pe(e)),a=ge(o,o),s=o[0],l=a-s*s;if(!l)return!n&&t;var u=r*a/l,c=-r*s/l,h=_e(i,o),d=ye(i,u);ve(d,ye(o,c));var f=h,p=ge(d,f),g=ge(f,f),_=p*p-g*(ge(d,d)-1);if(!(_<0)){var v=Math.sqrt(_),y=ye(f,(-p-v)/g);if(ve(y,d),y=xe(y),!n)return y;var m,x=t[0],S=e[0],E=t[1],T=e[1];S<x&&(m=x,x=S,S=m);var w=S-x,C=Jo(w-va)<ga;if(!C&&T<E&&(m=E,E=T,T=m),C||w<ga?C?E+T>0^y[1]<(Jo(y[0]-x)<ga?E:T):E<=y[1]&&y[1]<=T:w>va^(x<=y[0]&&y[0]<=S)){var b=ye(f,(-p+v)/g);return ve(b,d),[y,xe(b)]}}}function i(e,n){var i=o?t:va-t,r=0;return e<-i?r|=1:e>i&&(r|=2),n<-i?r|=4:n>i&&(r|=8),r}var r=Math.cos(t),o=r>0,a=Jo(r)>ga;return Me(e,function(t){var r,s,l,u,c;return{lineStart:function(){u=l=!1,c=1},point:function(h,d){var f,p=[h,d],g=e(h,d),_=o?g?0:i(h,d):g?i(h+(h<0?va:-va),d):0;if(!r&&(u=l=g)&&t.lineStart(),g!==l&&(f=n(r,p),(Se(r,f)||Se(p,f))&&(p[0]+=ga,p[1]+=ga,g=e(p[0],p[1]))),g!==l)c=0,g?(t.lineStart(),f=n(p,r),t.point(f[0],f[1])):(f=n(r,p),t.point(f[0],f[1]),t.lineEnd()),r=f;else if(a&&r&&o^g){var v;_&s||!(v=n(p,r,!0))||(c=0,o?(t.lineStart(),t.point(v[0][0],v[0][1]),t.point(v[1][0],v[1][1]),t.lineEnd()):(t.point(v[1][0],v[1][1]),t.lineEnd(),t.lineStart(),t.point(v[0][0],v[0][1])))}!g||r&&Se(r,p)||t.point(p[0],p[1]),r=p,l=g,s=_},lineEnd:function(){l&&t.lineEnd(),r=null},clean:function(){return c|(u&&l)<<1}}},hn(t,6*Sa),o?[0,-t]:[-va,t-va])}function Ve(t,e,n,i){return function(r){var o,a=r.a,s=r.b,l=a.x,u=a.y,c=0,h=1,d=s.x-l,f=s.y-u;if(o=t-l,d||!(o>0)){if(o/=d,d<0){if(o<c)return;o<h&&(h=o)}else if(d>0){if(o>h)return;o>c&&(c=o)}if(o=n-l,d||!(o<0)){if(o/=d,d<0){if(o>h)return;o>c&&(c=o)}else if(d>0){if(o<c)return;o<h&&(h=o)}if(o=e-u,f||!(o>0)){if(o/=f,f<0){if(o<c)return;o<h&&(h=o)}else if(f>0){if(o>h)return;o>c&&(c=o)}if(o=i-u,f||!(o<0)){if(o/=f,f<0){if(o>h)return;o>c&&(c=o)}else if(f>0){if(o<c)return;o<h&&(h=o)}return c>0&&(r.a={x:l+c*d,y:u+c*f}),h<1&&(r.b={x:l+h*d,y:u+h*f}),r}}}}}}function Ue(t,e,n,i){function r(i,r){return Jo(i[0]-t)<ga?r>0?0:3:Jo(i[0]-n)<ga?r>0?2:1:Jo(i[1]-e)<ga?r>0?1:0:r>0?3:2}function o(t,e){return a(t.x,e.x)}function a(t,e){var n=r(t,1),i=r(e,1);return n!==i?n-i:0===n?e[1]-t[1]:1===n?t[0]-e[0]:2===n?t[1]-e[1]:e[0]-t[0]}return function(s){function l(t){for(var e=0,n=p.length,i=t[1],r=0;r<n;++r)for(var o,a=1,s=p[r],l=s.length,u=s[0];a<l;++a)o=s[a],u[1]<=i?o[1]>i&&$(u,o,t)>0&&++e:o[1]<=i&&$(u,o,t)<0&&--e,u=o;return 0!==e}function u(o,s,l,u){var c=0,h=0;if(null==o||(c=r(o,l))!==(h=r(s,l))||a(o,s)<0^l>0)do{u.point(0===c||3===c?t:n,c>1?i:e)}while((c=(c+l+4)%4)!==h);else u.point(s[0],s[1])}function c(r,o){return t<=r&&r<=n&&e<=o&&o<=i}function h(t,e){c(t,e)&&s.point(t,e)}function d(t,e){var n=c(t=Math.max(-_s,Math.min(_s,t)),e=Math.max(-_s,Math.min(_s,e)));if(p&&g.push([t,e]),E)_=t,v=e,y=n,E=!1,n&&(s.lineStart(),s.point(t,e));else if(n&&S)s.point(t,e);else{var i={a:{x:m,y:x},b:{x:t,y:e}};b(i)?(S||(s.lineStart(),s.point(i.a.x,i.a.y)),s.point(i.b.x,i.b.y),n||s.lineEnd(),T=!1):n&&(s.lineStart(),s.point(t,e),T=!1)}m=t,x=e,S=n}var f,p,g,_,v,y,m,x,S,E,T,w=s,C=De(),b=Ve(t,e,n,i),A={point:h,lineStart:function(){A.point=d,p&&p.push(g=[]),E=!0,S=!1,m=x=NaN},lineEnd:function(){f&&(d(_,v),y&&S&&C.rejoin(),f.push(C.buffer())),A.point=h,S&&s.lineEnd()},polygonStart:function(){s=C,f=[],p=[],T=!0},polygonEnd:function(){s=w,f=zo.merge(f);var e=l([t,i]),n=T&&e,r=f.length;(n||r)&&(s.polygonStart(),n&&(s.lineStart(),u(null,null,1,s),s.lineEnd()),r&&Le(f,o,e,u,s),s.polygonEnd()),f=p=g=null}};return A}}function Be(t){var e=0,n=va/3,i=nn(t),r=i(e,n);return r.parallels=function(t){return arguments.length?i(e=t[0]*va/180,n=t[1]*va/180):[e/va*180,n/va*180]},r}function ze(t,e){function n(t,e){var n=Math.sqrt(o-2*r*Math.sin(e))/r;return[n*Math.sin(t*=r),a-n*Math.cos(t)]}var i=Math.sin(t),r=(i+Math.sin(e))/2,o=1+i*(2*r-i),a=Math.sqrt(o)/r;return n.invert=function(t,e){var n=a-e;return[Math.atan2(t,n)/r,et((o-(t*t+n*n)*r*r)/(2*r))]},n}function Xe(){function t(t,e){ys+=r*t-i*e,i=t,r=e}var e,n,i,r;Ts.point=function(o,a){Ts.point=t,e=i=o,n=r=a},Ts.lineEnd=function(){t(e,n)}}function He(){function t(t,e){a.push("M",t,",",e,o)}function e(t,e){a.push("M",t,",",e),s.point=n}function n(t,e){a.push("L",t,",",e)}function i(){s.point=t}function r(){a.push("Z")}var o=We(4.5),a=[],s={point:t,lineStart:function(){s.point=e},lineEnd:i,polygonStart:function(){s.lineEnd=r},polygonEnd:function(){s.lineEnd=i,s.point=t},pointRadius:function(t){return o=We(t),s},result:function(){if(a.length){var t=a.join("");return a=[],t}}};return s}function We(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}function Ye(t,e){os+=t,as+=e,++ss}function je(){function t(t,i){var r=t-e,o=i-n,a=Math.sqrt(r*r+o*o);ls+=a*(e+t)/2,us+=a*(n+i)/2,cs+=a,Ye(e=t,n=i)}var e,n;Cs.point=function(i,r){Cs.point=t,Ye(e=i,n=r)}}function Ke(){Cs.point=Ye}function qe(){function t(t,e){var n=t-i,o=e-r,a=Math.sqrt(n*n+o*o);ls+=a*(i+t)/2,us+=a*(r+e)/2,cs+=a,hs+=(a=r*t-i*e)*(i+t),ds+=a*(r+e),fs+=3*a,Ye(i=t,r=e)}var e,n,i,r;Cs.point=function(o,a){Cs.point=t,Ye(e=i=o,n=r=a)},Cs.lineEnd=function(){t(e,n)}}function Ze(t){function e(e,n){t.moveTo(e+a,n),t.arc(e,n,a,0,ya)}function n(e,n){t.moveTo(e,n),s.point=i}function i(e,n){t.lineTo(e,n)}function r(){s.point=e}function o(){t.closePath()}var a=4.5,s={point:e,lineStart:function(){s.point=n},lineEnd:r,polygonStart:function(){s.lineEnd=o},polygonEnd:function(){s.lineEnd=r,s.point=e},pointRadius:function(t){return a=t,s},result:S};return s}function Qe(t){function e(t){return(s?i:n)(t)}function n(e){return tn(e,function(n,i){n=t(n,i),e.point(n[0],n[1])})}function i(e){function n(n,i){n=t(n,i),e.point(n[0],n[1])}function i(){m=NaN,w.point=o,e.lineStart()}function o(n,i){var o=pe([n,i]),a=t(n,i);r(m,x,y,S,E,T,m=a[0],x=a[1],y=n,S=o[0],E=o[1],T=o[2],s,e),e.point(m,x)}function a(){w.point=n,e.lineEnd()}function l(){i(),w.point=u,w.lineEnd=c}function u(t,e){o(h=t,d=e),f=m,p=x,g=S,_=E,v=T,w.point=o}function c(){r(m,x,y,S,E,T,f,p,h,g,_,v,s,e),w.lineEnd=a,a()}var h,d,f,p,g,_,v,y,m,x,S,E,T,w={point:n,lineStart:i,lineEnd:a,polygonStart:function(){e.polygonStart(),w.lineStart=l},polygonEnd:function(){e.polygonEnd(),w.lineStart=i}};return w}function r(e,n,i,s,l,u,c,h,d,f,p,g,_,v){var y=c-e,m=h-n,x=y*y+m*m;if(x>4*o&&_--){var S=s+f,E=l+p,T=u+g,w=Math.sqrt(S*S+E*E+T*T),C=Math.asin(T/=w),b=Jo(Jo(T)-1)<ga||Jo(i-d)<ga?(i+d)/2:Math.atan2(E,S),A=t(b,C),R=A[0],L=A[1],I=R-e,P=L-n,M=m*I-y*P;(M*M/x>o||Jo((y*I+m*P)/x-.5)>.3||s*f+l*p+u*g<a)&&(r(e,n,i,s,l,u,R,L,b,S/=w,E/=w,T,_,v),v.point(R,L),r(R,L,b,S,E,T,c,h,d,f,p,g,_,v))}}var o=.5,a=Math.cos(30*Sa),s=16;return e.precision=function(t){return arguments.length?(s=(o=t*t)>0&&16,e):Math.sqrt(o)},e}function Je(t){var e=Qe(function(e,n){return t([e*Ea,n*Ea])});return function(t){return rn(e(t))}}function $e(t){this.stream=t}function tn(t,e){return{point:e,sphere:function(){t.sphere()},lineStart:function(){t.lineStart()},lineEnd:function(){t.lineEnd()},polygonStart:function(){t.polygonStart()},polygonEnd:function(){t.polygonEnd()}}}function en(t){return nn(function(){return t})()}function nn(t){function e(t){return t=s(t[0]*Sa,t[1]*Sa),[t[0]*d+l,u-t[1]*d]}function n(t){return(t=s.invert((t[0]-l)/d,(u-t[1])/d))&&[t[0]*Ea,t[1]*Ea]}function i(){s=Ae(a=sn(v,m,x),o);var t=o(g,_);return l=f-t[0]*d,u=p+t[1]*d,r()}function r(){return c&&(c.valid=!1,c=null),e}var o,a,s,l,u,c,h=Qe(function(t,e){return t=o(t,e),[t[0]*d+l,u-t[1]*d]}),d=150,f=480,p=250,g=0,_=0,v=0,m=0,x=0,S=gs,E=y,T=null,w=null;return e.stream=function(t){return c&&(c.valid=!1),c=rn(S(a,h(E(t)))),c.valid=!0,c},e.clipAngle=function(t){return arguments.length?(S=null==t?(T=t,gs):Ge((T=+t)*Sa),r()):T},e.clipExtent=function(t){return arguments.length?(w=t,E=t?Ue(t[0][0],t[0][1],t[1][0],t[1][1]):y,r()):w},e.scale=function(t){return arguments.length?(d=+t,i()):d},e.translate=function(t){return arguments.length?(f=+t[0],p=+t[1],i()):[f,p]},e.center=function(t){return arguments.length?(g=t[0]%360*Sa,_=t[1]%360*Sa,i()):[g*Ea,_*Ea]},e.rotate=function(t){return arguments.length?(v=t[0]%360*Sa,m=t[1]%360*Sa,x=t.length>2?t[2]%360*Sa:0,i()):[v*Ea,m*Ea,x*Ea]},zo.rebind(e,h,"precision"),function(){return o=t.apply(this,arguments),e.invert=o.invert&&n,i()}}function rn(t){return tn(t,function(e,n){t.point(e*Sa,n*Sa)})}function on(t,e){return[t,e]}function an(t,e){return[t>va?t-ya:t<-va?t+ya:t,e]}function sn(t,e,n){return t?e||n?Ae(un(t),cn(e,n)):un(t):e||n?cn(e,n):an}function ln(t){return function(e,n){return e+=t,[e>va?e-ya:e<-va?e+ya:e,n]}}function un(t){var e=ln(t);return e.invert=ln(-t),e}function cn(t,e){function n(t,e){var n=Math.cos(e),s=Math.cos(t)*n,l=Math.sin(t)*n,u=Math.sin(e),c=u*i+s*r;return[Math.atan2(l*o-c*a,s*i-u*r),et(c*o+l*a)]}var i=Math.cos(t),r=Math.sin(t),o=Math.cos(e),a=Math.sin(e);return n.invert=function(t,e){var n=Math.cos(e),s=Math.cos(t)*n,l=Math.sin(t)*n,u=Math.sin(e),c=u*o-l*a;return[Math.atan2(l*o+u*a,s*i+c*r),et(c*i-s*r)]},n}function hn(t,e){var n=Math.cos(t),i=Math.sin(t);return function(r,o,a,s){var l=a*e;null!=r?(r=dn(n,r),o=dn(n,o),(a>0?r<o:r>o)&&(r+=a*ya)):(r=t+a*ya,o=t-.5*l);for(var u,c=r;a>0?c>o:c<o;c-=l)s.point((u=xe([n,-i*Math.cos(c),-i*Math.sin(c)]))[0],u[1])}}function dn(t,e){var n=pe(e);n[0]-=t,me(n);var i=tt(-n[1]);return((-n[2]<0?-i:i)+2*Math.PI-ga)%(2*Math.PI)}function fn(t,e,n){var i=zo.range(t,e-ga,n).concat(e);return function(t){return i.map(function(e){return[t,e]})}}function pn(t,e,n){var i=zo.range(t,e-ga,n).concat(e);return function(t){return i.map(function(e){return[e,t]})}}function gn(t){return t.source}function _n(t){return t.target}function vn(t,e,n,i){var r=Math.cos(e),o=Math.sin(e),a=Math.cos(i),s=Math.sin(i),l=r*Math.cos(t),u=r*Math.sin(t),c=a*Math.cos(n),h=a*Math.sin(n),d=2*Math.asin(Math.sqrt(ot(i-e)+r*a*ot(n-t))),f=1/Math.sin(d),p=d?function(t){var e=Math.sin(t*=d)*f,n=Math.sin(d-t)*f,i=n*l+e*c,r=n*u+e*h,a=n*o+e*s;return[Math.atan2(r,i)*Ea,Math.atan2(a,Math.sqrt(i*i+r*r))*Ea]}:function(){return[t*Ea,e*Ea]};return p.distance=d,p}function yn(t,e){function n(e,n){var i=Math.cos(e),r=Math.cos(n),o=t(i*r);return[o*r*Math.sin(e),o*Math.sin(n)]}return n.invert=function(t,n){var i=Math.sqrt(t*t+n*n),r=e(i),o=Math.sin(r),a=Math.cos(r);return[Math.atan2(t*o,i*a),Math.asin(i&&n*o/i)]},n}function mn(t,e){function n(t,e){a>0?e<-xa+ga&&(e=-xa+ga):e>xa-ga&&(e=xa-ga);var n=a/Math.pow(r(e),o);return[n*Math.sin(o*t),a-n*Math.cos(o*t)]}var i=Math.cos(t),r=function(t){return Math.tan(va/4+t/2)},o=t===e?Math.sin(t):Math.log(i/Math.cos(e))/Math.log(r(e)/r(t)),a=i*Math.pow(r(t),o)/o;return o?(n.invert=function(t,e){var n=a-e,i=J(o)*Math.sqrt(t*t+n*n);return[Math.atan2(t,n)/o,2*Math.atan(Math.pow(a/i,1/o))-xa]},n):Sn}function xn(t,e){function n(t,e){var n=o-e;return[n*Math.sin(r*t),o-n*Math.cos(r*t)]}var i=Math.cos(t),r=t===e?Math.sin(t):(i-Math.cos(e))/(e-t),o=i/r+t;return Jo(r)<ga?on:(n.invert=function(t,e){var n=o-e;return[Math.atan2(t,n)/r,o-J(r)*Math.sqrt(t*t+n*n)]},n)}function Sn(t,e){return[t,Math.log(Math.tan(va/4+e/2))]}function En(t){var e,n=en(t),i=n.scale,r=n.translate,o=n.clipExtent;return n.scale=function(){var t=i.apply(n,arguments);return t===n?e?n.clipExtent(null):n:t},n.translate=function(){var t=r.apply(n,arguments);return t===n?e?n.clipExtent(null):n:t},n.clipExtent=function(t){var a=o.apply(n,arguments);if(a===n){if(e=null==t){var s=va*i(),l=r();o([[l[0]-s,l[1]-s],[l[0]+s,l[1]+s]])}}else e&&(a=null);return a},n.clipExtent(null)}function Tn(t,e){return[Math.log(Math.tan(va/4+e/2)),-t]}function wn(t){return t[0]}function Cn(t){return t[1]}function bn(t){for(var e=t.length,n=[0,1],i=2,r=2;r<e;r++){for(;i>1&&$(t[n[i-2]],t[n[i-1]],t[r])<=0;)--i;n[i++]=r}return n.slice(0,i)}function An(t,e){return t[0]-e[0]||t[1]-e[1]}function Rn(t,e,n){return(n[0]-e[0])*(t[1]-e[1])<(n[1]-e[1])*(t[0]-e[0])}function Ln(t,e,n,i){var r=t[0],o=n[0],a=e[0]-r,s=i[0]-o,l=t[1],u=n[1],c=e[1]-l,h=i[1]-u,d=(s*(l-u)-h*(r-o))/(h*a-s*c);return[r+d*a,l+d*c]}function In(t){var e=t[0],n=t[t.length-1];return!(e[0]-n[0]||e[1]-n[1])}function Pn(){Jn(this),this.edge=this.site=this.circle=null}function Mn(t){var e=Vs.pop()||new Pn;return e.site=t,e}function On(t){Xn(t),ks.remove(t),Vs.push(t),Jn(t)}function Dn(t){var e=t.circle,n=e.x,i=e.cy,r={x:n,y:i},o=t.P,a=t.N,s=[t];On(t);for(var l=o;l.circle&&Jo(n-l.circle.x)<ga&&Jo(i-l.circle.cy)<ga;)o=l.P,s.unshift(l),On(l),l=o;s.unshift(l),Xn(l);for(var u=a;u.circle&&Jo(n-u.circle.x)<ga&&Jo(i-u.circle.cy)<ga;)a=u.N,s.push(u),On(u),u=a;s.push(u),Xn(u);var c,h=s.length;for(c=1;c<h;++c)u=s[c],l=s[c-1],qn(u.edge,l.site,u.site,r);l=s[0],(u=s[h-1]).edge=jn(l.site,u.site,null,r),zn(l),zn(u)}function Fn(t){for(var e,n,i,r,o=t.x,a=t.y,s=ks._;s;)if((i=kn(s,a)-o)>ga)s=s.L;else{if(!((r=o-Nn(s,a))>ga)){i>-ga?(e=s.P,n=s):r>-ga?(e=s,n=s.N):e=n=s;break}if(!s.R){e=s;break}s=s.R}var l=Mn(t);if(ks.insert(e,l),e||n){if(e===n)return Xn(e),n=Mn(e.site),ks.insert(l,n),l.edge=n.edge=jn(e.site,l.site),zn(e),void zn(n);if(n){Xn(e),Xn(n);var u=e.site,c=u.x,h=u.y,d=t.x-c,f=t.y-h,p=n.site,g=p.x-c,_=p.y-h,v=2*(d*_-f*g),y=d*d+f*f,m=g*g+_*_,x={x:(_*y-f*m)/v+c,y:(d*m-g*y)/v+h};qn(n.edge,u,p,x),l.edge=jn(u,t,null,x),n.edge=jn(t,p,null,x),zn(e),zn(n)}else l.edge=jn(e.site,l.site)}}function kn(t,e){var n=t.site,i=n.x,r=n.y,o=r-e;if(!o)return i;var a=t.P;if(!a)return-1/0;var s=(n=a.site).x,l=n.y,u=l-e;if(!u)return s;var c=s-i,h=1/o-1/u,d=c/u;return h?(-d+Math.sqrt(d*d-2*h*(c*c/(-2*u)-l+u/2+r-o/2)))/h+i:(i+s)/2}function Nn(t,e){var n=t.N;if(n)return kn(n,e);var i=t.site;return i.y===e?i.x:1/0}function Gn(t){this.site=t,this.edges=[]}function Vn(t){for(var e,n,i,r,o,a,s,l,u,c,h=t[0][0],d=t[1][0],f=t[0][1],p=t[1][1],g=Fs,_=g.length;_--;)if((o=g[_])&&o.prepare())for(l=(s=o.edges).length,a=0;a<l;)i=(c=s[a].end()).x,r=c.y,e=(u=s[++a%l].start()).x,n=u.y,(Jo(i-e)>ga||Jo(r-n)>ga)&&(s.splice(a,0,new Zn(Kn(o.site,c,Jo(i-h)<ga&&p-r>ga?{x:h,y:Jo(e-h)<ga?n:p}:Jo(r-p)<ga&&d-i>ga?{x:Jo(n-p)<ga?e:d,y:p}:Jo(i-d)<ga&&r-f>ga?{x:d,y:Jo(e-d)<ga?n:f}:Jo(r-f)<ga&&i-h>ga?{x:Jo(n-f)<ga?e:h,y:f}:null),o.site,null)),++l)}function Un(t,e){return e.angle-t.angle}function Bn(){Jn(this),this.x=this.y=this.arc=this.site=this.cy=null}function zn(t){var e=t.P,n=t.N;if(e&&n){var i=e.site,r=t.site,o=n.site;if(i!==o){var a=r.x,s=r.y,l=i.x-a,u=i.y-s,c=o.x-a,h=2*(l*(_=o.y-s)-u*c);if(!(h>=-_a)){var d=l*l+u*u,f=c*c+_*_,p=(_*d-u*f)/h,g=(l*f-c*d)/h,_=g+s,v=Us.pop()||new Bn;v.arc=t,v.site=r,v.x=p+a,v.y=_+Math.sqrt(p*p+g*g),v.cy=_,t.circle=v;for(var y=null,m=Gs._;m;)if(v.y<m.y||v.y===m.y&&v.x<=m.x){if(!m.L){y=m.P;break}m=m.L}else{if(!m.R){y=m;break}m=m.R}Gs.insert(y,v),y||(Ns=v)}}}}function Xn(t){var e=t.circle;e&&(e.P||(Ns=e.N),Gs.remove(e),Us.push(e),Jn(e),t.circle=null)}function Hn(t){for(var e,n=Ds,i=Ve(t[0][0],t[0][1],t[1][0],t[1][1]),r=n.length;r--;)(!Wn(e=n[r],t)||!i(e)||Jo(e.a.x-e.b.x)<ga&&Jo(e.a.y-e.b.y)<ga)&&(e.a=e.b=null,n.splice(r,1))}function Wn(t,e){var n=t.b;if(n)return!0;var i,r,o=t.a,a=e[0][0],s=e[1][0],l=e[0][1],u=e[1][1],c=t.l,h=t.r,d=c.x,f=c.y,p=h.x,g=h.y,_=(d+p)/2,v=(f+g)/2;if(g===f){if(_<a||_>=s)return;if(d>p){if(o){if(o.y>=u)return}else o={x:_,y:l};n={x:_,y:u}}else{if(o){if(o.y<l)return}else o={x:_,y:u};n={x:_,y:l}}}else if(i=(d-p)/(g-f),r=v-i*_,i<-1||i>1)if(d>p){if(o){if(o.y>=u)return}else o={x:(l-r)/i,y:l};n={x:(u-r)/i,y:u}}else{if(o){if(o.y<l)return}else o={x:(u-r)/i,y:u};n={x:(l-r)/i,y:l}}else if(f<g){if(o){if(o.x>=s)return}else o={x:a,y:i*a+r};n={x:s,y:i*s+r}}else{if(o){if(o.x<a)return}else o={x:s,y:i*s+r};n={x:a,y:i*a+r}}return t.a=o,t.b=n,!0}function Yn(t,e){this.l=t,this.r=e,this.a=this.b=null}function jn(t,e,n,i){var r=new Yn(t,e);return Ds.push(r),n&&qn(r,t,e,n),i&&qn(r,e,t,i),Fs[t.i].edges.push(new Zn(r,t,e)),Fs[e.i].edges.push(new Zn(r,e,t)),r}function Kn(t,e,n){var i=new Yn(t,null);return i.a=e,i.b=n,Ds.push(i),i}function qn(t,e,n,i){t.a||t.b?t.l===n?t.b=i:t.a=i:(t.a=i,t.l=e,t.r=n)}function Zn(t,e,n){var i=t.a,r=t.b;this.edge=t,this.site=e,this.angle=n?Math.atan2(n.y-e.y,n.x-e.x):t.l===e?Math.atan2(r.x-i.x,i.y-r.y):Math.atan2(i.x-r.x,r.y-i.y)}function Qn(){this._=null}function Jn(t){t.U=t.C=t.L=t.R=t.P=t.N=null}function $n(t,e){var n=e,i=e.R,r=n.U;r?r.L===n?r.L=i:r.R=i:t._=i,i.U=r,n.U=i,n.R=i.L,n.R&&(n.R.U=n),i.L=n}function ti(t,e){var n=e,i=e.L,r=n.U;r?r.L===n?r.L=i:r.R=i:t._=i,i.U=r,n.U=i,n.L=i.R,n.L&&(n.L.U=n),i.R=n}function ei(t){for(;t.L;)t=t.L;return t}function ni(t,e){var n,i,r,o=t.sort(ii).pop();for(Ds=[],Fs=new Array(t.length),ks=new Qn,Gs=new Qn;;)if(r=Ns,o&&(!r||o.y<r.y||o.y===r.y&&o.x<r.x))o.x===n&&o.y===i||(Fs[o.i]=new Gn(o),Fn(o),n=o.x,i=o.y),o=t.pop();else{if(!r)break;Dn(r.arc)}e&&(Hn(e),Vn(e));var a={cells:Fs,edges:Ds};return ks=Gs=Ds=Fs=null,a}function ii(t,e){return e.y-t.y||e.x-t.x}function ri(t,e,n){return(t.x-n.x)*(e.y-t.y)-(t.x-e.x)*(n.y-t.y)}function oi(t){return t.x}function ai(t){return t.y}function si(t,e,n,i,r,o){if(!t(e,n,i,r,o)){var a=.5*(n+r),s=.5*(i+o),l=e.nodes;l[0]&&si(t,l[0],n,i,a,s),l[1]&&si(t,l[1],a,i,r,s),l[2]&&si(t,l[2],n,s,a,o),l[3]&&si(t,l[3],a,s,r,o)}}function li(t,e,n,i,r,o,a){var s,l=1/0;return function t(u,c,h,d,f){if(!(c>o||h>a||d<i||f<r)){if(p=u.point){var p,g=e-u.x,_=n-u.y,v=g*g+_*_;if(v<l){var y=Math.sqrt(l=v);i=e-y,r=n-y,o=e+y,a=n+y,s=p}}for(var m=u.nodes,x=.5*(c+d),S=.5*(h+f),E=(n>=S)<<1|e>=x,T=E+4;E<T;++E)if(u=m[3&E])switch(3&E){case 0:t(u,c,h,x,S);break;case 1:t(u,x,h,d,S);break;case 2:t(u,c,S,x,f);break;case 3:t(u,x,S,d,f)}}}(t,i,r,o,a),s}function ui(t,e){t=zo.rgb(t),e=zo.rgb(e);var n=t.r,i=t.g,r=t.b,o=e.r-n,a=e.g-i,s=e.b-r;return function(t){return"#"+xt(Math.round(n+o*t))+xt(Math.round(i+a*t))+xt(Math.round(r+s*t))}}function ci(t,e){var n,i={},r={};for(n in t)n in e?i[n]=fi(t[n],e[n]):r[n]=t[n];for(n in e)n in t||(r[n]=e[n]);return function(t){for(n in i)r[n]=i[n](t);return r}}function hi(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function di(t,e){var n,i,r,o=zs.lastIndex=Xs.lastIndex=0,a=-1,s=[],l=[];for(t+="",e+="";(n=zs.exec(t))&&(i=Xs.exec(e));)(r=i.index)>o&&(r=e.slice(o,r),s[a]?s[a]+=r:s[++a]=r),(n=n[0])===(i=i[0])?s[a]?s[a]+=i:s[++a]=i:(s[++a]=null,l.push({i:a,x:hi(n,i)})),o=Xs.lastIndex;return o<e.length&&(r=e.slice(o),s[a]?s[a]+=r:s[++a]=r),s.length<2?l[0]?(e=l[0].x,function(t){return e(t)+""}):function(){return e}:(e=l.length,function(t){for(var n,i=0;i<e;++i)s[(n=l[i]).i]=n.x(t);return s.join("")})}function fi(t,e){for(var n,i=zo.interpolators.length;--i>=0&&!(n=zo.interpolators[i](t,e)););return n}function pi(t,e){var n,i=[],r=[],o=t.length,a=e.length,s=Math.min(t.length,e.length);for(n=0;n<s;++n)i.push(fi(t[n],e[n]));for(;n<o;++n)r[n]=t[n];for(;n<a;++n)r[n]=e[n];return function(t){for(n=0;n<s;++n)r[n]=i[n](t);return r}}function gi(t){return function(e){return e<=0?0:e>=1?1:t(e)}}function _i(t){return function(e){return 1-t(1-e)}}function vi(t){return function(e){return.5*(e<.5?t(2*e):2-t(2-2*e))}}function yi(t){return t*t}function mi(t){return t*t*t}function xi(t){if(t<=0)return 0;if(t>=1)return 1;var e=t*t,n=e*t;return 4*(t<.5?n:3*(t-e)+n-.75)}function Si(t){return 1-Math.cos(t*xa)}function Ei(t){return Math.pow(2,10*(t-1))}function Ti(t){return 1-Math.sqrt(1-t*t)}function wi(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}function Ci(t,e){return e-=t,function(n){return Math.round(t+e*n)}}function bi(t){var e=[t.a,t.b],n=[t.c,t.d],i=Ri(e),r=Ai(e,n),o=Ri(Li(n,e,-r))||0;e[0]*n[1]<n[0]*e[1]&&(e[0]*=-1,e[1]*=-1,i*=-1,r*=-1),this.rotate=(i?Math.atan2(e[1],e[0]):Math.atan2(-n[0],n[1]))*Ea,this.translate=[t.e,t.f],this.scale=[i,o],this.skew=o?Math.atan2(r,o)*Ea:0}function Ai(t,e){return t[0]*e[0]+t[1]*e[1]}function Ri(t){var e=Math.sqrt(Ai(t,t));return e&&(t[0]/=e,t[1]/=e),e}function Li(t,e,n){return t[0]+=n*e[0],t[1]+=n*e[1],t}function Ii(t){return t.length?t.pop()+",":""}function Pi(t,e,n,i){if(t[0]!==e[0]||t[1]!==e[1]){var r=n.push("translate(",null,",",null,")");i.push({i:r-4,x:hi(t[0],e[0])},{i:r-2,x:hi(t[1],e[1])})}else(e[0]||e[1])&&n.push("translate("+e+")")}function Mi(t,e,n,i){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),i.push({i:n.push(Ii(n)+"rotate(",null,")")-2,x:hi(t,e)})):e&&n.push(Ii(n)+"rotate("+e+")")}function Oi(t,e,n,i){t!==e?i.push({i:n.push(Ii(n)+"skewX(",null,")")-2,x:hi(t,e)}):e&&n.push(Ii(n)+"skewX("+e+")")}function Di(t,e,n,i){if(t[0]!==e[0]||t[1]!==e[1]){var r=n.push(Ii(n)+"scale(",null,",",null,")");i.push({i:r-4,x:hi(t[0],e[0])},{i:r-2,x:hi(t[1],e[1])})}else 1===e[0]&&1===e[1]||n.push(Ii(n)+"scale("+e+")")}function Fi(t,e){var n=[],i=[];return t=zo.transform(t),e=zo.transform(e),Pi(t.translate,e.translate,n,i),Mi(t.rotate,e.rotate,n,i),Oi(t.skew,e.skew,n,i),Di(t.scale,e.scale,n,i),t=e=null,function(t){for(var e,r=-1,o=i.length;++r<o;)n[(e=i[r]).i]=e.x(t);return n.join("")}}function ki(t,e){return e=(e-=t=+t)||1/e,function(n){return(n-t)/e}}function Ni(t,e){return e=(e-=t=+t)||1/e,function(n){return Math.max(0,Math.min(1,(n-t)/e))}}function Gi(t){for(var e=t.source,n=t.target,i=Ui(e,n),r=[e];e!==i;)e=e.parent,r.push(e);for(var o=r.length;n!==i;)r.splice(o,0,n),n=n.parent;return r}function Vi(t){for(var e=[],n=t.parent;null!=n;)e.push(t),t=n,n=n.parent;return e.push(t),e}function Ui(t,e){if(t===e)return t;for(var n=Vi(t),i=Vi(e),r=n.pop(),o=i.pop(),a=null;r===o;)a=r,r=n.pop(),o=i.pop();return a}function Bi(t){t.fixed|=2}function zi(t){t.fixed&=-7}function Xi(t){t.fixed|=4,t.px=t.x,t.py=t.y}function Hi(t){t.fixed&=-5}function Wi(t,e,n){var i=0,r=0;if(t.charge=0,!t.leaf)for(var o,a=t.nodes,s=a.length,l=-1;++l<s;)null!=(o=a[l])&&(Wi(o,e,n),t.charge+=o.charge,i+=o.charge*o.cx,r+=o.charge*o.cy);if(t.point){t.leaf||(t.point.x+=Math.random()-.5,t.point.y+=Math.random()-.5);var u=e*n[t.point.index];t.charge+=t.pointCharge=u,i+=u*t.point.x,r+=u*t.point.y}t.cx=i/t.charge,t.cy=r/t.charge}function Yi(t,e){return zo.rebind(t,e,"sort","children","value"),t.nodes=t,t.links=Ji,t}function ji(t,e){for(var n=[t];null!=(t=n.pop());)if(e(t),(r=t.children)&&(i=r.length))for(var i,r;--i>=0;)n.push(r[i])}function Ki(t,e){for(var n=[t],i=[];null!=(t=n.pop());)if(i.push(t),(o=t.children)&&(r=o.length))for(var r,o,a=-1;++a<r;)n.push(o[a]);for(;null!=(t=i.pop());)e(t)}function qi(t){return t.children}function Zi(t){return t.value}function Qi(t,e){return e.value-t.value}function Ji(t){return zo.merge(t.map(function(t){return(t.children||[]).map(function(e){return{source:t,target:e}})}))}function $i(t){return t.x}function tr(t){return t.y}function er(t,e,n){t.y0=e,t.y=n}function nr(t){return zo.range(t.length)}function ir(t){for(var e=-1,n=t[0].length,i=[];++e<n;)i[e]=0;return i}function rr(t){for(var e,n=1,i=0,r=t[0][1],o=t.length;n<o;++n)(e=t[n][1])>r&&(i=n,r=e);return i}function or(t){return t.reduce(ar,0)}function ar(t,e){return t+e[1]}function sr(t,e){return lr(t,Math.ceil(Math.log(e.length)/Math.LN2+1))}function lr(t,e){for(var n=-1,i=+t[0],r=(t[1]-i)/e,o=[];++n<=e;)o[n]=r*n+i;return o}function ur(t){return[zo.min(t),zo.max(t)]}function cr(t,e){return t.value-e.value}function hr(t,e){var n=t._pack_next;t._pack_next=e,e._pack_prev=t,e._pack_next=n,n._pack_prev=e}function dr(t,e){t._pack_next=e,e._pack_prev=t}function fr(t,e){var n=e.x-t.x,i=e.y-t.y,r=t.r+e.r;return.999*r*r>n*n+i*i}function pr(t){function e(t){c=Math.min(t.x-t.r,c),h=Math.max(t.x+t.r,h),d=Math.min(t.y-t.r,d),f=Math.max(t.y+t.r,f)}if((n=t.children)&&(u=n.length)){var n,i,r,o,a,s,l,u,c=1/0,h=-1/0,d=1/0,f=-1/0;if(n.forEach(gr),i=n[0],i.x=-i.r,i.y=0,e(i),u>1&&(r=n[1],r.x=r.r,r.y=0,e(r),u>2))for(yr(i,r,o=n[2]),e(o),hr(i,o),i._pack_prev=o,hr(o,r),r=i._pack_next,a=3;a<u;a++){yr(i,r,o=n[a]);var p=0,g=1,_=1;for(s=r._pack_next;s!==r;s=s._pack_next,g++)if(fr(s,o)){p=1;break}if(1==p)for(l=i._pack_prev;l!==s._pack_prev&&!fr(l,o);l=l._pack_prev,_++);p?(g<_||g==_&&r.r<i.r?dr(i,r=s):dr(i=l,r),a--):(hr(i,o),r=o,e(o))}var v=(c+h)/2,y=(d+f)/2,m=0;for(a=0;a<u;a++)(o=n[a]).x-=v,o.y-=y,m=Math.max(m,o.r+Math.sqrt(o.x*o.x+o.y*o.y));t.r=m,n.forEach(_r)}}function gr(t){t._pack_next=t._pack_prev=t}function _r(t){delete t._pack_next,delete t._pack_prev}function vr(t,e,n,i){var r=t.children;if(t.x=e+=i*t.x,t.y=n+=i*t.y,t.r*=i,r)for(var o=-1,a=r.length;++o<a;)vr(r[o],e,n,i)}function yr(t,e,n){var i=t.r+n.r,r=e.x-t.x,o=e.y-t.y;if(i&&(r||o)){var a=e.r+n.r,s=r*r+o*o,l=.5+((i*=i)-(a*=a))/(2*s),u=Math.sqrt(Math.max(0,2*a*(i+s)-(i-=s)*i-a*a))/(2*s);n.x=t.x+l*r+u*o,n.y=t.y+l*o-u*r}else n.x=t.x+i,n.y=t.y}function mr(t,e){return t.parent==e.parent?1:2}function xr(t){var e=t.children;return e.length?e[0]:t.t}function Sr(t){var e,n=t.children;return(e=n.length)?n[e-1]:t.t}function Er(t,e,n){var i=n/(e.i-t.i);e.c-=i,e.s+=n,t.c+=i,e.z+=n,e.m+=n}function Tr(t){for(var e,n=0,i=0,r=t.children,o=r.length;--o>=0;)(e=r[o]).z+=n,e.m+=n,n+=e.s+(i+=e.c)}function wr(t,e,n){return t.a.parent===e.parent?t.a:n}function Cr(t){return 1+zo.max(t,function(t){return t.y})}function br(t){return t.reduce(function(t,e){return t+e.x},0)/t.length}function Ar(t){var e=t.children;return e&&e.length?Ar(e[0]):t}function Rr(t){var e,n=t.children;return n&&(e=n.length)?Rr(n[e-1]):t}function Lr(t){return{x:t.x,y:t.y,dx:t.dx,dy:t.dy}}function Ir(t,e){var n=t.x+e[3],i=t.y+e[0],r=t.dx-e[1]-e[3],o=t.dy-e[0]-e[2];return r<0&&(n+=r/2,r=0),o<0&&(i+=o/2,o=0),{x:n,y:i,dx:r,dy:o}}function Pr(t){var e=t[0],n=t[t.length-1];return e<n?[e,n]:[n,e]}function Mr(t){return t.rangeExtent?t.rangeExtent():Pr(t.range())}function Or(t,e,n,i){var r=n(t[0],t[1]),o=i(e[0],e[1]);return function(t){return o(r(t))}}function Dr(t,e){var n,i=0,r=t.length-1,o=t[i],a=t[r];return a<o&&(n=i,i=r,r=n,n=o,o=a,a=n),t[i]=e.floor(o),t[r]=e.ceil(a),t}function Fr(t){return t?{floor:function(e){return Math.floor(e/t)*t},ceil:function(e){return Math.ceil(e/t)*t}}:tl}function kr(t,e,n,i){var r=[],o=[],a=0,s=Math.min(t.length,e.length)-1;for(t[s]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++a<=s;)r.push(n(t[a-1],t[a])),o.push(i(e[a-1],e[a]));return function(e){var n=zo.bisect(t,e,1,s)-1;return o[n](r[n](e))}}function Nr(t,e,n,i){function r(){var r=Math.min(t.length,e.length)>2?kr:Or,l=i?Ni:ki;return a=r(t,e,l,n),s=r(e,t,l,fi),o}function o(t){return a(t)}var a,s;return o.invert=function(t){return s(t)},o.domain=function(e){return arguments.length?(t=e.map(Number),r()):t},o.range=function(t){return arguments.length?(e=t,r()):e},o.rangeRound=function(t){return o.range(t).interpolate(Ci)},o.clamp=function(t){return arguments.length?(i=t,r()):i},o.interpolate=function(t){return arguments.length?(n=t,r()):n},o.ticks=function(e){return Br(t,e)},o.tickFormat=function(e,n){return zr(t,e,n)},o.nice=function(e){return Vr(t,e),r()},o.copy=function(){return Nr(t,e,n,i)},r()}function Gr(t,e){return zo.rebind(t,e,"range","rangeRound","interpolate","clamp")}function Vr(t,e){return Dr(t,Fr(Ur(t,e)[2])),Dr(t,Fr(Ur(t,e)[2])),t}function Ur(t,e){null==e&&(e=10);var n=Pr(t),i=n[1]-n[0],r=Math.pow(10,Math.floor(Math.log(i/e)/Math.LN10)),o=e/i*r;return o<=.15?r*=10:o<=.35?r*=5:o<=.75&&(r*=2),n[0]=Math.ceil(n[0]/r)*r,n[1]=Math.floor(n[1]/r)*r+.5*r,n[2]=r,n}function Br(t,e){return zo.range.apply(zo,Ur(t,e))}function zr(t,e,n){var i=Ur(t,e);if(n){var r=za.exec(n);if(r.shift(),"s"===r[8]){var o=zo.formatPrefix(Math.max(Jo(i[0]),Jo(i[1])));return r[7]||(r[7]="."+Xr(o.scale(i[2]))),r[8]="f",n=zo.format(r.join("")),function(t){return n(o.scale(t))+o.symbol}}r[7]||(r[7]="."+Hr(r[8],i)),n=r.join("")}else n=",."+Xr(i[2])+"f";return zo.format(n)}function Xr(t){return-Math.floor(Math.log(t)/Math.LN10+.01)}function Hr(t,e){var n=Xr(e[2]);return t in el?Math.abs(n-Xr(Math.max(Jo(e[0]),Jo(e[1]))))+ +("e"!==t):n-2*("%"===t)}function Wr(t,e,n,i){function r(t){return(n?Math.log(t<0?0:t):-Math.log(t>0?0:-t))/Math.log(e)}function o(t){return n?Math.pow(e,t):-Math.pow(e,-t)}function a(e){return t(r(e))}return a.invert=function(e){return o(t.invert(e))},a.domain=function(e){return arguments.length?(n=e[0]>=0,t.domain((i=e.map(Number)).map(r)),a):i},a.base=function(n){return arguments.length?(e=+n,t.domain(i.map(r)),a):e},a.nice=function(){var e=Dr(i.map(r),n?Math:il);return t.domain(e),i=e.map(o),a},a.ticks=function(){var t=Pr(i),a=[],s=t[0],l=t[1],u=Math.floor(r(s)),c=Math.ceil(r(l)),h=e%1?2:e;if(isFinite(c-u)){if(n){for(;u<c;u++)for(d=1;d<h;d++)a.push(o(u)*d);a.push(o(u))}else for(a.push(o(u));u++<c;)for(var d=h-1;d>0;d--)a.push(o(u)*d);for(u=0;a[u]<s;u++);for(c=a.length;a[c-1]>l;c--);a=a.slice(u,c)}return a},a.tickFormat=function(t,n){if(!arguments.length)return nl;arguments.length<2?n=nl:"function"!=typeof n&&(n=zo.format(n));var i=Math.max(1,e*t/a.ticks().length);return function(t){var a=t/o(Math.round(r(t)));return a*e<e-.5&&(a*=e),a<=i?n(t):""}},a.copy=function(){return Wr(t.copy(),e,n,i)},Gr(a,t)}function Yr(t,e,n){function i(e){return t(r(e))}var r=jr(e),o=jr(1/e);return i.invert=function(e){return o(t.invert(e))},i.domain=function(e){return arguments.length?(t.domain((n=e.map(Number)).map(r)),i):n},i.ticks=function(t){return Br(n,t)},i.tickFormat=function(t,e){return zr(n,t,e)},i.nice=function(t){return i.domain(Vr(n,t))},i.exponent=function(a){return arguments.length?(r=jr(e=a),o=jr(1/e),t.domain(n.map(r)),i):e},i.copy=function(){return Yr(t.copy(),e,n)},Gr(i,t)}function jr(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function Kr(t,e){function n(n){return o[((r.get(n)||("range"===e.t?r.set(n,t.push(n)):NaN))-1)%o.length]}function i(e,n){return zo.range(t.length).map(function(t){return e+n*t})}var r,o,a;return n.domain=function(i){if(!arguments.length)return t;t=[],r=new u;for(var o,a=-1,s=i.length;++a<s;)r.has(o=i[a])||r.set(o,t.push(o));return n[e.t].apply(n,e.a)},n.range=function(t){return arguments.length?(o=t,a=0,e={t:"range",a:arguments},n):o},n.rangePoints=function(r,s){arguments.length<2&&(s=0);var l=r[0],u=r[1],c=t.length<2?(l=(l+u)/2,0):(u-l)/(t.length-1+s);return o=i(l+c*s/2,c),a=0,e={t:"rangePoints",a:arguments},n},n.rangeRoundPoints=function(r,s){arguments.length<2&&(s=0);var l=r[0],u=r[1],c=t.length<2?(l=u=Math.round((l+u)/2),0):(u-l)/(t.length-1+s)|0;return o=i(l+Math.round(c*s/2+(u-l-(t.length-1+s)*c)/2),c),a=0,e={t:"rangeRoundPoints",a:arguments},n},n.rangeBands=function(r,s,l){arguments.length<2&&(s=0),arguments.length<3&&(l=s);var u=r[1]<r[0],c=r[u-0],h=(r[1-u]-c)/(t.length-s+2*l);return o=i(c+h*l,h),u&&o.reverse(),a=h*(1-s),e={t:"rangeBands",a:arguments},n},n.rangeRoundBands=function(r,s,l){arguments.length<2&&(s=0),arguments.length<3&&(l=s);var u=r[1]<r[0],c=r[u-0],h=r[1-u],d=Math.floor((h-c)/(t.length-s+2*l));return o=i(c+Math.round((h-c-(t.length-s)*d)/2),d),u&&o.reverse(),a=Math.round(d*(1-s)),e={t:"rangeRoundBands",a:arguments},n},n.rangeBand=function(){return a},n.rangeExtent=function(){return Pr(e.a[0])},n.copy=function(){return Kr(t,e)},n.domain(t)}function qr(t,e){function o(){var n=0,i=e.length;for(s=[];++n<i;)s[n-1]=zo.quantile(t,n/i);return a}function a(t){if(!isNaN(t=+t))return e[zo.bisect(s,t)]}var s;return a.domain=function(e){return arguments.length?(t=e.map(i).filter(r).sort(n),o()):t},a.range=function(t){return arguments.length?(e=t,o()):e},a.quantiles=function(){return s},a.invertExtent=function(n){return(n=e.indexOf(n))<0?[NaN,NaN]:[n>0?s[n-1]:t[0],n<s.length?s[n]:t[t.length-1]]},a.copy=function(){return qr(t,e)},o()}function Zr(t,e,n){function i(e){return n[Math.max(0,Math.min(a,Math.floor(o*(e-t))))]}function r(){return o=n.length/(e-t),a=n.length-1,i}var o,a;return i.domain=function(n){return arguments.length?(t=+n[0],e=+n[n.length-1],r()):[t,e]},i.range=function(t){return arguments.length?(n=t,r()):n},i.invertExtent=function(e){return e=n.indexOf(e),e=e<0?NaN:e/o+t,[e,e+1/o]},i.copy=function(){return Zr(t,e,n)},r()}function Qr(t,e){function n(n){if(n<=n)return e[zo.bisect(t,n)]}return n.domain=function(e){return arguments.length?(t=e,n):t},n.range=function(t){return arguments.length?(e=t,n):e},n.invertExtent=function(n){return n=e.indexOf(n),[t[n-1],t[n]]},n.copy=function(){return Qr(t,e)},n}function Jr(t){function e(t){return+t}return e.invert=e,e.domain=e.range=function(n){return arguments.length?(t=n.map(e),e):t},e.ticks=function(e){return Br(t,e)},e.tickFormat=function(e,n){return zr(t,e,n)},e.copy=function(){return Jr(t)},e}function $r(){return 0}function to(t){return t.innerRadius}function eo(t){return t.outerRadius}function no(t){return t.startAngle}function io(t){return t.endAngle}function ro(t){return t&&t.padAngle}function oo(t,e,n,i){return(t-n)*e-(e-i)*t>0?0:1}function ao(t,e,n,i,r){var o=t[0]-e[0],a=t[1]-e[1],s=(r?i:-i)/Math.sqrt(o*o+a*a),l=s*a,u=-s*o,c=t[0]+l,h=t[1]+u,d=e[0]+l,f=e[1]+u,p=(c+d)/2,g=(h+f)/2,_=d-c,v=f-h,y=_*_+v*v,m=n-i,x=c*f-d*h,S=(v<0?-1:1)*Math.sqrt(Math.max(0,m*m*y-x*x)),E=(x*v-_*S)/y,T=(-x*_-v*S)/y,w=(x*v+_*S)/y,C=(-x*_+v*S)/y,b=E-p,A=T-g,R=w-p,L=C-g;return b*b+A*A>R*R+L*L&&(E=w,T=C),[[E-l,T-u],[E*n/m,T*n/m]]}function so(t){function e(e){function a(){u.push("M",o(t(c),s))}for(var l,u=[],c=[],h=-1,d=e.length,f=bt(n),p=bt(i);++h<d;)r.call(this,l=e[h],h)?c.push([+f.call(this,l,h),+p.call(this,l,h)]):c.length&&(a(),c=[]);return c.length&&a(),u.length?u.join(""):null}var n=wn,i=Cn,r=Re,o=lo,a=o.key,s=.7;return e.x=function(t){return arguments.length?(n=t,e):n},e.y=function(t){return arguments.length?(i=t,e):i},e.defined=function(t){return arguments.length?(r=t,e):r},e.interpolate=function(t){return arguments.length?(a="function"==typeof t?o=t:(o=ul.get(t)||lo).key,e):a},e.tension=function(t){return arguments.length?(s=t,e):s},e}function lo(t){return t.length>1?t.join("L"):t+"Z"}function uo(t){return t.join("L")+"Z"}function co(t){for(var e=0,n=t.length,i=t[0],r=[i[0],",",i[1]];++e<n;)r.push("V",(i=t[e])[1],"H",i[0]);return r.join("")}function ho(t){for(var e=0,n=t.length,i=t[0],r=[i[0],",",i[1]];++e<n;)r.push("H",(i=t[e])[0],"V",i[1]);return r.join("")}function fo(t,e){if(e.length<1||t.length!=e.length&&t.length!=e.length+2)return lo(t);var n=t.length!=e.length,i="",r=t[0],o=t[1],a=e[0],s=a,l=1;if(n&&(i+="Q"+(o[0]-2*a[0]/3)+","+(o[1]-2*a[1]/3)+","+o[0]+","+o[1],r=t[1],l=2),e.length>1){s=e[1],o=t[l],l++,i+="C"+(r[0]+a[0])+","+(r[1]+a[1])+","+(o[0]-s[0])+","+(o[1]-s[1])+","+o[0]+","+o[1];for(var u=2;u<e.length;u++,l++)o=t[l],s=e[u],i+="S"+(o[0]-s[0])+","+(o[1]-s[1])+","+o[0]+","+o[1]}if(n){var c=t[l];i+="Q"+(o[0]+2*s[0]/3)+","+(o[1]+2*s[1]/3)+","+c[0]+","+c[1]}return i}function po(t,e){for(var n,i=[],r=(1-e)/2,o=t[0],a=t[1],s=1,l=t.length;++s<l;)n=o,o=a,a=t[s],i.push([r*(a[0]-n[0]),r*(a[1]-n[1])]);return i}function go(t){if(t.length<3)return lo(t);var e=1,n=t.length,i=t[0],r=i[0],o=i[1],a=[r,r,r,(i=t[1])[0]],s=[o,o,o,i[1]],l=[r,",",o,"L",_o(dl,a),",",_o(dl,s)];for(t.push(t[n-1]);++e<=n;)i=t[e],a.shift(),a.push(i[0]),s.shift(),s.push(i[1]),vo(l,a,s);return t.pop(),l.push("L",i),l.join("")}function _o(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function vo(t,e,n){t.push("C",_o(cl,e),",",_o(cl,n),",",_o(hl,e),",",_o(hl,n),",",_o(dl,e),",",_o(dl,n))}function yo(t,e){return(e[1]-t[1])/(e[0]-t[0])}function mo(t){for(var e=0,n=t.length-1,i=[],r=t[0],o=t[1],a=i[0]=yo(r,o);++e<n;)i[e]=(a+(a=yo(r=o,o=t[e+1])))/2;return i[e]=a,i}function xo(t){for(var e,n,i,r,o=[],a=mo(t),s=-1,l=t.length-1;++s<l;)e=yo(t[s],t[s+1]),Jo(e)<ga?a[s]=a[s+1]=0:(r=(n=a[s]/e)*n+(i=a[s+1]/e)*i)>9&&(r=3*e/Math.sqrt(r),a[s]=r*n,a[s+1]=r*i);for(s=-1;++s<=l;)r=(t[Math.min(l,s+1)][0]-t[Math.max(0,s-1)][0])/(6*(1+a[s]*a[s])),o.push([r||0,a[s]*r||0]);return o}function So(t){for(var e,n,i,r=-1,o=t.length;++r<o;)n=(e=t[r])[0],i=e[1]-xa,e[0]=n*Math.cos(i),e[1]=n*Math.sin(i);return t}function Eo(t){function e(e){function l(){g.push("M",s(t(v),h),c,u(t(_.reverse()),h),"Z")}for(var d,f,p,g=[],_=[],v=[],y=-1,m=e.length,x=bt(n),S=bt(r),E=n===i?function(){return f}:bt(i),T=r===o?function(){return p}:bt(o);++y<m;)a.call(this,d=e[y],y)?(_.push([f=+x.call(this,d,y),p=+S.call(this,d,y)]),v.push([+E.call(this,d,y),+T.call(this,d,y)])):_.length&&(l(),_=[],v=[]);return _.length&&l(),g.length?g.join(""):null}var n=wn,i=wn,r=0,o=Cn,a=Re,s=lo,l=s.key,u=s,c="L",h=.7;return e.x=function(t){return arguments.length?(n=i=t,e):i},e.x0=function(t){return arguments.length?(n=t,e):n},e.x1=function(t){return arguments.length?(i=t,e):i},e.y=function(t){return arguments.length?(r=o=t,e):o},e.y0=function(t){return arguments.length?(r=t,e):r},e.y1=function(t){return arguments.length?(o=t,e):o},e.defined=function(t){return arguments.length?(a=t,e):a},e.interpolate=function(t){return arguments.length?(l="function"==typeof t?s=t:(s=ul.get(t)||lo).key,u=s.reverse||s,c=s.closed?"M":"L",e):l},e.tension=function(t){return arguments.length?(h=t,e):h},e}function To(t){return t.radius}function wo(t){return[t.x,t.y]}function Co(t){return function(){var e=t.apply(this,arguments),n=e[0],i=e[1]-xa;return[n*Math.cos(i),n*Math.sin(i)]}}function bo(){return 64}function Ao(){return"circle"}function Ro(t){var e=Math.sqrt(t/va);return"M0,"+e+"A"+e+","+e+" 0 1,1 0,"+-e+"A"+e+","+e+" 0 1,1 0,"+e+"Z"}function Lo(t){return function(){var e,n,i;(e=this[t])&&(i=e[n=e.active])&&(i.timer.c=null,i.timer.t=NaN,--e.count?delete e[n]:delete this[t],e.active+=.5,i.event&&i.event.interrupt.call(this,this.__data__,i.index))}}function Io(t,e,n){return ia(t,ml),t.namespace=e,t.id=n,t}function Po(t,e,n,i){var r=t.id,o=t.namespace;return X(t,"function"==typeof n?function(t,a,s){t[o][r].tween.set(e,i(n.call(t,t.__data__,a,s)))}:(n=i(n),function(t){t[o][r].tween.set(e,n)}))}function Mo(t){return null==t&&(t=""),function(){this.textContent=t}}function Oo(t){return null==t?"__transition__":"__transition_"+t+"__"}function Do(t,e,n,i,r){function o(n){var r=f.active,o=f[r];o&&(o.timer.c=null,o.timer.t=NaN,--f.count,delete f[r],o.event&&o.event.interrupt.call(t,t.__data__,o.index));for(var u in f)if(+u<i){var g=f[u];g.timer.c=null,g.timer.t=NaN,--f.count,delete f[u]}l.c=a,Pt(function(){return l.c&&a(n||1)&&(l.c=null,l.t=NaN),1},0,s),f.active=i,p.event&&p.event.start.call(t,t.__data__,e),d=[],p.tween.forEach(function(n,i){(i=i.call(t,t.__data__,e))&&d.push(i)}),h=p.ease,c=p.duration}function a(r){for(var o=r/c,a=h(o),s=d.length;s>0;)d[--s].call(t,a);if(o>=1)return p.event&&p.event.end.call(t,t.__data__,e),--f.count?delete f[i]:delete t[n],1}var s,l,c,h,d,f=t[n]||(t[n]={active:0,count:0}),p=f[i];p||(s=r.time,l=Pt(function(t){var e=p.delay;if(l.t=e+s,e<=t)return o(t-e);l.c=o},0,s),p=f[i]={tween:new u,time:s,timer:l,delay:r.delay,duration:r.duration,ease:r.ease,index:e},r=null,++f.count)}function Fo(t,e,n){t.attr("transform",function(t){var i=e(t);return"translate("+(isFinite(i)?i:n(t))+",0)"})}function ko(t,e,n){t.attr("transform",function(t){var i=e(t);return"translate(0,"+(isFinite(i)?i:n(t))+")"})}function No(t){return t.toISOString()}function Go(t,e,n){function i(e){return t(e)}function r(t,n){var i=(t[1]-t[0])/n,r=zo.bisect(Rl,i);return r==Rl.length?[e.year,Ur(t.map(function(t){return t/31536e6}),n)[2]]:r?e[i/Rl[r-1]<Rl[r]/i?r-1:r]:[Pl,Ur(t,n)[2]]}return i.invert=function(e){return Vo(t.invert(e))},i.domain=function(e){return arguments.length?(t.domain(e),i):t.domain().map(Vo)},i.nice=function(t,e){function n(n){return!isNaN(n)&&!t.range(n,Vo(+n+1),e).length}var o=i.domain(),a=Pr(o),s=null==t?r(a,10):"number"==typeof t&&r(a,t);return s&&(t=s[0],e=s[1]),i.domain(Dr(o,e>1?{floor:function(e){for(;n(e=t.floor(e));)e=Vo(e-1);return e},ceil:function(e){for(;n(e=t.ceil(e));)e=Vo(+e+1);return e}}:t))},i.ticks=function(t,e){var n=Pr(i.domain()),o=null==t?r(n,10):"number"==typeof t?r(n,t):!t.range&&[{range:t},e];return o&&(t=o[0],e=o[1]),t.range(n[0],Vo(+n[1]+1),e<1?1:e)},i.tickFormat=function(){return n},i.copy=function(){return Go(t.copy(),e,n)},Gr(i,t)}function Vo(t){return new Date(t)}function Uo(t){return JSON.parse(t.responseText)}function Bo(t){var e=Wo.createRange();return e.selectNode(Wo.body),e.createContextualFragment(t.responseText)}var zo={version:"3.5.17"},Xo=[].slice,Ho=function(t){return Xo.call(t)},Wo=this.document;if(Wo)try{Ho(Wo.documentElement.childNodes)[0].nodeType}catch(t){Ho=function(t){for(var e=t.length,n=new Array(e);e--;)n[e]=t[e];return n}}if(Date.now||(Date.now=function(){return+new Date}),Wo)try{Wo.createElement("DIV").style.setProperty("opacity",0,"")}catch(t){var Yo=this.Element.prototype,jo=Yo.setAttribute,Ko=Yo.setAttributeNS,qo=this.CSSStyleDeclaration.prototype,Zo=qo.setProperty;Yo.setAttribute=function(t,e){jo.call(this,t,e+"")},Yo.setAttributeNS=function(t,e,n){Ko.call(this,t,e,n+"")},qo.setProperty=function(t,e,n){Zo.call(this,t,e+"",n)}}zo.ascending=n,zo.descending=function(t,e){return e<t?-1:e>t?1:e>=t?0:NaN},zo.min=function(t,e){var n,i,r=-1,o=t.length;if(1===arguments.length){for(;++r<o;)if(null!=(i=t[r])&&i>=i){n=i;break}for(;++r<o;)null!=(i=t[r])&&n>i&&(n=i)}else{for(;++r<o;)if(null!=(i=e.call(t,t[r],r))&&i>=i){n=i;break}for(;++r<o;)null!=(i=e.call(t,t[r],r))&&n>i&&(n=i)}return n},zo.max=function(t,e){var n,i,r=-1,o=t.length;if(1===arguments.length){for(;++r<o;)if(null!=(i=t[r])&&i>=i){n=i;break}for(;++r<o;)null!=(i=t[r])&&i>n&&(n=i)}else{for(;++r<o;)if(null!=(i=e.call(t,t[r],r))&&i>=i){n=i;break}for(;++r<o;)null!=(i=e.call(t,t[r],r))&&i>n&&(n=i)}return n},zo.extent=function(t,e){var n,i,r,o=-1,a=t.length;if(1===arguments.length){for(;++o<a;)if(null!=(i=t[o])&&i>=i){n=r=i;break}for(;++o<a;)null!=(i=t[o])&&(n>i&&(n=i),r<i&&(r=i))}else{for(;++o<a;)if(null!=(i=e.call(t,t[o],o))&&i>=i){n=r=i;break}for(;++o<a;)null!=(i=e.call(t,t[o],o))&&(n>i&&(n=i),r<i&&(r=i))}return[n,r]},zo.sum=function(t,e){var n,i=0,o=t.length,a=-1;if(1===arguments.length)for(;++a<o;)r(n=+t[a])&&(i+=n);else for(;++a<o;)r(n=+e.call(t,t[a],a))&&(i+=n);return i},zo.mean=function(t,e){var n,o=0,a=t.length,s=-1,l=a;if(1===arguments.length)for(;++s<a;)r(n=i(t[s]))?o+=n:--l;else for(;++s<a;)r(n=i(e.call(t,t[s],s)))?o+=n:--l;if(l)return o/l},zo.quantile=function(t,e){var n=(t.length-1)*e+1,i=Math.floor(n),r=+t[i-1],o=n-i;return o?r+o*(t[i]-r):r},zo.median=function(t,e){var o,a=[],s=t.length,l=-1;if(1===arguments.length)for(;++l<s;)r(o=i(t[l]))&&a.push(o);else for(;++l<s;)r(o=i(e.call(t,t[l],l)))&&a.push(o);if(a.length)return zo.quantile(a.sort(n),.5)},zo.variance=function(t,e){var n,o,a=t.length,s=0,l=0,u=-1,c=0;if(1===arguments.length)for(;++u<a;)r(n=i(t[u]))&&(l+=(o=n-s)*(n-(s+=o/++c)));else for(;++u<a;)r(n=i(e.call(t,t[u],u)))&&(l+=(o=n-s)*(n-(s+=o/++c)));if(c>1)return l/(c-1)},zo.deviation=function(){var t=zo.variance.apply(this,arguments);return t?Math.sqrt(t):t};var Qo=o(n);zo.bisectLeft=Qo.left,zo.bisect=zo.bisectRight=Qo.right,zo.bisector=function(t){return o(1===t.length?function(e,i){return n(t(e),i)}:t)},zo.shuffle=function(t,e,n){(o=arguments.length)<3&&(n=t.length,o<2&&(e=0));for(var i,r,o=n-e;o;)r=Math.random()*o--|0,i=t[o+e],t[o+e]=t[r+e],t[r+e]=i;return t},zo.permute=function(t,e){for(var n=e.length,i=new Array(n);n--;)i[n]=t[e[n]];return i},zo.pairs=function(t){for(var e=0,n=t.length-1,i=t[0],r=new Array(n<0?0:n);e<n;)r[e]=[i,i=t[++e]];return r},zo.transpose=function(t){if(!(r=t.length))return[];for(var e=-1,n=zo.min(t,a),i=new Array(n);++e<n;)for(var r,o=-1,s=i[e]=new Array(r);++o<r;)s[o]=t[o][e];return i},zo.zip=function(){return zo.transpose(arguments)},zo.keys=function(t){var e=[];for(var n in t)e.push(n);return e},zo.values=function(t){var e=[];for(var n in t)e.push(t[n]);return e},zo.entries=function(t){var e=[];for(var n in t)e.push({key:n,value:t[n]});return e},zo.merge=function(t){for(var e,n,i,r=t.length,o=-1,a=0;++o<r;)a+=t[o].length;for(n=new Array(a);--r>=0;)for(e=(i=t[r]).length;--e>=0;)n[--a]=i[e];return n};var Jo=Math.abs;zo.range=function(t,e,n){if(arguments.length<3&&(n=1,arguments.length<2&&(e=t,t=0)),(e-t)/n==1/0)throw new Error("infinite range");var i,r=[],o=s(Jo(n)),a=-1;if(t*=o,e*=o,(n*=o)<0)for(;(i=t+n*++a)>e;)r.push(i/o);else for(;(i=t+n*++a)<e;)r.push(i/o);return r},zo.map=function(t,e){var n=new u;if(t instanceof u)t.forEach(function(t,e){n.set(t,e)});else if(Array.isArray(t)){var i,r=-1,o=t.length;if(1===arguments.length)for(;++r<o;)n.set(r,t[r]);else for(;++r<o;)n.set(e.call(t,i=t[r],r),i)}else for(var a in t)n.set(a,t[a]);return n};var $o="__proto__",ta="\0";l(u,{has:d,get:function(t){return this._[c(t)]},set:function(t,e){return this._[c(t)]=e},remove:f,keys:p,values:function(){var t=[];for(var e in this._)t.push(this._[e]);return t},entries:function(){var t=[];for(var e in this._)t.push({key:h(e),value:this._[e]});return t},size:g,empty:_,forEach:function(t){for(var e in this._)t.call(this,h(e),this._[e])}}),zo.nest=function(){function t(e,a,s){if(s>=o.length)return i?i.call(r,a):n?a.sort(n):a;for(var l,c,h,d,f=-1,p=a.length,g=o[s++],_=new u;++f<p;)(d=_.get(l=g(c=a[f])))?d.push(c):_.set(l,[c]);return e?(c=e(),h=function(n,i){c.set(n,t(e,i,s))}):(c={},h=function(n,i){c[n]=t(e,i,s)}),_.forEach(h),c}function e(t,n){if(n>=o.length)return t;var i=[],r=a[n++];return t.forEach(function(t,r){i.push({key:t,values:e(r,n)})}),r?i.sort(function(t,e){return r(t.key,e.key)}):i}var n,i,r={},o=[],a=[];return r.map=function(e,n){return t(n,e,0)},r.entries=function(n){return e(t(zo.map,n,0),0)},r.key=function(t){return o.push(t),r},r.sortKeys=function(t){return a[o.length-1]=t,r},r.sortValues=function(t){return n=t,r},r.rollup=function(t){return i=t,r},r},zo.set=function(t){var e=new v;if(t)for(var n=0,i=t.length;n<i;++n)e.add(t[n]);return e},l(v,{has:d,add:function(t){return this._[c(t+="")]=!0,t},remove:f,values:p,size:g,empty:_,forEach:function(t){for(var e in this._)t.call(this,h(e))}}),zo.behavior={},zo.rebind=function(t,e){for(var n,i=1,r=arguments.length;++i<r;)t[n=arguments[i]]=m(t,e,e[n]);return t};var ea=["webkit","ms","moz","Moz","o","O"];zo.dispatch=function(){for(var t=new E,e=-1,n=arguments.length;++e<n;)t[arguments[e]]=T(t);return t},E.prototype.on=function(t,e){var n=t.indexOf("."),i="";if(n>=0&&(i=t.slice(n+1),t=t.slice(0,n)),t)return arguments.length<2?this[t].on(i):this[t].on(i,e);if(2===arguments.length){if(null==e)for(t in this)this.hasOwnProperty(t)&&this[t].on(i,null);return this}},zo.event=null,zo.requote=function(t){return t.replace(na,"\\$&")};var na=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,ia={}.__proto__?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)t[n]=e[n]},ra=function(t,e){return e.querySelector(t)},oa=function(t,e){return e.querySelectorAll(t)},aa=function(t,e){var n=t.matches||t[x(t,"matchesSelector")];return(aa=function(t,e){return n.call(t,e)})(t,e)};"function"==typeof Sizzle&&(ra=function(t,e){return Sizzle(t,e)[0]||null},oa=Sizzle,aa=Sizzle.matchesSelector),zo.selection=function(){return zo.select(Wo.documentElement)};var sa=zo.selection.prototype=[];sa.select=function(t){var e,n,i,r,o=[];t=R(t);for(var a=-1,s=this.length;++a<s;){o.push(e=[]),e.parentNode=(i=this[a]).parentNode;for(var l=-1,u=i.length;++l<u;)(r=i[l])?(e.push(n=t.call(r,r.__data__,l,a)),n&&"__data__"in r&&(n.__data__=r.__data__)):e.push(null)}return A(o)},sa.selectAll=function(t){var e,n,i=[];t=L(t);for(var r=-1,o=this.length;++r<o;)for(var a=this[r],s=-1,l=a.length;++s<l;)(n=a[s])&&(i.push(e=Ho(t.call(n,n.__data__,s,r))),e.parentNode=n);return A(i)};var la="http://www.w3.org/1999/xhtml",ua={svg:"http://www.w3.org/2000/svg",xhtml:la,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};zo.ns={prefix:ua,qualify:function(t){var e=t.indexOf(":"),n=t;return e>=0&&"xmlns"!==(n=t.slice(0,e))&&(t=t.slice(e+1)),ua.hasOwnProperty(n)?{space:ua[n],local:t}:t}},sa.attr=function(t,e){if(arguments.length<2){if("string"==typeof t){var n=this.node();return(t=zo.ns.qualify(t)).local?n.getAttributeNS(t.space,t.local):n.getAttribute(t)}for(e in t)this.each(I(e,t[e]));return this}return this.each(I(t,e))},sa.classed=function(t,e){if(arguments.length<2){if("string"==typeof t){var n=this.node(),i=(t=O(t)).length,r=-1;if(e=n.classList){for(;++r<i;)if(!e.contains(t[r]))return!1}else for(e=n.getAttribute("class");++r<i;)if(!M(t[r]).test(e))return!1;return!0}for(e in t)this.each(D(e,t[e]));return this}return this.each(D(t,e))},sa.style=function(t,n,i){var r=arguments.length;if(r<3){if("string"!=typeof t){r<2&&(n="");for(i in t)this.each(k(i,t[i],n));return this}if(r<2){var o=this.node();return e(o).getComputedStyle(o,null).getPropertyValue(t)}i=""}return this.each(k(t,n,i))},sa.property=function(t,e){if(arguments.length<2){if("string"==typeof t)return this.node()[t];for(e in t)this.each(N(e,t[e]));return this}return this.each(N(t,e))},sa.text=function(t){return arguments.length?this.each("function"==typeof t?function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}:null==t?function(){this.textContent=""}:function(){this.textContent=t}):this.node().textContent},sa.html=function(t){return arguments.length?this.each("function"==typeof t?function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}:null==t?function(){this.innerHTML=""}:function(){this.innerHTML=t}):this.node().innerHTML},sa.append=function(t){return t=G(t),this.select(function(){return this.appendChild(t.apply(this,arguments))})},sa.insert=function(t,e){return t=G(t),e=R(e),this.select(function(){return this.insertBefore(t.apply(this,arguments),e.apply(this,arguments)||null)})},sa.remove=function(){return this.each(V)},sa.data=function(t,e){function n(t,n){var i,r,o,a=t.length,h=n.length,d=Math.min(a,h),f=new Array(h),p=new Array(h),g=new Array(a);if(e){var _,v=new u,y=new Array(a);for(i=-1;++i<a;)(r=t[i])&&(v.has(_=e.call(r,r.__data__,i))?g[i]=r:v.set(_,r),y[i]=_);for(i=-1;++i<h;)(r=v.get(_=e.call(n,o=n[i],i)))?!0!==r&&(f[i]=r,r.__data__=o):p[i]=U(o),v.set(_,!0);for(i=-1;++i<a;)i in y&&!0!==v.get(y[i])&&(g[i]=t[i])}else{for(i=-1;++i<d;)r=t[i],o=n[i],r?(r.__data__=o,f[i]=r):p[i]=U(o);for(;i<h;++i)p[i]=U(n[i]);for(;i<a;++i)g[i]=t[i]}p.update=f,p.parentNode=f.parentNode=g.parentNode=t.parentNode,s.push(p),l.push(f),c.push(g)}var i,r,o=-1,a=this.length;if(!arguments.length){for(t=new Array(a=(i=this[0]).length);++o<a;)(r=i[o])&&(t[o]=r.__data__);return t}var s=H([]),l=A([]),c=A([]);if("function"==typeof t)for(;++o<a;)n(i=this[o],t.call(i,i.parentNode.__data__,o));else for(;++o<a;)n(i=this[o],t);return l.enter=function(){return s},l.exit=function(){return c},l},sa.datum=function(t){return arguments.length?this.property("__data__",t):this.property("__data__")},sa.filter=function(t){var e,n,i,r=[];"function"!=typeof t&&(t=B(t));for(var o=0,a=this.length;o<a;o++){r.push(e=[]),e.parentNode=(n=this[o]).parentNode;for(var s=0,l=n.length;s<l;s++)(i=n[s])&&t.call(i,i.__data__,s,o)&&e.push(i)}return A(r)},sa.order=function(){for(var t=-1,e=this.length;++t<e;)for(var n,i=this[t],r=i.length-1,o=i[r];--r>=0;)(n=i[r])&&(o&&o!==n.nextSibling&&o.parentNode.insertBefore(n,o),o=n);return this},sa.sort=function(t){t=z.apply(this,arguments);for(var e=-1,n=this.length;++e<n;)this[e].sort(t);return this.order()},sa.each=function(t){return X(this,function(e,n,i){t.call(e,e.__data__,n,i)})},sa.call=function(t){var e=Ho(arguments);return t.apply(e[0]=this,e),this},sa.empty=function(){return!this.node()},sa.node=function(){for(var t=0,e=this.length;t<e;t++)for(var n=this[t],i=0,r=n.length;i<r;i++){var o=n[i];if(o)return o}return null},sa.size=function(){var t=0;return X(this,function(){++t}),t};var ca=[];zo.selection.enter=H,zo.selection.enter.prototype=ca,ca.append=sa.append,ca.empty=sa.empty,ca.node=sa.node,ca.call=sa.call,ca.size=sa.size,ca.select=function(t){for(var e,n,i,r,o,a=[],s=-1,l=this.length;++s<l;){i=(r=this[s]).update,a.push(e=[]),e.parentNode=r.parentNode;for(var u=-1,c=r.length;++u<c;)(o=r[u])?(e.push(i[u]=n=t.call(r.parentNode,o.__data__,u,s)),n.__data__=o.__data__):e.push(null)}return A(a)},ca.insert=function(t,e){return arguments.length<2&&(e=W(this)),sa.insert.call(this,t,e)},zo.select=function(e){var n;return"string"==typeof e?(n=[ra(e,Wo)]).parentNode=Wo.documentElement:(n=[e]).parentNode=t(e),A([n])},zo.selectAll=function(t){var e;return"string"==typeof t?(e=Ho(oa(t,Wo))).parentNode=Wo.documentElement:(e=Ho(t)).parentNode=null,A([e])},sa.on=function(t,e,n){var i=arguments.length;if(i<3){if("string"!=typeof t){i<2&&(e=!1);for(n in t)this.each(Y(n,t[n],e));return this}if(i<2)return(i=this.node()["__on"+t])&&i._;n=!1}return this.each(Y(t,e,n))};var ha=zo.map({mouseenter:"mouseover",mouseleave:"mouseout"});Wo&&ha.forEach(function(t){"on"+t in Wo&&ha.remove(t)});var da,fa=0;zo.mouse=function(t){return Z(t,C())};var pa=this.navigator&&/WebKit/.test(this.navigator.userAgent)?-1:0;zo.touch=function(t,e,n){if(arguments.length<3&&(n=e,e=C().changedTouches),e)for(var i,r=0,o=e.length;r<o;++r)if((i=e[r]).identifier===n)return Z(t,i)},zo.behavior.drag=function(){function t(){this.on("mousedown.drag",o).on("touchstart.drag",a)}function n(t,e,n,o,a){return function(){var s,l=this,u=zo.event.target.correspondingElement||zo.event.target,c=l.parentNode,h=i.of(l,arguments),d=0,f=t(),p=".drag"+(null==f?"":"-"+f),g=zo.select(n(u)).on(o+p,function(){var t,n,i=e(c,f);i&&(t=i[0]-v[0],n=i[1]-v[1],d|=t|n,v=i,h({type:"drag",x:i[0]+s[0],y:i[1]+s[1],dx:t,dy:n}))}).on(a+p,function(){e(c,f)&&(g.on(o+p,null).on(a+p,null),_(d),h({type:"dragend"}))}),_=q(u),v=e(c,f);r?(s=r.apply(l,arguments),s=[s.x-v[0],s.y-v[1]]):s=[0,0],h({type:"dragstart"})}}var i=b(t,"drag","dragstart","dragend"),r=null,o=n(S,zo.mouse,e,"mousemove","mouseup"),a=n(Q,zo.touch,y,"touchmove","touchend");return t.origin=function(e){return arguments.length?(r=e,t):r},zo.rebind(t,i,"on")},zo.touches=function(t,e){return arguments.length<2&&(e=C().touches),e?Ho(e).map(function(e){var n=Z(t,e);return n.identifier=e.identifier,n}):[]};var ga=1e-6,_a=ga*ga,va=Math.PI,ya=2*va,ma=ya-ga,xa=va/2,Sa=va/180,Ea=180/va,Ta=Math.SQRT2;zo.interpolateZoom=function(t,e){var n,i,r=t[0],o=t[1],a=t[2],s=e[0],l=e[1],u=e[2],c=s-r,h=l-o,d=c*c+h*h;if(d<_a)i=Math.log(u/a)/Ta,n=function(t){return[r+t*c,o+t*h,a*Math.exp(Ta*t*i)]};else{var f=Math.sqrt(d),p=(u*u-a*a+4*d)/(2*a*2*f),g=(u*u-a*a-4*d)/(2*u*2*f),_=Math.log(Math.sqrt(p*p+1)-p),v=Math.log(Math.sqrt(g*g+1)-g);i=(v-_)/Ta,n=function(t){var e=t*i,n=it(_),s=a/(2*f)*(n*rt(Ta*e+_)-nt(_));return[r+s*c,o+s*h,a*n/it(Ta*e+_)]}}return n.duration=1e3*i,n},zo.behavior.zoom=function(){function t(t){t.on(P,h).on(Ca+".zoom",f).on("dblclick.zoom",p).on(D,d)}function n(t){return[(t[0]-C.x)/C.k,(t[1]-C.y)/C.k]}function i(t){return[t[0]*C.k+C.x,t[1]*C.k+C.y]}function r(t){C.k=Math.max(R[0],Math.min(R[1],t))}function o(t,e){e=i(e),C.x+=t[0]-e[0],C.y+=t[1]-e[1]}function a(e,n,i,a){e.__chart__={x:C.x,y:C.y,k:C.k},r(Math.pow(2,a)),o(_=n,i),e=zo.select(e),L>0&&(e=e.transition().duration(L)),e.call(t.event)}function s(){S&&S.domain(x.range().map(function(t){return(t-C.x)/C.k}).map(x.invert)),T&&T.domain(E.range().map(function(t){return(t-C.y)/C.k}).map(E.invert))}function l(t){I++||t({type:"zoomstart"})}function u(t){s(),t({type:"zoom",scale:C.k,translate:[C.x,C.y]})}function c(t){--I||(t({type:"zoomend"}),_=null)}function h(){var t=this,i=F.of(t,arguments),r=0,a=zo.select(e(t)).on(M,function(){r=1,o(zo.mouse(t),s),u(i)}).on(O,function(){a.on(M,null).on(O,null),h(r),c(i)}),s=n(zo.mouse(t)),h=q(t);yl.call(t),l(i)}function d(){function t(){var t=zo.touches(p);return f=C.k,t.forEach(function(t){t.identifier in _&&(_[t.identifier]=n(t))}),t}function e(){var e=zo.event.target;zo.select(e).on(x,i).on(S,s),E.push(e);for(var n=zo.event.changedTouches,r=0,o=n.length;r<o;++r)_[n[r].identifier]=null;var l=t(),u=Date.now();if(1===l.length){if(u-m<500){c=l[0];a(p,c,_[c.identifier],Math.floor(Math.log(C.k)/Math.LN2)+1),w()}m=u}else if(l.length>1){var c=l[0],h=l[1],d=c[0]-h[0],f=c[1]-h[1];v=d*d+f*f}}function i(){var t,e,n,i,a=zo.touches(p);yl.call(p);for(var s=0,l=a.length;s<l;++s,i=null)if(n=a[s],i=_[n.identifier]){if(e)break;t=n,e=i}if(i){var c=(c=n[0]-t[0])*c+(c=n[1]-t[1])*c,h=v&&Math.sqrt(c/v);t=[(t[0]+n[0])/2,(t[1]+n[1])/2],e=[(e[0]+i[0])/2,(e[1]+i[1])/2],r(h*f)}m=null,o(t,e),u(g)}function s(){if(zo.event.touches.length){for(var e=zo.event.changedTouches,n=0,i=e.length;n<i;++n)delete _[e[n].identifier];for(var r in _)return void t()}zo.selectAll(E).on(y,null),T.on(P,h).on(D,d),b(),c(g)}var f,p=this,g=F.of(p,arguments),_={},v=0,y=".zoom-"+zo.event.changedTouches[0].identifier,x="touchmove"+y,S="touchend"+y,E=[],T=zo.select(p),b=q(p);e(),l(g),T.on(P,null).on(D,e)}function f(){var t=F.of(this,arguments);y?clearTimeout(y):(yl.call(this),g=n(_=v||zo.mouse(this)),l(t)),y=setTimeout(function(){y=null,c(t)},50),w(),r(Math.pow(2,.002*wa())*C.k),o(_,g),u(t)}function p(){var t=zo.mouse(this),e=Math.log(C.k)/Math.LN2;a(this,t,n(t),zo.event.shiftKey?Math.ceil(e)-1:Math.floor(e)+1)}var g,_,v,y,m,x,S,E,T,C={x:0,y:0,k:1},A=[960,500],R=ba,L=250,I=0,P="mousedown.zoom",M="mousemove.zoom",O="mouseup.zoom",D="touchstart.zoom",F=b(t,"zoomstart","zoom","zoomend");return Ca||(Ca="onwheel"in Wo?(wa=function(){return-zo.event.deltaY*(zo.event.deltaMode?120:1)},"wheel"):"onmousewheel"in Wo?(wa=function(){return zo.event.wheelDelta},"mousewheel"):(wa=function(){return-zo.event.detail},"MozMousePixelScroll")),t.event=function(t){t.each(function(){var t=F.of(this,arguments),e=C;_l?zo.select(this).transition().each("start.zoom",function(){C=this.__chart__||{x:0,y:0,k:1},l(t)}).tween("zoom:zoom",function(){var n=A[0],i=A[1],r=_?_[0]:n/2,o=_?_[1]:i/2,a=zo.interpolateZoom([(r-C.x)/C.k,(o-C.y)/C.k,n/C.k],[(r-e.x)/e.k,(o-e.y)/e.k,n/e.k]);return function(e){var i=a(e),s=n/i[2];this.__chart__=C={x:r-i[0]*s,y:o-i[1]*s,k:s},u(t)}}).each("interrupt.zoom",function(){c(t)}).each("end.zoom",function(){c(t)}):(this.__chart__=C,l(t),u(t),c(t))})},t.translate=function(e){return arguments.length?(C={x:+e[0],y:+e[1],k:C.k},s(),t):[C.x,C.y]},t.scale=function(e){return arguments.length?(C={x:C.x,y:C.y,k:null},r(+e),s(),t):C.k},t.scaleExtent=function(e){return arguments.length?(R=null==e?ba:[+e[0],+e[1]],t):R},t.center=function(e){return arguments.length?(v=e&&[+e[0],+e[1]],t):v},t.size=function(e){return arguments.length?(A=e&&[+e[0],+e[1]],t):A},t.duration=function(e){return arguments.length?(L=+e,t):L},t.x=function(e){return arguments.length?(S=e,x=e.copy(),C={x:0,y:0,k:1},t):S},t.y=function(e){return arguments.length?(T=e,E=e.copy(),C={x:0,y:0,k:1},t):T},zo.rebind(t,F,"on")};var wa,Ca,ba=[0,1/0];zo.color=at,at.prototype.toString=function(){return this.rgb()+""},zo.hsl=st;var Aa=st.prototype=new at;Aa.brighter=function(t){return t=Math.pow(.7,arguments.length?t:1),new st(this.h,this.s,this.l/t)},Aa.darker=function(t){return t=Math.pow(.7,arguments.length?t:1),new st(this.h,this.s,t*this.l)},Aa.rgb=function(){return lt(this.h,this.s,this.l)},zo.hcl=ut;var Ra=ut.prototype=new at;Ra.brighter=function(t){return new ut(this.h,this.c,Math.min(100,this.l+La*(arguments.length?t:1)))},Ra.darker=function(t){return new ut(this.h,this.c,Math.max(0,this.l-La*(arguments.length?t:1)))},Ra.rgb=function(){return ct(this.h,this.c,this.l).rgb()},zo.lab=ht;var La=18,Ia=.95047,Pa=1,Ma=1.08883,Oa=ht.prototype=new at;Oa.brighter=function(t){return new ht(Math.min(100,this.l+La*(arguments.length?t:1)),this.a,this.b)},Oa.darker=function(t){return new ht(Math.max(0,this.l-La*(arguments.length?t:1)),this.a,this.b)},Oa.rgb=function(){return dt(this.l,this.a,this.b)},zo.rgb=vt;var Da=vt.prototype=new at;Da.brighter=function(t){t=Math.pow(.7,arguments.length?t:1);var e=this.r,n=this.g,i=this.b,r=30;return e||n||i?(e&&e<r&&(e=r),n&&n<r&&(n=r),i&&i<r&&(i=r),new vt(Math.min(255,e/t),Math.min(255,n/t),Math.min(255,i/t))):new vt(r,r,r)},Da.darker=function(t){return t=Math.pow(.7,arguments.length?t:1),new vt(t*this.r,t*this.g,t*this.b)},Da.hsl=function(){return Et(this.r,this.g,this.b)},Da.toString=function(){return"#"+xt(this.r)+xt(this.g)+xt(this.b)};var Fa=zo.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});Fa.forEach(function(t,e){Fa.set(t,yt(e))}),zo.functor=bt,zo.xhr=At(y),zo.dsv=function(t,e){function n(t,n,o){arguments.length<3&&(o=n,n=null);var a=Rt(t,e,null==n?i:r(n),o);return a.row=function(t){return arguments.length?a.response(null==(n=t)?i:r(t)):n},a}function i(t){return n.parse(t.responseText)}function r(t){return function(e){return n.parse(e.responseText,t)}}function o(e){return e.map(a).join(t)}function a(t){return s.test(t)?'"'+t.replace(/\"/g,'""')+'"':t}var s=new RegExp('["'+t+"\n]"),l=t.charCodeAt(0);return n.parse=function(t,e){var i;return n.parseRows(t,function(t,n){if(i)return i(t,n-1);var r=new Function("d","return {"+t.map(function(t,e){return JSON.stringify(t)+": d["+e+"]"}).join(",")+"}");i=e?function(t,n){return e(r(t),n)}:r})},n.parseRows=function(t,e){function n(){if(c>=u)return a;if(r)return r=!1,o;var e=c;if(34===t.charCodeAt(e)){for(var n=e;n++<u;)if(34===t.charCodeAt(n)){if(34!==t.charCodeAt(n+1))break;++n}return c=n+2,13===(i=t.charCodeAt(n+1))?(r=!0,10===t.charCodeAt(n+2)&&++c):10===i&&(r=!0),t.slice(e+1,n).replace(/""/g,'"')}for(;c<u;){var i=t.charCodeAt(c++),s=1;if(10===i)r=!0;else if(13===i)r=!0,10===t.charCodeAt(c)&&(++c,++s);else if(i!==l)continue;return t.slice(e,c-s)}return t.slice(e)}for(var i,r,o={},a={},s=[],u=t.length,c=0,h=0;(i=n())!==a;){for(var d=[];i!==o&&i!==a;)d.push(i),i=n();e&&null==(d=e(d,h++))||s.push(d)}return s},n.format=function(e){if(Array.isArray(e[0]))return n.formatRows(e);var i=new v,r=[];return e.forEach(function(t){for(var e in t)i.has(e)||r.push(i.add(e))}),[r.map(a).join(t)].concat(e.map(function(e){return r.map(function(t){return a(e[t])}).join(t)})).join("\n")},n.formatRows=function(t){return t.map(o).join("\n")},n},zo.csv=zo.dsv(",","text/csv"),zo.tsv=zo.dsv("\t","text/tab-separated-values");var ka,Na,Ga,Va,Ua=this[x(this,"requestAnimationFrame")]||function(t){setTimeout(t,17)};zo.timer=function(){Pt.apply(this,arguments)},zo.timer.flush=function(){Ot(),Dt()},zo.round=function(t,e){return e?Math.round(t*(e=Math.pow(10,e)))/e:Math.round(t)};var Ba=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"].map(function(t,e){var n=Math.pow(10,3*Jo(8-e));return{scale:e>8?function(t){return t/n}:function(t){return t*n},symbol:t}});zo.formatPrefix=function(t,e){var n=0;return(t=+t)&&(t<0&&(t*=-1),e&&(t=zo.round(t,Ft(t,e))),n=1+Math.floor(1e-12+Math.log(t)/Math.LN10),n=Math.max(-24,Math.min(24,3*Math.floor((n-1)/3)))),Ba[8+n/3]};var za=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,Xa=zo.map({b:function(t){return t.toString(2)},c:function(t){return String.fromCharCode(t)},o:function(t){return t.toString(8)},x:function(t){return t.toString(16)},X:function(t){return t.toString(16).toUpperCase()},g:function(t,e){return t.toPrecision(e)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},r:function(t,e){return(t=zo.round(t,Ft(t,e))).toFixed(Math.max(0,Math.min(20,Ft(t*(1+1e-15),e))))}}),Ha=zo.time={},Wa=Date;Gt.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){Ya.setUTCDate.apply(this._,arguments)},setDay:function(){Ya.setUTCDay.apply(this._,arguments)},setFullYear:function(){Ya.setUTCFullYear.apply(this._,arguments)},setHours:function(){Ya.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){Ya.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){Ya.setUTCMinutes.apply(this._,arguments)},setMonth:function(){Ya.setUTCMonth.apply(this._,arguments)},setSeconds:function(){Ya.setUTCSeconds.apply(this._,arguments)},setTime:function(){Ya.setTime.apply(this._,arguments)}};var Ya=Date.prototype;Ha.year=Vt(function(t){return(t=Ha.day(t)).setMonth(0,1),t},function(t,e){t.setFullYear(t.getFullYear()+e)},function(t){return t.getFullYear()}),Ha.years=Ha.year.range,Ha.years.utc=Ha.year.utc.range,Ha.day=Vt(function(t){var e=new Wa(2e3,0);return e.setFullYear(t.getFullYear(),t.getMonth(),t.getDate()),e},function(t,e){t.setDate(t.getDate()+e)},function(t){return t.getDate()-1}),Ha.days=Ha.day.range,Ha.days.utc=Ha.day.utc.range,Ha.dayOfYear=function(t){var e=Ha.year(t);return Math.floor((t-e-6e4*(t.getTimezoneOffset()-e.getTimezoneOffset()))/864e5)},["sunday","monday","tuesday","wednesday","thursday","friday","saturday"].forEach(function(t,e){e=7-e;var n=Ha[t]=Vt(function(t){return(t=Ha.day(t)).setDate(t.getDate()-(t.getDay()+e)%7),t},function(t,e){t.setDate(t.getDate()+7*Math.floor(e))},function(t){var n=Ha.year(t).getDay();return Math.floor((Ha.dayOfYear(t)+(n+e)%7)/7)-(n!==e)});Ha[t+"s"]=n.range,Ha[t+"s"].utc=n.utc.range,Ha[t+"OfYear"]=function(t){var n=Ha.year(t).getDay();return Math.floor((Ha.dayOfYear(t)+(n+e)%7)/7)}}),Ha.week=Ha.sunday,Ha.weeks=Ha.sunday.range,Ha.weeks.utc=Ha.sunday.utc.range,Ha.weekOfYear=Ha.sundayOfYear;var ja={"-":"",_:" ",0:"0"},Ka=/^\s*\d+/,qa=/^%/;zo.locale=function(t){return{numberFormat:kt(t),timeFormat:Bt(t)}};var Za=zo.locale({decimal:".",thousands:",",grouping:[3],currency:["$",""],dateTime:"%a %b %e %X %Y",date:"%m/%d/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});zo.format=Za.numberFormat,zo.geo={},le.prototype={s:0,t:0,add:function(t){ue(t,this.t,Qa),ue(Qa.s,this.s,this),this.s?this.t+=Qa.t:this.s=Qa.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};var Qa=new le;zo.geo.stream=function(t,e){t&&Ja.hasOwnProperty(t.type)?Ja[t.type](t,e):ce(t,e)};var Ja={Feature:function(t,e){ce(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,i=-1,r=n.length;++i<r;)ce(n[i].geometry,e)}},$a={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)t=n[i],e.point(t[0],t[1],t[2])},LineString:function(t,e){he(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)he(n[i],e,0)},Polygon:function(t,e){de(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;++i<r;)de(n[i],e)},GeometryCollection:function(t,e){for(var n=t.geometries,i=-1,r=n.length;++i<r;)ce(n[i],e)}};zo.geo.area=function(t){return ts=0,zo.geo.stream(t,ns),ts};var ts,es=new le,ns={sphere:function(){ts+=4*va},point:S,lineStart:S,lineEnd:S,polygonStart:function(){es.reset(),ns.lineStart=fe},polygonEnd:function(){var t=2*es;ts+=t<0?4*va+t:t,ns.lineStart=ns.lineEnd=ns.point=S}};zo.geo.bounds=function(){function t(t,e){m.push(x=[c=t,d=t]),e<h&&(h=e),e>f&&(f=e)}function e(e,n){var i=pe([e*Sa,n*Sa]);if(v){var r=_e(v,i),o=_e([r[1],-r[0],0],r);me(o),o=xe(o);var a=e-p,l=a>0?1:-1,u=o[0]*Ea*l,g=Jo(a)>180;if(g^(l*p<u&&u<l*e))(_=o[1]*Ea)>f&&(f=_);else if(u=(u+360)%360-180,g^(l*p<u&&u<l*e)){var _=-o[1]*Ea;_<h&&(h=_)}else n<h&&(h=n),n>f&&(f=n);g?e<p?s(c,e)>s(c,d)&&(d=e):s(e,d)>s(c,d)&&(c=e):d>=c?(e<c&&(c=e),e>d&&(d=e)):e>p?s(c,e)>s(c,d)&&(d=e):s(e,d)>s(c,d)&&(c=e)}else t(e,n);v=i,p=e}function n(){S.point=e}function i(){x[0]=c,x[1]=d,S.point=t,v=null}function r(t,n){if(v){var i=t-p;y+=Jo(i)>180?i+(i>0?360:-360):i}else g=t,_=n;ns.point(t,n),e(t,n)}function o(){ns.lineStart()}function a(){r(g,_),ns.lineEnd(),Jo(y)>ga&&(c=-(d=180)),x[0]=c,x[1]=d,v=null}function s(t,e){return(e-=t)<0?e+360:e}function l(t,e){return t[0]-e[0]}function u(t,e){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}var c,h,d,f,p,g,_,v,y,m,x,S={point:t,lineStart:n,lineEnd:i,polygonStart:function(){S.point=r,S.lineStart=o,S.lineEnd=a,y=0,ns.polygonStart()},polygonEnd:function(){ns.polygonEnd(),S.point=t,S.lineStart=n,S.lineEnd=i,es<0?(c=-(d=180),h=-(f=90)):y>ga?f=90:y<-ga&&(h=-90),x[0]=c,x[1]=d}};return function(t){f=d=-(c=h=1/0),m=[],zo.geo.stream(t,S);var e=m.length;if(e){m.sort(l);for(var n=1,i=[p=m[0]];n<e;++n)u((o=m[n])[0],p)||u(o[1],p)?(s(p[0],o[1])>s(p[0],p[1])&&(p[1]=o[1]),s(o[0],p[1])>s(p[0],p[1])&&(p[0]=o[0])):i.push(p=o);for(var r,o,a=-1/0,n=0,p=i[e=i.length-1];n<=e;p=o,++n)o=i[n],(r=s(p[1],o[0]))>a&&(a=r,c=o[0],d=p[1])}return m=x=null,c===1/0||h===1/0?[[NaN,NaN],[NaN,NaN]]:[[c,h],[d,f]]}}(),zo.geo.centroid=function(t){is=rs=os=as=ss=ls=us=cs=hs=ds=fs=0,zo.geo.stream(t,ps);var e=hs,n=ds,i=fs,r=e*e+n*n+i*i;return r<_a&&(e=ls,n=us,i=cs,rs<ga&&(e=os,n=as,i=ss),(r=e*e+n*n+i*i)<_a)?[NaN,NaN]:[Math.atan2(n,e)*Ea,et(i/Math.sqrt(r))*Ea]};var is,rs,os,as,ss,ls,us,cs,hs,ds,fs,ps={sphere:S,point:Ee,lineStart:we,lineEnd:Ce,polygonStart:function(){ps.lineStart=be},polygonEnd:function(){ps.lineStart=we}},gs=Me(Re,function(t){var e,n=NaN,i=NaN,r=NaN;return{lineStart:function(){t.lineStart(),e=1},point:function(o,a){var s=o>0?va:-va,l=Jo(o-n);Jo(l-va)<ga?(t.point(n,i=(i+a)/2>0?xa:-xa),t.point(r,i),t.lineEnd(),t.lineStart(),t.point(s,i),t.point(o,i),e=0):r!==s&&l>=va&&(Jo(n-r)<ga&&(n-=r*ga),Jo(o-s)<ga&&(o-=s*ga),i=ke(n,i,o,a),t.point(r,i),t.lineEnd(),t.lineStart(),t.point(s,i),e=0),t.point(n=o,i=a),r=s},lineEnd:function(){t.lineEnd(),n=i=NaN},clean:function(){return 2-e}}},function(t,e,n,i){var r;if(null==t)r=n*xa,i.point(-va,r),i.point(0,r),i.point(va,r),i.point(va,0),i.point(va,-r),i.point(0,-r),i.point(-va,-r),i.point(-va,0),i.point(-va,r);else if(Jo(t[0]-e[0])>ga){var o=t[0]<e[0]?va:-va;r=n*o/2,i.point(-o,r),i.point(0,r),i.point(o,r)}else i.point(e[0],e[1])},[-va,-va/2]),_s=1e9;zo.geo.clipExtent=function(){var t,e,n,i,r,o,a={stream:function(t){return r&&(r.valid=!1),r=o(t),r.valid=!0,r},extent:function(s){return arguments.length?(o=Ue(t=+s[0][0],e=+s[0][1],n=+s[1][0],i=+s[1][1]),r&&(r.valid=!1,r=null),a):[[t,e],[n,i]]}};return a.extent([[0,0],[960,500]])},(zo.geo.conicEqualArea=function(){return Be(ze)}).raw=ze,zo.geo.albers=function(){return zo.geo.conicEqualArea().rotate([96,0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)},zo.geo.albersUsa=function(){function t(t){var o=t[0],a=t[1];return e=null,n(o,a),e||(i(o,a),e)||r(o,a),e}var e,n,i,r,o=zo.geo.albers(),a=zo.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),s=zo.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),l={point:function(t,n){e=[t,n]}};return t.invert=function(t){var e=o.scale(),n=o.translate(),i=(t[0]-n[0])/e,r=(t[1]-n[1])/e;return(r>=.12&&r<.234&&i>=-.425&&i<-.214?a:r>=.166&&r<.234&&i>=-.214&&i<-.115?s:o).invert(t)},t.stream=function(t){var e=o.stream(t),n=a.stream(t),i=s.stream(t);return{point:function(t,r){e.point(t,r),n.point(t,r),i.point(t,r)},sphere:function(){e.sphere(),n.sphere(),i.sphere()},lineStart:function(){e.lineStart(),n.lineStart(),i.lineStart()},lineEnd:function(){e.lineEnd(),n.lineEnd(),i.lineEnd()},polygonStart:function(){e.polygonStart(),n.polygonStart(),i.polygonStart()},polygonEnd:function(){e.polygonEnd(),n.polygonEnd(),i.polygonEnd()}}},t.precision=function(e){return arguments.length?(o.precision(e),a.precision(e),s.precision(e),t):o.precision()},t.scale=function(e){return arguments.length?(o.scale(e),a.scale(.35*e),s.scale(e),t.translate(o.translate())):o.scale()},t.translate=function(e){if(!arguments.length)return o.translate();var u=o.scale(),c=+e[0],h=+e[1];return n=o.translate(e).clipExtent([[c-.455*u,h-.238*u],[c+.455*u,h+.238*u]]).stream(l).point,i=a.translate([c-.307*u,h+.201*u]).clipExtent([[c-.425*u+ga,h+.12*u+ga],[c-.214*u-ga,h+.234*u-ga]]).stream(l).point,r=s.translate([c-.205*u,h+.212*u]).clipExtent([[c-.214*u+ga,h+.166*u+ga],[c-.115*u-ga,h+.234*u-ga]]).stream(l).point,t},t.scale(1070)};var vs,ys,ms,xs,Ss,Es,Ts={point:S,lineStart:S,lineEnd:S,polygonStart:function(){ys=0,Ts.lineStart=Xe},polygonEnd:function(){Ts.lineStart=Ts.lineEnd=Ts.point=S,vs+=Jo(ys/2)}},ws={point:function(t,e){t<ms&&(ms=t),t>Ss&&(Ss=t),e<xs&&(xs=e),e>Es&&(Es=e)},lineStart:S,lineEnd:S,polygonStart:S,polygonEnd:S},Cs={point:Ye,lineStart:je,lineEnd:Ke,polygonStart:function(){Cs.lineStart=qe},polygonEnd:function(){Cs.point=Ye,Cs.lineStart=je,Cs.lineEnd=Ke}};zo.geo.path=function(){function t(t){return t&&("function"==typeof s&&o.pointRadius(+s.apply(this,arguments)),a&&a.valid||(a=r(o)),zo.geo.stream(t,a)),o.result()}function e(){return a=null,t}var n,i,r,o,a,s=4.5;return t.area=function(t){return vs=0,zo.geo.stream(t,r(Ts)),vs},t.centroid=function(t){return os=as=ss=ls=us=cs=hs=ds=fs=0,zo.geo.stream(t,r(Cs)),fs?[hs/fs,ds/fs]:cs?[ls/cs,us/cs]:ss?[os/ss,as/ss]:[NaN,NaN]},t.bounds=function(t){return Ss=Es=-(ms=xs=1/0),zo.geo.stream(t,r(ws)),[[ms,xs],[Ss,Es]]},t.projection=function(t){return arguments.length?(r=(n=t)?t.stream||Je(t):y,e()):n},t.context=function(t){return arguments.length?(o=null==(i=t)?new He:new Ze(t),"function"!=typeof s&&o.pointRadius(s),e()):i},t.pointRadius=function(e){return arguments.length?(s="function"==typeof e?e:(o.pointRadius(+e),+e),t):s},t.projection(zo.geo.albersUsa()).context(null)},zo.geo.transform=function(t){return{stream:function(e){var n=new $e(e);for(var i in t)n[i]=t[i];return n}}},$e.prototype={point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}},zo.geo.projection=en,zo.geo.projectionMutator=nn,(zo.geo.equirectangular=function(){return en(on)}).raw=on.invert=on,zo.geo.rotation=function(t){function e(e){return e=t(e[0]*Sa,e[1]*Sa),e[0]*=Ea,e[1]*=Ea,e}return t=sn(t[0]%360*Sa,t[1]*Sa,t.length>2?t[2]*Sa:0),e.invert=function(e){return e=t.invert(e[0]*Sa,e[1]*Sa),e[0]*=Ea,e[1]*=Ea,e},e},an.invert=on,zo.geo.circle=function(){function t(){var t="function"==typeof i?i.apply(this,arguments):i,e=sn(-t[0]*Sa,-t[1]*Sa,0).invert,r=[];return n(null,null,1,{point:function(t,n){r.push(t=e(t,n)),t[0]*=Ea,t[1]*=Ea}}),{type:"Polygon",coordinates:[r]}}var e,n,i=[0,0],r=6;return t.origin=function(e){return arguments.length?(i=e,t):i},t.angle=function(i){return arguments.length?(n=hn((e=+i)*Sa,r*Sa),t):e},t.precision=function(i){return arguments.length?(n=hn(e*Sa,(r=+i)*Sa),t):r},t.angle(90)},zo.geo.distance=function(t,e){var n,i=(e[0]-t[0])*Sa,r=t[1]*Sa,o=e[1]*Sa,a=Math.sin(i),s=Math.cos(i),l=Math.sin(r),u=Math.cos(r),c=Math.sin(o),h=Math.cos(o);return Math.atan2(Math.sqrt((n=h*a)*n+(n=u*c-l*h*s)*n),l*c+u*h*s)},zo.geo.graticule=function(){function t(){return{type:"MultiLineString",coordinates:e()}}function e(){return zo.range(Math.ceil(o/_)*_,r,_).map(d).concat(zo.range(Math.ceil(u/v)*v,l,v).map(f)).concat(zo.range(Math.ceil(i/p)*p,n,p).filter(function(t){return Jo(t%_)>ga}).map(c)).concat(zo.range(Math.ceil(s/g)*g,a,g).filter(function(t){return Jo(t%v)>ga}).map(h))}var n,i,r,o,a,s,l,u,c,h,d,f,p=10,g=p,_=90,v=360,y=2.5;return t.lines=function(){return e().map(function(t){return{type:"LineString",coordinates:t}})},t.outline=function(){return{type:"Polygon",coordinates:[d(o).concat(f(l).slice(1),d(r).reverse().slice(1),f(u).reverse().slice(1))]}},t.extent=function(e){return arguments.length?t.majorExtent(e).minorExtent(e):t.minorExtent()},t.majorExtent=function(e){return arguments.length?(o=+e[0][0],r=+e[1][0],u=+e[0][1],l=+e[1][1],o>r&&(e=o,o=r,r=e),u>l&&(e=u,u=l,l=e),t.precision(y)):[[o,u],[r,l]]},t.minorExtent=function(e){return arguments.length?(i=+e[0][0],n=+e[1][0],s=+e[0][1],a=+e[1][1],i>n&&(e=i,i=n,n=e),s>a&&(e=s,s=a,a=e),t.precision(y)):[[i,s],[n,a]]},t.step=function(e){return arguments.length?t.majorStep(e).minorStep(e):t.minorStep()},t.majorStep=function(e){return arguments.length?(_=+e[0],v=+e[1],t):[_,v]},t.minorStep=function(e){return arguments.length?(p=+e[0],g=+e[1],t):[p,g]},t.precision=function(e){return arguments.length?(y=+e,c=fn(s,a,90),h=pn(i,n,y),d=fn(u,l,90),f=pn(o,r,y),t):y},t.majorExtent([[-180,-90+ga],[180,90-ga]]).minorExtent([[-180,-80-ga],[180,80+ga]])},zo.geo.greatArc=function(){function t(){return{type:"LineString",coordinates:[e||i.apply(this,arguments),n||r.apply(this,arguments)]}}var e,n,i=gn,r=_n;return t.distance=function(){return zo.geo.distance(e||i.apply(this,arguments),n||r.apply(this,arguments))},t.source=function(n){return arguments.length?(i=n,e="function"==typeof n?null:n,t):i},t.target=function(e){return arguments.length?(r=e,n="function"==typeof e?null:e,t):r},t.precision=function(){return arguments.length?t:0},t},zo.geo.interpolate=function(t,e){return vn(t[0]*Sa,t[1]*Sa,e[0]*Sa,e[1]*Sa)},zo.geo.length=function(t){return bs=0,zo.geo.stream(t,As),bs};var bs,As={sphere:S,point:S,lineStart:function(){function t(t,r){var o=Math.sin(r*=Sa),a=Math.cos(r),s=Jo((t*=Sa)-e),l=Math.cos(s);bs+=Math.atan2(Math.sqrt((s=a*Math.sin(s))*s+(s=i*o-n*a*l)*s),n*o+i*a*l),e=t,n=o,i=a}var e,n,i;As.point=function(r,o){e=r*Sa,n=Math.sin(o*=Sa),i=Math.cos(o),As.point=t},As.lineEnd=function(){As.point=As.lineEnd=S}},lineEnd:S,polygonStart:S,polygonEnd:S},Rs=yn(function(t){return Math.sqrt(2/(1+t))},function(t){return 2*Math.asin(t/2)});(zo.geo.azimuthalEqualArea=function(){return en(Rs)}).raw=Rs;var Ls=yn(function(t){var e=Math.acos(t);return e&&e/Math.sin(e)},y);(zo.geo.azimuthalEquidistant=function(){return en(Ls)}).raw=Ls,(zo.geo.conicConformal=function(){return Be(mn)}).raw=mn,(zo.geo.conicEquidistant=function(){return Be(xn)}).raw=xn;var Is=yn(function(t){return 1/t},Math.atan);(zo.geo.gnomonic=function(){return en(Is)}).raw=Is,Sn.invert=function(t,e){return[t,2*Math.atan(Math.exp(e))-xa]},(zo.geo.mercator=function(){return En(Sn)}).raw=Sn;var Ps=yn(function(){return 1},Math.asin);(zo.geo.orthographic=function(){return en(Ps)}).raw=Ps;var Ms=yn(function(t){return 1/(1+t)},function(t){return 2*Math.atan(t)});(zo.geo.stereographic=function(){return en(Ms)}).raw=Ms,Tn.invert=function(t,e){return[-e,2*Math.atan(Math.exp(t))-xa]},(zo.geo.transverseMercator=function(){var t=En(Tn),e=t.center,n=t.rotate;return t.center=function(t){return t?e([-t[1],t[0]]):(t=e(),[t[1],-t[0]])},t.rotate=function(t){return t?n([t[0],t[1],t.length>2?t[2]+90:90]):(t=n(),[t[0],t[1],t[2]-90])},n([0,0,90])}).raw=Tn,zo.geom={},zo.geom.hull=function(t){function e(t){if(t.length<3)return[];var e,r=bt(n),o=bt(i),a=t.length,s=[],l=[];for(e=0;e<a;e++)s.push([+r.call(this,t[e],e),+o.call(this,t[e],e),e]);for(s.sort(An),e=0;e<a;e++)l.push([s[e][0],-s[e][1]]);var u=bn(s),c=bn(l),h=c[0]===u[0],d=c[c.length-1]===u[u.length-1],f=[];for(e=u.length-1;e>=0;--e)f.push(t[s[u[e]][2]]);for(e=+h;e<c.length-d;++e)f.push(t[s[c[e]][2]]);return f}var n=wn,i=Cn;return arguments.length?e(t):(e.x=function(t){return arguments.length?(n=t,e):n},e.y=function(t){return arguments.length?(i=t,e):i},e)},zo.geom.polygon=function(t){return ia(t,Os),t};var Os=zo.geom.polygon.prototype=[];Os.area=function(){for(var t,e=-1,n=this.length,i=this[n-1],r=0;++e<n;)t=i,i=this[e],r+=t[1]*i[0]-t[0]*i[1];return.5*r},Os.centroid=function(t){var e,n,i=-1,r=this.length,o=0,a=0,s=this[r-1];for(arguments.length||(t=-1/(6*this.area()));++i<r;)e=s,s=this[i],n=e[0]*s[1]-s[0]*e[1],o+=(e[0]+s[0])*n,a+=(e[1]+s[1])*n;return[o*t,a*t]},Os.clip=function(t){for(var e,n,i,r,o,a,s=In(t),l=-1,u=this.length-In(this),c=this[u-1];++l<u;){for(e=t.slice(),t.length=0,r=this[l],o=e[(i=e.length-s)-1],n=-1;++n<i;)Rn(a=e[n],c,r)?(Rn(o,c,r)||t.push(Ln(o,a,c,r)),t.push(a)):Rn(o,c,r)&&t.push(Ln(o,a,c,r)),o=a;s&&t.push(t[0]),c=r}return t};var Ds,Fs,ks,Ns,Gs,Vs=[],Us=[];Gn.prototype.prepare=function(){for(var t,e=this.edges,n=e.length;n--;)(t=e[n].edge).b&&t.a||e.splice(n,1);return e.sort(Un),e.length},Zn.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}},Qn.prototype={insert:function(t,e){var n,i,r;if(t){if(e.P=t,e.N=t.N,t.N&&(t.N.P=e),t.N=e,t.R){for(t=t.R;t.L;)t=t.L;t.L=e}else t.R=e;n=t}else this._?(t=ei(this._),e.P=null,e.N=t,t.P=t.L=e,n=t):(e.P=e.N=null,this._=e,n=null);for(e.L=e.R=null,e.U=n,e.C=!0,t=e;n&&n.C;)n===(i=n.U).L?(r=i.R)&&r.C?(n.C=r.C=!1,i.C=!0,t=i):(t===n.R&&($n(this,n),n=(t=n).U),n.C=!1,i.C=!0,ti(this,i)):(r=i.L)&&r.C?(n.C=r.C=!1,i.C=!0,t=i):(t===n.L&&(ti(this,n),n=(t=n).U),n.C=!1,i.C=!0,$n(this,i)),n=t.U;this._.C=!1},remove:function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var e,n,i,r=t.U,o=t.L,a=t.R;if(n=o?a?ei(a):o:a,r?r.L===t?r.L=n:r.R=n:this._=n,o&&a?(i=n.C,n.C=t.C,n.L=o,o.U=n,n!==a?(r=n.U,n.U=t.U,t=n.R,r.L=t,n.R=a,a.U=n):(n.U=r,r=n,t=n.R)):(i=t.C,t=n),t&&(t.U=r),!i)if(t&&t.C)t.C=!1;else{do{if(t===this._)break;if(t===r.L){if((e=r.R).C&&(e.C=!1,r.C=!0,$n(this,r),e=r.R),e.L&&e.L.C||e.R&&e.R.C){e.R&&e.R.C||(e.L.C=!1,e.C=!0,ti(this,e),e=r.R),e.C=r.C,r.C=e.R.C=!1,$n(this,r),t=this._;break}}else if((e=r.L).C&&(e.C=!1,r.C=!0,ti(this,r),e=r.L),e.L&&e.L.C||e.R&&e.R.C){e.L&&e.L.C||(e.R.C=!1,e.C=!0,$n(this,e),e=r.L),e.C=r.C,r.C=e.L.C=!1,ti(this,r),t=this._;break}e.C=!0,t=r,r=r.U}while(!t.C);t&&(t.C=!1)}}},zo.geom.voronoi=function(t){function e(t){var e=new Array(t.length),i=s[0][0],r=s[0][1],o=s[1][0],a=s[1][1];return ni(n(t),s).cells.forEach(function(n,s){var l=n.edges,u=n.site;(e[s]=l.length?l.map(function(t){var e=t.start();return[e.x,e.y]}):u.x>=i&&u.x<=o&&u.y>=r&&u.y<=a?[[i,a],[o,a],[o,r],[i,r]]:[]).point=t[s]}),e}function n(t){return t.map(function(t,e){return{x:Math.round(o(t,e)/ga)*ga,y:Math.round(a(t,e)/ga)*ga,i:e}})}var i=wn,r=Cn,o=i,a=r,s=Bs;return t?e(t):(e.links=function(t){return ni(n(t)).edges.filter(function(t){return t.l&&t.r}).map(function(e){return{source:t[e.l.i],target:t[e.r.i]}})},e.triangles=function(t){var e=[];return ni(n(t)).cells.forEach(function(n,i){for(var r,o=n.site,a=n.edges.sort(Un),s=-1,l=a.length,u=a[l-1].edge,c=u.l===o?u.r:u.l;++s<l;)u,r=c,c=(u=a[s].edge).l===o?u.r:u.l,i<r.i&&i<c.i&&ri(o,r,c)<0&&e.push([t[i],t[r.i],t[c.i]])}),e},e.x=function(t){return arguments.length?(o=bt(i=t),e):i},e.y=function(t){return arguments.length?(a=bt(r=t),e):r},e.clipExtent=function(t){return arguments.length?(s=null==t?Bs:t,e):s===Bs?null:s},e.size=function(t){return arguments.length?e.clipExtent(t&&[[0,0],t]):s===Bs?null:s&&s[1]},e)};var Bs=[[-1e6,-1e6],[1e6,1e6]];zo.geom.delaunay=function(t){return zo.geom.voronoi().triangles(t)},zo.geom.quadtree=function(t,e,n,i,r){function o(t){function o(t,e,n,i,r,o,a,s){if(!isNaN(n)&&!isNaN(i))if(t.leaf){var l=t.x,c=t.y;if(null!=l)if(Jo(l-n)+Jo(c-i)<.01)u(t,e,n,i,r,o,a,s);else{var h=t.point;t.x=t.y=t.point=null,u(t,h,l,c,r,o,a,s),u(t,e,n,i,r,o,a,s)}else t.x=n,t.y=i,t.point=e}else u(t,e,n,i,r,o,a,s)}function u(t,e,n,i,r,a,s,l){var u=.5*(r+s),c=.5*(a+l),h=n>=u,d=i>=c,f=d<<1|h;t.leaf=!1,t=t.nodes[f]||(t.nodes[f]={leaf:!0,nodes:[],point:null,x:null,y:null}),h?r=u:s=u,d?a=c:l=c,o(t,e,n,i,r,a,s,l)}var c,h,d,f,p,g,_,v,y,m=bt(s),x=bt(l);if(null!=e)g=e,_=n,v=i,y=r;else if(v=y=-(g=_=1/0),h=[],d=[],p=t.length,a)for(f=0;f<p;++f)(c=t[f]).x<g&&(g=c.x),c.y<_&&(_=c.y),c.x>v&&(v=c.x),c.y>y&&(y=c.y),h.push(c.x),d.push(c.y);else for(f=0;f<p;++f){var S=+m(c=t[f],f),E=+x(c,f);S<g&&(g=S),E<_&&(_=E),S>v&&(v=S),E>y&&(y=E),h.push(S),d.push(E)}var T=v-g,w=y-_;T>w?y=_+T:v=g+w;var C={leaf:!0,nodes:[],point:null,x:null,y:null};if(C.add=function(t){o(C,t,+m(t,++f),+x(t,f),g,_,v,y)},C.visit=function(t){si(t,C,g,_,v,y)},C.find=function(t){return li(C,t[0],t[1],g,_,v,y)},f=-1,null==e){for(;++f<p;)o(C,t[f],h[f],d[f],g,_,v,y);--f}else t.forEach(C.add);return h=d=t=c=null,C}var a,s=wn,l=Cn;return(a=arguments.length)?(s=oi,l=ai,3===a&&(r=n,i=e,n=e=0),o(t)):(o.x=function(t){return arguments.length?(s=t,o):s},o.y=function(t){return arguments.length?(l=t,o):l},o.extent=function(t){return arguments.length?(null==t?e=n=i=r=null:(e=+t[0][0],n=+t[0][1],i=+t[1][0],r=+t[1][1]),o):null==e?null:[[e,n],[i,r]]},o.size=function(t){return arguments.length?(null==t?e=n=i=r=null:(e=n=0,i=+t[0],r=+t[1]),o):null==e?null:[i-e,r-n]},o)},zo.interpolateRgb=ui,zo.interpolateObject=ci,zo.interpolateNumber=hi,zo.interpolateString=di;var zs=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Xs=new RegExp(zs.source,"g");zo.interpolate=fi,zo.interpolators=[function(t,e){var n=typeof e;return("string"===n?Fa.has(e.toLowerCase())||/^(#|rgb\(|hsl\()/i.test(e)?ui:di:e instanceof at?ui:Array.isArray(e)?pi:"object"===n&&isNaN(e)?ci:hi)(t,e)}],zo.interpolateArray=pi;var Hs=function(){return y},Ws=zo.map({linear:Hs,poly:function(t){return function(e){return Math.pow(e,t)}},quad:function(){return yi},cubic:function(){return mi},sin:function(){return Si},exp:function(){return Ei},circle:function(){return Ti},elastic:function(t,e){var n;return arguments.length<2&&(e=.45),arguments.length?n=e/ya*Math.asin(1/t):(t=1,n=e/4),function(i){return 1+t*Math.pow(2,-10*i)*Math.sin((i-n)*ya/e)}},back:function(t){return t||(t=1.70158),function(e){return e*e*((t+1)*e-t)}},bounce:function(){return wi}}),Ys=zo.map({in:y,out:_i,"in-out":vi,"out-in":function(t){return vi(_i(t))}});zo.ease=function(t){var e=t.indexOf("-"),n=e>=0?t.slice(0,e):t,i=e>=0?t.slice(e+1):"in";return n=Ws.get(n)||Hs,i=Ys.get(i)||y,gi(i(n.apply(null,Xo.call(arguments,1))))},zo.interpolateHcl=function(t,e){t=zo.hcl(t),e=zo.hcl(e);var n=t.h,i=t.c,r=t.l,o=e.h-n,a=e.c-i,s=e.l-r;return isNaN(a)&&(a=0,i=isNaN(i)?e.c:i),isNaN(o)?(o=0,n=isNaN(n)?e.h:n):o>180?o-=360:o<-180&&(o+=360),function(t){return ct(n+o*t,i+a*t,r+s*t)+""}},zo.interpolateHsl=function(t,e){t=zo.hsl(t),e=zo.hsl(e);var n=t.h,i=t.s,r=t.l,o=e.h-n,a=e.s-i,s=e.l-r;return isNaN(a)&&(a=0,i=isNaN(i)?e.s:i),isNaN(o)?(o=0,n=isNaN(n)?e.h:n):o>180?o-=360:o<-180&&(o+=360),function(t){return lt(n+o*t,i+a*t,r+s*t)+""}},zo.interpolateLab=function(t,e){t=zo.lab(t),e=zo.lab(e);var n=t.l,i=t.a,r=t.b,o=e.l-n,a=e.a-i,s=e.b-r;return function(t){return dt(n+o*t,i+a*t,r+s*t)+""}},zo.interpolateRound=Ci,zo.transform=function(t){var e=Wo.createElementNS(zo.ns.prefix.svg,"g");return(zo.transform=function(t){if(null!=t){e.setAttribute("transform",t);var n=e.transform.baseVal.consolidate()}return new bi(n?n.matrix:js)})(t)},bi.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var js={a:1,b:0,c:0,d:1,e:0,f:0};zo.interpolateTransform=Fi,zo.layout={},zo.layout.bundle=function(){return function(t){for(var e=[],n=-1,i=t.length;++n<i;)e.push(Gi(t[n]));return e}},zo.layout.chord=function(){function t(){var t,u,h,d,f,p={},g=[],_=zo.range(o),v=[];for(n=[],i=[],t=0,d=-1;++d<o;){for(u=0,f=-1;++f<o;)u+=r[d][f];g.push(u),v.push(zo.range(o)),t+=u}for(a&&_.sort(function(t,e){return a(g[t],g[e])}),s&&v.forEach(function(t,e){t.sort(function(t,n){return s(r[e][t],r[e][n])})}),t=(ya-c*o)/t,u=0,d=-1;++d<o;){for(h=u,f=-1;++f<o;){var y=_[d],m=v[y][f],x=r[y][m],S=u,E=u+=x*t;p[y+"-"+m]={index:y,subindex:m,startAngle:S,endAngle:E,value:x}}i[y]={index:y,startAngle:h,endAngle:u,value:g[y]},u+=c}for(d=-1;++d<o;)for(f=d-1;++f<o;){var T=p[d+"-"+f],w=p[f+"-"+d];(T.value||w.value)&&n.push(T.value<w.value?{source:w,target:T}:{source:T,target:w})}l&&e()}function e(){n.sort(function(t,e){return l((t.source.value+t.target.value)/2,(e.source.value+e.target.value)/2)})}var n,i,r,o,a,s,l,u={},c=0;return u.matrix=function(t){return arguments.length?(o=(r=t)&&r.length,n=i=null,u):r},u.padding=function(t){return arguments.length?(c=t,n=i=null,u):c},u.sortGroups=function(t){return arguments.length?(a=t,n=i=null,u):a},u.sortSubgroups=function(t){return arguments.length?(s=t,n=null,u):s},u.sortChords=function(t){return arguments.length?(l=t,n&&e(),u):l},u.chords=function(){return n||t(),n},u.groups=function(){return i||t(),i},u},zo.layout.force=function(){function t(t){return function(e,n,i,r){if(e.point!==t){var o=e.cx-t.x,a=e.cy-t.y,s=r-n,l=o*o+a*a;if(s*s/v<l){if(l<g){u=e.charge/l;t.px-=o*u,t.py-=a*u}return!0}if(e.point&&l&&l<g){var u=e.pointCharge/l;t.px-=o*u,t.py-=a*u}}return!e.charge}}function e(t){t.px=zo.event.x,t.py=zo.event.y,l.resume()}var n,i,r,o,a,s,l={},u=zo.dispatch("start","tick","end"),c=[1,1],h=.9,d=Ks,f=qs,p=-30,g=Zs,_=.1,v=.64,m=[],x=[];return l.tick=function(){if((r*=.99)<.005)return n=null,u.end({type:"end",alpha:r=0}),!0;var e,i,l,d,f,g,v,y,S,E=m.length,T=x.length;for(i=0;i<T;++i)d=(l=x[i]).source,(g=(y=(f=l.target).x-d.x)*y+(S=f.y-d.y)*S)&&(y*=g=r*a[i]*((g=Math.sqrt(g))-o[i])/g,S*=g,f.x-=y*(v=d.weight+f.weight?d.weight/(d.weight+f.weight):.5),f.y-=S*v,d.x+=y*(v=1-v),d.y+=S*v);if((v=r*_)&&(y=c[0]/2,S=c[1]/2,i=-1,v))for(;++i<E;)(l=m[i]).x+=(y-l.x)*v,l.y+=(S-l.y)*v;if(p)for(Wi(e=zo.geom.quadtree(m),r,s),i=-1;++i<E;)(l=m[i]).fixed||e.visit(t(l));for(i=-1;++i<E;)(l=m[i]).fixed?(l.x=l.px,l.y=l.py):(l.x-=(l.px-(l.px=l.x))*h,l.y-=(l.py-(l.py=l.y))*h);u.tick({type:"tick",alpha:r})},l.nodes=function(t){return arguments.length?(m=t,l):m},l.links=function(t){return arguments.length?(x=t,l):x},l.size=function(t){return arguments.length?(c=t,l):c},l.linkDistance=function(t){return arguments.length?(d="function"==typeof t?t:+t,l):d},l.distance=l.linkDistance,l.linkStrength=function(t){return arguments.length?(f="function"==typeof t?t:+t,l):f},l.friction=function(t){return arguments.length?(h=+t,l):h},l.charge=function(t){return arguments.length?(p="function"==typeof t?t:+t,l):p},l.chargeDistance=function(t){return arguments.length?(g=t*t,l):Math.sqrt(g)},l.gravity=function(t){return arguments.length?(_=+t,l):_},l.theta=function(t){return arguments.length?(v=t*t,l):Math.sqrt(v)},l.alpha=function(t){return arguments.length?(t=+t,r?t>0?r=t:(n.c=null,n.t=NaN,n=null,u.end({type:"end",alpha:r=0})):t>0&&(u.start({type:"start",alpha:r=t}),n=Pt(l.tick)),l):r},l.start=function(){function t(t,i){if(!n){for(n=new Array(r),l=0;l<r;++l)n[l]=[];for(l=0;l<u;++l){var o=x[l];n[o.source.index].push(o.target),n[o.target.index].push(o.source)}}for(var a,s=n[e],l=-1,c=s.length;++l<c;)if(!isNaN(a=s[l][t]))return a;return Math.random()*i}var e,n,i,r=m.length,u=x.length,h=c[0],g=c[1];for(e=0;e<r;++e)(i=m[e]).index=e,i.weight=0;for(e=0;e<u;++e)"number"==typeof(i=x[e]).source&&(i.source=m[i.source]),"number"==typeof i.target&&(i.target=m[i.target]),++i.source.weight,++i.target.weight;for(e=0;e<r;++e)i=m[e],isNaN(i.x)&&(i.x=t("x",h)),isNaN(i.y)&&(i.y=t("y",g)),isNaN(i.px)&&(i.px=i.x),isNaN(i.py)&&(i.py=i.y);if(o=[],"function"==typeof d)for(e=0;e<u;++e)o[e]=+d.call(this,x[e],e);else for(e=0;e<u;++e)o[e]=d;if(a=[],"function"==typeof f)for(e=0;e<u;++e)a[e]=+f.call(this,x[e],e);else for(e=0;e<u;++e)a[e]=f;if(s=[],"function"==typeof p)for(e=0;e<r;++e)s[e]=+p.call(this,m[e],e);else for(e=0;e<r;++e)s[e]=p;return l.resume()},l.resume=function(){return l.alpha(.1)},l.stop=function(){return l.alpha(0)},l.drag=function(){if(i||(i=zo.behavior.drag().origin(y).on("dragstart.force",Bi).on("drag.force",e).on("dragend.force",zi)),!arguments.length)return i;this.on("mouseover.force",Xi).on("mouseout.force",Hi).call(i)},zo.rebind(l,u,"on")};var Ks=20,qs=1,Zs=1/0;zo.layout.hierarchy=function(){function t(r){var o,a=[r],s=[];for(r.depth=0;null!=(o=a.pop());)if(s.push(o),(u=n.call(t,o,o.depth))&&(l=u.length)){for(var l,u,c;--l>=0;)a.push(c=u[l]),c.parent=o,c.depth=o.depth+1;i&&(o.value=0),o.children=u}else i&&(o.value=+i.call(t,o,o.depth)||0),delete o.children;return Ki(r,function(t){var n,r;e&&(n=t.children)&&n.sort(e),i&&(r=t.parent)&&(r.value+=t.value)}),s}var e=Qi,n=qi,i=Zi;return t.sort=function(n){return arguments.length?(e=n,t):e},t.children=function(e){return arguments.length?(n=e,t):n},t.value=function(e){return arguments.length?(i=e,t):i},t.revalue=function(e){return i&&(ji(e,function(t){t.children&&(t.value=0)}),Ki(e,function(e){var n;e.children||(e.value=+i.call(t,e,e.depth)||0),(n=e.parent)&&(n.value+=e.value)})),e},t},zo.layout.partition=function(){function t(e,n,i,r){var o=e.children;if(e.x=n,e.y=e.depth*r,e.dx=i,e.dy=r,o&&(a=o.length)){var a,s,l,u=-1;for(i=e.value?i/e.value:0;++u<a;)t(s=o[u],n,l=s.value*i,r),n+=l}}function e(t){var n=t.children,i=0;if(n&&(r=n.length))for(var r,o=-1;++o<r;)i=Math.max(i,e(n[o]));return 1+i}function n(n,o){var a=i.call(this,n,o);return t(a[0],0,r[0],r[1]/e(a[0])),a}var i=zo.layout.hierarchy(),r=[1,1];return n.size=function(t){return arguments.length?(r=t,n):r},Yi(n,i)},zo.layout.pie=function(){function t(a){var s,l=a.length,u=a.map(function(n,i){return+e.call(t,n,i)}),c=+("function"==typeof i?i.apply(this,arguments):i),h=("function"==typeof r?r.apply(this,arguments):r)-c,d=Math.min(Math.abs(h)/l,+("function"==typeof o?o.apply(this,arguments):o)),f=d*(h<0?-1:1),p=zo.sum(u),g=p?(h-l*f)/p:0,_=zo.range(l),v=[];return null!=n&&_.sort(n===Qs?function(t,e){return u[e]-u[t]}:function(t,e){return n(a[t],a[e])}),_.forEach(function(t){v[t]={data:a[t],value:s=u[t],startAngle:c,endAngle:c+=s*g+f,padAngle:d}}),v}var e=Number,n=Qs,i=0,r=ya,o=0;return t.value=function(n){return arguments.length?(e=n,t):e},t.sort=function(e){return arguments.length?(n=e,t):n},t.startAngle=function(e){return arguments.length?(i=e,t):i},t.endAngle=function(e){return arguments.length?(r=e,t):r},t.padAngle=function(e){return arguments.length?(o=e,t):o},t};var Qs={};zo.layout.stack=function(){function t(s,l){if(!(d=s.length))return s;var u=s.map(function(n,i){return e.call(t,n,i)}),c=u.map(function(e){return e.map(function(e,n){return[o.call(t,e,n),a.call(t,e,n)]})}),h=n.call(t,c,l);u=zo.permute(u,h),c=zo.permute(c,h);var d,f,p,g,_=i.call(t,c,l),v=u[0].length;for(p=0;p<v;++p)for(r.call(t,u[0][p],g=_[p],c[0][p][1]),f=1;f<d;++f)r.call(t,u[f][p],g+=c[f-1][p][1],c[f][p][1]);return s}var e=y,n=nr,i=ir,r=er,o=$i,a=tr;return t.values=function(n){return arguments.length?(e=n,t):e},t.order=function(e){return arguments.length?(n="function"==typeof e?e:Js.get(e)||nr,t):n},t.offset=function(e){return arguments.length?(i="function"==typeof e?e:$s.get(e)||ir,t):i},t.x=function(e){return arguments.length?(o=e,t):o},t.y=function(e){return arguments.length?(a=e,t):a},t.out=function(e){return arguments.length?(r=e,t):r},t};var Js=zo.map({"inside-out":function(t){var e,n,i=t.length,r=t.map(rr),o=t.map(or),a=zo.range(i).sort(function(t,e){return r[t]-r[e]}),s=0,l=0,u=[],c=[];for(e=0;e<i;++e)n=a[e],s<l?(s+=o[n],u.push(n)):(l+=o[n],c.push(n));return c.reverse().concat(u)},reverse:function(t){return zo.range(t.length).reverse()},default:nr}),$s=zo.map({silhouette:function(t){var e,n,i,r=t.length,o=t[0].length,a=[],s=0,l=[];for(n=0;n<o;++n){for(e=0,i=0;e<r;e++)i+=t[e][n][1];i>s&&(s=i),a.push(i)}for(n=0;n<o;++n)l[n]=(s-a[n])/2;return l},wiggle:function(t){var e,n,i,r,o,a,s,l,u,c=t.length,h=t[0],d=h.length,f=[];for(f[0]=l=u=0,n=1;n<d;++n){for(e=0,r=0;e<c;++e)r+=t[e][n][1];for(e=0,o=0,s=h[n][0]-h[n-1][0];e<c;++e){for(i=0,a=(t[e][n][1]-t[e][n-1][1])/(2*s);i<e;++i)a+=(t[i][n][1]-t[i][n-1][1])/s;o+=a*t[e][n][1]}f[n]=l-=r?o/r*s:0,l<u&&(u=l)}for(n=0;n<d;++n)f[n]-=u;return f},expand:function(t){var e,n,i,r=t.length,o=t[0].length,a=1/r,s=[];for(n=0;n<o;++n){for(e=0,i=0;e<r;e++)i+=t[e][n][1];if(i)for(e=0;e<r;e++)t[e][n][1]/=i;else for(e=0;e<r;e++)t[e][n][1]=a}for(n=0;n<o;++n)s[n]=0;return s},zero:ir});zo.layout.histogram=function(){function t(t,o){for(var a,s,l=[],u=t.map(n,this),c=i.call(this,u,o),h=r.call(this,c,u,o),o=-1,d=u.length,f=h.length-1,p=e?1:1/d;++o<f;)(a=l[o]=[]).dx=h[o+1]-(a.x=h[o]),a.y=0;if(f>0)for(o=-1;++o<d;)(s=u[o])>=c[0]&&s<=c[1]&&((a=l[zo.bisect(h,s,1,f)-1]).y+=p,a.push(t[o]));return l}var e=!0,n=Number,i=ur,r=sr;return t.value=function(e){return arguments.length?(n=e,t):n},t.range=function(e){return arguments.length?(i=bt(e),t):i},t.bins=function(e){return arguments.length?(r="number"==typeof e?function(t){return lr(t,e)}:bt(e),t):r},t.frequency=function(n){return arguments.length?(e=!!n,t):e},t},zo.layout.pack=function(){function t(t,o){var a=n.call(this,t,o),s=a[0],l=r[0],u=r[1],c=null==e?Math.sqrt:"function"==typeof e?e:function(){return e};if(s.x=s.y=0,Ki(s,function(t){t.r=+c(t.value)}),Ki(s,pr),i){var h=i*(e?1:Math.max(2*s.r/l,2*s.r/u))/2;Ki(s,function(t){t.r+=h}),Ki(s,pr),Ki(s,function(t){t.r-=h})}return vr(s,l/2,u/2,e?1:1/Math.max(2*s.r/l,2*s.r/u)),a}var e,n=zo.layout.hierarchy().sort(cr),i=0,r=[1,1];return t.size=function(e){return arguments.length?(r=e,t):r},t.radius=function(n){return arguments.length?(e=null==n||"function"==typeof n?n:+n,t):e},t.padding=function(e){return arguments.length?(i=+e,t):i},Yi(t,n)},zo.layout.tree=function(){function t(t,r){var c=a.call(this,t,r),h=c[0],d=e(h);if(Ki(d,n),d.parent.m=-d.z,ji(d,i),u)ji(h,o);else{var f=h,p=h,g=h;ji(h,function(t){t.x<f.x&&(f=t),t.x>p.x&&(p=t),t.depth>g.depth&&(g=t)});var _=s(f,p)/2-f.x,v=l[0]/(p.x+s(p,f)/2+_),y=l[1]/(g.depth||1);ji(h,function(t){t.x=(t.x+_)*v,t.y=t.depth*y})}return c}function e(t){for(var e,n={A:null,children:[t]},i=[n];null!=(e=i.pop());)for(var r,o=e.children,a=0,s=o.length;a<s;++a)i.push((o[a]=r={_:o[a],parent:e,children:(r=o[a].children)&&r.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:a}).a=r);return n.children[0]}function n(t){var e=t.children,n=t.parent.children,i=t.i?n[t.i-1]:null;if(e.length){Tr(t);var o=(e[0].z+e[e.length-1].z)/2;i?(t.z=i.z+s(t._,i._),t.m=t.z-o):t.z=o}else i&&(t.z=i.z+s(t._,i._));t.parent.A=r(t,i,t.parent.A||n[0])}function i(t){t._.x=t.z+t.parent.m,t.m+=t.parent.m}function r(t,e,n){if(e){for(var i,r=t,o=t,a=e,l=r.parent.children[0],u=r.m,c=o.m,h=a.m,d=l.m;a=Sr(a),r=xr(r),a&&r;)l=xr(l),(o=Sr(o)).a=t,(i=a.z+h-r.z-u+s(a._,r._))>0&&(Er(wr(a,t,n),t,i),u+=i,c+=i),h+=a.m,u+=r.m,d+=l.m,c+=o.m;a&&!Sr(o)&&(o.t=a,o.m+=h-c),r&&!xr(l)&&(l.t=r,l.m+=u-d,n=t)}return n}function o(t){t.x*=l[0],t.y=t.depth*l[1]}var a=zo.layout.hierarchy().sort(null).value(null),s=mr,l=[1,1],u=null;return t.separation=function(e){return arguments.length?(s=e,t):s},t.size=function(e){return arguments.length?(u=null==(l=e)?o:null,t):u?null:l},t.nodeSize=function(e){return arguments.length?(u=null==(l=e)?null:o,t):u?l:null},Yi(t,a)},zo.layout.cluster=function(){function t(t,o){var a,s=e.call(this,t,o),l=s[0],u=0;Ki(l,function(t){var e=t.children;e&&e.length?(t.x=br(e),t.y=Cr(e)):(t.x=a?u+=n(t,a):0,t.y=0,a=t)});var c=Ar(l),h=Rr(l),d=c.x-n(c,h)/2,f=h.x+n(h,c)/2;return Ki(l,r?function(t){t.x=(t.x-l.x)*i[0],t.y=(l.y-t.y)*i[1]}:function(t){t.x=(t.x-d)/(f-d)*i[0],t.y=(1-(l.y?t.y/l.y:1))*i[1]}),s}var e=zo.layout.hierarchy().sort(null).value(null),n=mr,i=[1,1],r=!1;return t.separation=function(e){return arguments.length?(n=e,t):n},t.size=function(e){return arguments.length?(r=null==(i=e),t):r?null:i},t.nodeSize=function(e){return arguments.length?(r=null!=(i=e),t):r?i:null},Yi(t,e)},zo.layout.treemap=function(){function t(t,e){for(var n,i,r=-1,o=t.length;++r<o;)i=(n=t[r]).value*(e<0?0:e),n.area=isNaN(i)||i<=0?0:i}function e(n){var o=n.children;if(o&&o.length){var a,s,l,u=h(n),c=[],d=o.slice(),p=1/0,g="slice"===f?u.dx:"dice"===f?u.dy:"slice-dice"===f?1&n.depth?u.dy:u.dx:Math.min(u.dx,u.dy);for(t(d,u.dx*u.dy/n.value),c.area=0;(l=d.length)>0;)c.push(a=d[l-1]),c.area+=a.area,"squarify"!==f||(s=i(c,g))<=p?(d.pop(),p=s):(c.area-=c.pop().area,r(c,g,u,!1),g=Math.min(u.dx,u.dy),c.length=c.area=0,p=1/0);c.length&&(r(c,g,u,!0),c.length=c.area=0),o.forEach(e)}}function n(e){var i=e.children;if(i&&i.length){var o,a=h(e),s=i.slice(),l=[];for(t(s,a.dx*a.dy/e.value),l.area=0;o=s.pop();)l.push(o),l.area+=o.area,null!=o.z&&(r(l,o.z?a.dx:a.dy,a,!s.length),l.length=l.area=0);i.forEach(n)}}function i(t,e){for(var n,i=t.area,r=0,o=1/0,a=-1,s=t.length;++a<s;)(n=t[a].area)&&(n<o&&(o=n),n>r&&(r=n));return i*=i,e*=e,i?Math.max(e*r*p/i,i/(e*o*p)):1/0}function r(t,e,n,i){var r,o=-1,a=t.length,s=n.x,u=n.y,c=e?l(t.area/e):0;if(e==n.dx){for((i||c>n.dy)&&(c=n.dy);++o<a;)(r=t[o]).x=s,r.y=u,r.dy=c,s+=r.dx=Math.min(n.x+n.dx-s,c?l(r.area/c):0);r.z=!0,r.dx+=n.x+n.dx-s,n.y+=c,n.dy-=c}else{for((i||c>n.dx)&&(c=n.dx);++o<a;)(r=t[o]).x=s,r.y=u,r.dx=c,u+=r.dy=Math.min(n.y+n.dy-u,c?l(r.area/c):0);r.z=!1,r.dy+=n.y+n.dy-u,n.x+=c,n.dx-=c}}function o(i){var r=a||s(i),o=r[0];return o.x=o.y=0,o.value?(o.dx=u[0],o.dy=u[1]):o.dx=o.dy=0,a&&s.revalue(o),t([o],o.dx*o.dy/o.value),(a?n:e)(o),d&&(a=r),r}var a,s=zo.layout.hierarchy(),l=Math.round,u=[1,1],c=null,h=Lr,d=!1,f="squarify",p=.5*(1+Math.sqrt(5));return o.size=function(t){return arguments.length?(u=t,o):u},o.padding=function(t){function e(e){return Ir(e,t)}if(!arguments.length)return c;var n;return h=null==(c=t)?Lr:"function"==(n=typeof t)?function(e){var n=t.call(o,e,e.depth);return null==n?Lr(e):Ir(e,"number"==typeof n?[n,n,n,n]:n)}:"number"===n?(t=[t,t,t,t],e):e,o},o.round=function(t){return arguments.length?(l=t?Math.round:Number,o):l!=Number},o.sticky=function(t){return arguments.length?(d=t,a=null,o):d},o.ratio=function(t){return arguments.length?(p=t,o):p},o.mode=function(t){return arguments.length?(f=t+"",o):f},Yi(o,s)},zo.random={normal:function(t,e){var n=arguments.length;return n<2&&(e=1),n<1&&(t=0),function(){var n,i,r;do{r=(n=2*Math.random()-1)*n+(i=2*Math.random()-1)*i}while(!r||r>1);return t+e*n*Math.sqrt(-2*Math.log(r)/r)}},logNormal:function(){var t=zo.random.normal.apply(zo,arguments);return function(){return Math.exp(t())}},bates:function(t){var e=zo.random.irwinHall(t);return function(){return e()/t}},irwinHall:function(t){return function(){for(var e=0,n=0;n<t;n++)e+=Math.random();return e}}},zo.scale={};var tl={floor:y,ceil:y};zo.scale.linear=function(){return Nr([0,1],[0,1],fi,!1)};var el={s:1,g:1,p:1,r:1,e:1};zo.scale.log=function(){return Wr(zo.scale.linear().domain([0,1]),10,!0,[1,10])};var nl=zo.format(".0e"),il={floor:function(t){return-Math.ceil(-t)},ceil:function(t){return-Math.floor(-t)}};zo.scale.pow=function(){return Yr(zo.scale.linear(),1,[0,1])},zo.scale.sqrt=function(){return zo.scale.pow().exponent(.5)},zo.scale.ordinal=function(){return Kr([],{t:"range",a:[[]]})},zo.scale.category10=function(){return zo.scale.ordinal().range(rl)},zo.scale.category20=function(){return zo.scale.ordinal().range(ol)},zo.scale.category20b=function(){return zo.scale.ordinal().range(al)},zo.scale.category20c=function(){return zo.scale.ordinal().range(sl)};var rl=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(mt),ol=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(mt),al=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(mt),sl=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(mt);zo.scale.quantile=function(){return qr([],[])},zo.scale.quantize=function(){return Zr(0,1,[0,1])},zo.scale.threshold=function(){return Qr([.5],[0,1])},zo.scale.identity=function(){return Jr([0,1])},zo.svg={},zo.svg.arc=function(){function t(){var t=Math.max(0,+n.apply(this,arguments)),u=Math.max(0,+i.apply(this,arguments)),c=a.apply(this,arguments)-xa,h=s.apply(this,arguments)-xa,d=Math.abs(h-c),f=c>h?0:1;if(u<t&&(p=u,u=t,t=p),d>=ma)return e(u,f)+(t?e(t,1-f):"")+"Z";var p,g,_,v,y,m,x,S,E,T,w,C,b=0,A=0,R=[];if((v=(+l.apply(this,arguments)||0)/2)&&(_=o===ll?Math.sqrt(t*t+u*u):+o.apply(this,arguments),f||(A*=-1),u&&(A=et(_/u*Math.sin(v))),t&&(b=et(_/t*Math.sin(v)))),u){y=u*Math.cos(c+A),m=u*Math.sin(c+A),x=u*Math.cos(h-A),S=u*Math.sin(h-A);var L=Math.abs(h-c-2*A)<=va?0:1;if(A&&oo(y,m,x,S)===f^L){var I=(c+h)/2;y=u*Math.cos(I),m=u*Math.sin(I),x=S=null}}else y=m=0;if(t){E=t*Math.cos(h-b),T=t*Math.sin(h-b),w=t*Math.cos(c+b),C=t*Math.sin(c+b);var P=Math.abs(c-h+2*b)<=va?0:1;if(b&&oo(E,T,w,C)===1-f^P){var M=(c+h)/2;E=t*Math.cos(M),T=t*Math.sin(M),w=C=null}}else E=T=0;if(d>ga&&(p=Math.min(Math.abs(u-t)/2,+r.apply(this,arguments)))>.001){g=t<u^f?0:1;var O=p,D=p;if(d<va){var F=null==w?[E,T]:null==x?[y,m]:Ln([y,m],[w,C],[x,S],[E,T]),k=y-F[0],N=m-F[1],G=x-F[0],V=S-F[1],U=1/Math.sin(Math.acos((k*G+N*V)/(Math.sqrt(k*k+N*N)*Math.sqrt(G*G+V*V)))/2),B=Math.sqrt(F[0]*F[0]+F[1]*F[1]);D=Math.min(p,(t-B)/(U-1)),O=Math.min(p,(u-B)/(U+1))}if(null!=x){var z=ao(null==w?[E,T]:[w,C],[y,m],u,O,f),X=ao([x,S],[E,T],u,O,f);p===O?R.push("M",z[0],"A",O,",",O," 0 0,",g," ",z[1],"A",u,",",u," 0 ",1-f^oo(z[1][0],z[1][1],X[1][0],X[1][1]),",",f," ",X[1],"A",O,",",O," 0 0,",g," ",X[0]):R.push("M",z[0],"A",O,",",O," 0 1,",g," ",X[0])}else R.push("M",y,",",m);if(null!=w){var H=ao([y,m],[w,C],t,-D,f),W=ao([E,T],null==x?[y,m]:[x,S],t,-D,f);p===D?R.push("L",W[0],"A",D,",",D," 0 0,",g," ",W[1],"A",t,",",t," 0 ",f^oo(W[1][0],W[1][1],H[1][0],H[1][1]),",",1-f," ",H[1],"A",D,",",D," 0 0,",g," ",H[0]):R.push("L",W[0],"A",D,",",D," 0 0,",g," ",H[0])}else R.push("L",E,",",T)}else R.push("M",y,",",m),null!=x&&R.push("A",u,",",u," 0 ",L,",",f," ",x,",",S),R.push("L",E,",",T),null!=w&&R.push("A",t,",",t," 0 ",P,",",1-f," ",w,",",C);return R.push("Z"),R.join("")}function e(t,e){return"M0,"+t+"A"+t+","+t+" 0 1,"+e+" 0,"+-t+"A"+t+","+t+" 0 1,"+e+" 0,"+t}var n=to,i=eo,r=$r,o=ll,a=no,s=io,l=ro;return t.innerRadius=function(e){return arguments.length?(n=bt(e),t):n},t.outerRadius=function(e){return arguments.length?(i=bt(e),t):i},t.cornerRadius=function(e){return arguments.length?(r=bt(e),t):r},t.padRadius=function(e){return arguments.length?(o=e==ll?ll:bt(e),t):o},t.startAngle=function(e){return arguments.length?(a=bt(e),t):a},t.endAngle=function(e){return arguments.length?(s=bt(e),t):s},t.padAngle=function(e){return arguments.length?(l=bt(e),t):l},t.centroid=function(){var t=(+n.apply(this,arguments)+ +i.apply(this,arguments))/2,e=(+a.apply(this,arguments)+ +s.apply(this,arguments))/2-xa;return[Math.cos(e)*t,Math.sin(e)*t]},t};var ll="auto";zo.svg.line=function(){return so(y)};var ul=zo.map({linear:lo,"linear-closed":uo,step:function(t){for(var e=0,n=t.length,i=t[0],r=[i[0],",",i[1]];++e<n;)r.push("H",(i[0]+(i=t[e])[0])/2,"V",i[1]);return n>1&&r.push("H",i[0]),r.join("")},"step-before":co,"step-after":ho,basis:go,"basis-open":function(t){if(t.length<4)return lo(t);for(var e,n=[],i=-1,r=t.length,o=[0],a=[0];++i<3;)e=t[i],o.push(e[0]),a.push(e[1]);for(n.push(_o(dl,o)+","+_o(dl,a)),--i;++i<r;)e=t[i],o.shift(),o.push(e[0]),a.shift(),a.push(e[1]),vo(n,o,a);return n.join("")},"basis-closed":function(t){for(var e,n,i=-1,r=t.length,o=r+4,a=[],s=[];++i<4;)n=t[i%r],a.push(n[0]),s.push(n[1]);for(e=[_o(dl,a),",",_o(dl,s)],--i;++i<o;)n=t[i%r],a.shift(),a.push(n[0]),s.shift(),s.push(n[1]),vo(e,a,s);return e.join("")},bundle:function(t,e){var n=t.length-1;if(n)for(var i,r,o=t[0][0],a=t[0][1],s=t[n][0]-o,l=t[n][1]-a,u=-1;++u<=n;)r=u/n,(i=t[u])[0]=e*i[0]+(1-e)*(o+r*s),i[1]=e*i[1]+(1-e)*(a+r*l);return go(t)},cardinal:function(t,e){return t.length<3?lo(t):t[0]+fo(t,po(t,e))},"cardinal-open":function(t,e){return t.length<4?lo(t):t[1]+fo(t.slice(1,-1),po(t,e))},"cardinal-closed":function(t,e){return t.length<3?uo(t):t[0]+fo((t.push(t[0]),t),po([t[t.length-2]].concat(t,[t[1]]),e))},monotone:function(t){return t.length<3?lo(t):t[0]+fo(t,xo(t))}});ul.forEach(function(t,e){e.key=t,e.closed=/-closed$/.test(t)});var cl=[0,2/3,1/3,0],hl=[0,1/3,2/3,0],dl=[0,1/6,2/3,1/6];zo.svg.line.radial=function(){var t=so(So);return t.radius=t.x,delete t.x,t.angle=t.y,delete t.y,t},co.reverse=ho,ho.reverse=co,zo.svg.area=function(){return Eo(y)},zo.svg.area.radial=function(){var t=Eo(So);return t.radius=t.x,delete t.x,t.innerRadius=t.x0,delete t.x0,t.outerRadius=t.x1,delete t.x1,t.angle=t.y,delete t.y,t.startAngle=t.y0,delete t.y0,t.endAngle=t.y1,delete t.y1,t},zo.svg.chord=function(){function t(t,s){var l=e(this,o,t,s),u=e(this,a,t,s);return"M"+l.p0+i(l.r,l.p1,l.a1-l.a0)+(n(l,u)?r(l.r,l.p1,l.r,l.p0):r(l.r,l.p1,u.r,u.p0)+i(u.r,u.p1,u.a1-u.a0)+r(u.r,u.p1,l.r,l.p0))+"Z"}function e(t,e,n,i){var r=e.call(t,n,i),o=s.call(t,r,i),a=l.call(t,r,i)-xa,c=u.call(t,r,i)-xa;return{r:o,a0:a,a1:c,p0:[o*Math.cos(a),o*Math.sin(a)],p1:[o*Math.cos(c),o*Math.sin(c)]}}function n(t,e){return t.a0==e.a0&&t.a1==e.a1}function i(t,e,n){return"A"+t+","+t+" 0 "+ +(n>va)+",1 "+e}function r(t,e,n,i){return"Q 0,0 "+i}var o=gn,a=_n,s=To,l=no,u=io;return t.radius=function(e){return arguments.length?(s=bt(e),t):s},t.source=function(e){return arguments.length?(o=bt(e),t):o},t.target=function(e){return arguments.length?(a=bt(e),t):a},t.startAngle=function(e){return arguments.length?(l=bt(e),t):l},t.endAngle=function(e){return arguments.length?(u=bt(e),t):u},t},zo.svg.diagonal=function(){function t(t,r){var o=e.call(this,t,r),a=n.call(this,t,r),s=(o.y+a.y)/2,l=[o,{x:o.x,y:s},{x:a.x,y:s},a];return"M"+(l=l.map(i))[0]+"C"+l[1]+" "+l[2]+" "+l[3]}var e=gn,n=_n,i=wo;return t.source=function(n){return arguments.length?(e=bt(n),t):e},t.target=function(e){return arguments.length?(n=bt(e),t):n},t.projection=function(e){return arguments.length?(i=e,t):i},t},zo.svg.diagonal.radial=function(){var t=zo.svg.diagonal(),e=wo,n=t.projection;return t.projection=function(t){return arguments.length?n(Co(e=t)):e},t},zo.svg.symbol=function(){function t(t,i){return(fl.get(e.call(this,t,i))||Ro)(n.call(this,t,i))}var e=Ao,n=bo;return t.type=function(n){return arguments.length?(e=bt(n),t):e},t.size=function(e){return arguments.length?(n=bt(e),t):n},t};var fl=zo.map({circle:Ro,cross:function(t){var e=Math.sqrt(t/5)/2;return"M"+-3*e+","+-e+"H"+-e+"V"+-3*e+"H"+e+"V"+-e+"H"+3*e+"V"+e+"H"+e+"V"+3*e+"H"+-e+"V"+e+"H"+-3*e+"Z"},diamond:function(t){var e=Math.sqrt(t/(2*gl)),n=e*gl;return"M0,"+-e+"L"+n+",0 0,"+e+" "+-n+",0Z"},square:function(t){var e=Math.sqrt(t)/2;return"M"+-e+","+-e+"L"+e+","+-e+" "+e+","+e+" "+-e+","+e+"Z"},"triangle-down":function(t){var e=Math.sqrt(t/pl),n=e*pl/2;return"M0,"+n+"L"+e+","+-n+" "+-e+","+-n+"Z"},"triangle-up":function(t){var e=Math.sqrt(t/pl),n=e*pl/2;return"M0,"+-n+"L"+e+","+n+" "+-e+","+n+"Z"}});zo.svg.symbolTypes=fl.keys();var pl=Math.sqrt(3),gl=Math.tan(30*Sa);sa.transition=function(t){for(var e,n,i=_l||++xl,r=Oo(t),o=[],a=vl||{time:Date.now(),ease:xi,delay:0,duration:250},s=-1,l=this.length;++s<l;){o.push(e=[]);for(var u=this[s],c=-1,h=u.length;++c<h;)(n=u[c])&&Do(n,c,r,i,a),e.push(n)}return Io(o,r,i)},sa.interrupt=function(t){return this.each(null==t?yl:Lo(Oo(t)))};var _l,vl,yl=Lo(Oo()),ml=[],xl=0;ml.call=sa.call,ml.empty=sa.empty,ml.node=sa.node,ml.size=sa.size,zo.transition=function(t,e){return t&&t.transition?_l?t.transition(e):t:zo.selection().transition(t)},zo.transition.prototype=ml,ml.select=function(t){var e,n,i,r=this.id,o=this.namespace,a=[];t=R(t);for(var s=-1,l=this.length;++s<l;){a.push(e=[]);for(var u=this[s],c=-1,h=u.length;++c<h;)(i=u[c])&&(n=t.call(i,i.__data__,c,s))?("__data__"in i&&(n.__data__=i.__data__),Do(n,c,o,r,i[o][r]),e.push(n)):e.push(null)}return Io(a,o,r)},ml.selectAll=function(t){var e,n,i,r,o,a=this.id,s=this.namespace,l=[];t=L(t);for(var u=-1,c=this.length;++u<c;)for(var h=this[u],d=-1,f=h.length;++d<f;)if(i=h[d]){o=i[s][a],n=t.call(i,i.__data__,d,u),l.push(e=[]);for(var p=-1,g=n.length;++p<g;)(r=n[p])&&Do(r,p,s,a,o),e.push(r)}return Io(l,s,a)},ml.filter=function(t){var e,n,i,r=[];"function"!=typeof t&&(t=B(t));for(var o=0,a=this.length;o<a;o++){r.push(e=[]);for(var s=0,l=(n=this[o]).length;s<l;s++)(i=n[s])&&t.call(i,i.__data__,s,o)&&e.push(i)}return Io(r,this.namespace,this.id)},ml.tween=function(t,e){var n=this.id,i=this.namespace;return arguments.length<2?this.node()[i][n].tween.get(t):X(this,null==e?function(e){e[i][n].tween.remove(t)}:function(r){r[i][n].tween.set(t,e)})},ml.attr=function(t,e){function n(){this.removeAttribute(o)}function i(){this.removeAttributeNS(o.space,o.local)}if(arguments.length<2){for(e in t)this.attr(e,t[e]);return this}var r="transform"==t?Fi:fi,o=zo.ns.qualify(t);return Po(this,"attr."+t,e,o.local?function(t){return null==t?i:(t+="",function(){var e,n=this.getAttributeNS(o.space,o.local);return n!==t&&(e=r(n,t),function(t){this.setAttributeNS(o.space,o.local,e(t))})})}:function(t){return null==t?n:(t+="",function(){var e,n=this.getAttribute(o);return n!==t&&(e=r(n,t),function(t){this.setAttribute(o,e(t))})})})},ml.attrTween=function(t,e){var n=zo.ns.qualify(t);return this.tween("attr."+t,n.local?function(t,i){var r=e.call(this,t,i,this.getAttributeNS(n.space,n.local));return r&&function(t){this.setAttributeNS(n.space,n.local,r(t))}}:function(t,i){var r=e.call(this,t,i,this.getAttribute(n));return r&&function(t){this.setAttribute(n,r(t))}})},ml.style=function(t,n,i){function r(){this.style.removeProperty(t)}var o=arguments.length;if(o<3){if("string"!=typeof t){o<2&&(n="");for(i in t)this.style(i,t[i],n);return this}i=""}return Po(this,"style."+t,n,function(n){return null==n?r:(n+="",function(){var r,o=e(this).getComputedStyle(this,null).getPropertyValue(t);return o!==n&&(r=fi(o,n),function(e){this.style.setProperty(t,r(e),i)})})})},ml.styleTween=function(t,n,i){return arguments.length<3&&(i=""),this.tween("style."+t,function(r,o){var a=n.call(this,r,o,e(this).getComputedStyle(this,null).getPropertyValue(t));return a&&function(e){this.style.setProperty(t,a(e),i)}})},ml.text=function(t){return Po(this,"text",t,Mo)},ml.remove=function(){var t=this.namespace;return this.each("end.transition",function(){var e;this[t].count<2&&(e=this.parentNode)&&e.removeChild(this)})},ml.ease=function(t){var e=this.id,n=this.namespace;return arguments.length<1?this.node()[n][e].ease:("function"!=typeof t&&(t=zo.ease.apply(zo,arguments)),X(this,function(i){i[n][e].ease=t}))},ml.delay=function(t){var e=this.id,n=this.namespace;return arguments.length<1?this.node()[n][e].delay:X(this,"function"==typeof t?function(i,r,o){i[n][e].delay=+t.call(i,i.__data__,r,o)}:(t=+t,function(i){i[n][e].delay=t}))},ml.duration=function(t){var e=this.id,n=this.namespace;return arguments.length<1?this.node()[n][e].duration:X(this,"function"==typeof t?function(i,r,o){i[n][e].duration=Math.max(1,t.call(i,i.__data__,r,o))}:(t=Math.max(1,t),function(i){i[n][e].duration=t}))},ml.each=function(t,e){var n=this.id,i=this.namespace;if(arguments.length<2){var r=vl,o=_l;try{_l=n,X(this,function(e,r,o){vl=e[i][n],t.call(e,e.__data__,r,o)})}finally{vl=r,_l=o}}else X(this,function(r){var o=r[i][n];(o.event||(o.event=zo.dispatch("start","end","interrupt"))).on(t,e)});return this},ml.transition=function(){for(var t,e,n,i,r=this.id,o=++xl,a=this.namespace,s=[],l=0,u=this.length;l<u;l++){s.push(t=[]);for(var c=0,h=(e=this[l]).length;c<h;c++)(n=e[c])&&Do(n,c,a,o,{time:(i=n[a][r]).time,ease:i.ease,delay:i.delay+i.duration,duration:i.duration}),t.push(n)}return Io(s,a,o)},zo.svg.axis=function(){function t(t){t.each(function(){var t,u=zo.select(this),c=this.__chart__||n,h=this.__chart__=n.copy(),d=null==l?h.ticks?h.ticks.apply(h,s):h.domain():l,f=null==e?h.tickFormat?h.tickFormat.apply(h,s):y:e,p=u.selectAll(".tick").data(d,h),g=p.enter().insert("g",".domain").attr("class","tick").style("opacity",ga),_=zo.transition(p.exit()).style("opacity",ga).remove(),v=zo.transition(p.order()).style("opacity",1),m=Math.max(r,0)+a,x=Mr(h),S=u.selectAll(".domain").data([0]),E=(S.enter().append("path").attr("class","domain"),zo.transition(S));g.append("line"),g.append("text");var T,w,C,b,A=g.select("line"),R=v.select("line"),L=p.select("text").text(f),I=g.select("text"),P=v.select("text"),M="top"===i||"left"===i?-1:1;if("bottom"===i||"top"===i?(t=Fo,T="x",C="y",w="x2",b="y2",L.attr("dy",M<0?"0em":".71em").style("text-anchor","middle"),E.attr("d","M"+x[0]+","+M*o+"V0H"+x[1]+"V"+M*o)):(t=ko,T="y",C="x",w="y2",b="x2",L.attr("dy",".32em").style("text-anchor",M<0?"end":"start"),E.attr("d","M"+M*o+","+x[0]+"H0V"+x[1]+"H"+M*o)),A.attr(b,M*r),I.attr(C,M*m),R.attr(w,0).attr(b,M*r),P.attr(T,0).attr(C,M*m),h.rangeBand){var O=h,D=O.rangeBand()/2;c=h=function(t){return O(t)+D}}else c.rangeBand?c=h:_.call(t,h,c);g.call(t,c,h),v.call(t,h,h)})}var e,n=zo.scale.linear(),i=Sl,r=6,o=6,a=3,s=[10],l=null;return t.scale=function(e){return arguments.length?(n=e,t):n},t.orient=function(e){return arguments.length?(i=e in El?e+"":Sl,t):i},t.ticks=function(){return arguments.length?(s=Ho(arguments),t):s},t.tickValues=function(e){return arguments.length?(l=e,t):l},t.tickFormat=function(n){return arguments.length?(e=n,t):e},t.tickSize=function(e){var n=arguments.length;return n?(r=+e,o=+arguments[n-1],t):r},t.innerTickSize=function(e){return arguments.length?(r=+e,t):r},t.outerTickSize=function(e){return arguments.length?(o=+e,t):o},t.tickPadding=function(e){return arguments.length?(a=+e,t):a},t.tickSubdivide=function(){return arguments.length&&t},t};var Sl="bottom",El={top:1,right:1,bottom:1,left:1};zo.svg.brush=function(){function t(e){e.each(function(){var e=zo.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",o).on("touchstart.brush",o),a=e.selectAll(".background").data([0]);a.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),e.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var s=e.selectAll(".resize").data(g,y);s.exit().remove(),s.enter().append("g").attr("class",function(t){return"resize "+t}).style("cursor",function(t){return Tl[t]}).append("rect").attr("x",function(t){return/[ew]$/.test(t)?-3:null}).attr("y",function(t){return/^[ns]/.test(t)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),s.style("display",t.empty()?"none":null);var l,h=zo.transition(e),d=zo.transition(a);u&&(l=Mr(u),d.attr("x",l[0]).attr("width",l[1]-l[0]),i(h)),c&&(l=Mr(c),d.attr("y",l[0]).attr("height",l[1]-l[0]),r(h)),n(h)})}function n(t){t.selectAll(".resize").attr("transform",function(t){return"translate("+h[+/e$/.test(t)]+","+d[+/^s/.test(t)]+")"})}function i(t){t.select(".extent").attr("x",h[0]),t.selectAll(".extent,.n>rect,.s>rect").attr("width",h[1]-h[0])}function r(t){t.select(".extent").attr("y",d[0]),t.selectAll(".extent,.e>rect,.w>rect").attr("height",d[1]-d[0])}function o(){function o(){var t=zo.mouse(m),e=!1;y&&(t[0]+=y[0],t[1]+=y[1]),A||(zo.event.altKey?(v||(v=[(h[0]+h[1])/2,(d[0]+d[1])/2]),L[0]=h[+(t[0]<v[0])],L[1]=d[+(t[1]<v[1])]):v=null),C&&g(t,u,0)&&(i(E),e=!0),b&&g(t,c,1)&&(r(E),e=!0),e&&(n(E),S({type:"brush",mode:A?"move":"resize"}))}function g(t,e,n){var i,r,o=Mr(e),l=o[0],u=o[1],c=L[n],g=n?d:h,_=g[1]-g[0];if(A&&(l-=c,u-=_+c),i=(n?p:f)?Math.max(l,Math.min(u,t[n])):t[n],A?r=(i+=c)+_:(v&&(c=Math.max(l,Math.min(u,2*v[n]-i))),c<i?(r=i,i=c):r=c),g[0]!=i||g[1]!=r)return n?s=null:a=null,g[0]=i,g[1]=r,!0}function _(){o(),E.style("pointer-events","all").selectAll(".resize").style("display",t.empty()?"none":null),zo.select("body").style("cursor",null),I.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),R(),S({type:"brushend"})}var v,y,m=this,x=zo.select(zo.event.target),S=l.of(m,arguments),E=zo.select(m),T=x.datum(),C=!/^(n|s)$/.test(T)&&u,b=!/^(e|w)$/.test(T)&&c,A=x.classed("extent"),R=q(m),L=zo.mouse(m),I=zo.select(e(m)).on("keydown.brush",function(){32==zo.event.keyCode&&(A||(v=null,L[0]-=h[1],L[1]-=d[1],A=2),w())}).on("keyup.brush",function(){32==zo.event.keyCode&&2==A&&(L[0]+=h[1],L[1]+=d[1],A=0,w())});if(zo.event.changedTouches?I.on("touchmove.brush",o).on("touchend.brush",_):I.on("mousemove.brush",o).on("mouseup.brush",_),E.interrupt().selectAll("*").interrupt(),A)L[0]=h[0]-L[0],L[1]=d[0]-L[1];else if(T){var P=+/w$/.test(T),M=+/^n/.test(T);y=[h[1-P]-L[0],d[1-M]-L[1]],L[0]=h[P],L[1]=d[M]}else zo.event.altKey&&(v=L.slice());E.style("pointer-events","none").selectAll(".resize").style("display",null),zo.select("body").style("cursor",x.style("cursor")),S({type:"brushstart"}),o()}var a,s,l=b(t,"brushstart","brush","brushend"),u=null,c=null,h=[0,0],d=[0,0],f=!0,p=!0,g=wl[0];return t.event=function(t){t.each(function(){var t=l.of(this,arguments),e={x:h,y:d,i:a,j:s},n=this.__chart__||e;this.__chart__=e,_l?zo.select(this).transition().each("start.brush",function(){a=n.i,s=n.j,h=n.x,d=n.y,t({type:"brushstart"})}).tween("brush:brush",function(){var n=pi(h,e.x),i=pi(d,e.y);return a=s=null,function(r){h=e.x=n(r),d=e.y=i(r),t({type:"brush",mode:"resize"})}}).each("end.brush",function(){a=e.i,s=e.j,t({type:"brush",mode:"resize"}),t({type:"brushend"})}):(t({type:"brushstart"}),t({type:"brush",mode:"resize"}),t({type:"brushend"}))})},t.x=function(e){return arguments.length?(u=e,g=wl[!u<<1|!c],t):u},t.y=function(e){return arguments.length?(c=e,g=wl[!u<<1|!c],t):c},t.clamp=function(e){return arguments.length?(u&&c?(f=!!e[0],p=!!e[1]):u?f=!!e:c&&(p=!!e),t):u&&c?[f,p]:u?f:c?p:null},t.extent=function(e){var n,i,r,o,l;return arguments.length?(u&&(n=e[0],i=e[1],c&&(n=n[0],i=i[0]),a=[n,i],u.invert&&(n=u(n),i=u(i)),i<n&&(l=n,n=i,i=l),n==h[0]&&i==h[1]||(h=[n,i])),c&&(r=e[0],o=e[1],u&&(r=r[1],o=o[1]),s=[r,o],c.invert&&(r=c(r),o=c(o)),o<r&&(l=r,r=o,o=l),r==d[0]&&o==d[1]||(d=[r,o])),t):(u&&(a?(n=a[0],i=a[1]):(n=h[0],i=h[1],u.invert&&(n=u.invert(n),i=u.invert(i)),i<n&&(l=n,n=i,i=l))),c&&(s?(r=s[0],o=s[1]):(r=d[0],o=d[1],c.invert&&(r=c.invert(r),o=c.invert(o)),o<r&&(l=r,r=o,o=l))),u&&c?[[n,r],[i,o]]:u?[n,i]:c&&[r,o])},t.clear=function(){return t.empty()||(h=[0,0],d=[0,0],a=s=null),t},t.empty=function(){return!!u&&h[0]==h[1]||!!c&&d[0]==d[1]},zo.rebind(t,l,"on")};var Tl={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},wl=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]],Cl=Ha.format=Za.timeFormat,bl=Cl.utc,Al=bl("%Y-%m-%dT%H:%M:%S.%LZ");Cl.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?No:Al,No.parse=function(t){var e=new Date(t);return isNaN(e)?null:e},No.toString=Al.toString,Ha.second=Vt(function(t){return new Wa(1e3*Math.floor(t/1e3))},function(t,e){t.setTime(t.getTime()+1e3*Math.floor(e))},function(t){return t.getSeconds()}),Ha.seconds=Ha.second.range,Ha.seconds.utc=Ha.second.utc.range,Ha.minute=Vt(function(t){return new Wa(6e4*Math.floor(t/6e4))},function(t,e){t.setTime(t.getTime()+6e4*Math.floor(e))},function(t){return t.getMinutes()}),Ha.minutes=Ha.minute.range,Ha.minutes.utc=Ha.minute.utc.range,Ha.hour=Vt(function(t){var e=t.getTimezoneOffset()/60;return new Wa(36e5*(Math.floor(t/36e5-e)+e))},function(t,e){t.setTime(t.getTime()+36e5*Math.floor(e))},function(t){return t.getHours()}),Ha.hours=Ha.hour.range,Ha.hours.utc=Ha.hour.utc.range,Ha.month=Vt(function(t){return(t=Ha.day(t)).setDate(1),t},function(t,e){t.setMonth(t.getMonth()+e)},function(t){return t.getMonth()}),Ha.months=Ha.month.range,Ha.months.utc=Ha.month.utc.range;var Rl=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],Ll=[[Ha.second,1],[Ha.second,5],[Ha.second,15],[Ha.second,30],[Ha.minute,1],[Ha.minute,5],[Ha.minute,15],[Ha.minute,30],[Ha.hour,1],[Ha.hour,3],[Ha.hour,6],[Ha.hour,12],[Ha.day,1],[Ha.day,2],[Ha.week,1],[Ha.month,1],[Ha.month,3],[Ha.year,1]],Il=Cl.multi([[".%L",function(t){return t.getMilliseconds()}],[":%S",function(t){return t.getSeconds()}],["%I:%M",function(t){return t.getMinutes()}],["%I %p",function(t){return t.getHours()}],["%a %d",function(t){return t.getDay()&&1!=t.getDate()}],["%b %d",function(t){return 1!=t.getDate()}],["%B",function(t){return t.getMonth()}],["%Y",Re]]),Pl={range:function(t,e,n){return zo.range(Math.ceil(t/n)*n,+e,n).map(Vo)},floor:y,ceil:y};Ll.year=Ha.year,Ha.scale=function(){return Go(zo.scale.linear(),Ll,Il)};var Ml=Ll.map(function(t){return[t[0].utc,t[1]]}),Ol=bl.multi([[".%L",function(t){return t.getUTCMilliseconds()}],[":%S",function(t){return t.getUTCSeconds()}],["%I:%M",function(t){return t.getUTCMinutes()}],["%I %p",function(t){return t.getUTCHours()}],["%a %d",function(t){return t.getUTCDay()&&1!=t.getUTCDate()}],["%b %d",function(t){return 1!=t.getUTCDate()}],["%B",function(t){return t.getUTCMonth()}],["%Y",Re]]);Ml.year=Ha.year.utc,Ha.scale.utc=function(){return Go(zo.scale.linear(),Ml,Ol)},zo.text=At(function(t){return t.responseText}),zo.json=function(t,e){return Rt(t,"application/json",Uo,e)},zo.html=function(t,e){return Rt(t,"text/html",Bo,e)},zo.xml=At(function(t){return t.responseXML}),"function"==typeof define&&define.amd?(this.d3=zo,define(zo)):"object"==typeof module&&module.exports?module.exports=zo:this.d3=zo}(),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.c3=e()}(this,function(){"use strict";function t(t,e){var n=this;n.component=t,n.params=e||{},n.d3=t.d3,n.scale=n.d3.scale.linear(),n.range,n.orient="bottom",n.innerTickSize=6,n.outerTickSize=this.params.withOuterTick?6:0,n.tickPadding=3,n.tickValues=null,n.tickFormat,n.tickArguments,n.tickOffset=0,n.tickCulling=!0,n.tickCentered,n.tickTextCharSize,n.tickTextRotate=n.params.tickTextRotate,n.tickLength,n.axis=n.generateAxis()}function e(t,e,n){this.owner=t,L.chart.internal[e]=n}function n(t){var e=this.internal=new i(this);e.loadConfig(t),e.beforeInit(t),e.init(),e.afterInit(t),function t(e,n,i){Object.keys(e).forEach(function(r){n[r]=e[r].bind(i),Object.keys(e[r]).length>0&&t(e[r],n[r],i)})}(A,this,this)}function i(t){var e=this;e.d3=window.d3?window.d3:"undefined"!=typeof require?require("d3"):void 0,e.api=t,e.config=e.getDefaultConfig(),e.data={},e.cache={},e.axes={}}var r,o,a={target:"c3-target",chart:"c3-chart",chartLine:"c3-chart-line",chartLines:"c3-chart-lines",chartBar:"c3-chart-bar",chartBars:"c3-chart-bars",chartText:"c3-chart-text",chartTexts:"c3-chart-texts",chartArc:"c3-chart-arc",chartArcs:"c3-chart-arcs",chartArcsTitle:"c3-chart-arcs-title",chartArcsBackground:"c3-chart-arcs-background",chartArcsGaugeUnit:"c3-chart-arcs-gauge-unit",chartArcsGaugeMax:"c3-chart-arcs-gauge-max",chartArcsGaugeMin:"c3-chart-arcs-gauge-min",selectedCircle:"c3-selected-circle",selectedCircles:"c3-selected-circles",eventRect:"c3-event-rect",eventRects:"c3-event-rects",eventRectsSingle:"c3-event-rects-single",eventRectsMultiple:"c3-event-rects-multiple",zoomRect:"c3-zoom-rect",brush:"c3-brush",focused:"c3-focused",defocused:"c3-defocused",region:"c3-region",regions:"c3-regions",title:"c3-title",tooltipContainer:"c3-tooltip-container",tooltip:"c3-tooltip",tooltipName:"c3-tooltip-name",shape:"c3-shape",shapes:"c3-shapes",line:"c3-line",lines:"c3-lines",bar:"c3-bar",bars:"c3-bars",circle:"c3-circle",circles:"c3-circles",arc:"c3-arc",arcs:"c3-arcs",area:"c3-area",areas:"c3-areas",empty:"c3-empty",text:"c3-text",texts:"c3-texts",gaugeValue:"c3-gauge-value",grid:"c3-grid",gridLines:"c3-grid-lines",xgrid:"c3-xgrid",xgrids:"c3-xgrids",xgridLine:"c3-xgrid-line",xgridLines:"c3-xgrid-lines",xgridFocus:"c3-xgrid-focus",ygrid:"c3-ygrid",ygrids:"c3-ygrids",ygridLine:"c3-ygrid-line",ygridLines:"c3-ygrid-lines",axis:"c3-axis",axisX:"c3-axis-x",axisXLabel:"c3-axis-x-label",axisY:"c3-axis-y",axisYLabel:"c3-axis-y-label",axisY2:"c3-axis-y2",axisY2Label:"c3-axis-y2-label",legendBackground:"c3-legend-background",legendItem:"c3-legend-item",legendItemEvent:"c3-legend-item-event",legendItemTile:"c3-legend-item-tile",legendItemHidden:"c3-legend-item-hidden",legendItemFocused:"c3-legend-item-focused",dragarea:"c3-dragarea",EXPANDED:"_expanded_",SELECTED:"_selected_",INCLUDED:"_included_"},s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},u=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},c=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},h=function(t){return t||0===t},d=function(t){return"function"==typeof t},f=function(t){return Array.isArray(t)},p=function(t){return"string"==typeof t},g=function(t){return void 0===t},_=function(t){return void 0!==t},v=function(t){return 10*Math.ceil(t/10)},y=function(t){return Math.ceil(t)+.5},m=function(t){return t[1]-t[0]},x=function(t){return void 0===t||null===t||p(t)&&0===t.length||"object"===(void 0===t?"undefined":s(t))&&0===Object.keys(t).length},S=function(t){return!R.isEmpty(t)},E=function(t,e,n){return _(t[e])?t[e]:n},T=function(t,e){var n=!1;return Object.keys(t).forEach(function(i){t[i]===e&&(n=!0)}),n},w=function(t){return"string"==typeof t?t.replace(/</g,"&lt;").replace(/>/g,"&gt;"):t},C=function(t){var e=t.getBoundingClientRect(),n=[t.pathSegList.getItem(0),t.pathSegList.getItem(1)];return{x:n[0].x,y:Math.min(n[0].y,n[1].y),width:e.width,height:e.height}};(o=t.prototype).axisX=function(t,e,n){t.attr("transform",function(t){return"translate("+Math.ceil(e(t)+n)+", 0)"})},o.axisY=function(t,e){t.attr("transform",function(t){return"translate(0,"+Math.ceil(e(t))+")"})},o.scaleExtent=function(t){var e=t[0],n=t[t.length-1];return e<n?[e,n]:[n,e]},o.generateTicks=function(t){var e,n,i=this,r=[];if(t.ticks)return t.ticks.apply(t,i.tickArguments);for(n=t.domain(),e=Math.ceil(n[0]);e<n[1];e++)r.push(e);return r.length>0&&r[0]>0&&r.unshift(r[0]-(r[1]-r[0])),r},o.copyScale=function(){var t,e=this,n=e.scale.copy();return e.params.isCategory&&(t=e.scale.domain(),n.domain([t[0],t[1]-1])),n},o.textFormatted=function(t){var e=this,n=e.tickFormat?e.tickFormat(t):t;return void 0!==n?n:""},o.updateRange=function(){var t=this;return t.range=t.scale.rangeExtent?t.scale.rangeExtent():t.scaleExtent(t.scale.range()),t.range},o.updateTickTextCharSize=function(t){var e=this;if(e.tickTextCharSize)return e.tickTextCharSize;var n={h:11.5,w:5.5};return t.select("text").text(function(t){return e.textFormatted(t)}).each(function(t){var i=this.getBoundingClientRect(),r=e.textFormatted(t),o=i.height,a=r?i.width/r.length:void 0;o&&a&&(n.h=o,n.w=a)}).text(""),e.tickTextCharSize=n,n},o.transitionise=function(t){return this.params.withoutTransition?t:this.d3.transition(t)},o.isVertical=function(){return"left"===this.orient||"right"===this.orient},o.tspanData=function(t,e,n,i){var r=this,o=r.params.tickMultiline?r.splitTickText(t,n,i):[].concat(r.textFormatted(t));return o.map(function(t){return{index:e,splitted:t,length:o.length}})},o.splitTickText=function(t,e,n){function i(t,e){o=void 0;for(var n=1;n<e.length;n++)if(" "===e.charAt(n)&&(o=n),r=e.substr(0,n+1),a=s.tickTextCharSize.w*r.length,u<a)return i(t.concat(e.substr(0,o||n)),e.slice(o?o+1:n));return t.concat(e)}var r,o,a,s=this,l=s.textFormatted(t),u=s.params.tickWidth;return"[object Array]"===Object.prototype.toString.call(l)?l:((!u||u<=0)&&(u=s.isVertical()?95:s.params.isCategory?Math.ceil(n(e[1])-n(e[0]))-12:110),i([],l+""))},o.updateTickLength=function(){var t=this;t.tickLength=Math.max(t.innerTickSize,0)+t.tickPadding},o.lineY2=function(t){var e=this,n=e.scale(t)+(e.tickCentered?0:e.tickOffset);return e.range[0]<n&&n<e.range[1]?e.innerTickSize:0},o.textY=function(){var t=this,e=t.tickTextRotate;return e?11.5-e/15*2.5*(e>0?1:-1):t.tickLength},o.textTransform=function(){var t=this.tickTextRotate;return t?"rotate("+t+")":""},o.textTextAnchor=function(){var t=this.tickTextRotate;return t?t>0?"start":"end":"middle"},o.tspanDx=function(){var t=this.tickTextRotate;return t?8*Math.sin(Math.PI*(t/180)):0},o.tspanDy=function(t,e){var n=this,i=n.tickTextCharSize.h;return 0===e&&(i=n.isVertical()?-((t.length-1)*(n.tickTextCharSize.h/2)-3):".71em"),i},o.generateAxis=function(){function t(r){r.each(function(){var r,o,a,s=t.g=n.select(this),l=this.__chart__||e.scale,u=this.__chart__=e.copyScale(),c=e.tickValues?e.tickValues:e.generateTicks(u),h=s.selectAll(".tick").data(c,u),d=h.enter().insert("g",".domain").attr("class","tick").style("opacity",1e-6),f=h.exit().remove(),p=e.transitionise(h).style("opacity",1);i.isCategory?(e.tickOffset=Math.ceil((u(1)-u(0))/2),o=e.tickCentered?0:e.tickOffset,a=e.tickCentered?e.tickOffset:0):e.tickOffset=o=0,d.append("line"),d.append("text"),e.updateRange(),e.updateTickLength(),e.updateTickTextCharSize(s.select(".tick"));var g=p.select("line"),_=p.select("text"),v=h.select("text").selectAll("tspan").data(function(t,n){return e.tspanData(t,n,c,u)});v.enter().append("tspan"),v.exit().remove(),v.text(function(t){return t.splitted});var y=s.selectAll(".domain").data([0]),m=(y.enter().append("path").attr("class","domain"),e.transitionise(y));switch(e.orient){case"bottom":r=e.axisX,g.attr("x1",o).attr("x2",o).attr("y2",function(t,n){return e.lineY2(t,n)}),_.attr("x",0).attr("y",function(t,n){return e.textY(t,n)}).attr("transform",function(t,n){return e.textTransform(t,n)}).style("text-anchor",function(t,n){return e.textTextAnchor(t,n)}),v.attr("x",0).attr("dy",function(t,n){return e.tspanDy(t,n)}).attr("dx",function(t,n){return e.tspanDx(t,n)}),m.attr("d","M"+e.range[0]+","+e.outerTickSize+"V0H"+e.range[1]+"V"+e.outerTickSize);break;case"top":r=e.axisX,g.attr("x2",0).attr("y2",-e.innerTickSize),_.attr("x",0).attr("y",-e.tickLength).style("text-anchor","middle"),v.attr("x",0).attr("dy","0em"),m.attr("d","M"+e.range[0]+","+-e.outerTickSize+"V0H"+e.range[1]+"V"+-e.outerTickSize);break;case"left":r=e.axisY,g.attr("x2",-e.innerTickSize).attr("y1",a).attr("y2",a),_.attr("x",-e.tickLength).attr("y",e.tickOffset).style("text-anchor","end"),v.attr("x",-e.tickLength).attr("dy",function(t,n){return e.tspanDy(t,n)}),m.attr("d","M"+-e.outerTickSize+","+e.range[0]+"H0V"+e.range[1]+"H"+-e.outerTickSize);break;case"right":r=e.axisY,g.attr("x2",e.innerTickSize).attr("y2",0),_.attr("x",e.tickLength).attr("y",0).style("text-anchor","start"),v.attr("x",e.tickLength).attr("dy",function(t,n){return e.tspanDy(t,n)}),m.attr("d","M"+e.outerTickSize+","+e.range[0]+"H0V"+e.range[1]+"H"+e.outerTickSize)}if(u.rangeBand){var x=u,S=x.rangeBand()/2;l=u=function(t){return x(t)+S}}else l.rangeBand?l=u:f.call(r,u,e.tickOffset);d.call(r,l,e.tickOffset),p.call(r,u,e.tickOffset)})}var e=this,n=e.d3,i=e.params;return t.scale=function(n){return arguments.length?(e.scale=n,t):e.scale},t.orient=function(n){return arguments.length?(e.orient=n in{top:1,right:1,bottom:1,left:1}?n+"":"bottom",t):e.orient},t.tickFormat=function(n){return arguments.length?(e.tickFormat=n,t):e.tickFormat},t.tickCentered=function(n){return arguments.length?(e.tickCentered=n,t):e.tickCentered},t.tickOffset=function(){return e.tickOffset},t.tickInterval=function(){var n;return(n=i.isCategory?2*e.tickOffset:(t.g.select("path.domain").node().getTotalLength()-2*e.outerTickSize)/t.g.selectAll("line").size())===1/0?0:n},t.ticks=function(){return arguments.length?(e.tickArguments=arguments,t):e.tickArguments},t.tickCulling=function(n){return arguments.length?(e.tickCulling=n,t):e.tickCulling},t.tickValues=function(n){if("function"==typeof n)e.tickValues=function(){return n(e.scale.domain())};else{if(!arguments.length)return e.tickValues;e.tickValues=n}return t},t};var b=function(n){function i(e){l(this,i);var n={fn:r,internal:{fn:o}},a=c(this,(i.__proto__||Object.getPrototypeOf(i)).call(this,e,"axis",n));return a.d3=e.d3,a.internal=t,a}return u(i,e),i}();(r=b.prototype).init=function(){var t=this.owner,e=t.config,n=t.main;t.axes.x=n.append("g").attr("class",a.axis+" "+a.axisX).attr("clip-path",t.clipPathForXAxis).attr("transform",t.getTranslate("x")).style("visibility",e.axis_x_show?"visible":"hidden"),t.axes.x.append("text").attr("class",a.axisXLabel).attr("transform",e.axis_rotated?"rotate(-90)":"").style("text-anchor",this.textAnchorForXAxisLabel.bind(this)),t.axes.y=n.append("g").attr("class",a.axis+" "+a.axisY).attr("clip-path",e.axis_y_inner?"":t.clipPathForYAxis).attr("transform",t.getTranslate("y")).style("visibility",e.axis_y_show?"visible":"hidden"),t.axes.y.append("text").attr("class",a.axisYLabel).attr("transform",e.axis_rotated?"":"rotate(-90)").style("text-anchor",this.textAnchorForYAxisLabel.bind(this)),t.axes.y2=n.append("g").attr("class",a.axis+" "+a.axisY2).attr("transform",t.getTranslate("y2")).style("visibility",e.axis_y2_show?"visible":"hidden"),t.axes.y2.append("text").attr("class",a.axisY2Label).attr("transform",e.axis_rotated?"":"rotate(-90)").style("text-anchor",this.textAnchorForY2AxisLabel.bind(this))},r.getXAxis=function(t,e,n,i,r,o,a){var s=this.owner,l=s.config,u={isCategory:s.isCategorized(),withOuterTick:r,tickMultiline:l.axis_x_tick_multiline,tickWidth:l.axis_x_tick_width,tickTextRotate:a?0:l.axis_x_tick_rotate,withoutTransition:o},c=new this.internal(this,u).axis.scale(t).orient(e);return s.isTimeSeries()&&i&&"function"!=typeof i&&(i=i.map(function(t){return s.parseDate(t)})),c.tickFormat(n).tickValues(i),s.isCategorized()&&(c.tickCentered(l.axis_x_tick_centered),x(l.axis_x_tick_culling)&&(l.axis_x_tick_culling=!1)),c},r.updateXAxisTickValues=function(t,e){var n,i=this.owner,r=i.config;return(r.axis_x_tick_fit||r.axis_x_tick_count)&&(n=this.generateTickValues(i.mapTargetsToUniqueXs(t),r.axis_x_tick_count,i.isTimeSeries())),e?e.tickValues(n):(i.xAxis.tickValues(n),i.subXAxis.tickValues(n)),n},r.getYAxis=function(t,e,n,i,r,o,a){var s=this.owner,l=s.config,u={withOuterTick:r,withoutTransition:o,tickTextRotate:a?0:l.axis_y_tick_rotate},c=new this.internal(this,u).axis.scale(t).orient(e).tickFormat(n);return s.isTimeSeriesY()?c.ticks(s.d3.time[l.axis_y_tick_time_value],l.axis_y_tick_time_interval):c.tickValues(i),c},r.getId=function(t){var e=this.owner.config;return t in e.data_axes?e.data_axes[t]:"y"},r.getXAxisTickFormat=function(){var t=this.owner,e=t.config,n=t.isTimeSeries()?t.defaultAxisTimeFormat:t.isCategorized()?t.categoryName:function(t){return t<0?t.toFixed(0):t};return e.axis_x_tick_format&&(d(e.axis_x_tick_format)?n=e.axis_x_tick_format:t.isTimeSeries()&&(n=function(n){return n?t.axisTimeFormat(e.axis_x_tick_format)(n):""})),d(n)?function(e){return n.call(t,e)}:n},r.getTickValues=function(t,e){return t||(e?e.tickValues():void 0)},r.getXAxisTickValues=function(){return this.getTickValues(this.owner.config.axis_x_tick_values,this.owner.xAxis)},r.getYAxisTickValues=function(){return this.getTickValues(this.owner.config.axis_y_tick_values,this.owner.yAxis)},r.getY2AxisTickValues=function(){return this.getTickValues(this.owner.config.axis_y2_tick_values,this.owner.y2Axis)},r.getLabelOptionByAxisId=function(t){var e,n=this.owner.config;return"y"===t?e=n.axis_y_label:"y2"===t?e=n.axis_y2_label:"x"===t&&(e=n.axis_x_label),e},r.getLabelText=function(t){var e=this.getLabelOptionByAxisId(t);return p(e)?e:e?e.text:null},r.setLabelText=function(t,e){var n=this.owner.config,i=this.getLabelOptionByAxisId(t);p(i)?"y"===t?n.axis_y_label=e:"y2"===t?n.axis_y2_label=e:"x"===t&&(n.axis_x_label=e):i&&(i.text=e)},r.getLabelPosition=function(t,e){var n=this.getLabelOptionByAxisId(t),i=n&&"object"===(void 0===n?"undefined":s(n))&&n.position?n.position:e;return{isInner:i.indexOf("inner")>=0,isOuter:i.indexOf("outer")>=0,isLeft:i.indexOf("left")>=0,isCenter:i.indexOf("center")>=0,isRight:i.indexOf("right")>=0,isTop:i.indexOf("top")>=0,isMiddle:i.indexOf("middle")>=0,isBottom:i.indexOf("bottom")>=0}},r.getXAxisLabelPosition=function(){return this.getLabelPosition("x",this.owner.config.axis_rotated?"inner-top":"inner-right")},r.getYAxisLabelPosition=function(){return this.getLabelPosition("y",this.owner.config.axis_rotated?"inner-right":"inner-top")},r.getY2AxisLabelPosition=function(){return this.getLabelPosition("y2",this.owner.config.axis_rotated?"inner-right":"inner-top")},r.getLabelPositionById=function(t){return"y2"===t?this.getY2AxisLabelPosition():"y"===t?this.getYAxisLabelPosition():this.getXAxisLabelPosition()},r.textForXAxisLabel=function(){return this.getLabelText("x")},r.textForYAxisLabel=function(){return this.getLabelText("y")},r.textForY2AxisLabel=function(){return this.getLabelText("y2")},r.xForAxisLabel=function(t,e){var n=this.owner;return t?e.isLeft?0:e.isCenter?n.width/2:n.width:e.isBottom?-n.height:e.isMiddle?-n.height/2:0},r.dxForAxisLabel=function(t,e){return t?e.isLeft?"0.5em":e.isRight?"-0.5em":"0":e.isTop?"-0.5em":e.isBottom?"0.5em":"0"},r.textAnchorForAxisLabel=function(t,e){return t?e.isLeft?"start":e.isCenter?"middle":"end":e.isBottom?"start":e.isMiddle?"middle":"end"},r.xForXAxisLabel=function(){return this.xForAxisLabel(!this.owner.config.axis_rotated,this.getXAxisLabelPosition())},r.xForYAxisLabel=function(){return this.xForAxisLabel(this.owner.config.axis_rotated,this.getYAxisLabelPosition())},r.xForY2AxisLabel=function(){return this.xForAxisLabel(this.owner.config.axis_rotated,this.getY2AxisLabelPosition())},r.dxForXAxisLabel=function(){return this.dxForAxisLabel(!this.owner.config.axis_rotated,this.getXAxisLabelPosition())},r.dxForYAxisLabel=function(){return this.dxForAxisLabel(this.owner.config.axis_rotated,this.getYAxisLabelPosition())},r.dxForY2AxisLabel=function(){return this.dxForAxisLabel(this.owner.config.axis_rotated,this.getY2AxisLabelPosition())},r.dyForXAxisLabel=function(){var t=this.owner.config,e=this.getXAxisLabelPosition();return t.axis_rotated?e.isInner?"1.2em":-25-this.getMaxTickWidth("x"):e.isInner?"-0.5em":t.axis_x_height?t.axis_x_height-10:"3em"},r.dyForYAxisLabel=function(){var t=this.owner,e=this.getYAxisLabelPosition();return t.config.axis_rotated?e.isInner?"-0.5em":"3em":e.isInner?"1.2em":-10-(t.config.axis_y_inner?0:this.getMaxTickWidth("y")+10)},r.dyForY2AxisLabel=function(){var t=this.owner,e=this.getY2AxisLabelPosition();return t.config.axis_rotated?e.isInner?"1.2em":"-2.2em":e.isInner?"-0.5em":15+(t.config.axis_y2_inner?0:this.getMaxTickWidth("y2")+15)},r.textAnchorForXAxisLabel=function(){var t=this.owner;return this.textAnchorForAxisLabel(!t.config.axis_rotated,this.getXAxisLabelPosition())},r.textAnchorForYAxisLabel=function(){var t=this.owner;return this.textAnchorForAxisLabel(t.config.axis_rotated,this.getYAxisLabelPosition())},r.textAnchorForY2AxisLabel=function(){var t=this.owner;return this.textAnchorForAxisLabel(t.config.axis_rotated,this.getY2AxisLabelPosition())},r.getMaxTickWidth=function(t,e){var n,i,r,o,a=this.owner,s=a.config,l=0;return e&&a.currentMaxTickWidths[t]?a.currentMaxTickWidths[t]:(a.svg&&(n=a.filterTargetsToShow(a.data.targets),"y"===t?(i=a.y.copy().domain(a.getYDomain(n,"y")),r=this.getYAxis(i,a.yOrient,s.axis_y_tick_format,a.yAxisTickValues,!1,!0,!0)):"y2"===t?(i=a.y2.copy().domain(a.getYDomain(n,"y2")),r=this.getYAxis(i,a.y2Orient,s.axis_y2_tick_format,a.y2AxisTickValues,!1,!0,!0)):(i=a.x.copy().domain(a.getXDomain(n)),r=this.getXAxis(i,a.xOrient,a.xAxisTickFormat,a.xAxisTickValues,!1,!0,!0),this.updateXAxisTickValues(n,r)),(o=a.d3.select("body").append("div").classed("c3",!0)).append("svg").style("visibility","hidden").style("position","fixed").style("top",0).style("left",0).append("g").call(r).each(function(){a.d3.select(this).selectAll("text").each(function(){var t=this.getBoundingClientRect();l<t.width&&(l=t.width)}),o.remove()})),a.currentMaxTickWidths[t]=l<=0?a.currentMaxTickWidths[t]:l,a.currentMaxTickWidths[t])},r.updateLabels=function(t){var e=this.owner,n=e.main.select("."+a.axisX+" ."+a.axisXLabel),i=e.main.select("."+a.axisY+" ."+a.axisYLabel),r=e.main.select("."+a.axisY2+" ."+a.axisY2Label);(t?n.transition():n).attr("x",this.xForXAxisLabel.bind(this)).attr("dx",this.dxForXAxisLabel.bind(this)).attr("dy",this.dyForXAxisLabel.bind(this)).text(this.textForXAxisLabel.bind(this)),(t?i.transition():i).attr("x",this.xForYAxisLabel.bind(this)).attr("dx",this.dxForYAxisLabel.bind(this)).attr("dy",this.dyForYAxisLabel.bind(this)).text(this.textForYAxisLabel.bind(this)),(t?r.transition():r).attr("x",this.xForY2AxisLabel.bind(this)).attr("dx",this.dxForY2AxisLabel.bind(this)).attr("dy",this.dyForY2AxisLabel.bind(this)).text(this.textForY2AxisLabel.bind(this))},r.getPadding=function(t,e,n,i){var r="number"==typeof t?t:t[e];return h(r)?"ratio"===t.unit?t[e]*i:this.convertPixelsToAxisPadding(r,i):n},r.convertPixelsToAxisPadding=function(t,e){var n=this.owner;return e*(t/(n.config.axis_rotated?n.width:n.height))},r.generateTickValues=function(t,e,n){var i,r,o,a,s,l,u,c=t;if(e)if(1===(i=d(e)?e():e))c=[t[0]];else if(2===i)c=[t[0],t[t.length-1]];else if(i>2){for(a=i-2,r=t[0],s=((o=t[t.length-1])-r)/(a+1),c=[r],l=0;l<a;l++)u=+r+s*(l+1),c.push(n?new Date(u):u);c.push(o)}return n||(c=c.sort(function(t,e){return t-e})),c},r.generateTransitions=function(t){var e=this.owner.axes;return{axisX:t?e.x.transition().duration(t):e.x,axisY:t?e.y.transition().duration(t):e.y,axisY2:t?e.y2.transition().duration(t):e.y2,axisSubX:t?e.subx.transition().duration(t):e.subx}},r.redraw=function(t,e){var n=this.owner;n.axes.x.style("opacity",e?0:1),n.axes.y.style("opacity",e?0:1),n.axes.y2.style("opacity",e?0:1),n.axes.subx.style("opacity",e?0:1),t.axisX.call(n.xAxis),t.axisY.call(n.yAxis),t.axisY2.call(n.y2Axis),t.axisSubX.call(n.subXAxis)};var A,R,L={version:"0.4.18"};return L.generate=function(t){return new n(t)},L.chart={fn:n.prototype,internal:{fn:i.prototype}},A=L.chart.fn,R=L.chart.internal.fn,R.beforeInit=function(){},R.afterInit=function(){},R.init=function(){var t=this,e=t.config;if(t.initParams(),e.data_url)t.convertUrlToData(e.data_url,e.data_mimeType,e.data_headers,e.data_keys,t.initWithData);else if(e.data_json)t.initWithData(t.convertJsonToData(e.data_json,e.data_keys));else if(e.data_rows)t.initWithData(t.convertRowsToData(e.data_rows));else{if(!e.data_columns)throw Error("url or json or rows or columns is required.");t.initWithData(t.convertColumnsToData(e.data_columns))}},R.initParams=function(){var t=this,e=t.d3,n=t.config;t.clipId="c3-"+ +new Date+"-clip",t.clipIdForXAxis=t.clipId+"-xaxis",t.clipIdForYAxis=t.clipId+"-yaxis",t.clipIdForGrid=t.clipId+"-grid",t.clipIdForSubchart=t.clipId+"-subchart",t.clipPath=t.getClipPath(t.clipId),t.clipPathForXAxis=t.getClipPath(t.clipIdForXAxis),t.clipPathForYAxis=t.getClipPath(t.clipIdForYAxis),t.clipPathForGrid=t.getClipPath(t.clipIdForGrid),t.clipPathForSubchart=t.getClipPath(t.clipIdForSubchart),t.dragStart=null,t.dragging=!1,t.flowing=!1,t.cancelClick=!1,t.mouseover=!1,t.transiting=!1,t.color=t.generateColor(),t.levelColor=t.generateLevelColor(),t.dataTimeFormat=n.data_xLocaltime?e.time.format:e.time.format.utc,t.axisTimeFormat=n.axis_x_localtime?e.time.format:e.time.format.utc,t.defaultAxisTimeFormat=t.axisTimeFormat.multi([[".%L",function(t){return t.getMilliseconds()}],[":%S",function(t){return t.getSeconds()}],["%I:%M",function(t){return t.getMinutes()}],["%I %p",function(t){return t.getHours()}],["%-m/%-d",function(t){return t.getDay()&&1!==t.getDate()}],["%-m/%-d",function(t){return 1!==t.getDate()}],["%-m/%-d",function(t){return t.getMonth()}],["%Y/%-m/%-d",function(){return!0}]]),t.hiddenTargetIds=[],t.hiddenLegendIds=[],t.focusedTargetIds=[],t.defocusedTargetIds=[],t.xOrient=n.axis_rotated?"left":"bottom",t.yOrient=n.axis_rotated?n.axis_y_inner?"top":"bottom":n.axis_y_inner?"right":"left",t.y2Orient=n.axis_rotated?n.axis_y2_inner?"bottom":"top":n.axis_y2_inner?"left":"right",t.subXOrient=n.axis_rotated?"left":"bottom",t.isLegendRight="right"===n.legend_position,t.isLegendInset="inset"===n.legend_position,t.isLegendTop="top-left"===n.legend_inset_anchor||"top-right"===n.legend_inset_anchor,t.isLegendLeft="top-left"===n.legend_inset_anchor||"bottom-left"===n.legend_inset_anchor,t.legendStep=0,t.legendItemWidth=0,t.legendItemHeight=0,t.currentMaxTickWidths={x:0,y:0,y2:0},t.rotated_padding_left=30,t.rotated_padding_right=n.axis_rotated&&!n.axis_x_show?0:30,t.rotated_padding_top=5,t.withoutFadeIn={},t.intervalForObserveInserted=void 0,t.axes.subx=e.selectAll([])},R.initChartElements=function(){this.initBar&&this.initBar(),this.initLine&&this.initLine(),this.initArc&&this.initArc(),this.initGauge&&this.initGauge(),this.initText&&this.initText()},R.initWithData=function(t){var e,n,i=this,r=i.d3,o=i.config,s=!0;i.axis=new b(i),i.initPie&&i.initPie(),i.initBrush&&i.initBrush(),i.initZoom&&i.initZoom(),o.bindto?"function"==typeof o.bindto.node?i.selectChart=o.bindto:i.selectChart=r.select(o.bindto):i.selectChart=r.selectAll([]),i.selectChart.empty()&&(i.selectChart=r.select(document.createElement("div")).style("opacity",0),i.observeInserted(i.selectChart),s=!1),i.selectChart.html("").classed("c3",!0),i.data.xs={},i.data.targets=i.convertDataToTargets(t),o.data_filter&&(i.data.targets=i.data.targets.filter(o.data_filter)),o.data_hide&&i.addHiddenTargetIds(!0===o.data_hide?i.mapToIds(i.data.targets):o.data_hide),o.legend_hide&&i.addHiddenLegendIds(!0===o.legend_hide?i.mapToIds(i.data.targets):o.legend_hide),i.hasType("gauge")&&(o.legend_show=!1),i.updateSizes(),i.updateScales(),i.x.domain(r.extent(i.getXDomain(i.data.targets))),i.y.domain(i.getYDomain(i.data.targets,"y")),i.y2.domain(i.getYDomain(i.data.targets,"y2")),i.subX.domain(i.x.domain()),i.subY.domain(i.y.domain()),i.subY2.domain(i.y2.domain()),i.orgXDomain=i.x.domain(),i.brush&&i.brush.scale(i.subX),o.zoom_enabled&&i.zoom.scale(i.x),i.svg=i.selectChart.append("svg").style("overflow","hidden").on("mouseenter",function(){return o.onmouseover.call(i)}).on("mouseleave",function(){return o.onmouseout.call(i)}),i.config.svg_classname&&i.svg.attr("class",i.config.svg_classname),e=i.svg.append("defs"),i.clipChart=i.appendClip(e,i.clipId),i.clipXAxis=i.appendClip(e,i.clipIdForXAxis),i.clipYAxis=i.appendClip(e,i.clipIdForYAxis),i.clipGrid=i.appendClip(e,i.clipIdForGrid),i.clipSubchart=i.appendClip(e,i.clipIdForSubchart),i.updateSvgSize(),n=i.main=i.svg.append("g").attr("transform",i.getTranslate("main")),i.initSubchart&&i.initSubchart(),i.initTooltip&&i.initTooltip(),i.initLegend&&i.initLegend(),i.initTitle&&i.initTitle(),n.append("text").attr("class",a.text+" "+a.empty).attr("text-anchor","middle").attr("dominant-baseline","middle"),i.initRegion(),i.initGrid(),n.append("g").attr("clip-path",i.clipPath).attr("class",a.chart),o.grid_lines_front&&i.initGridLines(),i.initEventRect(),i.initChartElements(),n.insert("rect",o.zoom_privileged?null:"g."+a.regions).attr("class",a.zoomRect).attr("width",i.width).attr("height",i.height).style("opacity",0).on("dblclick.zoom",null),o.axis_x_extent&&i.brush.extent(i.getDefaultExtent()),i.axis.init(),i.updateTargets(i.data.targets),s&&(i.updateDimension(),i.config.oninit.call(i),i.redraw({withTransition:!1,withTransform:!0,withUpdateXDomain:!0,withUpdateOrgXDomain:!0,withTransitionForAxis:!1})),i.bindResize(),i.api.element=i.selectChart.node()},R.smoothLines=function(t,e){var n=this;"grid"===e&&t.each(function(){var t=n.d3.select(this),e=t.attr("x1"),i=t.attr("x2"),r=t.attr("y1"),o=t.attr("y2");t.attr({x1:Math.ceil(e),x2:Math.ceil(i),y1:Math.ceil(r),y2:Math.ceil(o)})})},R.updateSizes=function(){var t=this,e=t.config,n=t.legend?t.getLegendHeight():0,i=t.legend?t.getLegendWidth():0,r=t.isLegendRight||t.isLegendInset?0:n,o=t.hasArcType(),a=e.axis_rotated||o?0:t.getHorizontalAxisHeight("x"),s=e.subchart_show&&!o?e.subchart_size_height+a:0;t.currentWidth=t.getCurrentWidth(),t.currentHeight=t.getCurrentHeight(),t.margin=e.axis_rotated?{top:t.getHorizontalAxisHeight("y2")+t.getCurrentPaddingTop(),right:o?0:t.getCurrentPaddingRight(),bottom:t.getHorizontalAxisHeight("y")+r+t.getCurrentPaddingBottom(),left:s+(o?0:t.getCurrentPaddingLeft())}:{top:4+t.getCurrentPaddingTop(),right:o?0:t.getCurrentPaddingRight(),bottom:a+s+r+t.getCurrentPaddingBottom(),left:o?0:t.getCurrentPaddingLeft()},t.margin2=e.axis_rotated?{top:t.margin.top,right:NaN,bottom:20+r,left:t.rotated_padding_left}:{top:t.currentHeight-s-r,right:NaN,bottom:a+r,left:t.margin.left},t.margin3={top:0,right:NaN,bottom:0,left:0},t.updateSizeForLegend&&t.updateSizeForLegend(n,i),t.width=t.currentWidth-t.margin.left-t.margin.right,t.height=t.currentHeight-t.margin.top-t.margin.bottom,t.width<0&&(t.width=0),t.height<0&&(t.height=0),t.width2=e.axis_rotated?t.margin.left-t.rotated_padding_left-t.rotated_padding_right:t.width,t.height2=e.axis_rotated?t.height:t.currentHeight-t.margin2.top-t.margin2.bottom,t.width2<0&&(t.width2=0),t.height2<0&&(t.height2=0),t.arcWidth=t.width-(t.isLegendRight?i+10:0),t.arcHeight=t.height-(t.isLegendRight?0:10),t.hasType("gauge")&&!e.gauge_fullCircle&&(t.arcHeight+=t.height-t.getGaugeLabelHeight()),t.updateRadius&&t.updateRadius(),t.isLegendRight&&o&&(t.margin3.left=t.arcWidth/2+1.1*t.radiusExpanded)},R.updateTargets=function(t){var e=this;e.updateTargetsForText(t),e.updateTargetsForBar(t),e.updateTargetsForLine(t),e.hasArcType()&&e.updateTargetsForArc&&e.updateTargetsForArc(t),e.updateTargetsForSubchart&&e.updateTargetsForSubchart(t),e.showTargets()},R.showTargets=function(){var t=this;t.svg.selectAll("."+a.target).filter(function(e){return t.isTargetToShow(e.id)}).transition().duration(t.config.transition_duration).style("opacity",1)},R.redraw=function(t,e){var n,i,r,o,s,l,u,c,h,d,f,p,g,_,v,y,m,x,S,T,w,C,b,A,R,L,I,P,M,O=this,D=O.main,F=O.d3,k=O.config,N=O.getShapeIndices(O.isAreaType),G=O.getShapeIndices(O.isBarType),V=O.getShapeIndices(O.isLineType),U=O.hasArcType(),B=O.filterTargetsToShow(O.data.targets),z=O.xv.bind(O);if(t=t||{},n=E(t,"withY",!0),i=E(t,"withSubchart",!0),r=E(t,"withTransition",!0),l=E(t,"withTransform",!1),u=E(t,"withUpdateXDomain",!1),c=E(t,"withUpdateOrgXDomain",!1),h=E(t,"withTrimXDomain",!0),g=E(t,"withUpdateXAxis",u),d=E(t,"withLegend",!1),f=E(t,"withEventRect",!0),p=E(t,"withDimension",!0),o=E(t,"withTransitionForExit",r),s=E(t,"withTransitionForAxis",r),S=r?k.transition_duration:0,T=o?S:0,w=s?S:0,e=e||O.axis.generateTransitions(w),d&&k.legend_show?O.updateLegend(O.mapToIds(O.data.targets),t,e):p&&O.updateDimension(!0),O.isCategorized()&&0===B.length&&O.x.domain([0,O.axes.x.selectAll(".tick").size()]),B.length?(O.updateXDomain(B,u,c,h),k.axis_x_tick_values||(A=O.axis.updateXAxisTickValues(B))):(O.xAxis.tickValues([]),O.subXAxis.tickValues([])),k.zoom_rescale&&!t.flow&&(I=O.x.orgDomain()),O.y.domain(O.getYDomain(B,"y",I)),O.y2.domain(O.getYDomain(B,"y2",I)),!k.axis_y_tick_values&&k.axis_y_tick_count&&O.yAxis.tickValues(O.axis.generateTickValues(O.y.domain(),k.axis_y_tick_count)),!k.axis_y2_tick_values&&k.axis_y2_tick_count&&O.y2Axis.tickValues(O.axis.generateTickValues(O.y2.domain(),k.axis_y2_tick_count)),O.axis.redraw(e,U),O.axis.updateLabels(r),(u||g)&&B.length)if(k.axis_x_tick_culling&&A){for(R=1;R<A.length;R++)if(A.length/R<k.axis_x_tick_culling_max){L=R;break}O.svg.selectAll("."+a.axisX+" .tick text").each(function(t){var e=A.indexOf(t);e>=0&&F.select(this).style("display",e%L?"none":"block")})}else O.svg.selectAll("."+a.axisX+" .tick text").style("display","block");_=O.generateDrawArea?O.generateDrawArea(N,!1):void 0,v=O.generateDrawBar?O.generateDrawBar(G):void 0,y=O.generateDrawLine?O.generateDrawLine(V,!1):void 0,m=O.generateXYForText(N,G,V,!0),x=O.generateXYForText(N,G,V,!1),n&&(O.subY.domain(O.getYDomain(B,"y")),O.subY2.domain(O.getYDomain(B,"y2"))),O.updateXgridFocus(),D.select("text."+a.text+"."+a.empty).attr("x",O.width/2).attr("y",O.height/2).text(k.data_empty_label_text).transition().style("opacity",B.length?0:1),O.updateGrid(S),O.updateRegion(S),O.updateBar(T),O.updateLine(T),O.updateArea(T),O.updateCircle(),O.hasDataLabel()&&O.updateText(T),O.redrawTitle&&O.redrawTitle(),O.redrawArc&&O.redrawArc(S,T,l),O.redrawSubchart&&O.redrawSubchart(i,e,S,T,N,G,V),D.selectAll("."+a.selectedCircles).filter(O.isBarType.bind(O)).selectAll("circle").remove(),k.interaction_enabled&&!t.flow&&f&&(O.redrawEventRect(),O.updateZoom&&O.updateZoom()),O.updateCircleY(),P=(O.config.axis_rotated?O.circleY:O.circleX).bind(O),M=(O.config.axis_rotated?O.circleX:O.circleY).bind(O),t.flow&&(b=O.generateFlow({targets:B,flow:t.flow,duration:t.flow.duration,drawBar:v,drawLine:y,drawArea:_,cx:P,cy:M,xv:z,xForText:m,yForText:x})),(S||b)&&O.isTabVisible()?F.transition().duration(S).each(function(){var e=[];[O.redrawBar(v,!0),O.redrawLine(y,!0),O.redrawArea(_,!0),O.redrawCircle(P,M,!0),O.redrawText(m,x,t.flow,!0),O.redrawRegion(!0),O.redrawGrid(!0)].forEach(function(t){t.forEach(function(t){e.push(t)})}),C=O.generateWait(),e.forEach(function(t){C.add(t)})}).call(C,function(){b&&b(),k.onrendered&&k.onrendered.call(O)}):(O.redrawBar(v),O.redrawLine(y),O.redrawArea(_),O.redrawCircle(P,M),O.redrawText(m,x,t.flow),O.redrawRegion(),O.redrawGrid(),k.onrendered&&k.onrendered.call(O)),O.mapToIds(O.data.targets).forEach(function(t){O.withoutFadeIn[t]=!0})},R.updateAndRedraw=function(t){var e,n=this,i=n.config;(t=t||{}).withTransition=E(t,"withTransition",!0),t.withTransform=E(t,"withTransform",!1),t.withLegend=E(t,"withLegend",!1),t.withUpdateXDomain=!0,t.withUpdateOrgXDomain=!0,t.withTransitionForExit=!1,t.withTransitionForTransform=E(t,"withTransitionForTransform",t.withTransition),n.updateSizes(),t.withLegend&&i.legend_show||(e=n.axis.generateTransitions(t.withTransitionForAxis?i.transition_duration:0),n.updateScales(),n.updateSvgSize(),n.transformAll(t.withTransitionForTransform,e)),n.redraw(t,e)},R.redrawWithoutRescale=function(){this.redraw({withY:!1,withSubchart:!1,withEventRect:!1,withTransitionForAxis:!1})},R.isTimeSeries=function(){return"timeseries"===this.config.axis_x_type},R.isCategorized=function(){return this.config.axis_x_type.indexOf("categor")>=0},R.isCustomX=function(){var t=this,e=t.config;return!t.isTimeSeries()&&(e.data_x||S(e.data_xs))},R.isTimeSeriesY=function(){return"timeseries"===this.config.axis_y_type},R.getTranslate=function(t){var e,n,i=this,r=i.config;return"main"===t?(e=y(i.margin.left),n=y(i.margin.top)):"context"===t?(e=y(i.margin2.left),n=y(i.margin2.top)):"legend"===t?(e=i.margin3.left,n=i.margin3.top):"x"===t?(e=0,n=r.axis_rotated?0:i.height):"y"===t?(e=0,n=r.axis_rotated?i.height:0):"y2"===t?(e=r.axis_rotated?0:i.width,n=r.axis_rotated?1:0):"subx"===t?(e=0,n=r.axis_rotated?0:i.height2):"arc"===t&&(e=i.arcWidth/2,n=i.arcHeight/2),"translate("+e+","+n+")"},R.initialOpacity=function(t){return null!==t.value&&this.withoutFadeIn[t.id]?1:0},R.initialOpacityForCircle=function(t){return null!==t.value&&this.withoutFadeIn[t.id]?this.opacityForCircle(t):0},R.opacityForCircle=function(t){var e=(d(this.config.point_show)?this.config.point_show(t):this.config.point_show)?1:0;return h(t.value)?this.isScatterType(t)?.5:e:0},R.opacityForText=function(){return this.hasDataLabel()?1:0},R.xx=function(t){return t?this.x(t.x):null},R.xv=function(t){var e=this,n=t.value;return e.isTimeSeries()?n=e.parseDate(t.value):e.isCategorized()&&"string"==typeof t.value&&(n=e.config.axis_x_categories.indexOf(t.value)),Math.ceil(e.x(n))},R.yv=function(t){var e=this,n=t.axis&&"y2"===t.axis?e.y2:e.y;return Math.ceil(n(t.value))},R.subxx=function(t){return t?this.subX(t.x):null},R.transformMain=function(t,e){var n,i,r,o=this;e&&e.axisX?n=e.axisX:(n=o.main.select("."+a.axisX),t&&(n=n.transition())),e&&e.axisY?i=e.axisY:(i=o.main.select("."+a.axisY),t&&(i=i.transition())),e&&e.axisY2?r=e.axisY2:(r=o.main.select("."+a.axisY2),t&&(r=r.transition())),(t?o.main.transition():o.main).attr("transform",o.getTranslate("main")),n.attr("transform",o.getTranslate("x")),i.attr("transform",o.getTranslate("y")),r.attr("transform",o.getTranslate("y2")),o.main.select("."+a.chartArcs).attr("transform",o.getTranslate("arc"))},R.transformAll=function(t,e){var n=this;n.transformMain(t,e),n.config.subchart_show&&n.transformContext(t,e),n.legend&&n.transformLegend(t)},R.updateSvgSize=function(){var t=this,e=t.svg.select(".c3-brush .background");t.svg.attr("width",t.currentWidth).attr("height",t.currentHeight),t.svg.selectAll(["#"+t.clipId,"#"+t.clipIdForGrid]).select("rect").attr("width",t.width).attr("height",t.height),t.svg.select("#"+t.clipIdForXAxis).select("rect").attr("x",t.getXAxisClipX.bind(t)).attr("y",t.getXAxisClipY.bind(t)).attr("width",t.getXAxisClipWidth.bind(t)).attr("height",t.getXAxisClipHeight.bind(t)),t.svg.select("#"+t.clipIdForYAxis).select("rect").attr("x",t.getYAxisClipX.bind(t)).attr("y",t.getYAxisClipY.bind(t)).attr("width",t.getYAxisClipWidth.bind(t)).attr("height",t.getYAxisClipHeight.bind(t)),t.svg.select("#"+t.clipIdForSubchart).select("rect").attr("width",t.width).attr("height",e.size()?e.attr("height"):0),t.svg.select("."+a.zoomRect).attr("width",t.width).attr("height",t.height),t.selectChart.style("max-height",t.currentHeight+"px")},R.updateDimension=function(t){var e=this;t||(e.config.axis_rotated?(e.axes.x.call(e.xAxis),e.axes.subx.call(e.subXAxis)):(e.axes.y.call(e.yAxis),e.axes.y2.call(e.y2Axis))),e.updateSizes(),e.updateScales(),e.updateSvgSize(),e.transformAll(!1)},R.observeInserted=function(t){var e,n=this;"undefined"!=typeof MutationObserver?(e=new MutationObserver(function(i){i.forEach(function(i){"childList"===i.type&&i.previousSibling&&(e.disconnect(),n.intervalForObserveInserted=window.setInterval(function(){t.node().parentNode&&(window.clearInterval(n.intervalForObserveInserted),n.updateDimension(),n.brush&&n.brush.update(),n.config.oninit.call(n),n.redraw({withTransform:!0,withUpdateXDomain:!0,withUpdateOrgXDomain:!0,withTransition:!1,withTransitionForTransform:!1,withLegend:!0}),t.transition().style("opacity",1))},10))})})).observe(t.node(),{attributes:!0,childList:!0,characterData:!0}):window.console.error("MutationObserver not defined.")},R.bindResize=function(){var t=this,e=t.config;if(t.resizeFunction=t.generateResize(),t.resizeFunction.add(function(){e.onresize.call(t)}),e.resize_auto&&t.resizeFunction.add(function(){void 0!==t.resizeTimeout&&window.clearTimeout(t.resizeTimeout),t.resizeTimeout=window.setTimeout(function(){delete t.resizeTimeout,t.api.flush()},100)}),t.resizeFunction.add(function(){e.onresized.call(t)}),window.attachEvent)window.attachEvent("onresize",t.resizeFunction);else if(window.addEventListener)window.addEventListener("resize",t.resizeFunction,!1);else{var n=window.onresize;n?n.add&&n.remove||(n=t.generateResize()).add(window.onresize):n=t.generateResize(),n.add(t.resizeFunction),window.onresize=n}},R.generateResize=function(){function t(){e.forEach(function(t){t()})}var e=[];return t.add=function(t){e.push(t)},t.remove=function(t){for(var n=0;n<e.length;n++)if(e[n]===t){e.splice(n,1);break}},t},R.endall=function(t,e){var n=0;t.each(function(){++n}).each("end",function(){--n||e.apply(this,arguments)})},R.generateWait=function(){var t=[],e=function(e,n){var i=setInterval(function(){var e=0;t.forEach(function(t){if(t.empty())e+=1;else try{t.transition()}catch(t){e+=1}}),e===t.length&&(clearInterval(i),n&&n())},10)};return e.add=function(e){t.push(e)},e},R.parseDate=function(t){var e,n=this;return t instanceof Date?e=t:"string"==typeof t?e=n.dataTimeFormat(n.config.data_xFormat).parse(t):"object"===(void 0===t?"undefined":s(t))?e=new Date(+t):"number"!=typeof t||isNaN(t)||(e=new Date(+t)),e&&!isNaN(+e)||window.console.error("Failed to parse x '"+t+"' to Date object"),e},R.isTabVisible=function(){var t;return void 0!==document.hidden?t="hidden":void 0!==document.mozHidden?t="mozHidden":void 0!==document.msHidden?t="msHidden":void 0!==document.webkitHidden&&(t="webkitHidden"),!document[t]},R.isValue=h,R.isFunction=d,R.isString=p,R.isUndefined=g,R.isDefined=_,R.ceil10=v,R.asHalfPixel=y,R.diffDomain=m,R.isEmpty=x,R.notEmpty=S,R.notEmpty=S,R.getOption=E,R.hasValue=T,R.sanitise=w,R.getPathBox=C,R.CLASS=a,Function.prototype.bind||(Function.prototype.bind=function(t){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var e=Array.prototype.slice.call(arguments,1),n=this,i=function(){},r=function(){return n.apply(this instanceof i?this:t,e.concat(Array.prototype.slice.call(arguments)))};return i.prototype=this.prototype,r.prototype=new i,r}),"SVGPathSeg"in window||(window.SVGPathSeg=function(t,e,n){this.pathSegType=t,this.pathSegTypeAsLetter=e,this._owningPathSegList=n},window.SVGPathSeg.prototype.classname="SVGPathSeg",window.SVGPathSeg.PATHSEG_UNKNOWN=0,window.SVGPathSeg.PATHSEG_CLOSEPATH=1,window.SVGPathSeg.PATHSEG_MOVETO_ABS=2,window.SVGPathSeg.PATHSEG_MOVETO_REL=3,window.SVGPathSeg.PATHSEG_LINETO_ABS=4,window.SVGPathSeg.PATHSEG_LINETO_REL=5,window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_ABS=6,window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_REL=7,window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_ABS=8,window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_REL=9,window.SVGPathSeg.PATHSEG_ARC_ABS=10,window.SVGPathSeg.PATHSEG_ARC_REL=11,window.SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_ABS=12,window.SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_REL=13,window.SVGPathSeg.PATHSEG_LINETO_VERTICAL_ABS=14,window.SVGPathSeg.PATHSEG_LINETO_VERTICAL_REL=15,window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_ABS=16,window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_REL=17,window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_ABS=18,window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_REL=19,window.SVGPathSeg.prototype._segmentChanged=function(){this._owningPathSegList&&this._owningPathSegList.segmentChanged(this)},window.SVGPathSegClosePath=function(t){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_CLOSEPATH,"z",t)},window.SVGPathSegClosePath.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegClosePath.prototype.toString=function(){return"[object SVGPathSegClosePath]"},window.SVGPathSegClosePath.prototype._asPathString=function(){return this.pathSegTypeAsLetter},window.SVGPathSegClosePath.prototype.clone=function(){return new window.SVGPathSegClosePath(void 0)},window.SVGPathSegMovetoAbs=function(t,e,n){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_MOVETO_ABS,"M",t),this._x=e,this._y=n},window.SVGPathSegMovetoAbs.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegMovetoAbs.prototype.toString=function(){return"[object SVGPathSegMovetoAbs]"},window.SVGPathSegMovetoAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x+" "+this._y},window.SVGPathSegMovetoAbs.prototype.clone=function(){return new window.SVGPathSegMovetoAbs(void 0,this._x,this._y)},Object.defineProperty(window.SVGPathSegMovetoAbs.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegMovetoAbs.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this._segmentChanged()},enumerable:!0}),window.SVGPathSegMovetoRel=function(t,e,n){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_MOVETO_REL,"m",t),this._x=e,this._y=n},window.SVGPathSegMovetoRel.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegMovetoRel.prototype.toString=function(){return"[object SVGPathSegMovetoRel]"},window.SVGPathSegMovetoRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x+" "+this._y},window.SVGPathSegMovetoRel.prototype.clone=function(){return new window.SVGPathSegMovetoRel(void 0,this._x,this._y)},Object.defineProperty(window.SVGPathSegMovetoRel.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegMovetoRel.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this._segmentChanged()},enumerable:!0}),window.SVGPathSegLinetoAbs=function(t,e,n){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_LINETO_ABS,"L",t),this._x=e,this._y=n},window.SVGPathSegLinetoAbs.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegLinetoAbs.prototype.toString=function(){return"[object SVGPathSegLinetoAbs]"},window.SVGPathSegLinetoAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x+" "+this._y},window.SVGPathSegLinetoAbs.prototype.clone=function(){return new window.SVGPathSegLinetoAbs(void 0,this._x,this._y)},Object.defineProperty(window.SVGPathSegLinetoAbs.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegLinetoAbs.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this._segmentChanged()},enumerable:!0}),window.SVGPathSegLinetoRel=function(t,e,n){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_LINETO_REL,"l",t),this._x=e,this._y=n},window.SVGPathSegLinetoRel.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegLinetoRel.prototype.toString=function(){return"[object SVGPathSegLinetoRel]"},window.SVGPathSegLinetoRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x+" "+this._y},window.SVGPathSegLinetoRel.prototype.clone=function(){return new window.SVGPathSegLinetoRel(void 0,this._x,this._y)},Object.defineProperty(window.SVGPathSegLinetoRel.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegLinetoRel.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this._segmentChanged()},enumerable:!0}),window.SVGPathSegCurvetoCubicAbs=function(t,e,n,i,r,o,a){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_ABS,"C",t),this._x=e,this._y=n,this._x1=i,this._y1=r,this._x2=o,this._y2=a},window.SVGPathSegCurvetoCubicAbs.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegCurvetoCubicAbs.prototype.toString=function(){return"[object SVGPathSegCurvetoCubicAbs]"},window.SVGPathSegCurvetoCubicAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x1+" "+this._y1+" "+this._x2+" "+this._y2+" "+this._x+" "+this._y},window.SVGPathSegCurvetoCubicAbs.prototype.clone=function(){return new window.SVGPathSegCurvetoCubicAbs(void 0,this._x,this._y,this._x1,this._y1,this._x2,this._y2)},Object.defineProperty(window.SVGPathSegCurvetoCubicAbs.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicAbs.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicAbs.prototype,"x1",{get:function(){return this._x1},set:function(t){this._x1=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicAbs.prototype,"y1",{get:function(){return this._y1},set:function(t){this._y1=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicAbs.prototype,"x2",{get:function(){return this._x2},set:function(t){this._x2=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicAbs.prototype,"y2",{get:function(){return this._y2},set:function(t){this._y2=t,this._segmentChanged()},enumerable:!0}),window.SVGPathSegCurvetoCubicRel=function(t,e,n,i,r,o,a){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_REL,"c",t),this._x=e,this._y=n,this._x1=i,this._y1=r,this._x2=o,this._y2=a},window.SVGPathSegCurvetoCubicRel.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegCurvetoCubicRel.prototype.toString=function(){return"[object SVGPathSegCurvetoCubicRel]"},window.SVGPathSegCurvetoCubicRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x1+" "+this._y1+" "+this._x2+" "+this._y2+" "+this._x+" "+this._y},window.SVGPathSegCurvetoCubicRel.prototype.clone=function(){return new window.SVGPathSegCurvetoCubicRel(void 0,this._x,this._y,this._x1,this._y1,this._x2,this._y2)},Object.defineProperty(window.SVGPathSegCurvetoCubicRel.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicRel.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicRel.prototype,"x1",{get:function(){return this._x1},set:function(t){this._x1=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicRel.prototype,"y1",{get:function(){return this._y1},set:function(t){this._y1=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicRel.prototype,"x2",{get:function(){return this._x2},set:function(t){this._x2=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicRel.prototype,"y2",{get:function(){return this._y2},set:function(t){this._y2=t,this._segmentChanged()},enumerable:!0}),window.SVGPathSegCurvetoQuadraticAbs=function(t,e,n,i,r){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_ABS,"Q",t),this._x=e,this._y=n,this._x1=i,this._y1=r},window.SVGPathSegCurvetoQuadraticAbs.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegCurvetoQuadraticAbs.prototype.toString=function(){return"[object SVGPathSegCurvetoQuadraticAbs]"},window.SVGPathSegCurvetoQuadraticAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x1+" "+this._y1+" "+this._x+" "+this._y},window.SVGPathSegCurvetoQuadraticAbs.prototype.clone=function(){return new window.SVGPathSegCurvetoQuadraticAbs(void 0,this._x,this._y,this._x1,this._y1)},Object.defineProperty(window.SVGPathSegCurvetoQuadraticAbs.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoQuadraticAbs.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoQuadraticAbs.prototype,"x1",{get:function(){return this._x1},set:function(t){this._x1=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoQuadraticAbs.prototype,"y1",{get:function(){return this._y1},set:function(t){this._y1=t,this._segmentChanged()},enumerable:!0}),window.SVGPathSegCurvetoQuadraticRel=function(t,e,n,i,r){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_REL,"q",t),this._x=e,this._y=n,this._x1=i,this._y1=r},window.SVGPathSegCurvetoQuadraticRel.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegCurvetoQuadraticRel.prototype.toString=function(){return"[object SVGPathSegCurvetoQuadraticRel]"},window.SVGPathSegCurvetoQuadraticRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x1+" "+this._y1+" "+this._x+" "+this._y},window.SVGPathSegCurvetoQuadraticRel.prototype.clone=function(){return new window.SVGPathSegCurvetoQuadraticRel(void 0,this._x,this._y,this._x1,this._y1)},Object.defineProperty(window.SVGPathSegCurvetoQuadraticRel.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoQuadraticRel.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoQuadraticRel.prototype,"x1",{get:function(){return this._x1},set:function(t){this._x1=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoQuadraticRel.prototype,"y1",{get:function(){return this._y1},set:function(t){this._y1=t,this._segmentChanged()},enumerable:!0}),window.SVGPathSegArcAbs=function(t,e,n,i,r,o,a,s){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_ARC_ABS,"A",t),this._x=e,this._y=n,this._r1=i,this._r2=r,this._angle=o,this._largeArcFlag=a,this._sweepFlag=s},window.SVGPathSegArcAbs.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegArcAbs.prototype.toString=function(){return"[object SVGPathSegArcAbs]"},window.SVGPathSegArcAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._r1+" "+this._r2+" "+this._angle+" "+(this._largeArcFlag?"1":"0")+" "+(this._sweepFlag?"1":"0")+" "+this._x+" "+this._y},window.SVGPathSegArcAbs.prototype.clone=function(){return new window.SVGPathSegArcAbs(void 0,this._x,this._y,this._r1,this._r2,this._angle,this._largeArcFlag,this._sweepFlag)},Object.defineProperty(window.SVGPathSegArcAbs.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegArcAbs.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegArcAbs.prototype,"r1",{get:function(){return this._r1},set:function(t){this._r1=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegArcAbs.prototype,"r2",{get:function(){return this._r2},set:function(t){this._r2=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegArcAbs.prototype,"angle",{get:function(){return this._angle},set:function(t){this._angle=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegArcAbs.prototype,"largeArcFlag",{get:function(){return this._largeArcFlag},set:function(t){this._largeArcFlag=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegArcAbs.prototype,"sweepFlag",{get:function(){return this._sweepFlag},set:function(t){this._sweepFlag=t,this._segmentChanged()},enumerable:!0}),window.SVGPathSegArcRel=function(t,e,n,i,r,o,a,s){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_ARC_REL,"a",t),this._x=e,this._y=n,this._r1=i,this._r2=r,this._angle=o,this._largeArcFlag=a,this._sweepFlag=s},window.SVGPathSegArcRel.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegArcRel.prototype.toString=function(){return"[object SVGPathSegArcRel]"},window.SVGPathSegArcRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._r1+" "+this._r2+" "+this._angle+" "+(this._largeArcFlag?"1":"0")+" "+(this._sweepFlag?"1":"0")+" "+this._x+" "+this._y},window.SVGPathSegArcRel.prototype.clone=function(){return new window.SVGPathSegArcRel(void 0,this._x,this._y,this._r1,this._r2,this._angle,this._largeArcFlag,this._sweepFlag)},Object.defineProperty(window.SVGPathSegArcRel.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegArcRel.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegArcRel.prototype,"r1",{get:function(){return this._r1},set:function(t){this._r1=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegArcRel.prototype,"r2",{get:function(){return this._r2},set:function(t){this._r2=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegArcRel.prototype,"angle",{get:function(){return this._angle},set:function(t){this._angle=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegArcRel.prototype,"largeArcFlag",{get:function(){return this._largeArcFlag},set:function(t){this._largeArcFlag=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegArcRel.prototype,"sweepFlag",{get:function(){return this._sweepFlag},set:function(t){this._sweepFlag=t,this._segmentChanged()},enumerable:!0}),window.SVGPathSegLinetoHorizontalAbs=function(t,e){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_ABS,"H",t),this._x=e},window.SVGPathSegLinetoHorizontalAbs.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegLinetoHorizontalAbs.prototype.toString=function(){return"[object SVGPathSegLinetoHorizontalAbs]"},window.SVGPathSegLinetoHorizontalAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x},window.SVGPathSegLinetoHorizontalAbs.prototype.clone=function(){return new window.SVGPathSegLinetoHorizontalAbs(void 0,this._x)},Object.defineProperty(window.SVGPathSegLinetoHorizontalAbs.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this._segmentChanged()},enumerable:!0}),window.SVGPathSegLinetoHorizontalRel=function(t,e){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_REL,"h",t),this._x=e},window.SVGPathSegLinetoHorizontalRel.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegLinetoHorizontalRel.prototype.toString=function(){return"[object SVGPathSegLinetoHorizontalRel]"},window.SVGPathSegLinetoHorizontalRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x},window.SVGPathSegLinetoHorizontalRel.prototype.clone=function(){return new window.SVGPathSegLinetoHorizontalRel(void 0,this._x)},Object.defineProperty(window.SVGPathSegLinetoHorizontalRel.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this._segmentChanged()},enumerable:!0}),window.SVGPathSegLinetoVerticalAbs=function(t,e){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_LINETO_VERTICAL_ABS,"V",t),this._y=e},window.SVGPathSegLinetoVerticalAbs.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegLinetoVerticalAbs.prototype.toString=function(){return"[object SVGPathSegLinetoVerticalAbs]"},window.SVGPathSegLinetoVerticalAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._y},window.SVGPathSegLinetoVerticalAbs.prototype.clone=function(){return new window.SVGPathSegLinetoVerticalAbs(void 0,this._y)},Object.defineProperty(window.SVGPathSegLinetoVerticalAbs.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this._segmentChanged()},enumerable:!0}),window.SVGPathSegLinetoVerticalRel=function(t,e){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_LINETO_VERTICAL_REL,"v",t),this._y=e},window.SVGPathSegLinetoVerticalRel.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegLinetoVerticalRel.prototype.toString=function(){return"[object SVGPathSegLinetoVerticalRel]"},window.SVGPathSegLinetoVerticalRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._y},window.SVGPathSegLinetoVerticalRel.prototype.clone=function(){return new window.SVGPathSegLinetoVerticalRel(void 0,this._y)},Object.defineProperty(window.SVGPathSegLinetoVerticalRel.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this._segmentChanged()},enumerable:!0}),window.SVGPathSegCurvetoCubicSmoothAbs=function(t,e,n,i,r){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_ABS,"S",t),this._x=e,this._y=n,this._x2=i,this._y2=r},window.SVGPathSegCurvetoCubicSmoothAbs.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegCurvetoCubicSmoothAbs.prototype.toString=function(){return"[object SVGPathSegCurvetoCubicSmoothAbs]"},window.SVGPathSegCurvetoCubicSmoothAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x2+" "+this._y2+" "+this._x+" "+this._y},window.SVGPathSegCurvetoCubicSmoothAbs.prototype.clone=function(){return new window.SVGPathSegCurvetoCubicSmoothAbs(void 0,this._x,this._y,this._x2,this._y2)},Object.defineProperty(window.SVGPathSegCurvetoCubicSmoothAbs.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicSmoothAbs.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicSmoothAbs.prototype,"x2",{get:function(){return this._x2},set:function(t){this._x2=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicSmoothAbs.prototype,"y2",{get:function(){return this._y2},set:function(t){this._y2=t,this._segmentChanged()},enumerable:!0}),window.SVGPathSegCurvetoCubicSmoothRel=function(t,e,n,i,r){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_REL,"s",t),this._x=e,this._y=n,this._x2=i,this._y2=r},window.SVGPathSegCurvetoCubicSmoothRel.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegCurvetoCubicSmoothRel.prototype.toString=function(){return"[object SVGPathSegCurvetoCubicSmoothRel]"},window.SVGPathSegCurvetoCubicSmoothRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x2+" "+this._y2+" "+this._x+" "+this._y},window.SVGPathSegCurvetoCubicSmoothRel.prototype.clone=function(){return new window.SVGPathSegCurvetoCubicSmoothRel(void 0,this._x,this._y,this._x2,this._y2)},Object.defineProperty(window.SVGPathSegCurvetoCubicSmoothRel.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicSmoothRel.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicSmoothRel.prototype,"x2",{get:function(){return this._x2},set:function(t){this._x2=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoCubicSmoothRel.prototype,"y2",{get:function(){return this._y2},set:function(t){this._y2=t,this._segmentChanged()},enumerable:!0}),window.SVGPathSegCurvetoQuadraticSmoothAbs=function(t,e,n){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_ABS,"T",t),this._x=e,this._y=n},window.SVGPathSegCurvetoQuadraticSmoothAbs.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegCurvetoQuadraticSmoothAbs.prototype.toString=function(){return"[object SVGPathSegCurvetoQuadraticSmoothAbs]"},window.SVGPathSegCurvetoQuadraticSmoothAbs.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x+" "+this._y},window.SVGPathSegCurvetoQuadraticSmoothAbs.prototype.clone=function(){return new window.SVGPathSegCurvetoQuadraticSmoothAbs(void 0,this._x,this._y)},Object.defineProperty(window.SVGPathSegCurvetoQuadraticSmoothAbs.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoQuadraticSmoothAbs.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this._segmentChanged()},enumerable:!0}),window.SVGPathSegCurvetoQuadraticSmoothRel=function(t,e,n){window.SVGPathSeg.call(this,window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_REL,"t",t),this._x=e,this._y=n},window.SVGPathSegCurvetoQuadraticSmoothRel.prototype=Object.create(window.SVGPathSeg.prototype),window.SVGPathSegCurvetoQuadraticSmoothRel.prototype.toString=function(){return"[object SVGPathSegCurvetoQuadraticSmoothRel]"},window.SVGPathSegCurvetoQuadraticSmoothRel.prototype._asPathString=function(){return this.pathSegTypeAsLetter+" "+this._x+" "+this._y},window.SVGPathSegCurvetoQuadraticSmoothRel.prototype.clone=function(){return new window.SVGPathSegCurvetoQuadraticSmoothRel(void 0,this._x,this._y)},Object.defineProperty(window.SVGPathSegCurvetoQuadraticSmoothRel.prototype,"x",{get:function(){return this._x},set:function(t){this._x=t,this._segmentChanged()},enumerable:!0}),Object.defineProperty(window.SVGPathSegCurvetoQuadraticSmoothRel.prototype,"y",{get:function(){return this._y},set:function(t){this._y=t,this._segmentChanged()},enumerable:!0}),window.SVGPathElement.prototype.createSVGPathSegClosePath=function(){return new window.SVGPathSegClosePath(void 0)},window.SVGPathElement.prototype.createSVGPathSegMovetoAbs=function(t,e){return new window.SVGPathSegMovetoAbs(void 0,t,e)},window.SVGPathElement.prototype.createSVGPathSegMovetoRel=function(t,e){return new window.SVGPathSegMovetoRel(void 0,t,e)},window.SVGPathElement.prototype.createSVGPathSegLinetoAbs=function(t,e){return new window.SVGPathSegLinetoAbs(void 0,t,e)},window.SVGPathElement.prototype.createSVGPathSegLinetoRel=function(t,e){return new window.SVGPathSegLinetoRel(void 0,t,e)},window.SVGPathElement.prototype.createSVGPathSegCurvetoCubicAbs=function(t,e,n,i,r,o){return new window.SVGPathSegCurvetoCubicAbs(void 0,t,e,n,i,r,o)},window.SVGPathElement.prototype.createSVGPathSegCurvetoCubicRel=function(t,e,n,i,r,o){return new window.SVGPathSegCurvetoCubicRel(void 0,t,e,n,i,r,o)},window.SVGPathElement.prototype.createSVGPathSegCurvetoQuadraticAbs=function(t,e,n,i){return new window.SVGPathSegCurvetoQuadraticAbs(void 0,t,e,n,i)},window.SVGPathElement.prototype.createSVGPathSegCurvetoQuadraticRel=function(t,e,n,i){return new window.SVGPathSegCurvetoQuadraticRel(void 0,t,e,n,i)},window.SVGPathElement.prototype.createSVGPathSegArcAbs=function(t,e,n,i,r,o,a){return new window.SVGPathSegArcAbs(void 0,t,e,n,i,r,o,a)},window.SVGPathElement.prototype.createSVGPathSegArcRel=function(t,e,n,i,r,o,a){return new window.SVGPathSegArcRel(void 0,t,e,n,i,r,o,a)},window.SVGPathElement.prototype.createSVGPathSegLinetoHorizontalAbs=function(t){return new window.SVGPathSegLinetoHorizontalAbs(void 0,t)},window.SVGPathElement.prototype.createSVGPathSegLinetoHorizontalRel=function(t){return new window.SVGPathSegLinetoHorizontalRel(void 0,t)},window.SVGPathElement.prototype.createSVGPathSegLinetoVerticalAbs=function(t){return new window.SVGPathSegLinetoVerticalAbs(void 0,t)},window.SVGPathElement.prototype.createSVGPathSegLinetoVerticalRel=function(t){return new window.SVGPathSegLinetoVerticalRel(void 0,t)},window.SVGPathElement.prototype.createSVGPathSegCurvetoCubicSmoothAbs=function(t,e,n,i){return new window.SVGPathSegCurvetoCubicSmoothAbs(void 0,t,e,n,i)},window.SVGPathElement.prototype.createSVGPathSegCurvetoCubicSmoothRel=function(t,e,n,i){return new window.SVGPathSegCurvetoCubicSmoothRel(void 0,t,e,n,i)},window.SVGPathElement.prototype.createSVGPathSegCurvetoQuadraticSmoothAbs=function(t,e){return new window.SVGPathSegCurvetoQuadraticSmoothAbs(void 0,t,e)},window.SVGPathElement.prototype.createSVGPathSegCurvetoQuadraticSmoothRel=function(t,e){return new window.SVGPathSegCurvetoQuadraticSmoothRel(void 0,t,e)},"getPathSegAtLength"in window.SVGPathElement.prototype||(window.SVGPathElement.prototype.getPathSegAtLength=function(t){if(void 0===t||!isFinite(t))throw"Invalid arguments.";var e=document.createElementNS("http://www.w3.org/2000/svg","path");e.setAttribute("d",this.getAttribute("d"));var n=e.pathSegList.numberOfItems-1;if(n<=0)return 0;do{if(e.pathSegList.removeItem(n),t>e.getTotalLength())break;n--}while(n>0);return n})),"SVGPathSegList"in window||(window.SVGPathSegList=function(t){this._pathElement=t,this._list=this._parsePath(this._pathElement.getAttribute("d")),this._mutationObserverConfig={attributes:!0,attributeFilter:["d"]},this._pathElementMutationObserver=new MutationObserver(this._updateListFromPathMutations.bind(this)),this._pathElementMutationObserver.observe(this._pathElement,this._mutationObserverConfig)},window.SVGPathSegList.prototype.classname="SVGPathSegList",Object.defineProperty(window.SVGPathSegList.prototype,"numberOfItems",{get:function(){return this._checkPathSynchronizedToList(),this._list.length},enumerable:!0}),Object.defineProperty(window.SVGPathElement.prototype,"pathSegList",{get:function(){return this._pathSegList||(this._pathSegList=new window.SVGPathSegList(this)),this._pathSegList},enumerable:!0}),Object.defineProperty(window.SVGPathElement.prototype,"normalizedPathSegList",{get:function(){return this.pathSegList},enumerable:!0}),Object.defineProperty(window.SVGPathElement.prototype,"animatedPathSegList",{get:function(){return this.pathSegList},enumerable:!0}),Object.defineProperty(window.SVGPathElement.prototype,"animatedNormalizedPathSegList",{get:function(){return this.pathSegList},enumerable:!0}),window.SVGPathSegList.prototype._checkPathSynchronizedToList=function(){this._updateListFromPathMutations(this._pathElementMutationObserver.takeRecords())},window.SVGPathSegList.prototype._updateListFromPathMutations=function(t){if(this._pathElement){var e=!1;t.forEach(function(t){"d"==t.attributeName&&(e=!0)}),e&&(this._list=this._parsePath(this._pathElement.getAttribute("d")))}},window.SVGPathSegList.prototype._writeListToPath=function(){this._pathElementMutationObserver.disconnect(),this._pathElement.setAttribute("d",window.SVGPathSegList._pathSegArrayAsString(this._list)),this._pathElementMutationObserver.observe(this._pathElement,this._mutationObserverConfig)},window.SVGPathSegList.prototype.segmentChanged=function(t){this._writeListToPath()},window.SVGPathSegList.prototype.clear=function(){this._checkPathSynchronizedToList(),this._list.forEach(function(t){t._owningPathSegList=null}),this._list=[],this._writeListToPath()},window.SVGPathSegList.prototype.initialize=function(t){return this._checkPathSynchronizedToList(),this._list=[t],t._owningPathSegList=this,this._writeListToPath(),t},window.SVGPathSegList.prototype._checkValidIndex=function(t){if(isNaN(t)||t<0||t>=this.numberOfItems)throw"INDEX_SIZE_ERR"},window.SVGPathSegList.prototype.getItem=function(t){return this._checkPathSynchronizedToList(),this._checkValidIndex(t),this._list[t]},window.SVGPathSegList.prototype.insertItemBefore=function(t,e){return this._checkPathSynchronizedToList(),e>this.numberOfItems&&(e=this.numberOfItems),t._owningPathSegList&&(t=t.clone()),this._list.splice(e,0,t),t._owningPathSegList=this,this._writeListToPath(),t},window.SVGPathSegList.prototype.replaceItem=function(t,e){return this._checkPathSynchronizedToList(),t._owningPathSegList&&(t=t.clone()),this._checkValidIndex(e),this._list[e]=t,t._owningPathSegList=this,this._writeListToPath(),t},window.SVGPathSegList.prototype.removeItem=function(t){this._checkPathSynchronizedToList(),this._checkValidIndex(t);var e=this._list[t];return this._list.splice(t,1),this._writeListToPath(),e},window.SVGPathSegList.prototype.appendItem=function(t){return this._checkPathSynchronizedToList(),t._owningPathSegList&&(t=t.clone()),this._list.push(t),t._owningPathSegList=this,this._writeListToPath(),t},window.SVGPathSegList._pathSegArrayAsString=function(t){var e="",n=!0;return t.forEach(function(t){n?(n=!1,e+=t._asPathString()):e+=" "+t._asPathString()}),e},window.SVGPathSegList.prototype._parsePath=function(t){if(!t||0==t.length)return[];var e=this,n=function(){this.pathSegList=[]};n.prototype.appendSegment=function(t){this.pathSegList.push(t)};var i=function(t){this._string=t,this._currentIndex=0,this._endIndex=this._string.length,this._previousCommand=window.SVGPathSeg.PATHSEG_UNKNOWN,this._skipOptionalSpaces()};i.prototype._isCurrentSpace=function(){var t=this._string[this._currentIndex];return t<=" "&&(" "==t||"\n"==t||"\t"==t||"\r"==t||"\f"==t)},i.prototype._skipOptionalSpaces=function(){for(;this._currentIndex<this._endIndex&&this._isCurrentSpace();)this._currentIndex++;return this._currentIndex<this._endIndex},i.prototype._skipOptionalSpacesOrDelimiter=function(){return!(this._currentIndex<this._endIndex&&!this._isCurrentSpace()&&","!=this._string.charAt(this._currentIndex))&&(this._skipOptionalSpaces()&&this._currentIndex<this._endIndex&&","==this._string.charAt(this._currentIndex)&&(this._currentIndex++,this._skipOptionalSpaces()),this._currentIndex<this._endIndex)},i.prototype.hasMoreData=function(){return this._currentIndex<this._endIndex},i.prototype.peekSegmentType=function(){var t=this._string[this._currentIndex];return this._pathSegTypeFromChar(t)},i.prototype._pathSegTypeFromChar=function(t){switch(t){case"Z":case"z":return window.SVGPathSeg.PATHSEG_CLOSEPATH;case"M":return window.SVGPathSeg.PATHSEG_MOVETO_ABS;case"m":return window.SVGPathSeg.PATHSEG_MOVETO_REL;case"L":return window.SVGPathSeg.PATHSEG_LINETO_ABS;case"l":return window.SVGPathSeg.PATHSEG_LINETO_REL;case"C":return window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_ABS;case"c":return window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_REL;case"Q":return window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_ABS;case"q":return window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_REL;case"A":return window.SVGPathSeg.PATHSEG_ARC_ABS;case"a":return window.SVGPathSeg.PATHSEG_ARC_REL;case"H":return window.SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_ABS;case"h":return window.SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_REL;case"V":return window.SVGPathSeg.PATHSEG_LINETO_VERTICAL_ABS;case"v":return window.SVGPathSeg.PATHSEG_LINETO_VERTICAL_REL;case"S":return window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_ABS;case"s":return window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_REL;case"T":return window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_ABS;case"t":return window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_REL;default:return window.SVGPathSeg.PATHSEG_UNKNOWN}},i.prototype._nextCommandHelper=function(t,e){return("+"==t||"-"==t||"."==t||t>="0"&&t<="9")&&e!=window.SVGPathSeg.PATHSEG_CLOSEPATH?e==window.SVGPathSeg.PATHSEG_MOVETO_ABS?window.SVGPathSeg.PATHSEG_LINETO_ABS:e==window.SVGPathSeg.PATHSEG_MOVETO_REL?window.SVGPathSeg.PATHSEG_LINETO_REL:e:window.SVGPathSeg.PATHSEG_UNKNOWN},i.prototype.initialCommandIsMoveTo=function(){if(!this.hasMoreData())return!0;var t=this.peekSegmentType();return t==window.SVGPathSeg.PATHSEG_MOVETO_ABS||t==window.SVGPathSeg.PATHSEG_MOVETO_REL},i.prototype._parseNumber=function(){var t=0,e=0,n=1,i=0,r=1,o=1,a=this._currentIndex;if(this._skipOptionalSpaces(),this._currentIndex<this._endIndex&&"+"==this._string.charAt(this._currentIndex)?this._currentIndex++:this._currentIndex<this._endIndex&&"-"==this._string.charAt(this._currentIndex)&&(this._currentIndex++,r=-1),!(this._currentIndex==this._endIndex||(this._string.charAt(this._currentIndex)<"0"||this._string.charAt(this._currentIndex)>"9")&&"."!=this._string.charAt(this._currentIndex))){for(var s=this._currentIndex;this._currentIndex<this._endIndex&&this._string.charAt(this._currentIndex)>="0"&&this._string.charAt(this._currentIndex)<="9";)this._currentIndex++;if(this._currentIndex!=s)for(var l=this._currentIndex-1,u=1;l>=s;)e+=u*(this._string.charAt(l--)-"0"),u*=10;if(this._currentIndex<this._endIndex&&"."==this._string.charAt(this._currentIndex)){if(this._currentIndex++,this._currentIndex>=this._endIndex||this._string.charAt(this._currentIndex)<"0"||this._string.charAt(this._currentIndex)>"9")return;for(;this._currentIndex<this._endIndex&&this._string.charAt(this._currentIndex)>="0"&&this._string.charAt(this._currentIndex)<="9";)n*=10,i+=(this._string.charAt(this._currentIndex)-"0")/n,this._currentIndex+=1}if(this._currentIndex!=a&&this._currentIndex+1<this._endIndex&&("e"==this._string.charAt(this._currentIndex)||"E"==this._string.charAt(this._currentIndex))&&"x"!=this._string.charAt(this._currentIndex+1)&&"m"!=this._string.charAt(this._currentIndex+1)){if(this._currentIndex++,"+"==this._string.charAt(this._currentIndex)?this._currentIndex++:"-"==this._string.charAt(this._currentIndex)&&(this._currentIndex++,o=-1),this._currentIndex>=this._endIndex||this._string.charAt(this._currentIndex)<"0"||this._string.charAt(this._currentIndex)>"9")return;for(;this._currentIndex<this._endIndex&&this._string.charAt(this._currentIndex)>="0"&&this._string.charAt(this._currentIndex)<="9";)t*=10,t+=this._string.charAt(this._currentIndex)-"0",this._currentIndex++}var c=e+i;if(c*=r,t&&(c*=Math.pow(10,o*t)),a!=this._currentIndex)return this._skipOptionalSpacesOrDelimiter(),c}},i.prototype._parseArcFlag=function(){if(!(this._currentIndex>=this._endIndex)){var t=!1,e=this._string.charAt(this._currentIndex++);if("0"==e)t=!1;else{if("1"!=e)return;t=!0}return this._skipOptionalSpacesOrDelimiter(),t}},i.prototype.parseSegment=function(){var t=this._string[this._currentIndex],n=this._pathSegTypeFromChar(t);if(n==window.SVGPathSeg.PATHSEG_UNKNOWN){if(this._previousCommand==window.SVGPathSeg.PATHSEG_UNKNOWN)return null;if((n=this._nextCommandHelper(t,this._previousCommand))==window.SVGPathSeg.PATHSEG_UNKNOWN)return null}else this._currentIndex++;switch(this._previousCommand=n,n){case window.SVGPathSeg.PATHSEG_MOVETO_REL:return new window.SVGPathSegMovetoRel(e,this._parseNumber(),this._parseNumber());case window.SVGPathSeg.PATHSEG_MOVETO_ABS:return new window.SVGPathSegMovetoAbs(e,this._parseNumber(),this._parseNumber());case window.SVGPathSeg.PATHSEG_LINETO_REL:return new window.SVGPathSegLinetoRel(e,this._parseNumber(),this._parseNumber());case window.SVGPathSeg.PATHSEG_LINETO_ABS:return new window.SVGPathSegLinetoAbs(e,this._parseNumber(),this._parseNumber());case window.SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_REL:return new window.SVGPathSegLinetoHorizontalRel(e,this._parseNumber());case window.SVGPathSeg.PATHSEG_LINETO_HORIZONTAL_ABS:return new window.SVGPathSegLinetoHorizontalAbs(e,this._parseNumber());case window.SVGPathSeg.PATHSEG_LINETO_VERTICAL_REL:return new window.SVGPathSegLinetoVerticalRel(e,this._parseNumber());case window.SVGPathSeg.PATHSEG_LINETO_VERTICAL_ABS:return new window.SVGPathSegLinetoVerticalAbs(e,this._parseNumber());case window.SVGPathSeg.PATHSEG_CLOSEPATH:return this._skipOptionalSpaces(),new window.SVGPathSegClosePath(e);case window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_REL:i={x1:this._parseNumber(),y1:this._parseNumber(),x2:this._parseNumber(),y2:this._parseNumber(),x:this._parseNumber(),y:this._parseNumber()};return new window.SVGPathSegCurvetoCubicRel(e,i.x,i.y,i.x1,i.y1,i.x2,i.y2);case window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_ABS:i={x1:this._parseNumber(),y1:this._parseNumber(),x2:this._parseNumber(),y2:this._parseNumber(),x:this._parseNumber(),y:this._parseNumber()};return new window.SVGPathSegCurvetoCubicAbs(e,i.x,i.y,i.x1,i.y1,i.x2,i.y2);case window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_REL:i={x2:this._parseNumber(),y2:this._parseNumber(),x:this._parseNumber(),y:this._parseNumber()};return new window.SVGPathSegCurvetoCubicSmoothRel(e,i.x,i.y,i.x2,i.y2);case window.SVGPathSeg.PATHSEG_CURVETO_CUBIC_SMOOTH_ABS:i={x2:this._parseNumber(),y2:this._parseNumber(),x:this._parseNumber(),y:this._parseNumber()};return new window.SVGPathSegCurvetoCubicSmoothAbs(e,i.x,i.y,i.x2,i.y2);case window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_REL:i={x1:this._parseNumber(),y1:this._parseNumber(),x:this._parseNumber(),y:this._parseNumber()};return new window.SVGPathSegCurvetoQuadraticRel(e,i.x,i.y,i.x1,i.y1);case window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_ABS:i={x1:this._parseNumber(),y1:this._parseNumber(),x:this._parseNumber(),y:this._parseNumber()};return new window.SVGPathSegCurvetoQuadraticAbs(e,i.x,i.y,i.x1,i.y1);case window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_REL:return new window.SVGPathSegCurvetoQuadraticSmoothRel(e,this._parseNumber(),this._parseNumber());case window.SVGPathSeg.PATHSEG_CURVETO_QUADRATIC_SMOOTH_ABS:return new window.SVGPathSegCurvetoQuadraticSmoothAbs(e,this._parseNumber(),this._parseNumber());case window.SVGPathSeg.PATHSEG_ARC_REL:i={x1:this._parseNumber(),y1:this._parseNumber(),arcAngle:this._parseNumber(),arcLarge:this._parseArcFlag(),arcSweep:this._parseArcFlag(),x:this._parseNumber(),y:this._parseNumber()};return new window.SVGPathSegArcRel(e,i.x,i.y,i.x1,i.y1,i.arcAngle,i.arcLarge,i.arcSweep);case window.SVGPathSeg.PATHSEG_ARC_ABS:var i={x1:this._parseNumber(),y1:this._parseNumber(),arcAngle:this._parseNumber(),arcLarge:this._parseArcFlag(),arcSweep:this._parseArcFlag(),x:this._parseNumber(),y:this._parseNumber()};return new window.SVGPathSegArcAbs(e,i.x,i.y,i.x1,i.y1,i.arcAngle,i.arcLarge,i.arcSweep);default:throw"Unknown path seg type."}};var r=new n,o=new i(t);if(!o.initialCommandIsMoveTo())return[];for(;o.hasMoreData();){var a=o.parseSegment();if(!a)return[];r.appendSegment(a)}return r.pathSegList}),A.axis=function(){},A.axis.labels=function(t){var e=this.internal;arguments.length&&(Object.keys(t).forEach(function(n){e.axis.setLabelText(n,t[n])}),e.axis.updateLabels())},A.axis.max=function(t){var e=this.internal,n=e.config;if(!arguments.length)return{x:n.axis_x_max,y:n.axis_y_max,y2:n.axis_y2_max};"object"===(void 0===t?"undefined":s(t))?(h(t.x)&&(n.axis_x_max=t.x),h(t.y)&&(n.axis_y_max=t.y),h(t.y2)&&(n.axis_y2_max=t.y2)):n.axis_y_max=n.axis_y2_max=t,e.redraw({withUpdateOrgXDomain:!0,withUpdateXDomain:!0})},A.axis.min=function(t){var e=this.internal,n=e.config;if(!arguments.length)return{x:n.axis_x_min,y:n.axis_y_min,y2:n.axis_y2_min};"object"===(void 0===t?"undefined":s(t))?(h(t.x)&&(n.axis_x_min=t.x),h(t.y)&&(n.axis_y_min=t.y),h(t.y2)&&(n.axis_y2_min=t.y2)):n.axis_y_min=n.axis_y2_min=t,e.redraw({withUpdateOrgXDomain:!0,withUpdateXDomain:!0})},A.axis.range=function(t){if(!arguments.length)return{max:this.axis.max(),min:this.axis.min()};_(t.max)&&this.axis.max(t.max),_(t.min)&&this.axis.min(t.min)},A.category=function(t,e){var n=this.internal,i=n.config;return arguments.length>1&&(i.axis_x_categories[t]=e,n.redraw()),i.axis_x_categories[t]},A.categories=function(t){var e=this.internal,n=e.config;return arguments.length?(n.axis_x_categories=t,e.redraw(),n.axis_x_categories):n.axis_x_categories},A.resize=function(t){var e=this.internal.config;e.size_width=t?t.width:null,e.size_height=t?t.height:null,this.flush()},A.flush=function(){this.internal.updateAndRedraw({withLegend:!0,withTransition:!1,withTransitionForTransform:!1})},A.destroy=function(){var t=this.internal;if(window.clearInterval(t.intervalForObserveInserted),void 0!==t.resizeTimeout&&window.clearTimeout(t.resizeTimeout),window.detachEvent)window.detachEvent("onresize",t.resizeFunction);else if(window.removeEventListener)window.removeEventListener("resize",t.resizeFunction);else{var e=window.onresize;e&&e.add&&e.remove&&e.remove(t.resizeFunction)}return t.selectChart.classed("c3",!1).html(""),Object.keys(t).forEach(function(e){t[e]=null}),null},A.color=function(t){return this.internal.color(t)},A.data=function(t){var e=this.internal.data.targets;return void 0===t?e:e.filter(function(e){return[].concat(t).indexOf(e.id)>=0})},A.data.shown=function(t){return this.internal.filterTargetsToShow(this.data(t))},A.data.values=function(t){var e,n=null;return t&&(n=(e=this.data(t))[0]?e[0].values.map(function(t){return t.value}):null),n},A.data.names=function(t){return this.internal.clearLegendItemTextBoxCache(),this.internal.updateDataAttributes("names",t)},A.data.colors=function(t){return this.internal.updateDataAttributes("colors",t)},A.data.axes=function(t){return this.internal.updateDataAttributes("axes",t)},A.flow=function(t){var e,n,i,r,o,a,s,l=this.internal,u=[],c=l.getMaxDataCount(),d=0,f=0;if(t.json)n=l.convertJsonToData(t.json,t.keys);else if(t.rows)n=l.convertRowsToData(t.rows);else{if(!t.columns)return;n=l.convertColumnsToData(t.columns)}e=l.convertDataToTargets(n,!0),l.data.targets.forEach(function(t){var n,i,r=!1;for(n=0;n<e.length;n++)if(t.id===e[n].id){for(r=!0,t.values[t.values.length-1]&&(f=t.values[t.values.length-1].index+1),d=e[n].values.length,i=0;i<d;i++)e[n].values[i].index=f+i,l.isTimeSeries()||(e[n].values[i].x=f+i);t.values=t.values.concat(e[n].values),e.splice(n,1);break}r||u.push(t.id)}),l.data.targets.forEach(function(t){var e,n;for(e=0;e<u.length;e++)if(t.id===u[e])for(f=t.values[t.values.length-1].index+1,n=0;n<d;n++)t.values.push({id:t.id,index:f+n,x:l.isTimeSeries()?l.getOtherTargetX(f+n):f+n,value:null})}),l.data.targets.length&&e.forEach(function(t){var e,n=[];for(e=l.data.targets[0].values[0].index;e<f;e++)n.push({id:t.id,index:e,x:l.isTimeSeries()?l.getOtherTargetX(e):e,value:null});t.values.forEach(function(t){t.index+=f,l.isTimeSeries()||(t.x+=f)}),t.values=n.concat(t.values)}),l.data.targets=l.data.targets.concat(e),l.getMaxDataCount(),o=(r=l.data.targets[0]).values[0],_(t.to)?(d=0,s=l.isTimeSeries()?l.parseDate(t.to):t.to,r.values.forEach(function(t){t.x<s&&d++})):_(t.length)&&(d=t.length),c?1===c&&l.isTimeSeries()&&(a=(r.values[r.values.length-1].x-o.x)/2,i=[new Date(+o.x-a),new Date(+o.x+a)],l.updateXDomain(null,!0,!0,!1,i)):(a=l.isTimeSeries()?r.values.length>1?r.values[r.values.length-1].x-o.x:o.x-l.getXDomain(l.data.targets)[0]:1,i=[o.x-a,o.x],l.updateXDomain(null,!0,!0,!1,i)),l.updateTargets(l.data.targets),l.redraw({flow:{index:o.index,length:d,duration:h(t.duration)?t.duration:l.config.transition_duration,done:t.done,orgDataCount:c},withLegend:!0,withTransition:c>1,withTrimXDomain:!1,withUpdateXAxis:!0})},R.generateFlow=function(t){var e=this,n=e.config,i=e.d3;return function(){var r,o,s,l=t.targets,u=t.flow,c=t.drawBar,h=t.drawLine,d=t.drawArea,f=t.cx,p=t.cy,g=t.xv,_=t.xForText,v=t.yForText,y=t.duration,x=1,S=u.index,E=u.length,T=e.getValueOnIndex(e.data.targets[0].values,S),w=e.getValueOnIndex(e.data.targets[0].values,S+E),C=e.x.domain(),b=u.duration||y,A=u.done||function(){},R=e.generateWait(),L=e.xgrid||i.selectAll([]),I=e.xgridLines||i.selectAll([]),P=e.mainRegion||i.selectAll([]),M=e.mainText||i.selectAll([]),O=e.mainBar||i.selectAll([]),D=e.mainLine||i.selectAll([]),F=e.mainArea||i.selectAll([]),k=e.mainCircle||i.selectAll([]);e.flowing=!0,e.data.targets.forEach(function(t){t.values.splice(0,E)}),s=e.updateXDomain(l,!0,!0),e.updateXGrid&&e.updateXGrid(!0),u.orgDataCount?r=1===u.orgDataCount||(T&&T.x)===(w&&w.x)?e.x(C[0])-e.x(s[0]):e.isTimeSeries()?e.x(C[0])-e.x(s[0]):e.x(T.x)-e.x(w.x):1!==e.data.targets[0].values.length?r=e.x(C[0])-e.x(s[0]):e.isTimeSeries()?(T=e.getValueOnIndex(e.data.targets[0].values,0),w=e.getValueOnIndex(e.data.targets[0].values,e.data.targets[0].values.length-1),r=e.x(T.x)-e.x(w.x)):r=m(s)/2,x=m(C)/m(s),o="translate("+r+",0) scale("+x+",1)",e.hideXGridFocus(),i.transition().ease("linear").duration(b).each(function(){R.add(e.axes.x.transition().call(e.xAxis)),R.add(O.transition().attr("transform",o)),R.add(D.transition().attr("transform",o)),R.add(F.transition().attr("transform",o)),R.add(k.transition().attr("transform",o)),R.add(M.transition().attr("transform",o)),R.add(P.filter(e.isRegionOnX).transition().attr("transform",o)),R.add(L.transition().attr("transform",o)),R.add(I.transition().attr("transform",o))}).call(R,function(){var t,i=[],r=[],o=[];if(E){for(t=0;t<E;t++)i.push("."+a.shape+"-"+(S+t)),r.push("."+a.text+"-"+(S+t)),o.push("."+a.eventRect+"-"+(S+t));e.svg.selectAll("."+a.shapes).selectAll(i).remove(),e.svg.selectAll("."+a.texts).selectAll(r).remove(),e.svg.selectAll("."+a.eventRects).selectAll(o).remove(),e.svg.select("."+a.xgrid).remove()}L.attr("transform",null).attr(e.xgridAttr),I.attr("transform",null),I.select("line").attr("x1",n.axis_rotated?0:g).attr("x2",n.axis_rotated?e.width:g),I.select("text").attr("x",n.axis_rotated?e.width:0).attr("y",g),O.attr("transform",null).attr("d",c),D.attr("transform",null).attr("d",h),F.attr("transform",null).attr("d",d),k.attr("transform",null).attr("cx",f).attr("cy",p),M.attr("transform",null).attr("x",_).attr("y",v).style("fill-opacity",e.opacityForText.bind(e)),P.attr("transform",null),P.select("rect").filter(e.isRegionOnX).attr("x",e.regionX.bind(e)).attr("width",e.regionWidth.bind(e)),n.interaction_enabled&&e.redrawEventRect(),A(),e.flowing=!1})}},A.focus=function(t){var e,n=this.internal;t=n.mapToTargetIds(t),e=n.svg.selectAll(n.selectorTargets(t.filter(n.isTargetToShow,n))),this.revert(),this.defocus(),e.classed(a.focused,!0).classed(a.defocused,!1),n.hasArcType()&&n.expandArc(t),n.toggleFocusLegend(t,!0),n.focusedTargetIds=t,n.defocusedTargetIds=n.defocusedTargetIds.filter(function(e){return t.indexOf(e)<0})},A.defocus=function(t){var e=this.internal;t=e.mapToTargetIds(t),e.svg.selectAll(e.selectorTargets(t.filter(e.isTargetToShow,e))).classed(a.focused,!1).classed(a.defocused,!0),e.hasArcType()&&e.unexpandArc(t),e.toggleFocusLegend(t,!1),e.focusedTargetIds=e.focusedTargetIds.filter(function(e){return t.indexOf(e)<0}),e.defocusedTargetIds=t},A.revert=function(t){var e=this.internal;t=e.mapToTargetIds(t),e.svg.selectAll(e.selectorTargets(t)).classed(a.focused,!1).classed(a.defocused,!1),e.hasArcType()&&e.unexpandArc(t),e.config.legend_show&&(e.showLegend(t.filter(e.isLegendToShow.bind(e))),e.legend.selectAll(e.selectorLegends(t)).filter(function(){return e.d3.select(this).classed(a.legendItemFocused)}).classed(a.legendItemFocused,!1)),e.focusedTargetIds=[],e.defocusedTargetIds=[]},A.xgrids=function(t){var e=this.internal,n=e.config;return t?(n.grid_x_lines=t,e.redrawWithoutRescale(),n.grid_x_lines):n.grid_x_lines},A.xgrids.add=function(t){var e=this.internal;return this.xgrids(e.config.grid_x_lines.concat(t||[]))},A.xgrids.remove=function(t){this.internal.removeGridLines(t,!0)},A.ygrids=function(t){var e=this.internal,n=e.config;return t?(n.grid_y_lines=t,e.redrawWithoutRescale(),n.grid_y_lines):n.grid_y_lines},A.ygrids.add=function(t){var e=this.internal;return this.ygrids(e.config.grid_y_lines.concat(t||[]))},A.ygrids.remove=function(t){this.internal.removeGridLines(t,!1)},A.groups=function(t){var e=this.internal,n=e.config;return g(t)?n.data_groups:(n.data_groups=t,e.redraw(),n.data_groups)},A.legend=function(){},A.legend.show=function(t){var e=this.internal;e.showLegend(e.mapToTargetIds(t)),e.updateAndRedraw({withLegend:!0})},A.legend.hide=function(t){var e=this.internal;e.hideLegend(e.mapToTargetIds(t)),e.updateAndRedraw({withLegend:!0})},A.load=function(t){var e=this.internal,n=e.config;t.xs&&e.addXs(t.xs),"names"in t&&A.data.names.bind(this)(t.names),"classes"in t&&Object.keys(t.classes).forEach(function(e){n.data_classes[e]=t.classes[e]}),"categories"in t&&e.isCategorized()&&(n.axis_x_categories=t.categories),"axes"in t&&Object.keys(t.axes).forEach(function(e){n.data_axes[e]=t.axes[e]}),"colors"in t&&Object.keys(t.colors).forEach(function(e){n.data_colors[e]=t.colors[e]}),"cacheIds"in t&&e.hasCaches(t.cacheIds)?e.load(e.getCaches(t.cacheIds),t.done):"unload"in t?e.unload(e.mapToTargetIds("boolean"==typeof t.unload&&t.unload?null:t.unload),function(){e.loadFromArgs(t)}):e.loadFromArgs(t)},A.unload=function(t){var e=this.internal;(t=t||{})instanceof Array?t={ids:t}:"string"==typeof t&&(t={ids:[t]}),e.unload(e.mapToTargetIds(t.ids),function(){e.redraw({withUpdateOrgXDomain:!0,withUpdateXDomain:!0,withLegend:!0}),t.done&&t.done()})},A.regions=function(t){var e=this.internal,n=e.config;return t?(n.regions=t,e.redrawWithoutRescale(),n.regions):n.regions},A.regions.add=function(t){var e=this.internal,n=e.config;return t?(n.regions=n.regions.concat(t),e.redrawWithoutRescale(),n.regions):n.regions},A.regions.remove=function(t){var e,n,i,r=this.internal,o=r.config;return t=t||{},e=r.getOption(t,"duration",o.transition_duration),n=r.getOption(t,"classes",[a.region]),i=r.main.select("."+a.regions).selectAll(n.map(function(t){return"."+t})),(e?i.transition().duration(e):i).style("opacity",0).remove(),o.regions=o.regions.filter(function(t){var e=!1;return!t.class||(t.class.split(" ").forEach(function(t){n.indexOf(t)>=0&&(e=!0)}),!e)}),o.regions},A.selected=function(t){var e=this.internal,n=e.d3;return n.merge(e.main.selectAll("."+a.shapes+e.getTargetSelectorSuffix(t)).selectAll("."+a.shape).filter(function(){return n.select(this).classed(a.SELECTED)}).map(function(t){return t.map(function(t){var e=t.__data__;return e.data?e.data:e})}))},A.select=function(t,e,n){var i=this.internal,r=i.d3,o=i.config;o.data_selection_enabled&&i.main.selectAll("."+a.shapes).selectAll("."+a.shape).each(function(s,l){var u=r.select(this),c=s.data?s.data.id:s.id,h=i.getToggle(this,s).bind(i),d=o.data_selection_grouped||!t||t.indexOf(c)>=0,f=!e||e.indexOf(l)>=0,p=u.classed(a.SELECTED);u.classed(a.line)||u.classed(a.area)||(d&&f?o.data_selection_isselectable(s)&&!p&&h(!0,u.classed(a.SELECTED,!0),s,l):_(n)&&n&&p&&h(!1,u.classed(a.SELECTED,!1),s,l))})},A.unselect=function(t,e){var n=this.internal,i=n.d3,r=n.config;r.data_selection_enabled&&n.main.selectAll("."+a.shapes).selectAll("."+a.shape).each(function(o,s){var l=i.select(this),u=o.data?o.data.id:o.id,c=n.getToggle(this,o).bind(n),h=r.data_selection_grouped||!t||t.indexOf(u)>=0,d=!e||e.indexOf(s)>=0,f=l.classed(a.SELECTED);l.classed(a.line)||l.classed(a.area)||h&&d&&r.data_selection_isselectable(o)&&f&&c(!1,l.classed(a.SELECTED,!1),o,s)})},A.show=function(t,e){var n,i=this.internal;t=i.mapToTargetIds(t),e=e||{},i.removeHiddenTargetIds(t),(n=i.svg.selectAll(i.selectorTargets(t))).transition().style("opacity",1,"important").call(i.endall,function(){n.style("opacity",null).style("opacity",1)}),e.withLegend&&i.showLegend(t),i.redraw({withUpdateOrgXDomain:!0,withUpdateXDomain:!0,withLegend:!0})},A.hide=function(t,e){var n,i=this.internal;t=i.mapToTargetIds(t),e=e||{},i.addHiddenTargetIds(t),(n=i.svg.selectAll(i.selectorTargets(t))).transition().style("opacity",0,"important").call(i.endall,function(){n.style("opacity",null).style("opacity",0)}),e.withLegend&&i.hideLegend(t),i.redraw({withUpdateOrgXDomain:!0,withUpdateXDomain:!0,withLegend:!0})},A.toggle=function(t,e){var n=this,i=this.internal;i.mapToTargetIds(t).forEach(function(t){i.isTargetToShow(t)?n.hide(t,e):n.show(t,e)})},A.tooltip=function(){},A.tooltip.show=function(t){var e,n,i=this.internal;t.mouse&&(n=t.mouse),t.data?i.isMultipleX()?(n=[i.x(t.data.x),i.getYScale(t.data.id)(t.data.value)],e=null):e=h(t.data.index)?t.data.index:i.getIndexByX(t.data.x):void 0!==t.x?e=i.getIndexByX(t.x):void 0!==t.index&&(e=t.index),i.dispatchEvent("mouseover",e,n),i.dispatchEvent("mousemove",e,n),i.config.tooltip_onshow.call(i,t.data)},A.tooltip.hide=function(){this.internal.dispatchEvent("mouseout",0),this.internal.config.tooltip_onhide.call(this)},A.transform=function(t,e){var n=this.internal,i=["pie","donut"].indexOf(t)>=0?{withTransform:!0}:null;n.transformTo(e,t,i)},R.transformTo=function(t,e,n){var i=this,r=!i.hasArcType(),o=n||{withTransitionForAxis:r};o.withTransitionForTransform=!1,i.transiting=!1,i.setTargetType(t,e),i.updateTargets(i.data.targets),i.updateAndRedraw(o)},A.x=function(t){var e=this.internal;return arguments.length&&(e.updateTargetX(e.data.targets,t),e.redraw({withUpdateOrgXDomain:!0,withUpdateXDomain:!0})),e.data.xs},A.xs=function(t){var e=this.internal;return arguments.length&&(e.updateTargetXs(e.data.targets,t),e.redraw({withUpdateOrgXDomain:!0,withUpdateXDomain:!0})),e.data.xs},A.zoom=function(t){var e=this.internal;return t&&(e.isTimeSeries()&&(t=t.map(function(t){return e.parseDate(t)})),e.brush.extent(t),e.redraw({withUpdateXDomain:!0,withY:e.config.zoom_rescale}),e.config.zoom_onzoom.call(this,e.x.orgDomain())),e.brush.extent()},A.zoom.enable=function(t){var e=this.internal;e.config.zoom_enabled=t,e.updateAndRedraw()},A.unzoom=function(){var t=this.internal;t.brush.clear().update(),t.redraw({withUpdateXDomain:!0})},A.zoom.max=function(t){var e=this.internal,n=e.config,i=e.d3;if(0!==t&&!t)return n.zoom_x_max;n.zoom_x_max=i.max([e.orgXDomain[1],t])},A.zoom.min=function(t){var e=this.internal,n=e.config,i=e.d3;if(0!==t&&!t)return n.zoom_x_min;n.zoom_x_min=i.min([e.orgXDomain[0],t])},A.zoom.range=function(t){if(!arguments.length)return{max:this.domain.max(),min:this.domain.min()};_(t.max)&&this.domain.max(t.max),_(t.min)&&this.domain.min(t.min)},R.initPie=function(){var t=this,e=t.d3;t.pie=e.layout.pie().value(function(t){return t.values.reduce(function(t,e){return t+e.value},0)}),t.pie.sort(t.getOrderFunction()||null)},R.updateRadius=function(){var t=this,e=t.config,n=e.gauge_width||e.donut_width;t.radiusExpanded=Math.min(t.arcWidth,t.arcHeight)/2,t.radius=.95*t.radiusExpanded,t.innerRadiusRatio=n?(t.radius-n)/t.radius:.6,t.innerRadius=t.hasType("donut")||t.hasType("gauge")?t.radius*t.innerRadiusRatio:0},R.updateArc=function(){var t=this;t.svgArc=t.getSvgArc(),t.svgArcExpanded=t.getSvgArcExpanded(),t.svgArcExpandedSub=t.getSvgArcExpanded(.98)},R.updateAngle=function(t){var e,n,i,r,o=this,a=o.config,s=!1,l=0;return a?(o.pie(o.filterTargetsToShow(o.data.targets)).forEach(function(e){s||e.data.id!==t.data.id||(s=!0,(t=e).index=l),l++}),isNaN(t.startAngle)&&(t.startAngle=0),isNaN(t.endAngle)&&(t.endAngle=t.startAngle),o.isGaugeType(t.data)&&(e=a.gauge_min,n=a.gauge_max,i=Math.PI*(a.gauge_fullCircle?2:1)/(n-e),r=t.value<e?0:t.value<n?t.value-e:n-e,t.startAngle=a.gauge_startingAngle,t.endAngle=t.startAngle+i*r),s?t:null):null},R.getSvgArc=function(){var t=this,e=t.d3.svg.arc().outerRadius(t.radius).innerRadius(t.innerRadius),n=function(n,i){var r;return i?e(n):(r=t.updateAngle(n))?e(r):"M 0 0"};return n.centroid=e.centroid,n},R.getSvgArcExpanded=function(t){var e=this,n=e.d3.svg.arc().outerRadius(e.radiusExpanded*(t||1)).innerRadius(e.innerRadius);return function(t){var i=e.updateAngle(t);return i?n(i):"M 0 0"}},R.getArc=function(t,e,n){return n||this.isArcType(t.data)?this.svgArc(t,e):"M 0 0"},R.transformForArcLabel=function(t){var e,n,i,r,o,a=this,s=a.config,l=a.updateAngle(t),u="";return l&&!a.hasType("gauge")&&(e=this.svgArc.centroid(l),n=isNaN(e[0])?0:e[0],i=isNaN(e[1])?0:e[1],r=Math.sqrt(n*n+i*i),u="translate("+n*(o=a.hasType("donut")&&s.donut_label_ratio?d(s.donut_label_ratio)?s.donut_label_ratio(t,a.radius,r):s.donut_label_ratio:a.hasType("pie")&&s.pie_label_ratio?d(s.pie_label_ratio)?s.pie_label_ratio(t,a.radius,r):s.pie_label_ratio:a.radius&&r?(36/a.radius>.375?1.175-36/a.radius:.8)*a.radius/r:0)+","+i*o+")"),u},R.getArcRatio=function(t){var e=this,n=e.config,i=Math.PI*(e.hasType("gauge")&&!n.gauge_fullCircle?1:2);return t?(t.endAngle-t.startAngle)/i:null},R.convertToArcData=function(t){return this.addName({id:t.data.id,value:t.value,ratio:this.getArcRatio(t),index:t.index})},R.textForArcLabel=function(t){var e,n,i,r,o,a=this;return a.shouldShowArcLabel()?(e=a.updateAngle(t),n=e?e.value:null,i=a.getArcRatio(e),r=t.data.id,a.hasType("gauge")||a.meetsArcLabelThreshold(i)?(o=a.getArcLabelFormat())?o(n,i,r):a.defaultArcValueFormat(n,i):""):""},R.textForGaugeMinMax=function(t,e){var n=this.getGaugeLabelExtents();return n?n(t,e):t},R.expandArc=function(t){var e,n=this;n.transiting?e=window.setInterval(function(){n.transiting||(window.clearInterval(e),n.legend.selectAll(".c3-legend-item-focused").size()>0&&n.expandArc(t))},10):(t=n.mapToTargetIds(t),n.svg.selectAll(n.selectorTargets(t,"."+a.chartArc)).each(function(t){n.shouldExpand(t.data.id)&&n.d3.select(this).selectAll("path").transition().duration(n.expandDuration(t.data.id)).attr("d",n.svgArcExpanded).transition().duration(2*n.expandDuration(t.data.id)).attr("d",n.svgArcExpandedSub).each(function(t){n.isDonutType(t.data)})}))},R.unexpandArc=function(t){var e=this;e.transiting||(t=e.mapToTargetIds(t),e.svg.selectAll(e.selectorTargets(t,"."+a.chartArc)).selectAll("path").transition().duration(function(t){return e.expandDuration(t.data.id)}).attr("d",e.svgArc),e.svg.selectAll("."+a.arc))},R.expandDuration=function(t){var e=this,n=e.config;return e.isDonutType(t)?n.donut_expand_duration:e.isGaugeType(t)?n.gauge_expand_duration:e.isPieType(t)?n.pie_expand_duration:50},R.shouldExpand=function(t){var e=this,n=e.config;return e.isDonutType(t)&&n.donut_expand||e.isGaugeType(t)&&n.gauge_expand||e.isPieType(t)&&n.pie_expand},R.shouldShowArcLabel=function(){var t=this,e=t.config,n=!0;return t.hasType("donut")?n=e.donut_label_show:t.hasType("pie")&&(n=e.pie_label_show),n},R.meetsArcLabelThreshold=function(t){var e=this,n=e.config;return t>=(e.hasType("donut")?n.donut_label_threshold:n.pie_label_threshold)},R.getArcLabelFormat=function(){var t=this,e=t.config,n=e.pie_label_format;return t.hasType("gauge")?n=e.gauge_label_format:t.hasType("donut")&&(n=e.donut_label_format),n},R.getGaugeLabelExtents=function(){return this.config.gauge_label_extents},R.getArcTitle=function(){var t=this;return t.hasType("donut")?t.config.donut_title:""},R.updateTargetsForArc=function(t){var e,n=this,i=n.main,r=n.classChartArc.bind(n),o=n.classArcs.bind(n),s=n.classFocus.bind(n);(e=i.select("."+a.chartArcs).selectAll("."+a.chartArc).data(n.pie(t)).attr("class",function(t){return r(t)+s(t.data)}).enter().append("g").attr("class",r)).append("g").attr("class",o),e.append("text").attr("dy",n.hasType("gauge")?"-.1em":".35em").style("opacity",0).style("text-anchor","middle").style("pointer-events","none")},R.initArc=function(){var t=this;t.arcs=t.main.select("."+a.chart).append("g").attr("class",a.chartArcs).attr("transform",t.getTranslate("arc")),t.arcs.append("text").attr("class",a.chartArcsTitle).style("text-anchor","middle").text(t.getArcTitle())},R.redrawArc=function(t,e,n){var i,r=this,o=r.d3,s=r.config,l=r.main;(i=l.selectAll("."+a.arcs).selectAll("."+a.arc).data(r.arcData.bind(r))).enter().append("path").attr("class",r.classArc.bind(r)).style("fill",function(t){return r.color(t.data)}).style("cursor",function(t){return s.interaction_enabled&&s.data_selection_isselectable(t)?"pointer":null}).each(function(t){r.isGaugeType(t.data)&&(t.startAngle=t.endAngle=s.gauge_startingAngle),this._current=t}),i.attr("transform",function(t){return!r.isGaugeType(t.data)&&n?"scale(0)":""}).on("mouseover",s.interaction_enabled?function(t){var e,n;r.transiting||(e=r.updateAngle(t))&&(n=r.convertToArcData(e),r.expandArc(e.data.id),r.api.focus(e.data.id),r.toggleFocusLegend(e.data.id,!0),r.config.data_onmouseover(n,this))}:null).on("mousemove",s.interaction_enabled?function(t){var e,n=r.updateAngle(t);n&&(e=[r.convertToArcData(n)],r.showTooltip(e,this))}:null).on("mouseout",s.interaction_enabled?function(t){var e,n;r.transiting||(e=r.updateAngle(t))&&(n=r.convertToArcData(e),r.unexpandArc(e.data.id),r.api.revert(),r.revertLegend(),r.hideTooltip(),r.config.data_onmouseout(n,this))}:null).on("click",s.interaction_enabled?function(t,e){var n,i=r.updateAngle(t);i&&(n=r.convertToArcData(i),r.toggleShape&&r.toggleShape(this,n,e),r.config.data_onclick.call(r.api,n,this))}:null).each(function(){r.transiting=!0}).transition().duration(t).attrTween("d",function(t){var e,n=r.updateAngle(t);return n?(isNaN(this._current.startAngle)&&(this._current.startAngle=0),isNaN(this._current.endAngle)&&(this._current.endAngle=this._current.startAngle),e=o.interpolate(this._current,n),this._current=e(0),function(n){var i=e(n);return i.data=t.data,r.getArc(i,!0)}):function(){return"M 0 0"}}).attr("transform",n?"scale(1)":"").style("fill",function(t){return r.levelColor?r.levelColor(t.data.values[0].value):r.color(t.data.id)}).call(r.endall,function(){r.transiting=!1}),i.exit().transition().duration(e).style("opacity",0).remove(),l.selectAll("."+a.chartArc).select("text").style("opacity",0).attr("class",function(t){return r.isGaugeType(t.data)?a.gaugeValue:""}).text(r.textForArcLabel.bind(r)).attr("transform",r.transformForArcLabel.bind(r)).style("font-size",function(t){return r.isGaugeType(t.data)?Math.round(r.radius/5)+"px":""}).transition().duration(t).style("opacity",function(t){return r.isTargetToShow(t.data.id)&&r.isArcType(t.data)?1:0}),l.select("."+a.chartArcsTitle).style("opacity",r.hasType("donut")||r.hasType("gauge")?1:0),r.hasType("gauge")&&(r.arcs.select("."+a.chartArcsBackground).attr("d",function(){var t={data:[{value:s.gauge_max}],startAngle:s.gauge_startingAngle,endAngle:-1*s.gauge_startingAngle};return r.getArc(t,!0,!0)}),r.arcs.select("."+a.chartArcsGaugeUnit).attr("dy",".75em").text(s.gauge_label_show?s.gauge_units:""),r.arcs.select("."+a.chartArcsGaugeMin).attr("dx",-1*(r.innerRadius+(r.radius-r.innerRadius)/(s.gauge_fullCircle?1:2))+"px").attr("dy","1.2em").text(s.gauge_label_show?r.textForGaugeMinMax(s.gauge_min,!1):""),r.arcs.select("."+a.chartArcsGaugeMax).attr("dx",r.innerRadius+(r.radius-r.innerRadius)/(s.gauge_fullCircle?1:2)+"px").attr("dy","1.2em").text(s.gauge_label_show?r.textForGaugeMinMax(s.gauge_max,!0):""))},R.initGauge=function(){var t=this.arcs;this.hasType("gauge")&&(t.append("path").attr("class",a.chartArcsBackground),t.append("text").attr("class",a.chartArcsGaugeUnit).style("text-anchor","middle").style("pointer-events","none"),t.append("text").attr("class",a.chartArcsGaugeMin).style("text-anchor","middle").style("pointer-events","none"),t.append("text").attr("class",a.chartArcsGaugeMax).style("text-anchor","middle").style("pointer-events","none"))},R.getGaugeLabelHeight=function(){return this.config.gauge_label_show?20:0},R.hasCaches=function(t){for(var e=0;e<t.length;e++)if(!(t[e]in this.cache))return!1;return!0},R.addCache=function(t,e){this.cache[t]=this.cloneTarget(e)},R.getCaches=function(t){var e,n=[];for(e=0;e<t.length;e++)t[e]in this.cache&&n.push(this.cloneTarget(this.cache[t[e]]));return n},R.categoryName=function(t){var e=this.config;return t<e.axis_x_categories.length?e.axis_x_categories[t]:t},R.generateClass=function(t,e){return" "+t+" "+t+this.getTargetSelectorSuffix(e)},R.classText=function(t){return this.generateClass(a.text,t.index)},R.classTexts=function(t){return this.generateClass(a.texts,t.id)},R.classShape=function(t){return this.generateClass(a.shape,t.index)},R.classShapes=function(t){return this.generateClass(a.shapes,t.id)},R.classLine=function(t){return this.classShape(t)+this.generateClass(a.line,t.id)},R.classLines=function(t){return this.classShapes(t)+this.generateClass(a.lines,t.id)},R.classCircle=function(t){return this.classShape(t)+this.generateClass(a.circle,t.index)},R.classCircles=function(t){return this.classShapes(t)+this.generateClass(a.circles,t.id)},R.classBar=function(t){return this.classShape(t)+this.generateClass(a.bar,t.index)},R.classBars=function(t){return this.classShapes(t)+this.generateClass(a.bars,t.id)},R.classArc=function(t){return this.classShape(t.data)+this.generateClass(a.arc,t.data.id)},R.classArcs=function(t){return this.classShapes(t.data)+this.generateClass(a.arcs,t.data.id)},R.classArea=function(t){return this.classShape(t)+this.generateClass(a.area,t.id)},R.classAreas=function(t){return this.classShapes(t)+this.generateClass(a.areas,t.id)},R.classRegion=function(t,e){return this.generateClass(a.region,e)+" "+("class"in t?t.class:"")},R.classEvent=function(t){return this.generateClass(a.eventRect,t.index)},R.classTarget=function(t){var e=this,n=e.config.data_classes[t],i="";return n&&(i=" "+a.target+"-"+n),e.generateClass(a.target,t)+i},R.classFocus=function(t){return this.classFocused(t)+this.classDefocused(t)},R.classFocused=function(t){return" "+(this.focusedTargetIds.indexOf(t.id)>=0?a.focused:"")},R.classDefocused=function(t){return" "+(this.defocusedTargetIds.indexOf(t.id)>=0?a.defocused:"")},R.classChartText=function(t){return a.chartText+this.classTarget(t.id)},R.classChartLine=function(t){return a.chartLine+this.classTarget(t.id)},R.classChartBar=function(t){return a.chartBar+this.classTarget(t.id)},R.classChartArc=function(t){return a.chartArc+this.classTarget(t.data.id)},R.getTargetSelectorSuffix=function(t){return t||0===t?("-"+t).replace(/[\s?!@#$%^&*()_=+,.<>'":;\[\]\/|~`{}\\]/g,"-"):""},R.selectorTarget=function(t,e){return(e||"")+"."+a.target+this.getTargetSelectorSuffix(t)},R.selectorTargets=function(t,e){var n=this;return(t=t||[]).length?t.map(function(t){return n.selectorTarget(t,e)}):null},R.selectorLegend=function(t){return"."+a.legendItem+this.getTargetSelectorSuffix(t)},R.selectorLegends=function(t){var e=this;return t&&t.length?t.map(function(t){return e.selectorLegend(t)}):null},R.getClipPath=function(t){return"url("+(window.navigator.appVersion.toLowerCase().indexOf("msie 9.")>=0?"":document.URL.split("#")[0])+"#"+t+")"},R.appendClip=function(t,e){return t.append("clipPath").attr("id",e).append("rect")},R.getAxisClipX=function(t){var e=Math.max(30,this.margin.left);return t?-(1+e):-(e-1)},R.getAxisClipY=function(t){return t?-20:-this.margin.top},R.getXAxisClipX=function(){var t=this;return t.getAxisClipX(!t.config.axis_rotated)},R.getXAxisClipY=function(){var t=this;return t.getAxisClipY(!t.config.axis_rotated)},R.getYAxisClipX=function(){var t=this;return t.config.axis_y_inner?-1:t.getAxisClipX(t.config.axis_rotated)},R.getYAxisClipY=function(){var t=this;return t.getAxisClipY(t.config.axis_rotated)},R.getAxisClipWidth=function(t){var e=this,n=Math.max(30,e.margin.left),i=Math.max(30,e.margin.right);return t?e.width+2+n+i:e.margin.left+20},R.getAxisClipHeight=function(t){return(t?this.margin.bottom:this.margin.top+this.height)+20},R.getXAxisClipWidth=function(){var t=this;return t.getAxisClipWidth(!t.config.axis_rotated)},R.getXAxisClipHeight=function(){var t=this;return t.getAxisClipHeight(!t.config.axis_rotated)},R.getYAxisClipWidth=function(){var t=this;return t.getAxisClipWidth(t.config.axis_rotated)+(t.config.axis_y_inner?20:0)},R.getYAxisClipHeight=function(){var t=this;return t.getAxisClipHeight(t.config.axis_rotated)},R.generateColor=function(){var t=this,e=t.config,n=t.d3,i=e.data_colors,r=S(e.color_pattern)?e.color_pattern:n.scale.category10().range(),o=e.data_color,a=[];return function(t){var e,n=t.id||t.data&&t.data.id||t;return i[n]instanceof Function?e=i[n](t):i[n]?e=i[n]:(a.indexOf(n)<0&&a.push(n),e=r[a.indexOf(n)%r.length],i[n]=e),o instanceof Function?o(e,t):e}},R.generateLevelColor=function(){var t=this.config,e=t.color_pattern,n=t.color_threshold,i="value"===n.unit,r=n.values&&n.values.length?n.values:[],o=n.max||100;return S(t.color_threshold)?function(t){var n,a=e[e.length-1];for(n=0;n<r.length;n++)if((i?t:100*t/o)<r[n]){a=e[n];break}return a}:null},R.getDefaultConfig=function(){var t={bindto:"#chart",svg_classname:void 0,size_width:void 0,size_height:void 0,padding_left:void 0,padding_right:void 0,padding_top:void 0,padding_bottom:void 0,resize_auto:!0,zoom_enabled:!1,zoom_extent:void 0,zoom_privileged:!1,zoom_rescale:!1,zoom_onzoom:function(){},zoom_onzoomstart:function(){},zoom_onzoomend:function(){},zoom_x_min:void 0,zoom_x_max:void 0,interaction_brighten:!0,interaction_enabled:!0,onmouseover:function(){},onmouseout:function(){},onresize:function(){},onresized:function(){},oninit:function(){},onrendered:function(){},transition_duration:350,data_x:void 0,data_xs:{},data_xFormat:"%Y-%m-%d",data_xLocaltime:!0,data_xSort:!0,data_idConverter:function(t){return t},data_names:{},data_classes:{},data_groups:[],data_axes:{},data_type:void 0,data_types:{},data_labels:{},data_order:"desc",data_regions:{},data_color:void 0,data_colors:{},data_hide:!1,data_filter:void 0,data_selection_enabled:!1,data_selection_grouped:!1,data_selection_isselectable:function(){return!0},data_selection_multiple:!0,data_selection_draggable:!1,data_onclick:function(){},data_onmouseover:function(){},data_onmouseout:function(){},data_onselected:function(){},data_onunselected:function(){},data_url:void 0,data_headers:void 0,data_json:void 0,data_rows:void 0,data_columns:void 0,data_mimeType:void 0,data_keys:void 0,data_empty_label_text:"",subchart_show:!1,subchart_size_height:60,subchart_axis_x_show:!0,subchart_onbrush:function(){},color_pattern:[],color_threshold:{},legend_show:!0,legend_hide:!1,legend_position:"bottom",legend_inset_anchor:"top-left",legend_inset_x:10,legend_inset_y:0,legend_inset_step:void 0,legend_item_onclick:void 0,legend_item_onmouseover:void 0,legend_item_onmouseout:void 0,legend_equally:!1,legend_padding:0,legend_item_tile_width:10,legend_item_tile_height:10,axis_rotated:!1,axis_x_show:!0,axis_x_type:"indexed",axis_x_localtime:!0,axis_x_categories:[],axis_x_tick_centered:!1,axis_x_tick_format:void 0,axis_x_tick_culling:{},axis_x_tick_culling_max:10,axis_x_tick_count:void 0,axis_x_tick_fit:!0,axis_x_tick_values:null,axis_x_tick_rotate:0,axis_x_tick_outer:!0,axis_x_tick_multiline:!0,axis_x_tick_width:null,axis_x_max:void 0,axis_x_min:void 0,axis_x_padding:{},axis_x_height:void 0,axis_x_extent:void 0,axis_x_label:{},axis_y_show:!0,axis_y_type:void 0,axis_y_max:void 0,axis_y_min:void 0,axis_y_inverted:!1,axis_y_center:void 0,axis_y_inner:void 0,axis_y_label:{},axis_y_tick_format:void 0,axis_y_tick_outer:!0,axis_y_tick_values:null,axis_y_tick_rotate:0,axis_y_tick_count:void 0,axis_y_tick_time_value:void 0,axis_y_tick_time_interval:void 0,axis_y_padding:{},axis_y_default:void 0,axis_y2_show:!1,axis_y2_max:void 0,axis_y2_min:void 0,axis_y2_inverted:!1,axis_y2_center:void 0,axis_y2_inner:void 0,axis_y2_label:{},axis_y2_tick_format:void 0,axis_y2_tick_outer:!0,axis_y2_tick_values:null,axis_y2_tick_count:void 0,axis_y2_padding:{},axis_y2_default:void 0,grid_x_show:!1,grid_x_type:"tick",grid_x_lines:[],grid_y_show:!1,grid_y_lines:[],grid_y_ticks:10,grid_focus_show:!0,grid_lines_front:!0,point_show:!0,point_r:2.5,point_sensitivity:10,point_focus_expand_enabled:!0,point_focus_expand_r:void 0,point_select_r:void 0,line_connectNull:!1,line_step_type:"step",bar_width:void 0,bar_width_ratio:.6,bar_width_max:void 0,bar_zerobased:!0,bar_space:0,area_zerobased:!0,area_above:!1,pie_label_show:!0,pie_label_format:void 0,pie_label_threshold:.05,pie_label_ratio:void 0,pie_expand:{},pie_expand_duration:50,gauge_fullCircle:!1,gauge_label_show:!0,gauge_label_format:void 0,gauge_min:0,gauge_max:100,gauge_startingAngle:-1*Math.PI/2,gauge_label_extents:void 0,gauge_units:void 0,gauge_width:void 0,gauge_expand:{},gauge_expand_duration:50,donut_label_show:!0,donut_label_format:void 0,donut_label_threshold:.05,donut_label_ratio:void 0,donut_width:void 0,donut_title:"",donut_expand:{},donut_expand_duration:50,spline_interpolation_type:"cardinal",regions:[],tooltip_show:!0,tooltip_grouped:!0,tooltip_order:void 0,tooltip_format_title:void 0,tooltip_format_name:void 0,tooltip_format_value:void 0,tooltip_position:void 0,tooltip_contents:function(t,e,n,i){return this.getTooltipContent?this.getTooltipContent(t,e,n,i):""},tooltip_init_show:!1,tooltip_init_x:0,tooltip_init_position:{top:"0px",left:"50px"},tooltip_onshow:function(){},tooltip_onhide:function(){},title_text:void 0,title_padding:{top:0,right:0,bottom:0,left:0},title_position:"top-center"};return Object.keys(this.additionalConfig).forEach(function(e){t[e]=this.additionalConfig[e]},this),t},R.additionalConfig={},R.loadConfig=function(t){function e(){var t=i.shift();return t&&n&&"object"===(void 0===n?"undefined":s(n))&&t in n?(n=n[t],e()):t?void 0:n}var n,i,r,o=this.config;Object.keys(o).forEach(function(a){n=t,i=a.split("_"),r=e(),_(r)&&(o[a]=r)})},R.convertUrlToData=function(t,e,n,i,r){var o=this,a=e||"csv",s=o.d3.xhr(t);n&&Object.keys(n).forEach(function(t){s.header(t,n[t])}),s.get(function(t,e){var n,s=e.response||e.responseText;if(!e)throw new Error(t.responseURL+" "+t.status+" ("+t.statusText+")");n="json"===a?o.convertJsonToData(JSON.parse(s),i):"tsv"===a?o.convertTsvToData(s):o.convertCsvToData(s),r.call(o,n)})},R.convertXsvToData=function(t,e){var n,i=e.parseRows(t);return 1===i.length?(n=[{}],i[0].forEach(function(t){n[0][t]=null})):n=e.parse(t),n},R.convertCsvToData=function(t){return this.convertXsvToData(t,this.d3.csv)},R.convertTsvToData=function(t){return this.convertXsvToData(t,this.d3.tsv)},R.convertJsonToData=function(t,e){var n,i,r=this,o=[];return e?(e.x?(n=e.value.concat(e.x),r.config.data_x=e.x):n=e.value,o.push(n),t.forEach(function(t){var e=[];n.forEach(function(n){var i=r.findValueInJson(t,n);g(i)&&(i=null),e.push(i)}),o.push(e)}),i=r.convertRowsToData(o)):(Object.keys(t).forEach(function(e){o.push([e].concat(t[e]))}),i=r.convertColumnsToData(o)),i},R.findValueInJson=function(t,e){for(var n=(e=(e=e.replace(/\[(\w+)\]/g,".$1")).replace(/^\./,"")).split("."),i=0;i<n.length;++i){var r=n[i];if(!(r in t))return;t=t[r]}return t},R.convertRowsToData=function(t){for(var e=[],n=t[0],i=1;i<t.length;i++){for(var r={},o=0;o<t[i].length;o++){if(g(t[i][o]))throw new Error("Source data is missing a component at ("+i+","+o+")!");r[n[o]]=t[i][o]}e.push(r)}return e},R.convertColumnsToData=function(t){for(var e=[],n=0;n<t.length;n++)for(var i=t[n][0],r=1;r<t[n].length;r++){if(g(e[r-1])&&(e[r-1]={}),g(t[n][r]))throw new Error("Source data is missing a component at ("+n+","+r+")!");e[r-1][i]=t[n][r]}return e},R.convertDataToTargets=function(t,e){var n,i=this,r=i.config,o=i.d3.keys(t[0]).filter(i.isNotX,i),a=i.d3.keys(t[0]).filter(i.isX,i);return o.forEach(function(n){var o=i.getXKey(n);i.isCustomX()||i.isTimeSeries()?a.indexOf(o)>=0?i.data.xs[n]=(e&&i.data.xs[n]?i.data.xs[n]:[]).concat(t.map(function(t){return t[o]}).filter(h).map(function(t,e){return i.generateTargetX(t,n,e)})):r.data_x?i.data.xs[n]=i.getOtherTargetXs():S(r.data_xs)&&(i.data.xs[n]=i.getXValuesOfXKey(o,i.data.targets)):i.data.xs[n]=t.map(function(t,e){return e})}),o.forEach(function(t){if(!i.data.xs[t])throw new Error('x is not defined for id = "'+t+'".')}),(n=o.map(function(e,n){var o=r.data_idConverter(e);return{id:o,id_org:e,values:t.map(function(t,a){var s,l=t[i.getXKey(e)],u=null===t[e]||isNaN(t[e])?null:+t[e];return i.isCustomX()&&i.isCategorized()&&!g(l)?(0===n&&0===a&&(r.axis_x_categories=[]),-1===(s=r.axis_x_categories.indexOf(l))&&(s=r.axis_x_categories.length,r.axis_x_categories.push(l))):s=i.generateTargetX(l,e,a),(g(t[e])||i.data.xs[e].length<=a)&&(s=void 0),{x:s,value:u,id:o}}).filter(function(t){return _(t.x)})}})).forEach(function(t){var e;r.data_xSort&&(t.values=t.values.sort(function(t,e){return(t.x||0===t.x?t.x:1/0)-(e.x||0===e.x?e.x:1/0)})),e=0,t.values.forEach(function(t){t.index=e++}),i.data.xs[t.id].sort(function(t,e){return t-e})}),i.hasNegativeValue=i.hasNegativeValueInTargets(n),i.hasPositiveValue=i.hasPositiveValueInTargets(n),r.data_type&&i.setTargetType(i.mapToIds(n).filter(function(t){return!(t in r.data_types)}),r.data_type),n.forEach(function(t){i.addCache(t.id_org,t)}),n},R.isX=function(t){var e=this.config;return e.data_x&&t===e.data_x||S(e.data_xs)&&T(e.data_xs,t)},R.isNotX=function(t){return!this.isX(t)},R.getXKey=function(t){var e=this.config;return e.data_x?e.data_x:S(e.data_xs)?e.data_xs[t]:null},R.getXValuesOfXKey=function(t,e){var n,i=this;return(e&&S(e)?i.mapToIds(e):[]).forEach(function(e){i.getXKey(e)===t&&(n=i.data.xs[e])}),n},R.getIndexByX=function(t){var e=this,n=e.filterByX(e.data.targets,t);return n.length?n[0].index:null},R.getXValue=function(t,e){var n=this;return t in n.data.xs&&n.data.xs[t]&&h(n.data.xs[t][e])?n.data.xs[t][e]:e},R.getOtherTargetXs=function(){var t=this,e=Object.keys(t.data.xs);return e.length?t.data.xs[e[0]]:null},R.getOtherTargetX=function(t){var e=this.getOtherTargetXs();return e&&t<e.length?e[t]:null},R.addXs=function(t){var e=this;Object.keys(t).forEach(function(n){e.config.data_xs[n]=t[n]})},R.hasMultipleX=function(t){return this.d3.set(Object.keys(t).map(function(e){return t[e]})).size()>1},R.isMultipleX=function(){return S(this.config.data_xs)||!this.config.data_xSort||this.hasType("scatter")},R.addName=function(t){var e;return t&&(e=this.config.data_names[t.id],t.name=void 0!==e?e:t.id),t},R.getValueOnIndex=function(t,e){var n=t.filter(function(t){return t.index===e});return n.length?n[0]:null},R.updateTargetX=function(t,e){var n=this;t.forEach(function(t){t.values.forEach(function(i,r){i.x=n.generateTargetX(e[r],t.id,r)}),n.data.xs[t.id]=e})},R.updateTargetXs=function(t,e){var n=this;t.forEach(function(t){e[t.id]&&n.updateTargetX([t],e[t.id])})},R.generateTargetX=function(t,e,n){var i=this;return i.isTimeSeries()?t?i.parseDate(t):i.parseDate(i.getXValue(e,n)):i.isCustomX()&&!i.isCategorized()?h(t)?+t:i.getXValue(e,n):n},R.cloneTarget=function(t){return{id:t.id,id_org:t.id_org,values:t.values.map(function(t){return{x:t.x,value:t.value,id:t.id}})}},R.updateXs=function(){var t=this;t.data.targets.length&&(t.xs=[],t.data.targets[0].values.forEach(function(e){t.xs[e.index]=e.x}))},R.getPrevX=function(t){var e=this.xs[t-1];return void 0!==e?e:null},R.getNextX=function(t){var e=this.xs[t+1];return void 0!==e?e:null},R.getMaxDataCount=function(){var t=this;return t.d3.max(t.data.targets,function(t){return t.values.length})},R.getMaxDataCountTarget=function(t){var e,n=t.length,i=0;return n>1?t.forEach(function(t){t.values.length>i&&(e=t,i=t.values.length)}):e=n?t[0]:null,e},R.getEdgeX=function(t){var e=this;return t.length?[e.d3.min(t,function(t){return t.values[0].x}),e.d3.max(t,function(t){return t.values[t.values.length-1].x})]:[0,0]},R.mapToIds=function(t){return t.map(function(t){return t.id})},R.mapToTargetIds=function(t){var e=this;return t?[].concat(t):e.mapToIds(e.data.targets)},R.hasTarget=function(t,e){var n,i=this.mapToIds(t);for(n=0;n<i.length;n++)if(i[n]===e)return!0;return!1},R.isTargetToShow=function(t){return this.hiddenTargetIds.indexOf(t)<0},R.isLegendToShow=function(t){return this.hiddenLegendIds.indexOf(t)<0},R.filterTargetsToShow=function(t){var e=this;return t.filter(function(t){return e.isTargetToShow(t.id)})},R.mapTargetsToUniqueXs=function(t){var e=this,n=e.d3.set(e.d3.merge(t.map(function(t){return t.values.map(function(t){return+t.x})}))).values();return(n=e.isTimeSeries()?n.map(function(t){return new Date(+t)}):n.map(function(t){return+t})).sort(function(t,e){return t<e?-1:t>e?1:t>=e?0:NaN})},R.addHiddenTargetIds=function(t){t=t instanceof Array?t:new Array(t);for(var e=0;e<t.length;e++)this.hiddenTargetIds.indexOf(t[e])<0&&(this.hiddenTargetIds=this.hiddenTargetIds.concat(t[e]))},R.removeHiddenTargetIds=function(t){this.hiddenTargetIds=this.hiddenTargetIds.filter(function(e){return t.indexOf(e)<0})},R.addHiddenLegendIds=function(t){t=t instanceof Array?t:new Array(t);for(var e=0;e<t.length;e++)this.hiddenLegendIds.indexOf(t[e])<0&&(this.hiddenLegendIds=this.hiddenLegendIds.concat(t[e]))},R.removeHiddenLegendIds=function(t){this.hiddenLegendIds=this.hiddenLegendIds.filter(function(e){return t.indexOf(e)<0})},R.getValuesAsIdKeyed=function(t){var e={};return t.forEach(function(t){e[t.id]=[],t.values.forEach(function(n){e[t.id].push(n.value)})}),e},R.checkValueInTargets=function(t,e){var n,i,r,o=Object.keys(t);for(n=0;n<o.length;n++)for(r=t[o[n]].values,i=0;i<r.length;i++)if(e(r[i].value))return!0;return!1},R.hasNegativeValueInTargets=function(t){return this.checkValueInTargets(t,function(t){return t<0})},R.hasPositiveValueInTargets=function(t){return this.checkValueInTargets(t,function(t){return t>0})},R.isOrderDesc=function(){var t=this.config;return"string"==typeof t.data_order&&"desc"===t.data_order.toLowerCase()},R.isOrderAsc=function(){var t=this.config;return"string"==typeof t.data_order&&"asc"===t.data_order.toLowerCase()},R.getOrderFunction=function(){var t=this,e=t.config,n=t.isOrderAsc(),i=t.isOrderDesc();if(n||i)return function(t,e){var n=function(t,e){return t+Math.abs(e.value)},r=t.values.reduce(n,0),o=e.values.reduce(n,0);return i?o-r:r-o};if(d(e.data_order))return e.data_order;if(f(e.data_order)){var r=e.data_order;return function(t,e){return r.indexOf(t.id)-r.indexOf(e.id)}}},R.orderTargets=function(t){var e=this.getOrderFunction();return e&&(t.sort(e),(this.isOrderAsc()||this.isOrderDesc())&&t.reverse()),t},R.filterByX=function(t,e){return this.d3.merge(t.map(function(t){return t.values})).filter(function(t){return t.x-e==0})},R.filterRemoveNull=function(t){return t.filter(function(t){return h(t.value)})},R.filterByXDomain=function(t,e){return t.map(function(t){return{id:t.id,id_org:t.id_org,values:t.values.filter(function(t){return e[0]<=t.x&&t.x<=e[1]})}})},R.hasDataLabel=function(){var t=this.config;return!("boolean"!=typeof t.data_labels||!t.data_labels)||!("object"!==s(t.data_labels)||!S(t.data_labels))},R.getDataLabelLength=function(t,e,n){var i=this,r=[0,0];return i.selectChart.select("svg").selectAll(".dummy").data([t,e]).enter().append("text").text(function(t){return i.dataLabelFormat(t.id)(t)}).each(function(t,e){r[e]=1.3*this.getBoundingClientRect()[n]}).remove(),r},R.isNoneArc=function(t){return this.hasTarget(this.data.targets,t.id)},R.isArc=function(t){return"data"in t&&this.hasTarget(this.data.targets,t.data.id)},R.findSameXOfValues=function(t,e){var n,i=t[e].x,r=[];for(n=e-1;n>=0&&i===t[n].x;n--)r.push(t[n]);for(n=e;n<t.length&&i===t[n].x;n++)r.push(t[n]);return r},R.findClosestFromTargets=function(t,e){var n,i=this;return n=t.map(function(t){return i.findClosest(t.values,e)}),i.findClosest(n,e)},R.findClosest=function(t,e){var n,i=this,r=i.config.point_sensitivity;return t.filter(function(t){return t&&i.isBarType(t.id)}).forEach(function(t){var e=i.main.select("."+a.bars+i.getTargetSelectorSuffix(t.id)+" ."+a.bar+"-"+t.index).node();!n&&i.isWithinBar(e)&&(n=t)}),t.filter(function(t){return t&&!i.isBarType(t.id)}).forEach(function(t){var o=i.dist(t,e);o<r&&(r=o,n=t)}),n},R.dist=function(t,e){var n=this,i=n.config,r=i.axis_rotated?1:0,o=i.axis_rotated?0:1,a=n.circleY(t,t.index),s=n.x(t.x);return Math.sqrt(Math.pow(s-e[r],2)+Math.pow(a-e[o],2))},R.convertValuesToStep=function(t){var e,n=[].concat(t);if(!this.isCategorized())return t;for(e=t.length+1;0<e;e--)n[e]=n[e-1];return n[0]={x:n[0].x-1,value:n[0].value,id:n[0].id},n[t.length+1]={x:n[t.length].x+1,value:n[t.length].value,id:n[t.length].id},n},R.updateDataAttributes=function(t,e){var n=this,i=n.config["data_"+t];return void 0===e?i:(Object.keys(e).forEach(function(t){i[t]=e[t]}),n.redraw({withLegend:!0}),i)},R.load=function(t,e){var n=this;t&&(e.filter&&(t=t.filter(e.filter)),(e.type||e.types)&&t.forEach(function(t){var i=e.types&&e.types[t.id]?e.types[t.id]:e.type;n.setTargetType(t.id,i)}),n.data.targets.forEach(function(e){for(var n=0;n<t.length;n++)if(e.id===t[n].id){e.values=t[n].values,t.splice(n,1);break}}),n.data.targets=n.data.targets.concat(t)),n.updateTargets(n.data.targets),n.redraw({withUpdateOrgXDomain:!0,withUpdateXDomain:!0,withLegend:!0}),e.done&&e.done()},R.loadFromArgs=function(t){var e=this;t.data?e.load(e.convertDataToTargets(t.data),t):t.url?e.convertUrlToData(t.url,t.mimeType,t.headers,t.keys,function(n){e.load(e.convertDataToTargets(n),t)}):t.json?e.load(e.convertDataToTargets(e.convertJsonToData(t.json,t.keys)),t):t.rows?e.load(e.convertDataToTargets(e.convertRowsToData(t.rows)),t):t.columns?e.load(e.convertDataToTargets(e.convertColumnsToData(t.columns)),t):e.load(null,t)},R.unload=function(t,e){var n=this;e||(e=function(){}),(t=t.filter(function(t){return n.hasTarget(n.data.targets,t)}))&&0!==t.length?(n.svg.selectAll(t.map(function(t){return n.selectorTarget(t)})).transition().style("opacity",0).remove().call(n.endall,e),t.forEach(function(t){n.withoutFadeIn[t]=!1,n.legend&&n.legend.selectAll("."+a.legendItem+n.getTargetSelectorSuffix(t)).remove(),n.data.targets=n.data.targets.filter(function(e){return e.id!==t})})):e()},R.getYDomainMin=function(t){var e,n,i,r,o,a,s=this,l=s.config,u=s.mapToIds(t),c=s.getValuesAsIdKeyed(t);if(l.data_groups.length>0)for(a=s.hasNegativeValueInTargets(t),e=0;e<l.data_groups.length;e++)if(0!==(r=l.data_groups[e].filter(function(t){return u.indexOf(t)>=0})).length)for(i=r[0],a&&c[i]&&c[i].forEach(function(t,e){c[i][e]=t<0?t:0}),n=1;n<r.length;n++)o=r[n],c[o]&&c[o].forEach(function(t,e){s.axis.getId(o)!==s.axis.getId(i)||!c[i]||a&&+t>0||(c[i][e]+=+t)});return s.d3.min(Object.keys(c).map(function(t){return s.d3.min(c[t])}))},R.getYDomainMax=function(t){var e,n,i,r,o,a,s=this,l=s.config,u=s.mapToIds(t),c=s.getValuesAsIdKeyed(t);if(l.data_groups.length>0)for(a=s.hasPositiveValueInTargets(t),e=0;e<l.data_groups.length;e++)if(0!==(r=l.data_groups[e].filter(function(t){return u.indexOf(t)>=0})).length)for(i=r[0],a&&c[i]&&c[i].forEach(function(t,e){c[i][e]=t>0?t:0}),n=1;n<r.length;n++)o=r[n],c[o]&&c[o].forEach(function(t,e){s.axis.getId(o)!==s.axis.getId(i)||!c[i]||a&&+t<0||(c[i][e]+=+t)});return s.d3.max(Object.keys(c).map(function(t){return s.d3.max(c[t])}))},R.getYDomain=function(t,e,n){var i,r,o,a,s,l,u,c,d,f,p=this,g=p.config,_=t.filter(function(t){return p.axis.getId(t.id)===e}),v=n?p.filterByXDomain(_,n):_,y="y2"===e?g.axis_y2_min:g.axis_y_min,x="y2"===e?g.axis_y2_max:g.axis_y_max,E=p.getYDomainMin(v),T=p.getYDomainMax(v),w="y2"===e?g.axis_y2_center:g.axis_y_center,C=p.hasType("bar",v)&&g.bar_zerobased||p.hasType("area",v)&&g.area_zerobased,b="y2"===e?g.axis_y2_inverted:g.axis_y_inverted,A=p.hasDataLabel()&&g.axis_rotated,R=p.hasDataLabel()&&!g.axis_rotated;return E=h(y)?y:h(x)?E<x?E:x-10:E,T=h(x)?x:h(y)?y<T?T:y+10:T,0===v.length?"y2"===e?p.y2.domain():p.y.domain():(isNaN(E)&&(E=0),isNaN(T)&&(T=E),E===T&&(E<0?T=0:E=0),d=E>=0&&T>=0,f=E<=0&&T<=0,(h(y)&&d||h(x)&&f)&&(C=!1),C&&(d&&(E=0),f&&(T=0)),r=Math.abs(T-E),o=a=.1*r,void 0!==w&&(T=w+(s=Math.max(Math.abs(E),Math.abs(T))),E=w-s),A?(l=p.getDataLabelLength(E,T,"width"),u=m(p.y.range()),o+=r*((c=[l[0]/u,l[1]/u])[1]/(1-c[0]-c[1])),a+=r*(c[0]/(1-c[0]-c[1]))):R&&(l=p.getDataLabelLength(E,T,"height"),o+=p.axis.convertPixelsToAxisPadding(l[1],r),a+=p.axis.convertPixelsToAxisPadding(l[0],r)),"y"===e&&S(g.axis_y_padding)&&(o=p.axis.getPadding(g.axis_y_padding,"top",o,r),a=p.axis.getPadding(g.axis_y_padding,"bottom",a,r)),"y2"===e&&S(g.axis_y2_padding)&&(o=p.axis.getPadding(g.axis_y2_padding,"top",o,r),a=p.axis.getPadding(g.axis_y2_padding,"bottom",a,r)),C&&(d&&(a=E),f&&(o=-T)),i=[E-a,T+o],b?i.reverse():i)},R.getXDomainMin=function(t){var e=this,n=e.config;return _(n.axis_x_min)?e.isTimeSeries()?this.parseDate(n.axis_x_min):n.axis_x_min:e.d3.min(t,function(t){return e.d3.min(t.values,function(t){return t.x})})},R.getXDomainMax=function(t){var e=this,n=e.config;return _(n.axis_x_max)?e.isTimeSeries()?this.parseDate(n.axis_x_max):n.axis_x_max:e.d3.max(t,function(t){return e.d3.max(t.values,function(t){return t.x})})},R.getXDomainPadding=function(t){var e,n,i,r,o=this,a=o.config,l=t[1]-t[0];return n=o.isCategorized()?0:o.hasType("bar")?(e=o.getMaxDataCount())>1?l/(e-1)/2:.5:.01*l,"object"===s(a.axis_x_padding)&&S(a.axis_x_padding)?(i=h(a.axis_x_padding.left)?a.axis_x_padding.left:n,r=h(a.axis_x_padding.right)?a.axis_x_padding.right:n):i=r="number"==typeof a.axis_x_padding?a.axis_x_padding:n,{left:i,right:r}},R.getXDomain=function(t){var e=this,n=[e.getXDomainMin(t),e.getXDomainMax(t)],i=n[0],r=n[1],o=e.getXDomainPadding(n),a=0,s=0;return i-r!=0||e.isCategorized()||(e.isTimeSeries()?(i=new Date(.5*i.getTime()),r=new Date(1.5*r.getTime())):(i=0===i?1:.5*i,r=0===r?-1:1.5*r)),(i||0===i)&&(a=e.isTimeSeries()?new Date(i.getTime()-o.left):i-o.left),(r||0===r)&&(s=e.isTimeSeries()?new Date(r.getTime()+o.right):r+o.right),[a,s]},R.updateXDomain=function(t,e,n,i,r){var o=this,a=o.config;return n&&(o.x.domain(r||o.d3.extent(o.getXDomain(t))),o.orgXDomain=o.x.domain(),a.zoom_enabled&&o.zoom.scale(o.x).updateScaleExtent(),o.subX.domain(o.x.domain()),o.brush&&o.brush.scale(o.subX)),e&&(o.x.domain(r||(!o.brush||o.brush.empty()?o.orgXDomain:o.brush.extent())),a.zoom_enabled&&o.zoom.scale(o.x).updateScaleExtent()),i&&o.x.domain(o.trimXDomain(o.x.orgDomain())),o.x.domain()},R.trimXDomain=function(t){var e=this.getZoomDomain(),n=e[0],i=e[1];return t[0]<=n&&(t[1]=+t[1]+(n-t[0]),t[0]=n),i<=t[1]&&(t[0]=+t[0]-(t[1]-i),t[1]=i),t},R.drag=function(t){var e,n,i,r,o,s,l,u,c=this,h=c.config,d=c.main,f=c.d3;c.hasArcType()||h.data_selection_enabled&&(h.zoom_enabled&&!c.zoom.altDomain||h.data_selection_multiple&&(e=c.dragStart[0],n=c.dragStart[1],i=t[0],r=t[1],o=Math.min(e,i),s=Math.max(e,i),l=h.data_selection_grouped?c.margin.top:Math.min(n,r),u=h.data_selection_grouped?c.height:Math.max(n,r),d.select("."+a.dragarea).attr("x",o).attr("y",l).attr("width",s-o).attr("height",u-l),d.selectAll("."+a.shapes).selectAll("."+a.shape).filter(function(t){return h.data_selection_isselectable(t)}).each(function(t,e){var n,i,r,h,d,p,g=f.select(this),_=g.classed(a.SELECTED),v=g.classed(a.INCLUDED),y=!1;if(g.classed(a.circle))n=1*g.attr("cx"),i=1*g.attr("cy"),d=c.togglePoint,y=o<n&&n<s&&l<i&&i<u;else{if(!g.classed(a.bar))return;n=(p=C(this)).x,i=p.y,r=p.width,h=p.height,d=c.togglePath,y=!(s<n||n+r<o||u<i||i+h<l)}y^v&&(g.classed(a.INCLUDED,!v),g.classed(a.SELECTED,!_),d.call(c,!_,g,t,e))})))},R.dragstart=function(t){var e=this,n=e.config;e.hasArcType()||n.data_selection_enabled&&(e.dragStart=t,e.main.select("."+a.chart).append("rect").attr("class",a.dragarea).style("opacity",.1),e.dragging=!0)},R.dragend=function(){var t=this,e=t.config;t.hasArcType()||e.data_selection_enabled&&(t.main.select("."+a.dragarea).transition().duration(100).style("opacity",0).remove(),t.main.selectAll("."+a.shape).classed(a.INCLUDED,!1),t.dragging=!1)},R.getYFormat=function(t){var e=this,n=t&&!e.hasType("gauge")?e.defaultArcValueFormat:e.yFormat,i=t&&!e.hasType("gauge")?e.defaultArcValueFormat:e.y2Format;return function(t,r,o){return("y2"===e.axis.getId(o)?i:n).call(e,t,r)}},R.yFormat=function(t){var e=this,n=e.config;return(n.axis_y_tick_format?n.axis_y_tick_format:e.defaultValueFormat)(t)},R.y2Format=function(t){var e=this,n=e.config;return(n.axis_y2_tick_format?n.axis_y2_tick_format:e.defaultValueFormat)(t)},R.defaultValueFormat=function(t){return h(t)?+t:""},R.defaultArcValueFormat=function(t,e){return(100*e).toFixed(1)+"%"},R.dataLabelFormat=function(t){var e=this.config.data_labels,n=function(t){return h(t)?+t:""};return"function"==typeof e.format?e.format:"object"===s(e.format)?e.format[t]?!0===e.format[t]?n:e.format[t]:function(){return""}:n},R.initGrid=function(){var t=this,e=t.config,n=t.d3;t.grid=t.main.append("g").attr("clip-path",t.clipPathForGrid).attr("class",a.grid),e.grid_x_show&&t.grid.append("g").attr("class",a.xgrids),e.grid_y_show&&t.grid.append("g").attr("class",a.ygrids),e.grid_focus_show&&t.grid.append("g").attr("class",a.xgridFocus).append("line").attr("class",a.xgridFocus),t.xgrid=n.selectAll([]),e.grid_lines_front||t.initGridLines()},R.initGridLines=function(){var t=this,e=t.d3;t.gridLines=t.main.append("g").attr("clip-path",t.clipPathForGrid).attr("class",a.grid+" "+a.gridLines),t.gridLines.append("g").attr("class",a.xgridLines),t.gridLines.append("g").attr("class",a.ygridLines),t.xgridLines=e.selectAll([])},R.updateXGrid=function(t){var e=this,n=e.config,i=e.d3,r=e.generateGridData(n.grid_x_type,e.x),o=e.isCategorized()?e.xAxis.tickOffset():0;e.xgridAttr=n.axis_rotated?{x1:0,x2:e.width,y1:function(t){return e.x(t)-o},y2:function(t){return e.x(t)-o}}:{x1:function(t){return e.x(t)+o},x2:function(t){return e.x(t)+o},y1:0,y2:e.height},e.xgrid=e.main.select("."+a.xgrids).selectAll("."+a.xgrid).data(r),e.xgrid.enter().append("line").attr("class",a.xgrid),t||e.xgrid.attr(e.xgridAttr).style("opacity",function(){return+i.select(this).attr(n.axis_rotated?"y1":"x1")===(n.axis_rotated?e.height:0)?0:1}),e.xgrid.exit().remove()},R.updateYGrid=function(){var t=this,e=t.config,n=t.yAxis.tickValues()||t.y.ticks(e.grid_y_ticks);t.ygrid=t.main.select("."+a.ygrids).selectAll("."+a.ygrid).data(n),t.ygrid.enter().append("line").attr("class",a.ygrid),t.ygrid.attr("x1",e.axis_rotated?t.y:0).attr("x2",e.axis_rotated?t.y:t.width).attr("y1",e.axis_rotated?0:t.y).attr("y2",e.axis_rotated?t.height:t.y),t.ygrid.exit().remove(),t.smoothLines(t.ygrid,"grid")},R.gridTextAnchor=function(t){return t.position?t.position:"end"},R.gridTextDx=function(t){return"start"===t.position?4:"middle"===t.position?0:-4},R.xGridTextX=function(t){return"start"===t.position?-this.height:"middle"===t.position?-this.height/2:0},R.yGridTextX=function(t){return"start"===t.position?0:"middle"===t.position?this.width/2:this.width},R.updateGrid=function(t){var e,n,i,r=this,o=r.main,s=r.config;r.grid.style("visibility",r.hasArcType()?"hidden":"visible"),o.select("line."+a.xgridFocus).style("visibility","hidden"),s.grid_x_show&&r.updateXGrid(),r.xgridLines=o.select("."+a.xgridLines).selectAll("."+a.xgridLine).data(s.grid_x_lines),(e=r.xgridLines.enter().append("g").attr("class",function(t){return a.xgridLine+(t.class?" "+t.class:"")})).append("line").style("opacity",0),e.append("text").attr("text-anchor",r.gridTextAnchor).attr("transform",s.axis_rotated?"":"rotate(-90)").attr("dx",r.gridTextDx).attr("dy",-5).style("opacity",0),r.xgridLines.exit().transition().duration(t).style("opacity",0).remove(),s.grid_y_show&&r.updateYGrid(),r.ygridLines=o.select("."+a.ygridLines).selectAll("."+a.ygridLine).data(s.grid_y_lines),(n=r.ygridLines.enter().append("g").attr("class",function(t){return a.ygridLine+(t.class?" "+t.class:"")})).append("line").style("opacity",0),n.append("text").attr("text-anchor",r.gridTextAnchor).attr("transform",s.axis_rotated?"rotate(-90)":"").attr("dx",r.gridTextDx).attr("dy",-5).style("opacity",0),i=r.yv.bind(r),r.ygridLines.select("line").transition().duration(t).attr("x1",s.axis_rotated?i:0).attr("x2",s.axis_rotated?i:r.width).attr("y1",s.axis_rotated?0:i).attr("y2",s.axis_rotated?r.height:i).style("opacity",1),r.ygridLines.select("text").transition().duration(t).attr("x",s.axis_rotated?r.xGridTextX.bind(r):r.yGridTextX.bind(r)).attr("y",i).text(function(t){return t.text}).style("opacity",1),r.ygridLines.exit().transition().duration(t).style("opacity",0).remove()},R.redrawGrid=function(t){var e=this,n=e.config,i=e.xv.bind(e),r=e.xgridLines.select("line"),o=e.xgridLines.select("text");return[(t?r.transition():r).attr("x1",n.axis_rotated?0:i).attr("x2",n.axis_rotated?e.width:i).attr("y1",n.axis_rotated?i:0).attr("y2",n.axis_rotated?i:e.height).style("opacity",1),(t?o.transition():o).attr("x",n.axis_rotated?e.yGridTextX.bind(e):e.xGridTextX.bind(e)).attr("y",i).text(function(t){return t.text}).style("opacity",1)]},R.showXGridFocus=function(t){var e=this,n=e.config,i=t.filter(function(t){return t&&h(t.value)}),r=e.main.selectAll("line."+a.xgridFocus),o=e.xx.bind(e);n.tooltip_show&&(e.hasType("scatter")||e.hasArcType()||(r.style("visibility","visible").data([i[0]]).attr(n.axis_rotated?"y1":"x1",o).attr(n.axis_rotated?"y2":"x2",o),e.smoothLines(r,"grid")))},R.hideXGridFocus=function(){this.main.select("line."+a.xgridFocus).style("visibility","hidden")},R.updateXgridFocus=function(){var t=this,e=t.config;t.main.select("line."+a.xgridFocus).attr("x1",e.axis_rotated?0:-10).attr("x2",e.axis_rotated?t.width:-10).attr("y1",e.axis_rotated?-10:0).attr("y2",e.axis_rotated?-10:t.height)},R.generateGridData=function(t,e){var n,i,r,o,s=this,l=[],u=s.main.select("."+a.axisX).selectAll(".tick").size();if("year"===t)for(i=(n=s.getXDomain())[0].getFullYear(),r=n[1].getFullYear(),o=i;o<=r;o++)l.push(new Date(o+"-01-01 00:00:00"));else(l=e.ticks(10)).length>u&&(l=l.filter(function(t){return(""+t).indexOf(".")<0}));return l},R.getGridFilterToRemove=function(t){return t?function(e){var n=!1;return[].concat(t).forEach(function(t){("value"in t&&e.value===t.value||"class"in t&&e.class===t.class)&&(n=!0)}),n}:function(){return!0}},R.removeGridLines=function(t,e){var n=this,i=n.config,r=n.getGridFilterToRemove(t),o=function(t){return!r(t)},s=e?a.xgridLines:a.ygridLines,l=e?a.xgridLine:a.ygridLine;n.main.select("."+s).selectAll("."+l).filter(r).transition().duration(i.transition_duration).style("opacity",0).remove(),e?i.grid_x_lines=i.grid_x_lines.filter(o):i.grid_y_lines=i.grid_y_lines.filter(o)},R.initEventRect=function(){this.main.select("."+a.chart).append("g").attr("class",a.eventRects).style("fill-opacity",0)},R.redrawEventRect=function(){var t,e,n=this,i=n.config,r=n.isMultipleX(),o=n.main.select("."+a.eventRects).style("cursor",i.zoom_enabled?i.axis_rotated?"ns-resize":"ew-resize":null).classed(a.eventRectsMultiple,r).classed(a.eventRectsSingle,!r);o.selectAll("."+a.eventRect).remove(),n.eventRect=o.selectAll("."+a.eventRect),r?(t=n.eventRect.data([0]),n.generateEventRectsForMultipleXs(t.enter()),n.updateEventRect(t)):(e=n.getMaxDataCountTarget(n.data.targets),o.datum(e?e.values:[]),n.eventRect=o.selectAll("."+a.eventRect),t=n.eventRect.data(function(t){return t}),n.generateEventRectsForSingleX(t.enter()),n.updateEventRect(t),t.exit().remove())},R.updateEventRect=function(t){var e,n,i,r,o,a,s=this,l=s.config;t=t||s.eventRect.data(function(t){return t}),s.isMultipleX()?(e=0,n=0,i=s.width,r=s.height):(!s.isCustomX()&&!s.isTimeSeries()||s.isCategorized()?(o=s.getEventRectWidth(),a=function(t){return s.x(t.x)-o/2}):(s.updateXs(),o=function(t){var e=s.getPrevX(t.index),n=s.getNextX(t.index);return null===e&&null===n?l.axis_rotated?s.height:s.width:(null===e&&(e=s.x.domain()[0]),null===n&&(n=s.x.domain()[1]),Math.max(0,(s.x(n)-s.x(e))/2))},a=function(t){var e=s.getPrevX(t.index),n=s.getNextX(t.index),i=s.data.xs[t.id][t.index];return null===e&&null===n?0:(null===e&&(e=s.x.domain()[0]),(s.x(i)+s.x(e))/2)}),e=l.axis_rotated?0:a,n=l.axis_rotated?a:0,i=l.axis_rotated?s.width:o,r=l.axis_rotated?o:s.height),t.attr("class",s.classEvent.bind(s)).attr("x",e).attr("y",n).attr("width",i).attr("height",r)},R.generateEventRectsForSingleX=function(t){var e=this,n=e.d3,i=e.config;t.append("rect").attr("class",e.classEvent.bind(e)).style("cursor",i.data_selection_enabled&&i.data_selection_grouped?"pointer":null).on("mouseover",function(t){var n=t.index;e.dragging||e.flowing||e.hasArcType()||(i.point_focus_expand_enabled&&e.expandCircles(n,null,!0),e.expandBars(n,null,!0),e.main.selectAll("."+a.shape+"-"+n).each(function(t){i.data_onmouseover.call(e.api,t)}))}).on("mouseout",function(t){var n=t.index;e.config&&(e.hasArcType()||(e.hideXGridFocus(),e.hideTooltip(),e.unexpandCircles(),e.unexpandBars(),e.main.selectAll("."+a.shape+"-"+n).each(function(t){i.data_onmouseout.call(e.api,t)})))}).on("mousemove",function(t){var r,o=t.index,s=e.svg.select("."+a.eventRect+"-"+o);e.dragging||e.flowing||e.hasArcType()||(e.isStepType(t)&&"step-after"===e.config.line_step_type&&n.mouse(this)[0]<e.x(e.getXValue(t.id,o))&&(o-=1),r=e.filterTargetsToShow(e.data.targets).map(function(t){return e.addName(e.getValueOnIndex(t.values,o))}),i.tooltip_grouped&&(e.showTooltip(r,this),e.showXGridFocus(r)),(!i.tooltip_grouped||i.data_selection_enabled&&!i.data_selection_grouped)&&e.main.selectAll("."+a.shape+"-"+o).each(function(){n.select(this).classed(a.EXPANDED,!0),i.data_selection_enabled&&s.style("cursor",i.data_selection_grouped?"pointer":null),i.tooltip_grouped||(e.hideXGridFocus(),e.hideTooltip(),i.data_selection_grouped||(e.unexpandCircles(o),e.unexpandBars(o)))}).filter(function(t){return e.isWithinShape(this,t)}).each(function(t){i.data_selection_enabled&&(i.data_selection_grouped||i.data_selection_isselectable(t))&&s.style("cursor","pointer"),i.tooltip_grouped||(e.showTooltip([t],this),e.showXGridFocus([t]),i.point_focus_expand_enabled&&e.expandCircles(o,t.id,!0),e.expandBars(o,t.id,!0))}))}).on("click",function(t){var r=t.index;!e.hasArcType()&&e.toggleShape&&(e.cancelClick?e.cancelClick=!1:(e.isStepType(t)&&"step-after"===i.line_step_type&&n.mouse(this)[0]<e.x(e.getXValue(t.id,r))&&(r-=1),e.main.selectAll("."+a.shape+"-"+r).each(function(t){(i.data_selection_grouped||e.isWithinShape(this,t))&&(e.toggleShape(this,t,r),e.config.data_onclick.call(e.api,t,this))})))}).call(i.data_selection_draggable&&e.drag?n.behavior.drag().origin(Object).on("drag",function(){e.drag(n.mouse(this))}).on("dragstart",function(){e.dragstart(n.mouse(this))}).on("dragend",function(){e.dragend()}):function(){})},R.generateEventRectsForMultipleXs=function(t){function e(){n.svg.select("."+a.eventRect).style("cursor",null),n.hideXGridFocus(),n.hideTooltip(),n.unexpandCircles(),n.unexpandBars()}var n=this,i=n.d3,r=n.config;t.append("rect").attr("x",0).attr("y",0).attr("width",n.width).attr("height",n.height).attr("class",a.eventRect).on("mouseout",function(){n.config&&(n.hasArcType()||e())}).on("mousemove",function(){var t,o,s,l=n.filterTargetsToShow(n.data.targets);n.dragging||n.hasArcType(l)||(t=i.mouse(this),o=n.findClosestFromTargets(l,t),!n.mouseover||o&&o.id===n.mouseover.id||(r.data_onmouseout.call(n.api,n.mouseover),n.mouseover=void 0),o?(s=(n.isScatterType(o)||!r.tooltip_grouped?[o]:n.filterByX(l,o.x)).map(function(t){return n.addName(t)}),n.showTooltip(s,this),r.point_focus_expand_enabled&&n.expandCircles(o.index,o.id,!0),n.expandBars(o.index,o.id,!0),n.showXGridFocus(s),(n.isBarType(o.id)||n.dist(o,t)<r.point_sensitivity)&&(n.svg.select("."+a.eventRect).style("cursor","pointer"),n.mouseover||(r.data_onmouseover.call(n.api,o),n.mouseover=o))):e())}).on("click",function(){var t,e,o=n.filterTargetsToShow(n.data.targets);n.hasArcType(o)||(t=i.mouse(this),(e=n.findClosestFromTargets(o,t))&&(n.isBarType(e.id)||n.dist(e,t)<r.point_sensitivity)&&n.main.selectAll("."+a.shapes+n.getTargetSelectorSuffix(e.id)).selectAll("."+a.shape+"-"+e.index).each(function(){(r.data_selection_grouped||n.isWithinShape(this,e))&&(n.toggleShape(this,e,e.index),n.config.data_onclick.call(n.api,e,this))}))}).call(r.data_selection_draggable&&n.drag?i.behavior.drag().origin(Object).on("drag",function(){n.drag(i.mouse(this))}).on("dragstart",function(){n.dragstart(i.mouse(this))}).on("dragend",function(){n.dragend()}):function(){})},R.dispatchEvent=function(t,e,n){var i=this,r="."+a.eventRect+(i.isMultipleX()?"":"-"+e),o=i.main.select(r).node(),s=o.getBoundingClientRect(),l=s.left+(n?n[0]:0),u=s.top+(n?n[1]:0),c=document.createEvent("MouseEvents");c.initMouseEvent(t,!0,!0,window,0,l,u,l,u,!1,!1,!1,!1,0,null),o.dispatchEvent(c)},R.initLegend=function(){var t=this;if(t.legendItemTextBox={},t.legendHasRendered=!1,t.legend=t.svg.append("g").attr("transform",t.getTranslate("legend")),!t.config.legend_show)return t.legend.style("visibility","hidden"),void(t.hiddenLegendIds=t.mapToIds(t.data.targets));t.updateLegendWithDefaults()},R.updateLegendWithDefaults=function(){var t=this;t.updateLegend(t.mapToIds(t.data.targets),{withTransform:!1,withTransitionForTransform:!1,withTransition:!1})},R.updateSizeForLegend=function(t,e){var n=this,i=n.config,r={top:n.isLegendTop?n.getCurrentPaddingTop()+i.legend_inset_y+5.5:n.currentHeight-t-n.getCurrentPaddingBottom()-i.legend_inset_y,left:n.isLegendLeft?n.getCurrentPaddingLeft()+i.legend_inset_x+.5:n.currentWidth-e-n.getCurrentPaddingRight()-i.legend_inset_x+.5};n.margin3={top:n.isLegendRight?0:n.isLegendInset?r.top:n.currentHeight-t,right:NaN,bottom:0,left:n.isLegendRight?n.currentWidth-e:n.isLegendInset?r.left:0}},R.transformLegend=function(t){var e=this;(t?e.legend.transition():e.legend).attr("transform",e.getTranslate("legend"))},R.updateLegendStep=function(t){this.legendStep=t},R.updateLegendItemWidth=function(t){this.legendItemWidth=t},R.updateLegendItemHeight=function(t){this.legendItemHeight=t},R.getLegendWidth=function(){var t=this;return t.config.legend_show?t.isLegendRight||t.isLegendInset?t.legendItemWidth*(t.legendStep+1):t.currentWidth:0},R.getLegendHeight=function(){var t=this,e=0;return t.config.legend_show&&(e=t.isLegendRight?t.currentHeight:Math.max(20,t.legendItemHeight)*(t.legendStep+1)),e},R.opacityForLegend=function(t){return t.classed(a.legendItemHidden)?null:1},R.opacityForUnfocusedLegend=function(t){return t.classed(a.legendItemHidden)?null:.3},R.toggleFocusLegend=function(t,e){var n=this;t=n.mapToTargetIds(t),n.legend.selectAll("."+a.legendItem).filter(function(e){return t.indexOf(e)>=0}).classed(a.legendItemFocused,e).transition().duration(100).style("opacity",function(){return(e?n.opacityForLegend:n.opacityForUnfocusedLegend).call(n,n.d3.select(this))})},R.revertLegend=function(){var t=this,e=t.d3;t.legend.selectAll("."+a.legendItem).classed(a.legendItemFocused,!1).transition().duration(100).style("opacity",function(){return t.opacityForLegend(e.select(this))})},R.showLegend=function(t){var e=this,n=e.config;n.legend_show||(n.legend_show=!0,e.legend.style("visibility","visible"),e.legendHasRendered||e.updateLegendWithDefaults()),e.removeHiddenLegendIds(t),e.legend.selectAll(e.selectorLegends(t)).style("visibility","visible").transition().style("opacity",function(){return e.opacityForLegend(e.d3.select(this))})},R.hideLegend=function(t){var e=this,n=e.config;n.legend_show&&x(t)&&(n.legend_show=!1,e.legend.style("visibility","hidden")),e.addHiddenLegendIds(t),e.legend.selectAll(e.selectorLegends(t)).style("opacity",0).style("visibility","hidden")},R.clearLegendItemTextBoxCache=function(){this.legendItemTextBox={}},R.updateLegend=function(t,e,n){function i(t,e){return w.legendItemTextBox[e]||(w.legendItemTextBox[e]=w.getTextRect(t.textContent,a.legendItem,t)),w.legendItemTextBox[e]}function r(e,n,r){function o(t,e){e||(a=(p-M-f)/2)<I&&(a=(p-f)/2,M=0,G++),N[t]=G,k[G]=w.isLegendInset?10:a,O[t]=M,M+=f}var a,s,l=0===r,u=r===t.length-1,c=i(e,n),h=c.width+P+(!u||w.isLegendRight||w.isLegendInset?A:0)+C.legend_padding,d=c.height+b,f=w.isLegendRight||w.isLegendInset?d:h,p=w.isLegendRight||w.isLegendInset?w.getLegendHeight():w.getLegendWidth();l&&(M=0,G=0,R=0,L=0),!C.legend_show||w.isLegendToShow(n)?(D[n]=h,F[n]=d,(!R||h>=R)&&(R=h),(!L||d>=L)&&(L=d),s=w.isLegendRight||w.isLegendInset?L:R,C.legend_equally?(Object.keys(D).forEach(function(t){D[t]=R}),Object.keys(F).forEach(function(t){F[t]=L}),(a=(p-s*t.length)/2)<I?(M=0,G=0,t.forEach(function(t){o(t)})):o(n,!0)):o(n)):D[n]=F[n]=N[n]=O[n]=0}var o,s,l,u,c,h,d,f,p,g,v,y,m,x,S,T,w=this,C=w.config,b=4,A=10,R=0,L=0,I=10,P=C.legend_item_tile_width+5,M=0,O={},D={},F={},k=[0],N={},G=0;t=t.filter(function(t){return!_(C.data_names[t])||null!==C.data_names[t]}),v=E(e=e||{},"withTransition",!0),y=E(e,"withTransitionForTransform",!0),w.isLegendInset&&(G=C.legend_inset_step?C.legend_inset_step:t.length,w.updateLegendStep(G)),w.isLegendRight?(o=function(t){return R*N[t]},u=function(t){return k[N[t]]+O[t]}):w.isLegendInset?(o=function(t){return R*N[t]+10},u=function(t){return k[N[t]]+O[t]}):(o=function(t){return k[N[t]]+O[t]},u=function(t){return L*N[t]}),s=function(t,e){return o(t,e)+4+C.legend_item_tile_width},c=function(t,e){return u(t,e)+9},l=function(t,e){return o(t,e)},h=function(t,e){return u(t,e)-5},d=function(t,e){return o(t,e)-2},f=function(t,e){return o(t,e)-2+C.legend_item_tile_width},p=function(t,e){return u(t,e)+4},(g=w.legend.selectAll("."+a.legendItem).data(t).enter().append("g").attr("class",function(t){return w.generateClass(a.legendItem,t)}).style("visibility",function(t){return w.isLegendToShow(t)?"visible":"hidden"}).style("cursor","pointer").on("click",function(t){C.legend_item_onclick?C.legend_item_onclick.call(w,t):w.d3.event.altKey?(w.api.hide(),w.api.show(t)):(w.api.toggle(t),w.isTargetToShow(t)?w.api.focus(t):w.api.revert())}).on("mouseover",function(t){C.legend_item_onmouseover?C.legend_item_onmouseover.call(w,t):(w.d3.select(this).classed(a.legendItemFocused,!0),!w.transiting&&w.isTargetToShow(t)&&w.api.focus(t))}).on("mouseout",function(t){C.legend_item_onmouseout?C.legend_item_onmouseout.call(w,t):(w.d3.select(this).classed(a.legendItemFocused,!1),w.api.revert())})).append("text").text(function(t){return _(C.data_names[t])?C.data_names[t]:t}).each(function(t,e){r(this,t,e)}).style("pointer-events","none").attr("x",w.isLegendRight||w.isLegendInset?s:-200).attr("y",w.isLegendRight||w.isLegendInset?-200:c),g.append("rect").attr("class",a.legendItemEvent).style("fill-opacity",0).attr("x",w.isLegendRight||w.isLegendInset?l:-200).attr("y",w.isLegendRight||w.isLegendInset?-200:h),g.append("line").attr("class",a.legendItemTile).style("stroke",w.color).style("pointer-events","none").attr("x1",w.isLegendRight||w.isLegendInset?d:-200).attr("y1",w.isLegendRight||w.isLegendInset?-200:p).attr("x2",w.isLegendRight||w.isLegendInset?f:-200).attr("y2",w.isLegendRight||w.isLegendInset?-200:p).attr("stroke-width",C.legend_item_tile_height),T=w.legend.select("."+a.legendBackground+" rect"),w.isLegendInset&&R>0&&0===T.size()&&(T=w.legend.insert("g","."+a.legendItem).attr("class",a.legendBackground).append("rect")),m=w.legend.selectAll("text").data(t).text(function(t){return _(C.data_names[t])?C.data_names[t]:t}).each(function(t,e){r(this,t,e)}),(v?m.transition():m).attr("x",s).attr("y",c),x=w.legend.selectAll("rect."+a.legendItemEvent).data(t),(v?x.transition():x).attr("width",function(t){return D[t]}).attr("height",function(t){return F[t]}).attr("x",l).attr("y",h),S=w.legend.selectAll("line."+a.legendItemTile).data(t),(v?S.transition():S).style("stroke",w.color).attr("x1",d).attr("y1",p).attr("x2",f).attr("y2",p),T&&(v?T.transition():T).attr("height",w.getLegendHeight()-12).attr("width",R*(G+1)+10),w.legend.selectAll("."+a.legendItem).classed(a.legendItemHidden,function(t){return!w.isTargetToShow(t)}),w.updateLegendItemWidth(R),w.updateLegendItemHeight(L),w.updateLegendStep(G),w.updateSizes(),w.updateScales(),w.updateSvgSize(),w.transformAll(y,n),w.legendHasRendered=!0},R.initRegion=function(){var t=this;t.region=t.main.append("g").attr("clip-path",t.clipPath).attr("class",a.regions)},R.updateRegion=function(t){var e=this,n=e.config;e.region.style("visibility",e.hasArcType()?"hidden":"visible"),e.mainRegion=e.main.select("."+a.regions).selectAll("."+a.region).data(n.regions),e.mainRegion.enter().append("g").append("rect").style("fill-opacity",0),e.mainRegion.attr("class",e.classRegion.bind(e)),e.mainRegion.exit().transition().duration(t).style("opacity",0).remove()},R.redrawRegion=function(t){var e=this,n=e.mainRegion.selectAll("rect").each(function(){var t=e.d3.select(this.parentNode).datum();e.d3.select(this).datum(t)}),i=e.regionX.bind(e),r=e.regionY.bind(e),o=e.regionWidth.bind(e),a=e.regionHeight.bind(e);return[(t?n.transition():n).attr("x",i).attr("y",r).attr("width",o).attr("height",a).style("fill-opacity",function(t){return h(t.opacity)?t.opacity:.1})]},R.regionX=function(t){var e=this,n=e.config,i="y"===t.axis?e.y:e.y2;return"y"===t.axis||"y2"===t.axis?n.axis_rotated&&"start"in t?i(t.start):0:n.axis_rotated?0:"start"in t?e.x(e.isTimeSeries()?e.parseDate(t.start):t.start):0},R.regionY=function(t){var e=this,n=e.config,i="y"===t.axis?e.y:e.y2;return"y"===t.axis||"y2"===t.axis?n.axis_rotated?0:"end"in t?i(t.end):0:n.axis_rotated&&"start"in t?e.x(e.isTimeSeries()?e.parseDate(t.start):t.start):0},R.regionWidth=function(t){var e,n=this,i=n.config,r=n.regionX(t),o="y"===t.axis?n.y:n.y2;return(e="y"===t.axis||"y2"===t.axis?i.axis_rotated&&"end"in t?o(t.end):n.width:i.axis_rotated?n.width:"end"in t?n.x(n.isTimeSeries()?n.parseDate(t.end):t.end):n.width)<r?0:e-r},R.regionHeight=function(t){var e,n=this,i=n.config,r=this.regionY(t),o="y"===t.axis?n.y:n.y2;return(e="y"===t.axis||"y2"===t.axis?i.axis_rotated?n.height:"start"in t?o(t.start):n.height:i.axis_rotated&&"end"in t?n.x(n.isTimeSeries()?n.parseDate(t.end):t.end):n.height)<r?0:e-r},R.isRegionOnX=function(t){return!t.axis||"x"===t.axis},R.getScale=function(t,e,n){return(n?this.d3.time.scale():this.d3.scale.linear()).range([t,e])},R.getX=function(t,e,n,i){var r,o=this,a=o.getScale(t,e,o.isTimeSeries()),s=n?a.domain(n):a;o.isCategorized()?(i=i||function(){return 0},a=function(t,e){var n=s(t)+i(t);return e?n:Math.ceil(n)}):a=function(t,e){var n=s(t);return e?n:Math.ceil(n)};for(r in s)a[r]=s[r];return a.orgDomain=function(){return s.domain()},o.isCategorized()&&(a.domain=function(t){return arguments.length?(s.domain(t),a):(t=this.orgDomain(),[t[0],t[1]+1])}),a},R.getY=function(t,e,n){var i=this.getScale(t,e,this.isTimeSeriesY());return n&&i.domain(n),i},R.getYScale=function(t){return"y2"===this.axis.getId(t)?this.y2:this.y},R.getSubYScale=function(t){return"y2"===this.axis.getId(t)?this.subY2:this.subY},R.updateScales=function(){var t=this,e=t.config,n=!t.x;t.xMin=e.axis_rotated?1:0,t.xMax=e.axis_rotated?t.height:t.width,t.yMin=e.axis_rotated?0:t.height,t.yMax=e.axis_rotated?t.width:1,t.subXMin=t.xMin,t.subXMax=t.xMax,t.subYMin=e.axis_rotated?0:t.height2,t.subYMax=e.axis_rotated?t.width2:1,t.x=t.getX(t.xMin,t.xMax,n?void 0:t.x.orgDomain(),function(){return t.xAxis.tickOffset()}),t.y=t.getY(t.yMin,t.yMax,n?e.axis_y_default:t.y.domain()),t.y2=t.getY(t.yMin,t.yMax,n?e.axis_y2_default:t.y2.domain()),t.subX=t.getX(t.xMin,t.xMax,t.orgXDomain,function(e){return e%1?0:t.subXAxis.tickOffset()}),t.subY=t.getY(t.subYMin,t.subYMax,n?e.axis_y_default:t.subY.domain()),t.subY2=t.getY(t.subYMin,t.subYMax,n?e.axis_y2_default:t.subY2.domain()),t.xAxisTickFormat=t.axis.getXAxisTickFormat(),t.xAxisTickValues=t.axis.getXAxisTickValues(),t.yAxisTickValues=t.axis.getYAxisTickValues(),t.y2AxisTickValues=t.axis.getY2AxisTickValues(),t.xAxis=t.axis.getXAxis(t.x,t.xOrient,t.xAxisTickFormat,t.xAxisTickValues,e.axis_x_tick_outer),t.subXAxis=t.axis.getXAxis(t.subX,t.subXOrient,t.xAxisTickFormat,t.xAxisTickValues,e.axis_x_tick_outer),t.yAxis=t.axis.getYAxis(t.y,t.yOrient,e.axis_y_tick_format,t.yAxisTickValues,e.axis_y_tick_outer),t.y2Axis=t.axis.getYAxis(t.y2,t.y2Orient,e.axis_y2_tick_format,t.y2AxisTickValues,e.axis_y2_tick_outer),n||(t.brush&&t.brush.scale(t.subX),e.zoom_enabled&&t.zoom.scale(t.x)),t.updateArc&&t.updateArc()},R.selectPoint=function(t,e,n){var i=this,r=i.config,o=(r.axis_rotated?i.circleY:i.circleX).bind(i),s=(r.axis_rotated?i.circleX:i.circleY).bind(i),l=i.pointSelectR.bind(i);r.data_onselected.call(i.api,e,t.node()),i.main.select("."+a.selectedCircles+i.getTargetSelectorSuffix(e.id)).selectAll("."+a.selectedCircle+"-"+n).data([e]).enter().append("circle").attr("class",function(){return i.generateClass(a.selectedCircle,n)}).attr("cx",o).attr("cy",s).attr("stroke",function(){return i.color(e)}).attr("r",function(t){return 1.4*i.pointSelectR(t)}).transition().duration(100).attr("r",l)},R.unselectPoint=function(t,e,n){var i=this;i.config.data_onunselected.call(i.api,e,t.node()),i.main.select("."+a.selectedCircles+i.getTargetSelectorSuffix(e.id)).selectAll("."+a.selectedCircle+"-"+n).transition().duration(100).attr("r",0).remove()},R.togglePoint=function(t,e,n,i){t?this.selectPoint(e,n,i):this.unselectPoint(e,n,i)},R.selectPath=function(t,e){var n=this;n.config.data_onselected.call(n,e,t.node()),n.config.interaction_brighten&&t.transition().duration(100).style("fill",function(){return n.d3.rgb(n.color(e)).brighter(.75)})},R.unselectPath=function(t,e){var n=this;n.config.data_onunselected.call(n,e,t.node()),n.config.interaction_brighten&&t.transition().duration(100).style("fill",function(){return n.color(e)})},R.togglePath=function(t,e,n,i){t?this.selectPath(e,n,i):this.unselectPath(e,n,i)},R.getToggle=function(t,e){var n,i=this;return"circle"===t.nodeName?n=i.isStepType(e)?function(){}:i.togglePoint:"path"===t.nodeName&&(n=i.togglePath),n},R.toggleShape=function(t,e,n){var i=this,r=i.d3,o=i.config,s=r.select(t),l=s.classed(a.SELECTED),u=i.getToggle(t,e).bind(i);o.data_selection_enabled&&o.data_selection_isselectable(e)&&(o.data_selection_multiple||i.main.selectAll("."+a.shapes+(o.data_selection_grouped?i.getTargetSelectorSuffix(e.id):"")).selectAll("."+a.shape).each(function(t,e){var n=r.select(this);n.classed(a.SELECTED)&&u(!1,n.classed(a.SELECTED,!1),t,e)}),s.classed(a.SELECTED,!l),u(!l,s,e,n))},R.initBar=function(){this.main.select("."+a.chart).append("g").attr("class",a.chartBars)},R.updateTargetsForBar=function(t){var e=this,n=e.config,i=e.classChartBar.bind(e),r=e.classBars.bind(e),o=e.classFocus.bind(e);e.main.select("."+a.chartBars).selectAll("."+a.chartBar).data(t).attr("class",function(t){return i(t)+o(t)}).enter().append("g").attr("class",i).style("pointer-events","none").append("g").attr("class",r).style("cursor",function(t){return n.data_selection_isselectable(t)?"pointer":null})},R.updateBar=function(t){var e=this,n=e.barData.bind(e),i=e.classBar.bind(e),r=e.initialOpacity.bind(e),o=function(t){return e.color(t.id)};e.mainBar=e.main.selectAll("."+a.bars).selectAll("."+a.bar).data(n),e.mainBar.enter().append("path").attr("class",i).style("stroke",o).style("fill",o),e.mainBar.style("opacity",r),e.mainBar.exit().transition().duration(t).remove()},R.redrawBar=function(t,e){return[(e?this.mainBar.transition(Math.random().toString()):this.mainBar).attr("d",t).style("stroke",this.color).style("fill",this.color).style("opacity",1)]},R.getBarW=function(t,e){var n=this.config,i="number"==typeof n.bar_width?n.bar_width:e?t.tickInterval()*n.bar_width_ratio/e:0;return n.bar_width_max&&i>n.bar_width_max?n.bar_width_max:i},R.getBars=function(t,e){var n=this;return(e?n.main.selectAll("."+a.bars+n.getTargetSelectorSuffix(e)):n.main).selectAll("."+a.bar+(h(t)?"-"+t:""))},R.expandBars=function(t,e,n){var i=this;n&&i.unexpandBars(),i.getBars(t,e).classed(a.EXPANDED,!0)},R.unexpandBars=function(t){this.getBars(t).classed(a.EXPANDED,!1)},R.generateDrawBar=function(t,e){var n=this,i=n.config,r=n.generateGetBarPoints(t,e);return function(t,e){var n=r(t,e),o=i.axis_rotated?1:0,a=i.axis_rotated?0:1;return"M "+n[0][o]+","+n[0][a]+" L"+n[1][o]+","+n[1][a]+" L"+n[2][o]+","+n[2][a]+" L"+n[3][o]+","+n[3][a]+" z"}},R.generateGetBarPoints=function(t,e){var n=this,i=e?n.subXAxis:n.xAxis,r=t.__max__+1,o=n.getBarW(i,r),a=n.getShapeX(o,r,t,!!e),s=n.getShapeY(!!e),l=n.getShapeOffset(n.isBarType,t,!!e),u=o*(n.config.bar_space/2),c=e?n.getSubYScale:n.getYScale;return function(t,e){var i=c.call(n,t.id)(0),r=l(t,e)||i,h=a(t),d=s(t);return n.config.axis_rotated&&(0<t.value&&d<i||t.value<0&&i<d)&&(d=i),[[h+u,r],[h+u,d-(i-r)],[h+o-u,d-(i-r)],[h+o-u,r]]}},R.isWithinBar=function(t){var e=this.d3.mouse(t),n=t.getBoundingClientRect(),i=t.pathSegList.getItem(0),r=t.pathSegList.getItem(1),o=Math.min(i.x,r.x),a=Math.min(i.y,r.y),s=o+n.width+2,l=a+n.height+2,u=a-2;return o-2<e[0]&&e[0]<s&&u<e[1]&&e[1]<l},R.getShapeIndices=function(t){var e,n,i=this,r=i.config,o={},a=0;return i.filterTargetsToShow(i.data.targets.filter(t,i)).forEach(function(t){for(e=0;e<r.data_groups.length;e++)if(!(r.data_groups[e].indexOf(t.id)<0))for(n=0;n<r.data_groups[e].length;n++)if(r.data_groups[e][n]in o){o[t.id]=o[r.data_groups[e][n]];break}g(o[t.id])&&(o[t.id]=a++)}),o.__max__=a-1,o},R.getShapeX=function(t,e,n,i){var r=this,o=i?r.subX:r.x;return function(i){var r=i.id in n?n[i.id]:0;return i.x||0===i.x?o(i.x)-t*(e/2-r):0}},R.getShapeY=function(t){var e=this;return function(n){return(t?e.getSubYScale(n.id):e.getYScale(n.id))(n.value)}},R.getShapeOffset=function(t,e,n){var i=this,r=i.orderTargets(i.filterTargetsToShow(i.data.targets.filter(t,i))),o=r.map(function(t){return t.id});return function(t,a){var s=n?i.getSubYScale(t.id):i.getYScale(t.id),l=s(0),u=l;return r.forEach(function(n){var r=i.isStepType(t)?i.convertValuesToStep(n.values):n.values;n.id!==t.id&&e[n.id]===e[t.id]&&o.indexOf(n.id)<o.indexOf(t.id)&&(void 0!==r[a]&&+r[a].x==+t.x||(a=-1,r.forEach(function(e,n){e.x===t.x&&(a=n)})),a in r&&r[a].value*t.value>=0&&(u+=s(r[a].value)-l))}),u}},R.isWithinShape=function(t,e){var n,i=this,r=i.d3.select(t);return i.isTargetToShow(e.id)?"circle"===t.nodeName?n=i.isStepType(e)?i.isWithinStep(t,i.getYScale(e.id)(e.value)):i.isWithinCircle(t,1.5*i.pointSelectR(e)):"path"===t.nodeName&&(n=!r.classed(a.bar)||i.isWithinBar(t)):n=!1,n},R.getInterpolate=function(t){var e=this,n=e.isInterpolationType(e.config.spline_interpolation_type)?e.config.spline_interpolation_type:"cardinal";return e.isSplineType(t)?n:e.isStepType(t)?e.config.line_step_type:"linear"},R.initLine=function(){this.main.select("."+a.chart).append("g").attr("class",a.chartLines)},R.updateTargetsForLine=function(t){var e,n=this,i=n.config,r=n.classChartLine.bind(n),o=n.classLines.bind(n),s=n.classAreas.bind(n),l=n.classCircles.bind(n),u=n.classFocus.bind(n);(e=n.main.select("."+a.chartLines).selectAll("."+a.chartLine).data(t).attr("class",function(t){return r(t)+u(t)}).enter().append("g").attr("class",r).style("opacity",0).style("pointer-events","none")).append("g").attr("class",o),e.append("g").attr("class",s),e.append("g").attr("class",function(t){return n.generateClass(a.selectedCircles,t.id)}),e.append("g").attr("class",l).style("cursor",function(t){return i.data_selection_isselectable(t)?"pointer":null}),t.forEach(function(t){n.main.selectAll("."+a.selectedCircles+n.getTargetSelectorSuffix(t.id)).selectAll("."+a.selectedCircle).each(function(e){e.value=t.values[e.index].value})})},R.updateLine=function(t){var e=this;e.mainLine=e.main.selectAll("."+a.lines).selectAll("."+a.line).data(e.lineData.bind(e)),e.mainLine.enter().append("path").attr("class",e.classLine.bind(e)).style("stroke",e.color),e.mainLine.style("opacity",e.initialOpacity.bind(e)).style("shape-rendering",function(t){return e.isStepType(t)?"crispEdges":""}).attr("transform",null),e.mainLine.exit().transition().duration(t).style("opacity",0).remove()},R.redrawLine=function(t,e){return[(e?this.mainLine.transition(Math.random().toString()):this.mainLine).attr("d",t).style("stroke",this.color).style("opacity",1)]},R.generateDrawLine=function(t,e){var n=this,i=n.config,r=n.d3.svg.line(),o=n.generateGetLinePoints(t,e),a=e?n.getSubYScale:n.getYScale,s=function(t){return(e?n.subxx:n.xx).call(n,t)},l=function(t,e){return i.data_groups.length>0?o(t,e)[0][1]:a.call(n,t.id)(t.value)};return r=i.axis_rotated?r.x(l).y(s):r.x(s).y(l),i.line_connectNull||(r=r.defined(function(t){return null!=t.value})),function(t){var o,s=i.line_connectNull?n.filterRemoveNull(t.values):t.values,l=e?n.x:n.subX,u=a.call(n,t.id),c=0,h=0;return n.isLineType(t)?i.data_regions[t.id]?o=n.lineWithRegions(s,l,u,i.data_regions[t.id]):(n.isStepType(t)&&(s=n.convertValuesToStep(s)),o=r.interpolate(n.getInterpolate(t))(s)):(s[0]&&(c=l(s[0].x),h=u(s[0].value)),o=i.axis_rotated?"M "+h+" "+c:"M "+c+" "+h),o||"M 0 0"}},R.generateGetLinePoints=function(t,e){var n=this,i=n.config,r=t.__max__+1,o=n.getShapeX(0,r,t,!!e),a=n.getShapeY(!!e),s=n.getShapeOffset(n.isLineType,t,!!e),l=e?n.getSubYScale:n.getYScale;return function(t,e){var r=l.call(n,t.id)(0),u=s(t,e)||r,c=o(t),h=a(t);return i.axis_rotated&&(0<t.value&&h<r||t.value<0&&r<h)&&(h=r),[[c,h-(r-u)],[c,h-(r-u)],[c,h-(r-u)],[c,h-(r-u)]]}},R.lineWithRegions=function(t,e,n,i){function r(t){return"M"+t[0][0]+" "+t[0][1]+" "+t[1][0]+" "+t[1][1]}var o,a,s,l,u,c,h,d,f,p,v,y=this,m=y.config,x="M",S=y.isCategorized()?.5:0,E=[];if(_(i))for(o=0;o<i.length;o++)E[o]={},g(i[o].start)?E[o].start=t[0].x:E[o].start=y.isTimeSeries()?y.parseDate(i[o].start):i[o].start,g(i[o].end)?E[o].end=t[t.length-1].x:E[o].end=y.isTimeSeries()?y.parseDate(i[o].end):i[o].end;for(p=m.axis_rotated?function(t){return n(t.value)}:function(t){return e(t.x)},v=m.axis_rotated?function(t){return e(t.x)}:function(t){return n(t.value)},s=y.isTimeSeries()?function(t,i,o,a){var s,l=t.x.getTime(),c=i.x-t.x,h=new Date(l+c*o),d=new Date(l+c*(o+a));return s=m.axis_rotated?[[n(u(o)),e(h)],[n(u(o+a)),e(d)]]:[[e(h),n(u(o))],[e(d),n(u(o+a))]],r(s)}:function(t,i,o,a){var s;return s=m.axis_rotated?[[n(u(o),!0),e(l(o))],[n(u(o+a),!0),e(l(o+a))]]:[[e(l(o),!0),n(u(o))],[e(l(o+a),!0),n(u(o+a))]],r(s)},o=0;o<t.length;o++){if(g(E)||!function(t,e){var n;for(n=0;n<e.length;n++)if(e[n].start<t&&t<=e[n].end)return!0;return!1}(t[o].x,E))x+=" "+p(t[o])+" "+v(t[o]);else for(l=y.getScale(t[o-1].x+S,t[o].x+S,y.isTimeSeries()),u=y.getScale(t[o-1].value,t[o].value),c=e(t[o].x)-e(t[o-1].x),h=n(t[o].value)-n(t[o-1].value),f=2*(d=2/Math.sqrt(Math.pow(c,2)+Math.pow(h,2))),a=d;a<=1;a+=f)x+=s(t[o-1],t[o],a,d);t[o].x}return x},R.updateArea=function(t){var e=this,n=e.d3;e.mainArea=e.main.selectAll("."+a.areas).selectAll("."+a.area).data(e.lineData.bind(e)),e.mainArea.enter().append("path").attr("class",e.classArea.bind(e)).style("fill",e.color).style("opacity",function(){return e.orgAreaOpacity=+n.select(this).style("opacity"),0}),e.mainArea.style("opacity",e.orgAreaOpacity),e.mainArea.exit().transition().duration(t).style("opacity",0).remove()},R.redrawArea=function(t,e){return[(e?this.mainArea.transition(Math.random().toString()):this.mainArea).attr("d",t).style("fill",this.color).style("opacity",this.orgAreaOpacity)]},R.generateDrawArea=function(t,e){var n=this,i=n.config,r=n.d3.svg.area(),o=n.generateGetAreaPoints(t,e),a=e?n.getSubYScale:n.getYScale,s=function(t){return(e?n.subxx:n.xx).call(n,t)},l=function(t,e){return i.data_groups.length>0?o(t,e)[0][1]:a.call(n,t.id)(n.getAreaBaseValue(t.id))},u=function(t,e){return i.data_groups.length>0?o(t,e)[1][1]:a.call(n,t.id)(t.value)};return r=i.axis_rotated?r.x0(l).x1(u).y(s):r.x(s).y0(i.area_above?0:l).y1(u),i.line_connectNull||(r=r.defined(function(t){return null!==t.value})),function(t){var e,o=i.line_connectNull?n.filterRemoveNull(t.values):t.values,a=0,s=0;return n.isAreaType(t)?(n.isStepType(t)&&(o=n.convertValuesToStep(o)),e=r.interpolate(n.getInterpolate(t))(o)):(o[0]&&(a=n.x(o[0].x),s=n.getYScale(t.id)(o[0].value)),e=i.axis_rotated?"M "+s+" "+a:"M "+a+" "+s),e||"M 0 0"}},R.getAreaBaseValue=function(){return 0},R.generateGetAreaPoints=function(t,e){var n=this,i=n.config,r=t.__max__+1,o=n.getShapeX(0,r,t,!!e),a=n.getShapeY(!!e),s=n.getShapeOffset(n.isAreaType,t,!!e),l=e?n.getSubYScale:n.getYScale;return function(t,e){var r=l.call(n,t.id)(0),u=s(t,e)||r,c=o(t),h=a(t);return i.axis_rotated&&(0<t.value&&h<r||t.value<0&&r<h)&&(h=r),[[c,u],[c,h-(r-u)],[c,h-(r-u)],[c,u]]}},R.updateCircle=function(){var t=this;t.mainCircle=t.main.selectAll("."+a.circles).selectAll("."+a.circle).data(t.lineOrScatterData.bind(t)),t.mainCircle.enter().append("circle").attr("class",t.classCircle.bind(t)).attr("r",t.pointR.bind(t)).style("fill",t.color),t.mainCircle.style("opacity",t.initialOpacityForCircle.bind(t)),t.mainCircle.exit().remove()},R.redrawCircle=function(t,e,n){var i=this.main.selectAll("."+a.selectedCircle);return[(n?this.mainCircle.transition(Math.random().toString()):this.mainCircle).style("opacity",this.opacityForCircle.bind(this)).style("fill",this.color).attr("cx",t).attr("cy",e),(n?i.transition(Math.random().toString()):i).attr("cx",t).attr("cy",e)]},R.circleX=function(t){return t.x||0===t.x?this.x(t.x):null},R.updateCircleY=function(){var t,e,n=this;n.config.data_groups.length>0?(t=n.getShapeIndices(n.isLineType),e=n.generateGetLinePoints(t),n.circleY=function(t,n){return e(t,n)[0][1]}):n.circleY=function(t){return n.getYScale(t.id)(t.value)}},R.getCircles=function(t,e){var n=this;return(e?n.main.selectAll("."+a.circles+n.getTargetSelectorSuffix(e)):n.main).selectAll("."+a.circle+(h(t)?"-"+t:""))},R.expandCircles=function(t,e,n){var i=this,r=i.pointExpandedR.bind(i);n&&i.unexpandCircles(),i.getCircles(t,e).classed(a.EXPANDED,!0).attr("r",r)},R.unexpandCircles=function(t){var e=this,n=e.pointR.bind(e);e.getCircles(t).filter(function(){return e.d3.select(this).classed(a.EXPANDED)}).classed(a.EXPANDED,!1).attr("r",n)},R.pointR=function(t){var e=this,n=e.config;return e.isStepType(t)?0:d(n.point_r)?n.point_r(t):n.point_r},R.pointExpandedR=function(t){var e=this,n=e.config;return n.point_focus_expand_enabled?d(n.point_focus_expand_r)?n.point_focus_expand_r(t):n.point_focus_expand_r?n.point_focus_expand_r:1.75*e.pointR(t):e.pointR(t)},R.pointSelectR=function(t){var e=this,n=e.config;return d(n.point_select_r)?n.point_select_r(t):n.point_select_r?n.point_select_r:4*e.pointR(t)},R.isWithinCircle=function(t,e){var n=this.d3,i=n.mouse(t),r=n.select(t),o=+r.attr("cx"),a=+r.attr("cy");return Math.sqrt(Math.pow(o-i[0],2)+Math.pow(a-i[1],2))<e},R.isWithinStep=function(t,e){return Math.abs(e-this.d3.mouse(t)[1])<30},R.getCurrentWidth=function(){var t=this,e=t.config;return e.size_width?e.size_width:t.getParentWidth()},R.getCurrentHeight=function(){var t=this,e=t.config,n=e.size_height?e.size_height:t.getParentHeight();return n>0?n:320/(t.hasType("gauge")&&!e.gauge_fullCircle?2:1)},R.getCurrentPaddingTop=function(){var t=this,e=t.config,n=h(e.padding_top)?e.padding_top:0;return t.title&&t.title.node()&&(n+=t.getTitlePadding()),n},R.getCurrentPaddingBottom=function(){var t=this.config;return h(t.padding_bottom)?t.padding_bottom:0},R.getCurrentPaddingLeft=function(t){var e=this,n=e.config;return h(n.padding_left)?n.padding_left:n.axis_rotated?n.axis_x_show?Math.max(v(e.getAxisWidthByAxisId("x",t)),40):1:!n.axis_y_show||n.axis_y_inner?e.axis.getYAxisLabelPosition().isOuter?30:1:v(e.getAxisWidthByAxisId("y",t))},R.getCurrentPaddingRight=function(){var t=this,e=t.config,n=t.isLegendRight?t.getLegendWidth()+20:0;return h(e.padding_right)?e.padding_right+1:e.axis_rotated?10+n:!e.axis_y2_show||e.axis_y2_inner?2+n+(t.axis.getY2AxisLabelPosition().isOuter?20:0):v(t.getAxisWidthByAxisId("y2"))+n},R.getParentRectValue=function(t){for(var e,n=this.selectChart.node();n&&"BODY"!==n.tagName;){try{e=n.getBoundingClientRect()[t]}catch(i){"width"===t&&(e=n.offsetWidth)}if(e)break;n=n.parentNode}return e},R.getParentWidth=function(){return this.getParentRectValue("width")},R.getParentHeight=function(){var t=this.selectChart.style("height");return t.indexOf("px")>0?+t.replace("px",""):0},R.getSvgLeft=function(t){var e=this,n=e.config,i=n.axis_rotated||!n.axis_rotated&&!n.axis_y_inner,r=n.axis_rotated?a.axisX:a.axisY,o=e.main.select("."+r).node(),s=o&&i?o.getBoundingClientRect():{right:0},l=e.selectChart.node().getBoundingClientRect(),u=e.hasArcType(),c=s.right-l.left-(u?0:e.getCurrentPaddingLeft(t));return c>0?c:0},R.getAxisWidthByAxisId=function(t,e){var n=this,i=n.axis.getLabelPositionById(t);return n.axis.getMaxTickWidth(t,e)+(i.isInner?20:40)},R.getHorizontalAxisHeight=function(t){var e=this,n=e.config,i=30;return"x"!==t||n.axis_x_show?"x"===t&&n.axis_x_height?n.axis_x_height:"y"!==t||n.axis_y_show?"y2"!==t||n.axis_y2_show?("x"===t&&!n.axis_rotated&&n.axis_x_tick_rotate&&(i=30+e.axis.getMaxTickWidth(t)*Math.cos(Math.PI*(90-n.axis_x_tick_rotate)/180)),"y"===t&&n.axis_rotated&&n.axis_y_tick_rotate&&(i=30+e.axis.getMaxTickWidth(t)*Math.cos(Math.PI*(90-n.axis_y_tick_rotate)/180)),i+(e.axis.getLabelPositionById(t).isInner?0:10)+("y2"===t?-10:0)):e.rotated_padding_top:!n.legend_show||e.isLegendRight||e.isLegendInset?1:10:8},R.getEventRectWidth=function(){return Math.max(0,this.xAxis.tickInterval())},R.initBrush=function(){var t=this,e=t.d3;t.brush=e.svg.brush().on("brush",function(){t.redrawForBrush()}),t.brush.update=function(){return t.context&&t.context.select("."+a.brush).call(this),this},t.brush.scale=function(e){return t.config.axis_rotated?this.y(e):this.x(e)}},R.initSubchart=function(){var t=this,e=t.config,n=t.context=t.svg.append("g").attr("transform",t.getTranslate("context")),i=e.subchart_show?"visible":"hidden";n.style("visibility",i),n.append("g").attr("clip-path",t.clipPathForSubchart).attr("class",a.chart),n.select("."+a.chart).append("g").attr("class",a.chartBars),n.select("."+a.chart).append("g").attr("class",a.chartLines),n.append("g").attr("clip-path",t.clipPath).attr("class",a.brush).call(t.brush),t.axes.subx=n.append("g").attr("class",a.axisX).attr("transform",t.getTranslate("subx")).attr("clip-path",e.axis_rotated?"":t.clipPathForXAxis).style("visibility",e.subchart_axis_x_show?i:"hidden")},R.updateTargetsForSubchart=function(t){var e,n=this,i=n.context,r=n.config,o=n.classChartBar.bind(n),s=n.classBars.bind(n),l=n.classChartLine.bind(n),u=n.classLines.bind(n),c=n.classAreas.bind(n);r.subchart_show&&(i.select("."+a.chartBars).selectAll("."+a.chartBar).data(t).attr("class",o).enter().append("g").style("opacity",0).attr("class",o).append("g").attr("class",s),(e=i.select("."+a.chartLines).selectAll("."+a.chartLine).data(t).attr("class",l).enter().append("g").style("opacity",0).attr("class",l)).append("g").attr("class",u),e.append("g").attr("class",c),i.selectAll("."+a.brush+" rect").attr(r.axis_rotated?"width":"height",r.axis_rotated?n.width2:n.height2))},R.updateBarForSubchart=function(t){var e=this;e.contextBar=e.context.selectAll("."+a.bars).selectAll("."+a.bar).data(e.barData.bind(e)),e.contextBar.enter().append("path").attr("class",e.classBar.bind(e)).style("stroke","none").style("fill",e.color),e.contextBar.style("opacity",e.initialOpacity.bind(e)),e.contextBar.exit().transition().duration(t).style("opacity",0).remove()},R.redrawBarForSubchart=function(t,e,n){(e?this.contextBar.transition(Math.random().toString()).duration(n):this.contextBar).attr("d",t).style("opacity",1)},R.updateLineForSubchart=function(t){var e=this;e.contextLine=e.context.selectAll("."+a.lines).selectAll("."+a.line).data(e.lineData.bind(e)),e.contextLine.enter().append("path").attr("class",e.classLine.bind(e)).style("stroke",e.color),e.contextLine.style("opacity",e.initialOpacity.bind(e)),e.contextLine.exit().transition().duration(t).style("opacity",0).remove()},R.redrawLineForSubchart=function(t,e,n){(e?this.contextLine.transition(Math.random().toString()).duration(n):this.contextLine).attr("d",t).style("opacity",1)},R.updateAreaForSubchart=function(t){var e=this,n=e.d3;e.contextArea=e.context.selectAll("."+a.areas).selectAll("."+a.area).data(e.lineData.bind(e)),e.contextArea.enter().append("path").attr("class",e.classArea.bind(e)).style("fill",e.color).style("opacity",function(){return e.orgAreaOpacity=+n.select(this).style("opacity"),0}),e.contextArea.style("opacity",0),e.contextArea.exit().transition().duration(t).style("opacity",0).remove()},R.redrawAreaForSubchart=function(t,e,n){(e?this.contextArea.transition(Math.random().toString()).duration(n):this.contextArea).attr("d",t).style("fill",this.color).style("opacity",this.orgAreaOpacity)},R.redrawSubchart=function(t,e,n,i,r,o,a){var s,l,u,c=this,h=c.d3,d=c.config;c.context.style("visibility",d.subchart_show?"visible":"hidden"),d.subchart_show&&(h.event&&"zoom"===h.event.type&&c.brush.extent(c.x.orgDomain()).update(),t&&(c.brush.empty()||c.brush.extent(c.x.orgDomain()).update(),s=c.generateDrawArea(r,!0),l=c.generateDrawBar(o,!0),u=c.generateDrawLine(a,!0),c.updateBarForSubchart(n),c.updateLineForSubchart(n),c.updateAreaForSubchart(n),c.redrawBarForSubchart(l,n,n),c.redrawLineForSubchart(u,n,n),c.redrawAreaForSubchart(s,n,n)))},R.redrawForBrush=function(){var t=this,e=t.x;t.redraw({withTransition:!1,withY:t.config.zoom_rescale,withSubchart:!1,withUpdateXDomain:!0,withDimension:!1}),t.config.subchart_onbrush.call(t.api,e.orgDomain())},R.transformContext=function(t,e){var n,i=this;e&&e.axisSubX?n=e.axisSubX:(n=i.context.select("."+a.axisX),t&&(n=n.transition())),i.context.attr("transform",i.getTranslate("context")),n.attr("transform",i.getTranslate("subx"))},R.getDefaultExtent=function(){var t=this,e=t.config,n=d(e.axis_x_extent)?e.axis_x_extent(t.getXDomain(t.data.targets)):e.axis_x_extent;return t.isTimeSeries()&&(n=[t.parseDate(n[0]),t.parseDate(n[1])]),n},R.initText=function(){var t=this;t.main.select("."+a.chart).append("g").attr("class",a.chartTexts),t.mainText=t.d3.selectAll([])},R.updateTargetsForText=function(t){var e=this,n=e.classChartText.bind(e),i=e.classTexts.bind(e),r=e.classFocus.bind(e);e.main.select("."+a.chartTexts).selectAll("."+a.chartText).data(t).attr("class",function(t){return n(t)+r(t)}).enter().append("g").attr("class",n).style("opacity",0).style("pointer-events","none").append("g").attr("class",i)},R.updateText=function(t){var e=this,n=e.config,i=e.barOrLineData.bind(e),r=e.classText.bind(e);e.mainText=e.main.selectAll("."+a.texts).selectAll("."+a.text).data(i),e.mainText.enter().append("text").attr("class",r).attr("text-anchor",function(t){return n.axis_rotated?t.value<0?"end":"start":"middle"}).style("stroke","none").style("fill",function(t){return e.color(t)}).style("fill-opacity",0),e.mainText.text(function(t,n,i){return e.dataLabelFormat(t.id)(t.value,t.id,n,i)}),e.mainText.exit().transition().duration(t).style("fill-opacity",0).remove()},R.redrawText=function(t,e,n,i){return[(i?this.mainText.transition():this.mainText).attr("x",t).attr("y",e).style("fill",this.color).style("fill-opacity",n?0:this.opacityForText.bind(this))]},R.getTextRect=function(t,e,n){var i,r=this.d3.select("body").append("div").classed("c3",!0),o=r.append("svg").style("visibility","hidden").style("position","fixed").style("top",0).style("left",0),a=this.d3.select(n).style("font");return o.selectAll(".dummy").data([t]).enter().append("text").classed(e||"",!0).style("font",a).text(t).each(function(){i=this.getBoundingClientRect()}),r.remove(),i},R.generateXYForText=function(t,e,n,i){var r=this,o=r.generateGetAreaPoints(t,!1),a=r.generateGetBarPoints(e,!1),s=r.generateGetLinePoints(n,!1),l=i?r.getXForText:r.getYForText;return function(t,e){var n=r.isAreaType(t)?o:r.isBarType(t)?a:s;return l.call(r,n(t,e),t,this)}},R.getXForText=function(t,e,n){var i,r,o=this,a=n.getBoundingClientRect();return o.config.axis_rotated?(r=o.isBarType(e)?4:6,i=t[2][1]+r*(e.value<0?-1:1)):i=o.hasType("bar")?(t[2][0]+t[0][0])/2:t[0][0],null===e.value&&(i>o.width?i=o.width-a.width:i<0&&(i=4)),i},R.getYForText=function(t,e,n){var i,r=this,o=n.getBoundingClientRect();return r.config.axis_rotated?i=(t[0][0]+t[2][0]+.6*o.height)/2:(i=t[2][1],e.value<0||0===e.value&&!r.hasPositiveValue?(i+=o.height,r.isBarType(e)&&r.isSafari()?i-=3:!r.isBarType(e)&&r.isChrome()&&(i+=3)):i+=r.isBarType(e)?-3:-6),null!==e.value||r.config.axis_rotated||(i<o.height?i=o.height:i>this.height&&(i=this.height-4)),i},R.initTitle=function(){var t=this;t.title=t.svg.append("text").text(t.config.title_text).attr("class",t.CLASS.title)},R.redrawTitle=function(){var t=this;t.title.attr("x",t.xForTitle.bind(t)).attr("y",t.yForTitle.bind(t))},R.xForTitle=function(){var t=this,e=t.config,n=e.title_position||"left";return n.indexOf("right")>=0?t.currentWidth-t.getTextRect(t.title.node().textContent,t.CLASS.title,t.title.node()).width-e.title_padding.right:n.indexOf("center")>=0?(t.currentWidth-t.getTextRect(t.title.node().textContent,t.CLASS.title,t.title.node()).width)/2:e.title_padding.left},R.yForTitle=function(){var t=this;return t.config.title_padding.top+t.getTextRect(t.title.node().textContent,t.CLASS.title,t.title.node()).height},R.getTitlePadding=function(){var t=this;return t.yForTitle()+t.config.title_padding.bottom},R.initTooltip=function(){var t,e=this,n=e.config;if(e.tooltip=e.selectChart.style("position","relative").append("div").attr("class",a.tooltipContainer).style("position","absolute").style("pointer-events","none").style("display","none"),n.tooltip_init_show){if(e.isTimeSeries()&&p(n.tooltip_init_x)){for(n.tooltip_init_x=e.parseDate(n.tooltip_init_x),t=0;t<e.data.targets[0].values.length&&e.data.targets[0].values[t].x-n.tooltip_init_x!=0;t++);n.tooltip_init_x=t}e.tooltip.html(n.tooltip_contents.call(e,e.data.targets.map(function(t){return e.addName(t.values[n.tooltip_init_x])}),e.axis.getXAxisTickFormat(),e.getYFormat(e.hasArcType()),e.color)),e.tooltip.style("top",n.tooltip_init_position.top).style("left",n.tooltip_init_position.left).style("display","block")}},R.getTooltipSortFunction=function(){var t=this,e=t.config;if(0!==e.data_groups.length&&void 0===e.tooltip_order){var n=t.orderTargets(t.data.targets).map(function(t){return t.id});return(t.isOrderAsc()||t.isOrderDesc())&&(n=n.reverse()),function(t,e){return n.indexOf(t.id)-n.indexOf(e.id)}}var i=e.tooltip_order;void 0===i&&(i=e.data_order);var r=function(t){return t?t.value:null};if(p(i)&&"asc"===i.toLowerCase())return function(t,e){return r(t)-r(e)};if(p(i)&&"desc"===i.toLowerCase())return function(t,e){return r(e)-r(t)};if(d(i)){var o=i;return void 0===e.tooltip_order&&(o=function(t,e){return i(t?{id:t.id,values:[t]}:null,e?{id:e.id,values:[e]}:null)}),o}return f(i)?function(t,e){return i.indexOf(t.id)-i.indexOf(e.id)}:void 0},R.getTooltipContent=function(t,e,n,i){var r,o,a,s,l,u,c=this,h=c.config,d=h.tooltip_format_title||e,f=h.tooltip_format_name||function(t){return t},p=h.tooltip_format_value||n,g=this.getTooltipSortFunction();for(g&&t.sort(g),o=0;o<t.length;o++)if(t[o]&&(t[o].value||0===t[o].value)&&(r||(a=w(d?d(t[o].x):t[o].x),r="<table class='"+c.CLASS.tooltip+"'>"+(a||0===a?"<tr><th colspan='2'>"+a+"</th></tr>":"")),void 0!==(s=w(p(t[o].value,t[o].ratio,t[o].id,t[o].index,t))))){if(null===t[o].name)continue;l=w(f(t[o].name,t[o].ratio,t[o].id,t[o].index)),u=c.levelColor?c.levelColor(t[o].value):i(t[o].id),r+="<tr class='"+c.CLASS.tooltipName+"-"+c.getTargetSelectorSuffix(t[o].id)+"'>",r+="<td class='name'><span style='background-color:"+u+"'></span>"+l+"</td>",r+="<td class='value'>"+s+"</td>",r+="</tr>"}return r+"</table>"},R.tooltipPosition=function(t,e,n,i){var r,o,a,s,l,u=this,c=u.config,h=u.d3,d=u.hasArcType(),f=h.mouse(i);return d?(o=(u.width-(u.isLegendRight?u.getLegendWidth():0))/2+f[0],s=u.height/2+f[1]+20):(r=u.getSvgLeft(!0),c.axis_rotated?(a=(o=r+f[0]+100)+e,l=u.currentWidth-u.getCurrentPaddingRight(),s=u.x(t[0].x)+20):(a=(o=r+u.getCurrentPaddingLeft(!0)+u.x(t[0].x)+20)+e,l=r+u.currentWidth-u.getCurrentPaddingRight(),s=f[1]+15),a>l&&(o-=a-l+20),s+n>u.currentHeight&&(s-=n+30)),s<0&&(s=0),{top:s,left:o}},R.showTooltip=function(t,e){var n,i,r,o=this,a=o.config,s=o.hasArcType(),l=t.filter(function(t){return t&&h(t.value)}),u=a.tooltip_position||R.tooltipPosition;0!==l.length&&a.tooltip_show&&(o.tooltip.html(a.tooltip_contents.call(o,t,o.axis.getXAxisTickFormat(),o.getYFormat(s),o.color)).style("display","block"),n=o.tooltip.property("offsetWidth"),i=o.tooltip.property("offsetHeight"),r=u.call(this,l,n,i,e),o.tooltip.style("top",r.top+"px").style("left",r.left+"px"))},R.hideTooltip=function(){this.tooltip.style("display","none")},R.setTargetType=function(t,e){var n=this,i=n.config;n.mapToTargetIds(t).forEach(function(t){n.withoutFadeIn[t]=e===i.data_types[t],i.data_types[t]=e}),t||(i.data_type=e)},R.hasType=function(t,e){var n=this,i=n.config.data_types,r=!1;return(e=e||n.data.targets)&&e.length?e.forEach(function(e){var n=i[e.id];(n&&n.indexOf(t)>=0||!n&&"line"===t)&&(r=!0)}):Object.keys(i).length?Object.keys(i).forEach(function(e){i[e]===t&&(r=!0)}):r=n.config.data_type===t,r},R.hasArcType=function(t){return this.hasType("pie",t)||this.hasType("donut",t)||this.hasType("gauge",t)},R.isLineType=function(t){var e=this.config,n=p(t)?t:t.id;return!e.data_types[n]||["line","spline","area","area-spline","step","area-step"].indexOf(e.data_types[n])>=0},R.isStepType=function(t){var e=p(t)?t:t.id;return["step","area-step"].indexOf(this.config.data_types[e])>=0},R.isSplineType=function(t){var e=p(t)?t:t.id;return["spline","area-spline"].indexOf(this.config.data_types[e])>=0},R.isAreaType=function(t){var e=p(t)?t:t.id;return["area","area-spline","area-step"].indexOf(this.config.data_types[e])>=0},R.isBarType=function(t){var e=p(t)?t:t.id;return"bar"===this.config.data_types[e]},R.isScatterType=function(t){var e=p(t)?t:t.id;return"scatter"===this.config.data_types[e]},R.isPieType=function(t){var e=p(t)?t:t.id;return"pie"===this.config.data_types[e]},R.isGaugeType=function(t){var e=p(t)?t:t.id;return"gauge"===this.config.data_types[e]},R.isDonutType=function(t){var e=p(t)?t:t.id;return"donut"===this.config.data_types[e]},R.isArcType=function(t){return this.isPieType(t)||this.isDonutType(t)||this.isGaugeType(t)},R.lineData=function(t){return this.isLineType(t)?[t]:[]},R.arcData=function(t){return this.isArcType(t.data)?[t]:[]},R.barData=function(t){return this.isBarType(t)?t.values:[]},R.lineOrScatterData=function(t){return this.isLineType(t)||this.isScatterType(t)?t.values:[]},R.barOrLineData=function(t){return this.isBarType(t)||this.isLineType(t)?t.values:[]},R.isInterpolationType=function(t){return["linear","linear-closed","basis","basis-open","basis-closed","bundle","cardinal","cardinal-open","cardinal-closed","monotone"].indexOf(t)>=0},R.isSafari=function(){var t=window.navigator.userAgent;return t.indexOf("Safari")>=0&&t.indexOf("Chrome")<0},R.isChrome=function(){return window.navigator.userAgent.indexOf("Chrome")>=0},R.initZoom=function(){var t,e=this,n=e.d3,i=e.config;e.zoom=n.behavior.zoom().on("zoomstart",function(){t=n.event.sourceEvent,e.zoom.altDomain=n.event.sourceEvent.altKey?e.x.orgDomain():null,i.zoom_onzoomstart.call(e.api,n.event.sourceEvent)}).on("zoom",function(){e.redrawForZoom.call(e)}).on("zoomend",function(){var r=n.event.sourceEvent;r&&t.clientX===r.clientX&&t.clientY===r.clientY||(e.redrawEventRect(),e.updateZoom(),i.zoom_onzoomend.call(e.api,e.x.orgDomain()))}),e.zoom.scale=function(t){return i.axis_rotated?this.y(t):this.x(t)},e.zoom.orgScaleExtent=function(){var t=i.zoom_extent?i.zoom_extent:[1,10];return[t[0],Math.max(e.getMaxDataCount()/t[1],t[1])]},e.zoom.updateScaleExtent=function(){var t=m(e.x.orgDomain())/m(e.getZoomDomain()),n=this.orgScaleExtent();return this.scaleExtent([n[0]*t,n[1]*t]),this}},R.getZoomDomain=function(){var t=this,e=t.config,n=t.d3;return[n.min([t.orgXDomain[0],e.zoom_x_min]),n.max([t.orgXDomain[1],e.zoom_x_max])]},R.updateZoom=function(){var t=this,e=t.config.zoom_enabled?t.zoom:function(){};t.main.select("."+a.zoomRect).call(e).on("dblclick.zoom",null),t.main.selectAll("."+a.eventRect).call(e).on("dblclick.zoom",null)},R.redrawForZoom=function(){var t=this,e=t.d3,n=t.config,i=t.zoom,r=t.x;if(n.zoom_enabled&&0!==t.filterTargetsToShow(t.data.targets).length){if("mousemove"===e.event.sourceEvent.type&&i.altDomain)return r.domain(i.altDomain),void i.scale(r).updateScaleExtent();t.isCategorized()&&r.orgDomain()[0]===t.orgXDomain[0]&&r.domain([t.orgXDomain[0]-1e-10,r.orgDomain()[1]]),t.redraw({withTransition:!1,withY:n.zoom_rescale,withSubchart:!1,withEventRect:!1,withDimension:!1}),"mousemove"===e.event.sourceEvent.type&&(t.cancelClick=!0),n.zoom_onzoom.call(t.api,r.orgDomain())}},L}),function(){"use strict";function t(t,e){return e={exports:{}},t(e,e.exports),e.exports}function e(t){if(null===t||void 0===t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}function n(t){return function(){return t}}function i(t){for(var e=arguments.length-1,n="Minified React error #"+t+"; visit http://facebook.github.io/react/docs/error-decoder.html?invariant="+t,i=0;i<e;i++)n+="&args[]="+encodeURIComponent(arguments[i+1]);throw e=Error(n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."),e.name="Invariant Violation",e.framesToPop=1,e}function r(t,e,n){this.props=t,this.context=e,this.refs=ii,this.updater=n||ai}function o(t,e,n){this.props=t,this.context=e,this.refs=ii,this.updater=n||ai}function a(){}function s(t,e,n){this.props=t,this.context=e,this.refs=ii,this.updater=n||ai}function l(t,e,n){var i,r={},o=null,a=null;if(null!=e)for(i in void 0!==e.ref&&(a=e.ref),void 0!==e.key&&(o=""+e.key),e)ci.call(e,i)&&!di.hasOwnProperty(i)&&(r[i]=e[i]);var s=arguments.length-2;if(1===s)r.children=n;else if(1<s){for(var l=Array(s),u=0;u<s;u++)l[u]=arguments[u+2];r.children=l}if(t&&t.defaultProps)for(i in s=t.defaultProps)void 0===r[i]&&(r[i]=s[i]);return{$$typeof:hi,type:t,key:o,ref:a,props:r,_owner:ui.current}}function u(t){return"object"==typeof t&&null!==t&&t.$$typeof===hi}function c(t){var e={"=":"=0",":":"=2"};return"$"+(""+t).replace(/[=:]/g,function(t){return e[t]})}function h(t,e,n,i){if(vi.length){var r=vi.pop();return r.result=t,r.keyPrefix=e,r.func=n,r.context=i,r.count=0,r}return{result:t,keyPrefix:e,func:n,context:i,count:0}}function d(t){t.result=null,t.keyPrefix=null,t.func=null,t.context=null,t.count=0,10>vi.length&&vi.push(t)}function f(t,e,n,r){var o=typeof t;if("undefined"!==o&&"boolean"!==o||(t=null),null===t||"string"===o||"number"===o||"object"===o&&t.$$typeof===pi||"object"===o&&t.$$typeof===gi)return n(r,t,""===e?"."+p(t,0):e),1;var a=0;if(e=""===e?".":e+":",Array.isArray(t))for(var s=0;s<t.length;s++){var l=e+p(o=t[s],s);a+=f(o,l,n,r)}else if("function"==typeof(l=fi&&t[fi]||t["@@iterator"]))for(t=l.call(t),s=0;!(o=t.next()).done;)o=o.value,l=e+p(o,s++),a+=f(o,l,n,r);else"object"===o&&(n=""+t,i("31","[object Object]"===n?"object with keys {"+Object.keys(t).join(", ")+"}":n,""));return a}function p(t,e){return"object"==typeof t&&null!==t&&null!=t.key?c(t.key):e.toString(36)}function g(t,e){t.func.call(t.context,e,t.count++)}function _(t,e,n){var i=t.result,r=t.keyPrefix;t=t.func.call(t.context,e,t.count++),Array.isArray(t)?v(t,i,n,oi.thatReturnsArgument):null!=t&&(u(t)&&(e=r+(!t.key||e&&e.key===t.key?"":(""+t.key).replace(_i,"$&/")+"/")+n,t={$$typeof:hi,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}),i.push(t))}function v(t,e,n,i,r){var o="";null!=n&&(o=(""+n).replace(_i,"$&/")+"/"),e=h(e,o,i,r),null==t||f(t,"",_,e),d(e)}function y(t,e){return t===e?0!==t||0!==e||1/t==1/e:t!=t&&e!=e}function m(t,e){return!(!t||!e)&&(t===e||!Ii(t)&&(Ii(e)?m(t,e.parentNode):"contains"in t?t.contains(e):!!t.compareDocumentPosition&&!!(16&t.compareDocumentPosition(e))))}function x(t){for(var e=arguments.length-1,n="Minified React error #"+t+"; visit http://facebook.github.io/react/docs/error-decoder.html?invariant="+t,i=0;i<e;i++)n+="&args[]="+encodeURIComponent(arguments[i+1]);throw e=Error(n+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."),e.name="Invariant Violation",e.framesToPop=1,e}function S(t,e){return(t&e)===e}function E(t,e){if(Oi.hasOwnProperty(t)||2<t.length&&("o"===t[0]||"O"===t[0])&&("n"===t[1]||"N"===t[1]))return!1;if(null===e)return!0;switch(typeof e){case"boolean":return Oi.hasOwnProperty(t)?t=!0:(e=T(t))?t=e.hasBooleanValue||e.hasStringBooleanValue||e.hasOverloadedBooleanValue:(t=t.toLowerCase().slice(0,5),t="data-"===t||"aria-"===t),t;case"undefined":case"number":case"string":case"object":return!0;default:return!1}}function T(t){return Fi.hasOwnProperty(t)?Fi[t]:null}function w(t){return t[1].toUpperCase()}function C(t,e,n,i,r,o,a,s,l){Ki._hasCaughtError=!1,Ki._caughtError=null;var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(t){Ki._caughtError=t,Ki._hasCaughtError=!0}}function b(){if(Ki._hasRethrowError){var t=Ki._rethrowError;throw Ki._rethrowError=null,Ki._hasRethrowError=!1,t}}function A(){if(qi)for(var t in Zi){var e=Zi[t],n=qi.indexOf(t);if(-1<n||x("96",t),!Qi[n]){e.extractEvents||x("97",t),Qi[n]=e,n=e.eventTypes;for(var i in n){var r=void 0,o=n[i],a=e,s=i;Ji.hasOwnProperty(s)&&x("99",s),Ji[s]=o;var l=o.phasedRegistrationNames;if(l){for(r in l)l.hasOwnProperty(r)&&R(l[r],a,s);r=!0}else o.registrationName?(R(o.registrationName,a,s),r=!0):r=!1;r||x("98",i,t)}}}}function R(t,e,n){$i[t]&&x("100",t),$i[t]=e,tr[t]=e.eventTypes[n].dependencies}function L(t){qi&&x("101"),qi=Array.prototype.slice.call(t),A()}function I(t){var e,n=!1;for(e in t)if(t.hasOwnProperty(e)){var i=t[e];Zi.hasOwnProperty(e)&&Zi[e]===i||(Zi[e]&&x("102",e),Zi[e]=i,n=!0)}n&&A()}function P(t,e,n,i){e=t.type||"unknown-event",t.currentTarget=rr(i),Ki.invokeGuardedCallbackAndCatchFirstError(e,n,void 0,t),t.currentTarget=null}function M(t,e){return null==e&&x("30"),null==t?e:Array.isArray(t)?Array.isArray(e)?(t.push.apply(t,e),t):(t.push(e),t):Array.isArray(e)?[t].concat(e):[t,e]}function O(t,e,n){Array.isArray(t)?t.forEach(e,n):t&&e.call(n,t)}function D(t,e){if(t){var n=t._dispatchListeners,i=t._dispatchInstances;if(Array.isArray(n))for(var r=0;r<n.length&&!t.isPropagationStopped();r++)P(t,e,n[r],i[r]);else n&&P(t,e,n,i);t._dispatchListeners=null,t._dispatchInstances=null,t.isPersistent()||t.constructor.release(t)}}function F(t){return D(t,!0)}function k(t){return D(t,!1)}function N(t,e){var n=t.stateNode;if(!n)return null;var i=nr(n);if(!i)return null;n=i[e];t:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":(i=!i.disabled)||(t=t.type,i=!("button"===t||"input"===t||"select"===t||"textarea"===t)),t=!i;break t;default:t=!1}return t?null:(n&&"function"!=typeof n&&x("231",e,typeof n),n)}function G(t,e,n,i){for(var r,o=0;o<Qi.length;o++){var a=Qi[o];a&&(a=a.extractEvents(t,e,n,i))&&(r=M(r,a))}return r}function V(t){t&&(or=M(or,t))}function U(t){var e=or;or=null,t?O(e,F):O(e,k),or&&x("95"),Ki.rethrowCaughtError()}function B(t){if(t[ur])return t[ur];for(var e=[];!t[ur];){if(e.push(t),!t.parentNode)return null;t=t.parentNode}var n=void 0,i=t[ur];if(5===i.tag||6===i.tag)return i;for(;t&&(i=t[ur]);t=e.pop())n=i;return n}function z(t){if(5===t.tag||6===t.tag)return t.stateNode;x("33")}function X(t){return t[cr]||null}function H(t){do{t=t.return}while(t&&5!==t.tag);return t||null}function W(t,e,n){for(var i=[];t;)i.push(t),t=H(t);for(t=i.length;0<t--;)e(i[t],"captured",n);for(t=0;t<i.length;t++)e(i[t],"bubbled",n)}function Y(t,e,n){(e=N(t,n.dispatchConfig.phasedRegistrationNames[e]))&&(n._dispatchListeners=M(n._dispatchListeners,e),n._dispatchInstances=M(n._dispatchInstances,t))}function j(t){t&&t.dispatchConfig.phasedRegistrationNames&&W(t._targetInst,Y,t)}function K(t){if(t&&t.dispatchConfig.phasedRegistrationNames){var e=t._targetInst;W(e=e?H(e):null,Y,t)}}function q(t,e,n){t&&n&&n.dispatchConfig.registrationName&&(e=N(t,n.dispatchConfig.registrationName))&&(n._dispatchListeners=M(n._dispatchListeners,e),n._dispatchInstances=M(n._dispatchInstances,t))}function Z(t){t&&t.dispatchConfig.registrationName&&q(t._targetInst,null,t)}function Q(t){O(t,j)}function J(t,e,n,i){if(n&&i)t:{for(var r=n,o=i,a=0,s=r;s;s=H(s))a++;s=0;for(var l=o;l;l=H(l))s++;for(;0<a-s;)r=H(r),a--;for(;0<s-a;)o=H(o),s--;for(;a--;){if(r===o||r===o.alternate)break t;r=H(r),o=H(o)}r=null}else r=null;for(o=r,r=[];n&&n!==o&&(null===(a=n.alternate)||a!==o);)r.push(n),n=H(n);for(n=[];i&&i!==o&&(null===(a=i.alternate)||a!==o);)n.push(i),i=H(i);for(i=0;i<r.length;i++)q(r[i],"bubbled",t);for(t=n.length;0<t--;)q(n[t],"captured",e)}function $(){return!fr&&wi.canUseDOM&&(fr="textContent"in document.documentElement?"textContent":"innerText"),fr}function tt(){if(pr._fallbackText)return pr._fallbackText;var t,e,n=pr._startText,i=n.length,r=et(),o=r.length;for(t=0;t<i&&n[t]===r[t];t++);var a=i-t;for(e=1;e<=a&&n[i-e]===r[o-e];e++);return pr._fallbackText=r.slice(t,1<e?1-e:void 0),pr._fallbackText}function et(){return"value"in pr._root?pr._root.value:pr._root[$()]}function nt(t,e,n,i){this.dispatchConfig=t,this._targetInst=e,this.nativeEvent=n,t=this.constructor.Interface;for(var r in t)t.hasOwnProperty(r)&&((e=t[r])?this[r]=e(n):"target"===r?this.target=i:this[r]=n[r]);return this.isDefaultPrevented=(null!=n.defaultPrevented?n.defaultPrevented:!1===n.returnValue)?oi.thatReturnsTrue:oi.thatReturnsFalse,this.isPropagationStopped=oi.thatReturnsFalse,this}function it(t,e,n,i){if(this.eventPool.length){var r=this.eventPool.pop();return this.call(r,t,e,n,i),r}return new this(t,e,n,i)}function rt(t){t instanceof this||x("223"),t.destructor(),10>this.eventPool.length&&this.eventPool.push(t)}function ot(t){t.eventPool=[],t.getPooled=it,t.release=rt}function at(t,e,n,i){return nt.call(this,t,e,n,i)}function st(t,e,n,i){return nt.call(this,t,e,n,i)}function lt(t,e){switch(t){case"topKeyUp":return-1!==vr.indexOf(e.keyCode);case"topKeyDown":return 229!==e.keyCode;case"topKeyPress":case"topMouseDown":case"topBlur":return!0;default:return!1}}function ut(t){return"object"==typeof(t=t.detail)&&"data"in t?t.data:null}function ct(t,e){switch(t){case"topCompositionEnd":return ut(e);case"topKeyPress":return 32!==e.which?null:(Ar=!0,Cr);case"topTextInput":return(t=e.data)===Cr&&Ar?null:t;default:return null}}function ht(t,e){if(Rr)return"topCompositionEnd"===t||!yr&&lt(t,e)?(t=tt(),pr._root=null,pr._startText=null,pr._fallbackText=null,Rr=!1,t):null;switch(t){case"topPaste":return null;case"topKeyPress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"topCompositionEnd":return wr?null:e.data;default:return null}}function dt(t){if(t=ir(t)){Ir&&"function"==typeof Ir.restoreControlledState||x("194");var e=nr(t.stateNode);Ir.restoreControlledState(t.stateNode,t.type,e)}}function ft(t){Pr?Mr?Mr.push(t):Mr=[t]:Pr=t}function pt(){if(Pr){var t=Pr,e=Mr;if(Mr=Pr=null,dt(t),e)for(t=0;t<e.length;t++)dt(e[t])}}function gt(t,e){return t(e)}function _t(t,e){if(Fr)return gt(t,e);Fr=!0;try{return gt(t,e)}finally{Fr=!1,pt()}}function vt(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return"input"===e?!!kr[t.type]:"textarea"===e}function yt(t){return(t=t.target||t.srcElement||window).correspondingUseElement&&(t=t.correspondingUseElement),3===t.nodeType?t.parentNode:t}function mt(t,e){if(!wi.canUseDOM||e&&!("addEventListener"in document))return!1;var n=(e="on"+t)in document;return n||((n=document.createElement("div")).setAttribute(e,"return;"),n="function"==typeof n[e]),!n&&Er&&"wheel"===t&&(n=document.implementation.hasFeature("Events.wheel","3.0")),n}function xt(t){var e=t.type;return(t=t.nodeName)&&"input"===t.toLowerCase()&&("checkbox"===e||"radio"===e)}function St(t){var e=xt(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),i=""+t[e];if(!t.hasOwnProperty(e)&&"function"==typeof n.get&&"function"==typeof n.set)return Object.defineProperty(t,e,{enumerable:n.enumerable,configurable:!0,get:function(){return n.get.call(this)},set:function(t){i=""+t,n.set.call(this,t)}}),{getValue:function(){return i},setValue:function(t){i=""+t},stopTracking:function(){t._valueTracker=null,delete t[e]}}}function Et(t){t._valueTracker||(t._valueTracker=St(t))}function Tt(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),i="";return t&&(i=xt(t)?t.checked?"true":"false":t.value),(t=i)!==n&&(e.setValue(t),!0)}function wt(t,e,n){return t=nt.getPooled(Nr.change,t,e,n),t.type="change",ft(n),Q(t),t}function Ct(t){V(t),U(!1)}function bt(t){if(Tt(z(t)))return t}function At(t,e){if("topChange"===t)return e}function Rt(){Gr&&(Gr.detachEvent("onpropertychange",Lt),Vr=Gr=null)}function Lt(t){"value"===t.propertyName&&bt(Vr)&&(t=wt(Vr,t,yt(t)),_t(Ct,t))}function It(t,e,n){"topFocus"===t?(Rt(),Gr=e,Vr=n,Gr.attachEvent("onpropertychange",Lt)):"topBlur"===t&&Rt()}function Pt(t){if("topSelectionChange"===t||"topKeyUp"===t||"topKeyDown"===t)return bt(Vr)}function Mt(t,e){if("topClick"===t)return bt(e)}function Ot(t,e){if("topInput"===t||"topChange"===t)return bt(e)}function Dt(t,e,n,i){return nt.call(this,t,e,n,i)}function Ft(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):!!(t=zr[t])&&!!e[t]}function kt(){return Ft}function Nt(t,e,n,i){return nt.call(this,t,e,n,i)}function Gt(t){return"string"==typeof(t=t.type)?t:"function"==typeof t?t.displayName||t.name:null}function Vt(t){var e=t;if(t.alternate)for(;e.return;)e=e.return;else{if(0!=(2&e.effectTag))return 1;for(;e.return;)if(0!=(2&(e=e.return).effectTag))return 1}return 3===e.tag?2:3}function Ut(t){return!!(t=t._reactInternalFiber)&&2===Vt(t)}function Bt(t){2!==Vt(t)&&x("188")}function zt(t){var e=t.alternate;if(!e)return 3===(e=Vt(t))&&x("188"),1===e?null:t;for(var n=t,i=e;;){var r=n.return,o=r?r.alternate:null;if(!r||!o)break;if(r.child===o.child){for(var a=r.child;a;){if(a===n)return Bt(r),t;if(a===i)return Bt(r),e;a=a.sibling}x("188")}if(n.return!==i.return)n=r,i=o;else{a=!1;for(var s=r.child;s;){if(s===n){a=!0,n=r,i=o;break}if(s===i){a=!0,i=r,n=o;break}s=s.sibling}if(!a){for(s=o.child;s;){if(s===n){a=!0,n=o,i=r;break}if(s===i){a=!0,i=o,n=r;break}s=s.sibling}a||x("189")}}n.alternate!==i&&x("190")}return 3!==n.tag&&x("188"),n.stateNode.current===n?t:e}function Xt(t){if(!(t=zt(t)))return null;for(var e=t;;){if(5===e.tag||6===e.tag)return e;if(e.child)e.child.return=e,e=e.child;else{if(e===t)break;for(;!e.sibling;){if(!e.return||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}}return null}function Ht(t){if(!(t=zt(t)))return null;for(var e=t;;){if(5===e.tag||6===e.tag)return e;if(e.child&&4!==e.tag)e.child.return=e,e=e.child;else{if(e===t)break;for(;!e.sibling;){if(!e.return||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}}return null}function Wt(t){var e=t.targetInst;do{if(!e){t.ancestors.push(e);break}var n;for(n=e;n.return;)n=n.return;if(!(n=3!==n.tag?null:n.stateNode.containerInfo))break;t.ancestors.push(e),e=B(n)}while(e);for(n=0;n<t.ancestors.length;n++)e=t.ancestors[n],Kr(t.topLevelType,e,t.nativeEvent,yt(t.nativeEvent))}function Yt(t){jr=!!t}function jt(t,e,n){return n?Ci.listen(n,e,qt.bind(null,t)):null}function Kt(t,e,n){return n?Ci.capture(n,e,qt.bind(null,t)):null}function qt(t,e){if(jr){var n=yt(e);if(null===(n=B(n))||"number"!=typeof n.tag||2===Vt(n)||(n=null),Yr.length){var i=Yr.pop();i.topLevelType=t,i.nativeEvent=e,i.targetInst=n,t=i}else t={topLevelType:t,nativeEvent:e,targetInst:n,ancestors:[]};try{_t(Wt,t)}finally{t.topLevelType=null,t.nativeEvent=null,t.targetInst=null,t.ancestors.length=0,10>Yr.length&&Yr.push(t)}}}function Zt(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n["ms"+t]="MS"+e,n["O"+t]="o"+e.toLowerCase(),n}function Qt(t){if(Qr[t])return Qr[t];if(!Zr[t])return t;var e,n=Zr[t];for(e in n)if(n.hasOwnProperty(e)&&e in Jr)return Qr[t]=n[e];return""}function Jt(t){return Object.prototype.hasOwnProperty.call(t,no)||(t[no]=eo++,to[t[no]]={}),to[t[no]]}function $t(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function te(t,e){var n=$t(t);t=0;for(var i;n;){if(3===n.nodeType){if(i=t+n.textContent.length,t<=e&&i>=e)return{node:n,offset:e-t};t=i}t:{for(;n;){if(n.nextSibling){n=n.nextSibling;break t}n=n.parentNode}n=void 0}n=$t(n)}}function ee(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&("input"===e&&"text"===t.type||"textarea"===e||"true"===t.contentEditable)}function ne(t,e){if(lo||null==oo||oo!==bi())return null;var n=oo;return"selectionStart"in n&&ee(n)?n={start:n.selectionStart,end:n.selectionEnd}:window.getSelection?(n=window.getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}):n=void 0,so&&Ri(so,n)?null:(so=n,t=nt.getPooled(ro.select,ao,t,e),t.type="select",t.target=oo,Q(t),t)}function ie(t,e,n,i){return nt.call(this,t,e,n,i)}function re(t,e,n,i){return nt.call(this,t,e,n,i)}function oe(t,e,n,i){return nt.call(this,t,e,n,i)}function ae(t){var e=t.keyCode;return"charCode"in t?0===(t=t.charCode)&&13===e&&(t=13):t=e,32<=t||13===t?t:0}function se(t,e,n,i){return nt.call(this,t,e,n,i)}function le(t,e,n,i){return nt.call(this,t,e,n,i)}function ue(t,e,n,i){return nt.call(this,t,e,n,i)}function ce(t,e,n,i){return nt.call(this,t,e,n,i)}function he(t,e,n,i){return nt.call(this,t,e,n,i)}function de(t){0>vo||(t.current=_o[vo],_o[vo]=null,vo--)}function fe(t,e){_o[++vo]=t.current,t.current=e}function pe(t){return _e(t)?wo:Eo.current}function ge(t,e){var n=t.type.contextTypes;if(!n)return ii;var i=t.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===e)return i.__reactInternalMemoizedMaskedChildContext;var r,o={};for(r in n)o[r]=e[r];return i&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=o),o}function _e(t){return 2===t.tag&&null!=t.type.childContextTypes}function ve(t){_e(t)&&(de(To,t),de(Eo,t))}function ye(t,e,n){null!=Eo.cursor&&x("168"),fe(Eo,e,t),fe(To,n,t)}function me(t,e){var n=t.stateNode,i=t.type.childContextTypes;if("function"!=typeof n.getChildContext)return e;n=n.getChildContext();for(var r in n)r in i||x("108",Gt(t)||"Unknown",r);return ni({},e,n)}function xe(t){if(!_e(t))return!1;var e=t.stateNode;return e=e&&e.__reactInternalMemoizedMergedChildContext||ii,wo=Eo.current,fe(Eo,e,t),fe(To,To.current,t),!0}function Se(t,e){var n=t.stateNode;if(n||x("169"),e){var i=me(t,wo);n.__reactInternalMemoizedMergedChildContext=i,de(To,t),de(Eo,t),fe(Eo,i,t)}else de(To,t);fe(To,e,t)}function Ee(t,e,n){this.tag=t,this.key=e,this.stateNode=this.type=null,this.sibling=this.child=this.return=null,this.index=0,this.memoizedState=this.updateQueue=this.memoizedProps=this.pendingProps=this.ref=null,this.internalContextTag=n,this.effectTag=0,this.lastEffect=this.firstEffect=this.nextEffect=null,this.expirationTime=0,this.alternate=null}function Te(t,e,n){var i=t.alternate;return null===i?(i=new Ee(t.tag,t.key,t.internalContextTag),i.type=t.type,i.stateNode=t.stateNode,i.alternate=t,t.alternate=i):(i.effectTag=0,i.nextEffect=null,i.firstEffect=null,i.lastEffect=null),i.expirationTime=n,i.pendingProps=e,i.child=t.child,i.memoizedProps=t.memoizedProps,i.memoizedState=t.memoizedState,i.updateQueue=t.updateQueue,i.sibling=t.sibling,i.index=t.index,i.ref=t.ref,i}function we(t,e,n){var i=void 0,r=t.type,o=t.key;return"function"==typeof r?(i=r.prototype&&r.prototype.isReactComponent?new Ee(2,o,e):new Ee(0,o,e),i.type=r,i.pendingProps=t.props):"string"==typeof r?(i=new Ee(5,o,e),i.type=r,i.pendingProps=t.props):"object"==typeof r&&null!==r&&"number"==typeof r.tag?(i=r,i.pendingProps=t.props):x("130",null==r?r:typeof r,""),i.expirationTime=n,i}function Ce(t,e,n,i){return e=new Ee(10,i,e),e.pendingProps=t,e.expirationTime=n,e}function be(t,e,n){return e=new Ee(6,null,e),e.pendingProps=t,e.expirationTime=n,e}function Ae(t,e,n){return e=new Ee(7,t.key,e),e.type=t.handler,e.pendingProps=t,e.expirationTime=n,e}function Re(t,e,n){return t=new Ee(9,null,e),t.expirationTime=n,t}function Le(t,e,n){return e=new Ee(4,t.key,e),e.pendingProps=t.children||[],e.expirationTime=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function Ie(t){return function(e){try{return t(e)}catch(t){}}}function Pe(t){if("undefined"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__)return!1;var e=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(e.isDisabled||!e.supportsFiber)return!0;try{var n=e.inject(t);Co=Ie(function(t){return e.onCommitFiberRoot(n,t)}),bo=Ie(function(t){return e.onCommitFiberUnmount(n,t)})}catch(t){}return!0}function Me(t){"function"==typeof Co&&Co(t)}function Oe(t){"function"==typeof bo&&bo(t)}function De(t){return{baseState:t,expirationTime:0,first:null,last:null,callbackList:null,hasForceUpdate:!1,isInitialized:!1}}function Fe(t,e){null===t.last?t.first=t.last=e:(t.last.next=e,t.last=e),(0===t.expirationTime||t.expirationTime>e.expirationTime)&&(t.expirationTime=e.expirationTime)}function ke(t,e){var n=t.alternate,i=t.updateQueue;null===i&&(i=t.updateQueue=De(null)),null!==n?null===(t=n.updateQueue)&&(t=n.updateQueue=De(null)):t=null,null===(t=t!==i?t:null)?Fe(i,e):null===i.last||null===t.last?(Fe(i,e),Fe(t,e)):(Fe(i,e),t.last=e)}function Ne(t,e,n,i){return"function"==typeof(t=t.partialState)?t.call(e,n,i):t}function Ge(t,e,n,i,r,o){null!==t&&t.updateQueue===n&&(n=e.updateQueue={baseState:n.baseState,expirationTime:n.expirationTime,first:n.first,last:n.last,isInitialized:n.isInitialized,callbackList:null,hasForceUpdate:!1}),n.expirationTime=0,n.isInitialized?t=n.baseState:(t=n.baseState=e.memoizedState,n.isInitialized=!0);for(var a=!0,s=n.first,l=!1;null!==s;){var u=s.expirationTime;if(u>o){var c=n.expirationTime;(0===c||c>u)&&(n.expirationTime=u),l||(l=!0,n.baseState=t)}else l||(n.first=s.next,null===n.first&&(n.last=null)),s.isReplace?(t=Ne(s,i,t,r),a=!0):(u=Ne(s,i,t,r))&&(t=a?ni({},t,u):ni(t,u),a=!1),s.isForced&&(n.hasForceUpdate=!0),null!==s.callback&&(null===(u=n.callbackList)&&(u=n.callbackList=[]),u.push(s));s=s.next}return null!==n.callbackList?e.effectTag|=32:null!==n.first||n.hasForceUpdate||(e.updateQueue=null),l||(n.baseState=t),t}function Ve(t,e){var n=t.callbackList;if(null!==n)for(t.callbackList=null,t=0;t<n.length;t++){var i=n[t],r=i.callback;i.callback=null,"function"!=typeof r&&x("191",r),r.call(e)}}function Ue(t,e,n,i){function r(t,e){e.updater=o,t.stateNode=e,e._reactInternalFiber=t}var o={isMounted:Ut,enqueueSetState:function(n,i,r){n=n._reactInternalFiber,r=void 0===r?null:r;var o=e(n);ke(n,{expirationTime:o,partialState:i,callback:r,isReplace:!1,isForced:!1,nextCallback:null,next:null}),t(n,o)},enqueueReplaceState:function(n,i,r){n=n._reactInternalFiber,r=void 0===r?null:r;var o=e(n);ke(n,{expirationTime:o,partialState:i,callback:r,isReplace:!0,isForced:!1,nextCallback:null,next:null}),t(n,o)},enqueueForceUpdate:function(n,i){n=n._reactInternalFiber,i=void 0===i?null:i;var r=e(n);ke(n,{expirationTime:r,partialState:null,callback:i,isReplace:!1,isForced:!0,nextCallback:null,next:null}),t(n,r)}};return{adoptClassInstance:r,constructClassInstance:function(t,e){var n=t.type,i=pe(t),o=2===t.tag&&null!=t.type.contextTypes,a=o?ge(t,i):ii;return e=new n(e,a),r(t,e),o&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=a),e},mountClassInstance:function(t,e){var n=t.alternate,i=t.stateNode,r=i.state||null,a=t.pendingProps;a||x("158");var s=pe(t);i.props=a,i.state=t.memoizedState=r,i.refs=ii,i.context=ge(t,s),null!=t.type&&null!=t.type.prototype&&!0===t.type.prototype.unstable_isAsyncReactComponent&&(t.internalContextTag|=1),"function"==typeof i.componentWillMount&&(r=i.state,i.componentWillMount(),r!==i.state&&o.enqueueReplaceState(i,i.state,null),null!==(r=t.updateQueue)&&(i.state=Ge(n,t,r,i,a,e))),"function"==typeof i.componentDidMount&&(t.effectTag|=4)},updateClassInstance:function(t,e,r){var a=e.stateNode;a.props=e.memoizedProps,a.state=e.memoizedState;var s=e.memoizedProps,l=e.pendingProps;l||null==(l=s)&&x("159");var u=a.context,c=pe(e);if(c=ge(e,c),"function"!=typeof a.componentWillReceiveProps||s===l&&u===c||(u=a.state,a.componentWillReceiveProps(l,c),a.state!==u&&o.enqueueReplaceState(a,a.state,null)),u=e.memoizedState,r=null!==e.updateQueue?Ge(t,e,e.updateQueue,a,l,r):u,!(s!==l||u!==r||To.current||null!==e.updateQueue&&e.updateQueue.hasForceUpdate))return"function"!=typeof a.componentDidUpdate||s===t.memoizedProps&&u===t.memoizedState||(e.effectTag|=4),!1;var h=l;if(null===s||null!==e.updateQueue&&e.updateQueue.hasForceUpdate)h=!0;else{var d=e.stateNode,f=e.type;h="function"==typeof d.shouldComponentUpdate?d.shouldComponentUpdate(h,r,c):!f.prototype||!f.prototype.isPureReactComponent||(!Ri(s,h)||!Ri(u,r))}return h?("function"==typeof a.componentWillUpdate&&a.componentWillUpdate(l,r,c),"function"==typeof a.componentDidUpdate&&(e.effectTag|=4)):("function"!=typeof a.componentDidUpdate||s===t.memoizedProps&&u===t.memoizedState||(e.effectTag|=4),n(e,l),i(e,r)),a.props=l,a.state=r,a.context=c,h}}}function Be(t,e,n){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:Ao,key:null==i?null:""+i,children:t,containerInfo:e,implementation:n}}function ze(t){return null===t||void 0===t?null:"function"==typeof(t=Lo&&t[Lo]||t["@@iterator"])?t:null}function Xe(t,e){var n=e.ref;if(null!==n&&"function"!=typeof n){if(e._owner){var i=void 0;(e=e._owner)&&(2!==e.tag&&x("110"),i=e.stateNode),i||x("147",n);var r=""+n;return null!==t&&null!==t.ref&&t.ref._stringRef===r?t.ref:(t=function(t){var e=i.refs===ii?i.refs={}:i.refs;null===t?delete e[r]:e[r]=t},t._stringRef=r,t)}"string"!=typeof n&&x("148"),e._owner||x("149",n)}return n}function He(t,e){"textarea"!==t.type&&x("31","[object Object]"===Object.prototype.toString.call(e)?"object with keys {"+Object.keys(e).join(", ")+"}":e,"")}function We(t,e){function n(n,i){if(e){if(!t){if(null===i.alternate)return;i=i.alternate}var r=n.lastEffect;null!==r?(r.nextEffect=i,n.lastEffect=i):n.firstEffect=n.lastEffect=i,i.nextEffect=null,i.effectTag=8}}function i(t,i){if(!e)return null;for(;null!==i;)n(t,i),i=i.sibling;return null}function r(t,e){for(t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function o(e,n,i){return t?(e=Te(e,n,i),e.index=0,e.sibling=null,e):(e.expirationTime=i,e.effectTag=0,e.index=0,e.sibling=null,e.pendingProps=n,e)}function a(t,n,i){return t.index=i,e?null!==(i=t.alternate)?(i=i.index)<n?(t.effectTag=2,n):i:(t.effectTag=2,n):n}function s(t){return e&&null===t.alternate&&(t.effectTag=2),t}function l(t,e,n,i){return null===e||6!==e.tag?(e=be(n,t.internalContextTag,i),e.return=t,e):(e=o(e,n,i),e.return=t,e)}function u(t,e,n,i){return null!==e&&e.type===n.type?(i=o(e,n.props,i),i.ref=Xe(e,n),i.return=t,i):(i=we(n,t.internalContextTag,i),i.ref=Xe(e,n),i.return=t,i)}function c(t,e,n,i){return null===e||7!==e.tag?(e=Ae(n,t.internalContextTag,i),e.return=t,e):(e=o(e,n,i),e.return=t,e)}function h(t,e,n,i){return null===e||9!==e.tag?(e=Re(n,t.internalContextTag,i),e.type=n.value,e.return=t,e):(e=o(e,null,i),e.type=n.value,e.return=t,e)}function d(t,e,n,i){return null===e||4!==e.tag||e.stateNode.containerInfo!==n.containerInfo||e.stateNode.implementation!==n.implementation?(e=Le(n,t.internalContextTag,i),e.return=t,e):(e=o(e,n.children||[],i),e.return=t,e)}function f(t,e,n,i,r){return null===e||10!==e.tag?(e=Ce(n,t.internalContextTag,i,r),e.return=t,e):(e=o(e,n,i),e.return=t,e)}function p(t,e,n){if("string"==typeof e||"number"==typeof e)return e=be(""+e,t.internalContextTag,n),e.return=t,e;if("object"==typeof e&&null!==e){switch(e.$$typeof){case yo:return e.type===So?(e=Ce(e.props.children,t.internalContextTag,n,e.key),e.return=t,e):(n=we(e,t.internalContextTag,n),n.ref=Xe(null,e),n.return=t,n);case mo:return e=Ae(e,t.internalContextTag,n),e.return=t,e;case xo:return n=Re(e,t.internalContextTag,n),n.type=e.value,n.return=t,n;case Ao:return e=Le(e,t.internalContextTag,n),e.return=t,e}if(Ro(e)||ze(e))return e=Ce(e,t.internalContextTag,n,null),e.return=t,e;He(t,e)}return null}function g(t,e,n,i){var r=null!==e?e.key:null;if("string"==typeof n||"number"==typeof n)return null!==r?null:l(t,e,""+n,i);if("object"==typeof n&&null!==n){switch(n.$$typeof){case yo:return n.key===r?n.type===So?f(t,e,n.props.children,i,r):u(t,e,n,i):null;case mo:return n.key===r?c(t,e,n,i):null;case xo:return null===r?h(t,e,n,i):null;case Ao:return n.key===r?d(t,e,n,i):null}if(Ro(n)||ze(n))return null!==r?null:f(t,e,n,i,null);He(t,n)}return null}function _(t,e,n,i,r){if("string"==typeof i||"number"==typeof i)return t=t.get(n)||null,l(e,t,""+i,r);if("object"==typeof i&&null!==i){switch(i.$$typeof){case yo:return t=t.get(null===i.key?n:i.key)||null,i.type===So?f(e,t,i.props.children,r,i.key):u(e,t,i,r);case mo:return t=t.get(null===i.key?n:i.key)||null,c(e,t,i,r);case xo:return t=t.get(n)||null,h(e,t,i,r);case Ao:return t=t.get(null===i.key?n:i.key)||null,d(e,t,i,r)}if(Ro(i)||ze(i))return t=t.get(n)||null,f(e,t,i,r,null);He(e,i)}return null}function v(t,o,s,l){for(var u=null,c=null,h=o,d=o=0,f=null;null!==h&&d<s.length;d++){h.index>d?(f=h,h=null):f=h.sibling;var v=g(t,h,s[d],l);if(null===v){null===h&&(h=f);break}e&&h&&null===v.alternate&&n(t,h),o=a(v,o,d),null===c?u=v:c.sibling=v,c=v,h=f}if(d===s.length)return i(t,h),u;if(null===h){for(;d<s.length;d++)(h=p(t,s[d],l))&&(o=a(h,o,d),null===c?u=h:c.sibling=h,c=h);return u}for(h=r(t,h);d<s.length;d++)(f=_(h,t,d,s[d],l))&&(e&&null!==f.alternate&&h.delete(null===f.key?d:f.key),o=a(f,o,d),null===c?u=f:c.sibling=f,c=f);return e&&h.forEach(function(e){return n(t,e)}),u}function y(t,o,s,l){var u=ze(s);"function"!=typeof u&&x("150"),null==(s=u.call(s))&&x("151");for(var c=u=null,h=o,d=o=0,f=null,v=s.next();null!==h&&!v.done;d++,v=s.next()){h.index>d?(f=h,h=null):f=h.sibling;var y=g(t,h,v.value,l);if(null===y){h||(h=f);break}e&&h&&null===y.alternate&&n(t,h),o=a(y,o,d),null===c?u=y:c.sibling=y,c=y,h=f}if(v.done)return i(t,h),u;if(null===h){for(;!v.done;d++,v=s.next())null!==(v=p(t,v.value,l))&&(o=a(v,o,d),null===c?u=v:c.sibling=v,c=v);return u}for(h=r(t,h);!v.done;d++,v=s.next())null!==(v=_(h,t,d,v.value,l))&&(e&&null!==v.alternate&&h.delete(null===v.key?d:v.key),o=a(v,o,d),null===c?u=v:c.sibling=v,c=v);return e&&h.forEach(function(e){return n(t,e)}),u}return function(t,e,r,a){var l="object"==typeof r&&null!==r;if(l)switch(r.$$typeof){case yo:t:{var u=r.key;for(l=e;null!==l;){if(l.key===u){if(10===l.tag?r.type===So:l.type===r.type){i(t,l.sibling),(e=o(l,r.type===So?r.props.children:r.props,a)).ref=Xe(l,r),e.return=t,t=e;break t}i(t,l);break}n(t,l),l=l.sibling}r.type===So?(r=Ce(r.props.children,t.internalContextTag,a,r.key),r.return=t,t=r):(a=we(r,t.internalContextTag,a),a.ref=Xe(e,r),a.return=t,t=a)}return s(t);case mo:t:{for(l=r.key;null!==e;){if(e.key===l){if(7===e.tag){i(t,e.sibling),(r=o(e,r,a)).return=t,t=r;break t}i(t,e);break}n(t,e),e=e.sibling}(r=Ae(r,t.internalContextTag,a)).return=t,t=r}return s(t);case xo:t:{if(null!==e){if(9===e.tag){i(t,e.sibling),(e=o(e,null,a)).type=r.value,e.return=t,t=e;break t}i(t,e)}(e=Re(r,t.internalContextTag,a)).type=r.value,e.return=t,t=e}return s(t);case Ao:t:{for(l=r.key;null!==e;){if(e.key===l){if(4===e.tag&&e.stateNode.containerInfo===r.containerInfo&&e.stateNode.implementation===r.implementation){i(t,e.sibling),(r=o(e,r.children||[],a)).return=t,t=r;break t}i(t,e);break}n(t,e),e=e.sibling}(r=Le(r,t.internalContextTag,a)).return=t,t=r}return s(t)}if("string"==typeof r||"number"==typeof r)return r=""+r,null!==e&&6===e.tag?(i(t,e.sibling),r=o(e,r,a)):(i(t,e),r=be(r,t.internalContextTag,a)),r.return=t,t=r,s(t);if(Ro(r))return v(t,e,r,a);if(ze(r))return y(t,e,r,a);if(l&&He(t,r),void 0===r)switch(t.tag){case 2:case 1:x("152",(r=t.type).displayName||r.name||"Component")}return i(t,e)}}function Ye(t,e,n,i,r){function o(t,e,n){a(t,e,n,e.expirationTime)}function a(t,e,n,i){e.child=null===t?Mo(e,e.child,n,i):t.child===e.child?Io(e,e.child,n,i):Po(e,e.child,n,i)}function s(t,e){var n=e.ref;null===n||t&&t.ref===n||(e.effectTag|=128)}function l(t,e,n,i){if(s(t,e),!n)return i&&Se(e,!1),c(t,e);n=e.stateNode,Wr.current=e;var r=n.render();return e.effectTag|=1,o(t,e,r),e.memoizedState=n.state,e.memoizedProps=n.props,i&&Se(e,!0),e.child}function u(t){var e=t.stateNode;e.pendingContext?ye(t,e.pendingContext,e.pendingContext!==e.context):e.context&&ye(t,e.context,!1),_(t,e.containerInfo)}function c(t,e){if(null!==t&&e.child!==t.child&&x("153"),null!==e.child){var n=Te(t=e.child,t.pendingProps,t.expirationTime);for(e.child=n,n.return=e;null!==t.sibling;)t=t.sibling,n=n.sibling=Te(t,t.pendingProps,t.expirationTime),n.return=e;n.sibling=null}return e.child}function h(t,e){switch(e.tag){case 3:u(e);break;case 2:xe(e);break;case 4:_(e,e.stateNode.containerInfo)}return null}var d=t.shouldSetTextContent,f=t.useSyncScheduling,p=t.shouldDeprioritizeSubtree,g=e.pushHostContext,_=e.pushHostContainer,v=n.enterHydrationState,y=n.resetHydrationState,m=n.tryToClaimNextHydratableInstance,S=(t=Ue(i,r,function(t,e){t.memoizedProps=e},function(t,e){t.memoizedState=e})).adoptClassInstance,E=t.constructClassInstance,T=t.mountClassInstance,w=t.updateClassInstance;return{beginWork:function(t,e,n){if(0===e.expirationTime||e.expirationTime>n)return h(0,e);switch(e.tag){case 0:null!==t&&x("155");var i=e.type,r=e.pendingProps,a=pe(e);return a=ge(e,a),i=i(r,a),e.effectTag|=1,"object"==typeof i&&null!==i&&"function"==typeof i.render?(e.tag=2,r=xe(e),S(e,i),T(e,n),e=l(t,e,!0,r)):(e.tag=1,o(t,e,i),e.memoizedProps=r,e=e.child),e;case 1:t:{if(r=e.type,n=e.pendingProps,i=e.memoizedProps,To.current)null===n&&(n=i);else if(null===n||i===n){e=c(t,e);break t}r=r(n,i=ge(e,i=pe(e))),e.effectTag|=1,o(t,e,r),e.memoizedProps=n,e=e.child}return e;case 2:return r=xe(e),i=void 0,null===t?e.stateNode?x("153"):(E(e,e.pendingProps),T(e,n),i=!0):i=w(t,e,n),l(t,e,i,r);case 3:return u(e),null!==(r=e.updateQueue)?(i=e.memoizedState,r=Ge(t,e,r,null,null,n),i===r?(y(),e=c(t,e)):(i=r.element,a=e.stateNode,(null===t||null===t.child)&&a.hydrate&&v(e)?(e.effectTag|=2,e.child=Mo(e,e.child,i,n)):(y(),o(t,e,i)),e.memoizedState=r,e=e.child)):(y(),e=c(t,e)),e;case 5:g(e),null===t&&m(e),r=e.type;var C=e.memoizedProps;return null===(i=e.pendingProps)&&null===(i=C)&&x("154"),a=null!==t?t.memoizedProps:null,To.current||null!==i&&C!==i?(C=i.children,d(r,i)?C=null:a&&d(r,a)&&(e.effectTag|=16),s(t,e),2147483647!==n&&!f&&p(r,i)?(e.expirationTime=2147483647,e=null):(o(t,e,C),e.memoizedProps=i,e=e.child)):e=c(t,e),e;case 6:return null===t&&m(e),null===(t=e.pendingProps)&&(t=e.memoizedProps),e.memoizedProps=t,null;case 8:e.tag=7;case 7:return r=e.pendingProps,To.current?null===r&&null===(r=t&&t.memoizedProps)&&x("154"):null!==r&&e.memoizedProps!==r||(r=e.memoizedProps),i=r.children,e.stateNode=null===t?Mo(e,e.stateNode,i,n):t.child===e.child?Io(e,e.stateNode,i,n):Po(e,e.stateNode,i,n),e.memoizedProps=r,e.stateNode;case 9:return null;case 4:t:{if(_(e,e.stateNode.containerInfo),r=e.pendingProps,To.current)null===r&&null==(r=t&&t.memoizedProps)&&x("154");else if(null===r||e.memoizedProps===r){e=c(t,e);break t}null===t?e.child=Po(e,e.child,r,n):o(t,e,r),e.memoizedProps=r,e=e.child}return e;case 10:t:{if(n=e.pendingProps,To.current)null===n&&(n=e.memoizedProps);else if(null===n||e.memoizedProps===n){e=c(t,e);break t}o(t,e,n),e.memoizedProps=n,e=e.child}return e;default:x("156")}},beginFailedWork:function(t,e,n){switch(e.tag){case 2:xe(e);break;case 3:u(e);break;default:x("157")}return e.effectTag|=64,null===t?e.child=null:e.child!==t.child&&(e.child=t.child),0===e.expirationTime||e.expirationTime>n?h(0,e):(e.firstEffect=null,e.lastEffect=null,a(t,e,null,n),2===e.tag&&(t=e.stateNode,e.memoizedProps=t.props,e.memoizedState=t.state),e.child)}}}function je(t,e,n){function i(t){t.effectTag|=4}var r=t.createInstance,o=t.createTextInstance,a=t.appendInitialChild,s=t.finalizeInitialChildren,l=t.prepareUpdate,u=t.persistence,c=e.getRootHostContainer,h=e.popHostContext,d=e.getHostContext,f=e.popHostContainer,p=n.prepareToHydrateHostInstance,g=n.prepareToHydrateHostTextInstance,_=n.popHydrationState,v=void 0,y=void 0,m=void 0;return t.mutation?(v=function(){},y=function(t,e,n){(e.updateQueue=n)&&i(e)},m=function(t,e,n,r){n!==r&&i(e)}):x(u?"235":"236"),{completeWork:function(t,e,n){var u=e.pendingProps;switch(null===u?u=e.memoizedProps:2147483647===e.expirationTime&&2147483647!==n||(e.pendingProps=null),e.tag){case 1:return null;case 2:return ve(e),null;case 3:return f(e),de(To,e),de(Eo,e),(u=e.stateNode).pendingContext&&(u.context=u.pendingContext,u.pendingContext=null),null!==t&&null!==t.child||(_(e),e.effectTag&=-3),v(e),null;case 5:h(e),n=c();var S=e.type;if(null!==t&&null!=e.stateNode){var E=t.memoizedProps,T=e.stateNode,w=d();T=l(T,S,E,u,n,w),y(t,e,T,S,E,u,n),t.ref!==e.ref&&(e.effectTag|=128)}else{if(!u)return null===e.stateNode&&x("166"),null;if(t=d(),_(e))p(e,n,t)&&i(e);else{t=r(S,u,n,t,e);t:for(E=e.child;null!==E;){if(5===E.tag||6===E.tag)a(t,E.stateNode);else if(4!==E.tag&&null!==E.child){E.child.return=E,E=E.child;continue}if(E===e)break;for(;null===E.sibling;){if(null===E.return||E.return===e)break t;E=E.return}E.sibling.return=E.return,E=E.sibling}s(t,S,u,n)&&i(e),e.stateNode=t}null!==e.ref&&(e.effectTag|=128)}return null;case 6:if(t&&null!=e.stateNode)m(t,e,t.memoizedProps,u);else{if("string"!=typeof u)return null===e.stateNode&&x("166"),null;t=c(),n=d(),_(e)?g(e)&&i(e):e.stateNode=o(u,t,n,e)}return null;case 7:(u=e.memoizedProps)||x("165"),e.tag=8,S=[];t:for((E=e.stateNode)&&(E.return=e);null!==E;){if(5===E.tag||6===E.tag||4===E.tag)x("247");else if(9===E.tag)S.push(E.type);else if(null!==E.child){E.child.return=E,E=E.child;continue}for(;null===E.sibling;){if(null===E.return||E.return===e)break t;E=E.return}E.sibling.return=E.return,E=E.sibling}return E=u.handler,u=E(u.props,S),e.child=Io(e,null!==t?t.child:null,u,n),e.child;case 8:return e.tag=7,null;case 9:case 10:return null;case 4:return f(e),v(e),null;case 0:x("167");default:x("156")}}}}function Ke(t,e){function n(t){var n=t.ref;if(null!==n)try{n(null)}catch(n){e(t,n)}}function i(t){switch("function"==typeof Oe&&Oe(t),t.tag){case 2:n(t);var i=t.stateNode;if("function"==typeof i.componentWillUnmount)try{i.props=t.memoizedProps,i.state=t.memoizedState,i.componentWillUnmount()}catch(n){e(t,n)}break;case 5:n(t);break;case 7:r(t.stateNode);break;case 4:l&&a(t)}}function r(t){for(var e=t;;)if(i(e),null===e.child||l&&4===e.tag){if(e===t)break;for(;null===e.sibling;){if(null===e.return||e.return===t)return;e=e.return}e.sibling.return=e.return,e=e.sibling}else e.child.return=e,e=e.child}function o(t){return 5===t.tag||3===t.tag||4===t.tag}function a(t){for(var e=t,n=!1,o=void 0,a=void 0;;){if(!n){n=e.return;t:for(;;){switch(null===n&&x("160"),n.tag){case 5:o=n.stateNode,a=!1;break t;case 3:case 4:o=n.stateNode.containerInfo,a=!0;break t}n=n.return}n=!0}if(5===e.tag||6===e.tag)r(e),a?y(o,e.stateNode):v(o,e.stateNode);else if(4===e.tag?o=e.stateNode.containerInfo:i(e),null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break;for(;null===e.sibling;){if(null===e.return||e.return===t)return;4===(e=e.return).tag&&(n=!1)}e.sibling.return=e.return,e=e.sibling}}var s=t.getPublicInstance,l=t.mutation;t=t.persistence,l||x(t?"235":"236");var u=l.commitMount,c=l.commitUpdate,h=l.resetTextContent,d=l.commitTextUpdate,f=l.appendChild,p=l.appendChildToContainer,g=l.insertBefore,_=l.insertInContainerBefore,v=l.removeChild,y=l.removeChildFromContainer;return{commitResetTextContent:function(t){h(t.stateNode)},commitPlacement:function(t){t:{for(var e=t.return;null!==e;){if(o(e)){var n=e;break t}e=e.return}x("160"),n=void 0}var i=e=void 0;switch(n.tag){case 5:e=n.stateNode,i=!1;break;case 3:case 4:e=n.stateNode.containerInfo,i=!0;break;default:x("161")}16&n.effectTag&&(h(e),n.effectTag&=-17);t:e:for(n=t;;){for(;null===n.sibling;){if(null===n.return||o(n.return)){n=null;break t}n=n.return}for(n.sibling.return=n.return,n=n.sibling;5!==n.tag&&6!==n.tag;){if(2&n.effectTag)continue e;if(null===n.child||4===n.tag)continue e;n.child.return=n,n=n.child}if(!(2&n.effectTag)){n=n.stateNode;break t}}for(var r=t;;){if(5===r.tag||6===r.tag)n?i?_(e,r.stateNode,n):g(e,r.stateNode,n):i?p(e,r.stateNode):f(e,r.stateNode);else if(4!==r.tag&&null!==r.child){r.child.return=r,r=r.child;continue}if(r===t)break;for(;null===r.sibling;){if(null===r.return||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}},commitDeletion:function(t){a(t),t.return=null,t.child=null,t.alternate&&(t.alternate.child=null,t.alternate.return=null)},commitWork:function(t,e){switch(e.tag){case 2:break;case 5:var n=e.stateNode;if(null!=n){var i=e.memoizedProps;t=null!==t?t.memoizedProps:i;var r=e.type,o=e.updateQueue;e.updateQueue=null,null!==o&&c(n,o,r,t,i,e)}break;case 6:null===e.stateNode&&x("162"),n=e.memoizedProps,d(e.stateNode,null!==t?t.memoizedProps:n,n);break;case 3:break;default:x("163")}},commitLifeCycles:function(t,e){switch(e.tag){case 2:var n=e.stateNode;if(4&e.effectTag)if(null===t)n.props=e.memoizedProps,n.state=e.memoizedState,n.componentDidMount();else{var i=t.memoizedProps;t=t.memoizedState,n.props=e.memoizedProps,n.state=e.memoizedState,n.componentDidUpdate(i,t)}null!==(e=e.updateQueue)&&Ve(e,n);break;case 3:null!==(n=e.updateQueue)&&Ve(n,null!==e.child?e.child.stateNode:null);break;case 5:n=e.stateNode,null===t&&4&e.effectTag&&u(n,e.type,e.memoizedProps,e);break;case 6:case 4:break;default:x("163")}},commitAttachRef:function(t){var e=t.ref;if(null!==e){var n=t.stateNode;switch(t.tag){case 5:e(s(n));break;default:e(n)}}},commitDetachRef:function(t){null!==(t=t.ref)&&t(null)}}}function qe(t){function e(t){return t===Oo&&x("174"),t}var n=t.getChildHostContext,i=t.getRootHostContext,r={current:Oo},o={current:Oo},a={current:Oo};return{getHostContext:function(){return e(r.current)},getRootHostContainer:function(){return e(a.current)},popHostContainer:function(t){de(r,t),de(o,t),de(a,t)},popHostContext:function(t){o.current===t&&(de(r,t),de(o,t))},pushHostContainer:function(t,e){fe(a,e,t),e=i(e),fe(o,t,t),fe(r,e,t)},pushHostContext:function(t){var i=e(a.current),s=e(r.current);s!==(i=n(s,t.type,i))&&(fe(o,t,t),fe(r,i,t))},resetHostContainer:function(){r.current=Oo,a.current=Oo}}}function Ze(t){function e(t,e){var n=new Ee(5,null,0);n.type="DELETED",n.stateNode=e,n.return=t,n.effectTag=8,null!==t.lastEffect?(t.lastEffect.nextEffect=n,t.lastEffect=n):t.firstEffect=t.lastEffect=n}function n(t,e){switch(t.tag){case 5:return null!==(e=o(e,t.type,t.pendingProps))&&(t.stateNode=e,!0);case 6:return null!==(e=a(e,t.pendingProps))&&(t.stateNode=e,!0);default:return!1}}function i(t){for(t=t.return;null!==t&&5!==t.tag&&3!==t.tag;)t=t.return;h=t}var r=t.shouldSetTextContent;if(!(t=t.hydration))return{enterHydrationState:function(){return!1},resetHydrationState:function(){},tryToClaimNextHydratableInstance:function(){},prepareToHydrateHostInstance:function(){x("175")},prepareToHydrateHostTextInstance:function(){x("176")},popHydrationState:function(){return!1}};var o=t.canHydrateInstance,a=t.canHydrateTextInstance,s=t.getNextHydratableSibling,l=t.getFirstHydratableChild,u=t.hydrateInstance,c=t.hydrateTextInstance,h=null,d=null,f=!1;return{enterHydrationState:function(t){return d=l(t.stateNode.containerInfo),h=t,f=!0},resetHydrationState:function(){d=h=null,f=!1},tryToClaimNextHydratableInstance:function(t){if(f){var i=d;if(i){if(!n(t,i)){if(!(i=s(i))||!n(t,i))return t.effectTag|=2,f=!1,void(h=t);e(h,d)}h=t,d=l(i)}else t.effectTag|=2,f=!1,h=t}},prepareToHydrateHostInstance:function(t,e,n){return e=u(t.stateNode,t.type,t.memoizedProps,e,n,t),t.updateQueue=e,null!==e},prepareToHydrateHostTextInstance:function(t){return c(t.stateNode,t.memoizedProps,t)},popHydrationState:function(t){if(t!==h)return!1;if(!f)return i(t),f=!0,!1;var n=t.type;if(5!==t.tag||"head"!==n&&"body"!==n&&!r(n,t.memoizedProps))for(n=d;n;)e(t,n),n=s(n);return i(t),d=h?s(t.stateNode):null,!0}}}function Qe(t){function e(t){it=j=!0;var e=t.stateNode;if(e.current===t&&x("177"),e.isReadyForCommit=!1,Wr.current=null,1<t.effectTag)if(null!==t.lastEffect){t.lastEffect.nextEffect=t;var n=t.firstEffect}else n=t;else n=t.firstEffect;for(z(),Q=n;null!==Q;){var i=!1,r=void 0;try{for(;null!==Q;){var o=Q.effectTag;if(16&o&&M(Q),128&o){var a=Q.alternate;null!==a&&G(a)}switch(-242&o){case 2:O(Q),Q.effectTag&=-3;break;case 6:O(Q),Q.effectTag&=-3,F(Q.alternate,Q);break;case 4:F(Q.alternate,Q);break;case 8:rt=!0,D(Q),rt=!1}Q=Q.nextEffect}}catch(t){i=!0,r=t}i&&(null===Q&&x("178"),s(Q,r),null!==Q&&(Q=Q.nextEffect))}for(X(),e.current=t,Q=n;null!==Q;){n=!1,i=void 0;try{for(;null!==Q;){var l=Q.effectTag;if(36&l&&k(Q.alternate,Q),128&l&&N(Q),64&l)switch(r=Q,o=void 0,null!==J&&(o=J.get(r),J.delete(r),null==o&&null!==r.alternate&&(r=r.alternate,o=J.get(r),J.delete(r))),null==o&&x("184"),r.tag){case 2:r.stateNode.componentDidCatch(o.error,{componentStack:o.componentStack});break;case 3:null===et&&(et=o.error);break;default:x("157")}var u=Q.nextEffect;Q.nextEffect=null,Q=u}}catch(t){n=!0,i=t}n&&(null===Q&&x("178"),s(Q,i),null!==Q&&(Q=Q.nextEffect))}return j=it=!1,"function"==typeof Me&&Me(t.stateNode),tt&&(tt.forEach(p),tt=null),null!==et&&(t=et,et=null,E(t)),0===(e=e.current.expirationTime)&&($=J=null),e}function n(t){for(;;){var e=P(t.alternate,t,Z),n=t.return,i=t.sibling,r=t;if(2147483647===Z||2147483647!==r.expirationTime){if(2!==r.tag&&3!==r.tag)var o=0;else o=r.updateQueue,o=null===o?0:o.expirationTime;for(var a=r.child;null!==a;)0!==a.expirationTime&&(0===o||o>a.expirationTime)&&(o=a.expirationTime),a=a.sibling;r.expirationTime=o}if(null!==e)return e;if(null!==n&&(null===n.firstEffect&&(n.firstEffect=t.firstEffect),null!==t.lastEffect&&(null!==n.lastEffect&&(n.lastEffect.nextEffect=t.firstEffect),n.lastEffect=t.lastEffect),1<t.effectTag&&(null!==n.lastEffect?n.lastEffect.nextEffect=t:n.firstEffect=t,n.lastEffect=t)),null!==i)return i;if(null===n){t.stateNode.isReadyForCommit=!0;break}t=n}return null}function i(t){var e=L(t.alternate,t,Z);return null===e&&(e=n(t)),Wr.current=null,e}function r(t){var e=I(t.alternate,t,Z);return null===e&&(e=n(t)),Wr.current=null,e}function o(t){if(null!==J){if(!(0===Z||Z>t))if(Z<=W)for(;null!==K;)K=l(K)?r(K):i(K);else for(;null!==K&&!S();)K=l(K)?r(K):i(K)}else if(!(0===Z||Z>t))if(Z<=W)for(;null!==K;)K=i(K);else for(;null!==K&&!S();)K=i(K)}function a(t,e){if(j&&x("243"),j=!0,t.isReadyForCommit=!1,t!==q||e!==Z||null===K){for(;-1<vo;)_o[vo]=null,vo--;wo=ii,Eo.current=ii,To.current=!1,A(),Z=e,K=Te((q=t).current,null,e)}var n=!1,i=null;try{o(e)}catch(t){n=!0,i=t}for(;n;){if(nt){et=i;break}var a=K;if(null===a)nt=!0;else{var l=s(a,i);if(null===l&&x("183"),!nt){try{for(i=e,l=n=l;null!==a;){switch(a.tag){case 2:ve(a);break;case 5:b(a);break;case 3:C(a);break;case 4:C(a)}if(a===l||a.alternate===l)break;a=a.return}K=r(n),o(i)}catch(t){n=!0,i=t;continue}break}}}return e=et,nt=j=!1,et=null,null!==e&&E(e),t.isReadyForCommit?t.current.alternate:null}function s(t,e){var n=Wr.current=null,i=!1,r=!1,o=null;if(3===t.tag)n=t,u(t)&&(nt=!0);else for(var a=t.return;null!==a&&null===n;){if(2===a.tag?"function"==typeof a.stateNode.componentDidCatch&&(i=!0,o=Gt(a),n=a,r=!0):3===a.tag&&(n=a),u(a)){if(rt||null!==tt&&(tt.has(a)||null!==a.alternate&&tt.has(a.alternate)))return null;n=null,r=!1}a=a.return}if(null!==n){null===$&&($=new Set),$.add(n);var s="";a=t;do{t:switch(a.tag){case 0:case 1:case 2:case 5:var l=a._debugOwner,c=a._debugSource,h=Gt(a),d=null;l&&(d=Gt(l)),l=c,h="\n    in "+(h||"Unknown")+(l?" (at "+l.fileName.replace(/^.*[\\\/]/,"")+":"+l.lineNumber+")":d?" (created by "+d+")":"");break t;default:h=""}s+=h,a=a.return}while(a);a=s,t=Gt(t),null===J&&(J=new Map),e={componentName:t,componentStack:a,error:e,errorBoundary:i?n.stateNode:null,errorBoundaryFound:i,errorBoundaryName:o,willRetry:r},J.set(n,e);try{console.error(e.error)}catch(t){console.error(t)}return it?(null===tt&&(tt=new Set),tt.add(n)):p(n),n}return null===et&&(et=e),null}function l(t){return null!==J&&(J.has(t)||null!==t.alternate&&J.has(t.alternate))}function u(t){return null!==$&&($.has(t)||null!==t.alternate&&$.has(t.alternate))}function c(){return 20*(1+((g()+100)/20|0))}function h(t){return 0!==Y?Y:j?it?1:Z:!B||1&t.internalContextTag?c():1}function d(t,e){return f(t,e,!1)}function f(t,e){for(;null!==t;){if((0===t.expirationTime||t.expirationTime>e)&&(t.expirationTime=e),null!==t.alternate&&(0===t.alternate.expirationTime||t.alternate.expirationTime>e)&&(t.alternate.expirationTime=e),null===t.return){if(3!==t.tag)break;var n=t.stateNode;!j&&n===q&&e<=Z&&(K=q=null,Z=0);var i=e;if(yt>vt&&x("185"),null===n.nextScheduledRoot)n.remainingExpirationTime=i,null===at?(ot=at=n,n.nextScheduledRoot=n):(at=at.nextScheduledRoot=n,at.nextScheduledRoot=ot);else{var r=n.remainingExpirationTime;(0===r||i<r)&&(n.remainingExpirationTime=i)}lt||(gt?_t&&m(n,1):1===i?y(1,null):st||(st=!0,U(v)))}t=t.return}}function p(t){f(t,1,!0)}function g(){return W=2+((V()-H)/10|0)}function _(){var t=0,e=null;if(null!==at)for(var n=at,i=ot;null!==i;){var r=i.remainingExpirationTime;if(0===r){if((null===n||null===at)&&x("244"),i===i.nextScheduledRoot){ot=at=i.nextScheduledRoot=null;break}if(i===ot)ot=r=i.nextScheduledRoot,at.nextScheduledRoot=r,i.nextScheduledRoot=null;else{if(i===at){(at=n).nextScheduledRoot=ot,i.nextScheduledRoot=null;break}n.nextScheduledRoot=i.nextScheduledRoot,i.nextScheduledRoot=null}i=n.nextScheduledRoot}else{if((0===t||r<t)&&(t=r,e=i),i===at)break;n=i,i=i.nextScheduledRoot}}null!==(n=ut)&&n===e?yt++:yt=0,ut=e,ct=t}function v(t){y(0,t)}function y(t,e){for(pt=e,_();null!==ut&&0!==ct&&(0===t||ct<=t)&&!ht;)m(ut,ct),_();if(null!==pt&&(st=!1),null===ut||st||(st=!0,U(v)),pt=null,ht=!1,yt=0,dt)throw t=ft,ft=null,dt=!1,t}function m(t,n){if(lt&&x("245"),lt=!0,n<=g()){var i=t.finishedWork;null!==i?(t.finishedWork=null,t.remainingExpirationTime=e(i)):(t.finishedWork=null,null!==(i=a(t,n))&&(t.remainingExpirationTime=e(i)))}else null!==(i=t.finishedWork)?(t.finishedWork=null,t.remainingExpirationTime=e(i)):(t.finishedWork=null,null!==(i=a(t,n))&&(S()?t.finishedWork=i:t.remainingExpirationTime=e(i)));lt=!1}function S(){return!(null===pt||pt.timeRemaining()>mt)&&(ht=!0)}function E(t){null===ut&&x("246"),ut.remainingExpirationTime=0,dt||(dt=!0,ft=t)}var T=qe(t),w=Ze(t),C=T.popHostContainer,b=T.popHostContext,A=T.resetHostContainer,R=Ye(t,T,w,d,h),L=R.beginWork,I=R.beginFailedWork,P=je(t,T,w).completeWork,M=(T=Ke(t,s)).commitResetTextContent,O=T.commitPlacement,D=T.commitDeletion,F=T.commitWork,k=T.commitLifeCycles,N=T.commitAttachRef,G=T.commitDetachRef,V=t.now,U=t.scheduleDeferredCallback,B=t.useSyncScheduling,z=t.prepareForCommit,X=t.resetAfterCommit,H=V(),W=2,Y=0,j=!1,K=null,q=null,Z=0,Q=null,J=null,$=null,tt=null,et=null,nt=!1,it=!1,rt=!1,ot=null,at=null,st=!1,lt=!1,ut=null,ct=0,ht=!1,dt=!1,ft=null,pt=null,gt=!1,_t=!1,vt=1e3,yt=0,mt=1;return{computeAsyncExpiration:c,computeExpirationForFiber:h,scheduleWork:d,batchedUpdates:function(t,e){var n=gt;gt=!0;try{return t(e)}finally{(gt=n)||lt||y(1,null)}},unbatchedUpdates:function(t){if(gt&&!_t){_t=!0;try{return t()}finally{_t=!1}}return t()},flushSync:function(t){var e=gt;gt=!0;try{t:{var n=Y;Y=1;try{var i=t();break t}finally{Y=n}i=void 0}return i}finally{gt=e,lt&&x("187"),y(1,null)}},deferredUpdates:function(t){var e=Y;Y=c();try{return t()}finally{Y=e}}}}function Je(t){function e(t){return null===(t=Xt(t))?null:t.stateNode}var n=t.getPublicInstance,i=(t=Qe(t)).computeAsyncExpiration,r=t.computeExpirationForFiber,o=t.scheduleWork;return{createContainer:function(t,e){var n=new Ee(3,null,0);return t={current:n,containerInfo:t,pendingChildren:null,remainingExpirationTime:0,isReadyForCommit:!1,finishedWork:null,context:null,pendingContext:null,hydrate:e,nextScheduledRoot:null},n.stateNode=t},updateContainer:function(t,e,n,a){var s=e.current;if(n){var l;t:{for(2===Vt(n=n._reactInternalFiber)&&2===n.tag||x("170"),l=n;3!==l.tag;){if(_e(l)){l=l.stateNode.__reactInternalMemoizedMergedChildContext;break t}(l=l.return)||x("171")}l=l.stateNode.context}n=_e(n)?me(n,l):l}else n=ii;null===e.context?e.context=n:e.pendingContext=n,e=void 0===(e=a)?null:e,ke(s,{expirationTime:a=null!=t&&null!=t.type&&null!=t.type.prototype&&!0===t.type.prototype.unstable_isAsyncReactComponent?i():r(s),partialState:{element:t},callback:e,isReplace:!1,isForced:!1,nextCallback:null,next:null}),o(s,a)},batchedUpdates:t.batchedUpdates,unbatchedUpdates:t.unbatchedUpdates,deferredUpdates:t.deferredUpdates,flushSync:t.flushSync,getPublicRootInstance:function(t){if(!(t=t.current).child)return null;switch(t.child.tag){case 5:return n(t.child.stateNode);default:return t.child.stateNode}},findHostInstance:e,findHostInstanceWithNoPortals:function(t){return null===(t=Ht(t))?null:t.stateNode},injectIntoDevTools:function(t){var n=t.findFiberByHostInstance;return Pe(ni({},t,{findHostInstanceByFiber:function(t){return e(t)},findFiberByHostInstance:function(t){return n?n(t):null}}))}}}function $e(t){return!!Qo.hasOwnProperty(t)||!Zo.hasOwnProperty(t)&&(qo.test(t)?Qo[t]=!0:(Zo[t]=!0,!1))}function tn(t,e,n){var i=T(e);if(i&&E(e,n)){var r=i.mutationMethod;r?r(t,n):null==n||i.hasBooleanValue&&!n||i.hasNumericValue&&isNaN(n)||i.hasPositiveNumericValue&&1>n||i.hasOverloadedBooleanValue&&!1===n?nn(t,e):i.mustUseProperty?t[i.propertyName]=n:(e=i.attributeName,(r=i.attributeNamespace)?t.setAttributeNS(r,e,""+n):i.hasBooleanValue||i.hasOverloadedBooleanValue&&!0===n?t.setAttribute(e,""):t.setAttribute(e,""+n))}else en(t,e,E(e,n)?n:null)}function en(t,e,n){$e(e)&&(null==n?t.removeAttribute(e):t.setAttribute(e,""+n))}function nn(t,e){var n=T(e);n?(e=n.mutationMethod)?e(t,void 0):n.mustUseProperty?t[n.propertyName]=!n.hasBooleanValue&&"":t.removeAttribute(n.attributeName):t.removeAttribute(e)}function rn(t,e){var n=e.value,i=e.checked;return ni({type:void 0,step:void 0,min:void 0,max:void 0},e,{defaultChecked:void 0,defaultValue:void 0,value:null!=n?n:t._wrapperState.initialValue,checked:null!=i?i:t._wrapperState.initialChecked})}function on(t,e){var n=e.defaultValue;t._wrapperState={initialChecked:null!=e.checked?e.checked:e.defaultChecked,initialValue:null!=e.value?e.value:n,controlled:"checkbox"===e.type||"radio"===e.type?null!=e.checked:null!=e.value}}function an(t,e){var n=e.checked;null!=n&&tn(t,"checked",n||!1),null!=(n=e.value)?0===n&&""===t.value?t.value="0":"number"===e.type?(n!=(e=parseFloat(t.value)||0)||n==e&&t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n):(null==e.value&&null!=e.defaultValue&&t.defaultValue!==""+e.defaultValue&&(t.defaultValue=""+e.defaultValue),null==e.checked&&null!=e.defaultChecked&&(t.defaultChecked=!!e.defaultChecked))}function sn(t,e){switch(e.type){case"submit":case"reset":break;case"color":case"date":case"datetime":case"datetime-local":case"month":case"time":case"week":t.value="",t.value=t.defaultValue;break;default:t.value=t.value}""!==(e=t.name)&&(t.name=""),t.defaultChecked=!t.defaultChecked,t.defaultChecked=!t.defaultChecked,""!==e&&(t.name=e)}function ln(t){var e="";return Ei.Children.forEach(t,function(t){null==t||"string"!=typeof t&&"number"!=typeof t||(e+=t)}),e}function un(t,e){return t=ni({children:void 0},e),(e=ln(e.children))&&(t.children=e),t}function cn(t,e,n,i){if(t=t.options,e){e={};for(var r=0;r<n.length;r++)e["$"+n[r]]=!0;for(n=0;n<t.length;n++)r=e.hasOwnProperty("$"+t[n].value),t[n].selected!==r&&(t[n].selected=r),r&&i&&(t[n].defaultSelected=!0)}else{for(n=""+n,e=null,r=0;r<t.length;r++){if(t[r].value===n)return t[r].selected=!0,void(i&&(t[r].defaultSelected=!0));null!==e||t[r].disabled||(e=t[r])}null!==e&&(e.selected=!0)}}function hn(t,e){var n=e.value;t._wrapperState={initialValue:null!=n?n:e.defaultValue,wasMultiple:!!e.multiple}}function dn(t,e){return null!=e.dangerouslySetInnerHTML&&x("91"),ni({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function fn(t,e){var n=e.value,i=n;null==n&&(n=e.defaultValue,null!=(e=e.children)&&(null!=n&&x("92"),Array.isArray(e)&&(1>=e.length||x("93"),e=e[0]),n=""+e),null==n&&(n=""),i=n),t._wrapperState={initialValue:""+i}}function pn(t,e){var n=e.value;null!=n&&((n=""+n)!==t.value&&(t.value=n),null==e.defaultValue&&(t.defaultValue=n)),null!=e.defaultValue&&(t.defaultValue=e.defaultValue)}function gn(t){var e=t.textContent;e===t._wrapperState.initialValue&&(t.value=e)}function _n(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function vn(t,e){return null==t||"http://www.w3.org/1999/xhtml"===t?_n(e):"http://www.w3.org/2000/svg"===t&&"foreignObject"===e?"http://www.w3.org/1999/xhtml":t}function yn(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&3===n.nodeType)return void(n.nodeValue=e)}t.textContent=e}function mn(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var i=0===n.indexOf("--"),r=n,o=e[n];r=null==o||"boolean"==typeof o||""===o?"":i||"number"!=typeof o||0===o||ia.hasOwnProperty(r)&&ia[r]?(""+o).trim():o+"px","float"===n&&(n="cssFloat"),i?t.setProperty(n,r):t[n]=r}}function xn(t,e,n){e&&(oa[t]&&(null!=e.children||null!=e.dangerouslySetInnerHTML)&&x("137",t,n()),null!=e.dangerouslySetInnerHTML&&(null!=e.children&&x("60"),"object"==typeof e.dangerouslySetInnerHTML&&"__html"in e.dangerouslySetInnerHTML||x("61")),null!=e.style&&"object"!=typeof e.style&&x("62",n()))}function Sn(t,e){if(-1===t.indexOf("-"))return"string"==typeof e.is;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}function En(t,e){var n=Jt(t=9===t.nodeType||11===t.nodeType?t:t.ownerDocument);e=tr[e];for(var i=0;i<e.length;i++){var r=e[i];n.hasOwnProperty(r)&&n[r]||("topWheel"===r?mt("wheel")?jt("topWheel","wheel",t):mt("mousewheel")?jt("topWheel","mousewheel",t):jt("topWheel","DOMMouseScroll",t):"topScroll"===r?Kt("topScroll","scroll",t):"topFocus"===r||"topBlur"===r?(Kt("topFocus","focus",t),Kt("topBlur","blur",t),n.topBlur=!0,n.topFocus=!0):"topCancel"===r?(mt("cancel",!0)&&Kt("topCancel","cancel",t),n.topCancel=!0):"topClose"===r?(mt("close",!0)&&Kt("topClose","close",t),n.topClose=!0):$r.hasOwnProperty(r)&&jt(r,$r[r],t),n[r]=!0)}}function Tn(t,e,n,i){return n=9===n.nodeType?n:n.ownerDocument,i===aa&&(i=_n(t)),i===aa?"script"===t?(t=n.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):t="string"==typeof e.is?n.createElement(t,{is:e.is}):n.createElement(t):t=n.createElementNS(i,t),t}function wn(t,e){return(9===e.nodeType?e:e.ownerDocument).createTextNode(t)}function Cn(t,e,n,i){var r=Sn(e,n);switch(e){case"iframe":case"object":jt("topLoad","load",t);var o=n;break;case"video":case"audio":for(o in la)la.hasOwnProperty(o)&&jt(o,la[o],t);o=n;break;case"source":jt("topError","error",t),o=n;break;case"img":case"image":jt("topError","error",t),jt("topLoad","load",t),o=n;break;case"form":jt("topReset","reset",t),jt("topSubmit","submit",t),o=n;break;case"details":jt("topToggle","toggle",t),o=n;break;case"input":on(t,n),o=rn(t,n),jt("topInvalid","invalid",t),En(i,"onChange");break;case"option":o=un(t,n);break;case"select":hn(t,n),o=ni({},n,{value:void 0}),jt("topInvalid","invalid",t),En(i,"onChange");break;case"textarea":fn(t,n),o=dn(t,n),jt("topInvalid","invalid",t),En(i,"onChange");break;default:o=n}xn(e,o,sa);var a,s=o;for(a in s)if(s.hasOwnProperty(a)){var l=s[a];"style"===a?mn(t,l,sa):"dangerouslySetInnerHTML"===a?null!=(l=l?l.__html:void 0)&&ta(t,l):"children"===a?"string"==typeof l?("textarea"!==e||""!==l)&&na(t,l):"number"==typeof l&&na(t,""+l):"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&"autoFocus"!==a&&($i.hasOwnProperty(a)?null!=l&&En(i,a):r?en(t,a,l):null!=l&&tn(t,a,l))}switch(e){case"input":Et(t),sn(t,n);break;case"textarea":Et(t),gn(t,n);break;case"option":null!=n.value&&t.setAttribute("value",n.value);break;case"select":t.multiple=!!n.multiple,null!=(e=n.value)?cn(t,!!n.multiple,e,!1):null!=n.defaultValue&&cn(t,!!n.multiple,n.defaultValue,!0);break;default:"function"==typeof o.onClick&&(t.onclick=oi)}}function bn(t,e,n,i,r){var o=null;switch(e){case"input":n=rn(t,n),i=rn(t,i),o=[];break;case"option":n=un(t,n),i=un(t,i),o=[];break;case"select":n=ni({},n,{value:void 0}),i=ni({},i,{value:void 0}),o=[];break;case"textarea":n=dn(t,n),i=dn(t,i),o=[];break;default:"function"!=typeof n.onClick&&"function"==typeof i.onClick&&(t.onclick=oi)}xn(e,i,sa);var a,s;t=null;for(a in n)if(!i.hasOwnProperty(a)&&n.hasOwnProperty(a)&&null!=n[a])if("style"===a)for(s in e=n[a])e.hasOwnProperty(s)&&(t||(t={}),t[s]="");else"dangerouslySetInnerHTML"!==a&&"children"!==a&&"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&"autoFocus"!==a&&($i.hasOwnProperty(a)?o||(o=[]):(o=o||[]).push(a,null));for(a in i){var l=i[a];if(e=null!=n?n[a]:void 0,i.hasOwnProperty(a)&&l!==e&&(null!=l||null!=e))if("style"===a)if(e){for(s in e)!e.hasOwnProperty(s)||l&&l.hasOwnProperty(s)||(t||(t={}),t[s]="");for(s in l)l.hasOwnProperty(s)&&e[s]!==l[s]&&(t||(t={}),t[s]=l[s])}else t||(o||(o=[]),o.push(a,t)),t=l;else"dangerouslySetInnerHTML"===a?(l=l?l.__html:void 0,e=e?e.__html:void 0,null!=l&&e!==l&&(o=o||[]).push(a,""+l)):"children"===a?e===l||"string"!=typeof l&&"number"!=typeof l||(o=o||[]).push(a,""+l):"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&($i.hasOwnProperty(a)?(null!=l&&En(r,a),o||e===l||(o=[])):(o=o||[]).push(a,l))}return t&&(o=o||[]).push("style",t),o}function An(t,e,n,i,r){Sn(n,i),i=Sn(n,r);for(var o=0;o<e.length;o+=2){var a=e[o],s=e[o+1];"style"===a?mn(t,s,sa):"dangerouslySetInnerHTML"===a?ta(t,s):"children"===a?na(t,s):i?null!=s?en(t,a,s):t.removeAttribute(a):null!=s?tn(t,a,s):nn(t,a)}switch(n){case"input":an(t,r),Tt(t);break;case"textarea":pn(t,r);break;case"select":t._wrapperState.initialValue=void 0,e=t._wrapperState.wasMultiple,t._wrapperState.wasMultiple=!!r.multiple,null!=(n=r.value)?cn(t,!!r.multiple,n,!1):e!==!!r.multiple&&(null!=r.defaultValue?cn(t,!!r.multiple,r.defaultValue,!0):cn(t,!!r.multiple,r.multiple?[]:"",!1))}}function Rn(t,e,n,i,r){switch(e){case"iframe":case"object":jt("topLoad","load",t);break;case"video":case"audio":for(var o in la)la.hasOwnProperty(o)&&jt(o,la[o],t);break;case"source":jt("topError","error",t);break;case"img":case"image":jt("topError","error",t),jt("topLoad","load",t);break;case"form":jt("topReset","reset",t),jt("topSubmit","submit",t);break;case"details":jt("topToggle","toggle",t);break;case"input":on(t,n),jt("topInvalid","invalid",t),En(r,"onChange");break;case"select":hn(t,n),jt("topInvalid","invalid",t),En(r,"onChange");break;case"textarea":fn(t,n),jt("topInvalid","invalid",t),En(r,"onChange")}xn(e,n,sa),i=null;for(var a in n)n.hasOwnProperty(a)&&(o=n[a],"children"===a?"string"==typeof o?t.textContent!==o&&(i=["children",o]):"number"==typeof o&&t.textContent!==""+o&&(i=["children",""+o]):$i.hasOwnProperty(a)&&null!=o&&En(r,a));switch(e){case"input":Et(t),sn(t,n);break;case"textarea":Et(t),gn(t,n);break;case"select":case"option":break;default:"function"==typeof n.onClick&&(t.onclick=oi)}return i}function Ln(t,e){return t.nodeValue!==e}function In(t){return!(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType&&(8!==t.nodeType||" react-mount-point-unstable "!==t.nodeValue))}function Pn(t){return!(!(t=t?9===t.nodeType?t.documentElement:t.firstChild:null)||1!==t.nodeType||!t.hasAttribute("data-reactroot"))}function Mn(t,e,n,i,r){In(n)||x("200");var o=n._reactRootContainer;if(o)da.updateContainer(e,o,t,r);else{if(!(i=i||Pn(n)))for(o=void 0;o=n.lastChild;)n.removeChild(o);var a=da.createContainer(n,i);o=n._reactRootContainer=a,da.unbatchedUpdates(function(){da.updateContainer(e,a,t,r)})}return da.getPublicRootInstance(o)}function On(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;return In(e)||x("200"),Be(t,e,null,n)}function Dn(t,e){this._reactRootContainer=da.createContainer(t,e)}function Fn(t,e,n,i,r){for(n=n||0,i=i||t.length-1,r=r||Nn;i>n;){if(i-n>600){var o=i-n+1,a=e-n+1,s=Math.log(o),l=.5*Math.exp(2*s/3),u=.5*Math.sqrt(s*l*(o-l)/o)*(a-o/2<0?-1:1);Fn(t,e,Math.max(n,Math.floor(e-a*l/o+u)),Math.min(i,Math.floor(e+(o-a)*l/o+u)),r)}var c=t[e],h=n,d=i;for(kn(t,n,e),r(t[i],c)>0&&kn(t,n,i);h<d;){for(kn(t,h,d),h++,d--;r(t[h],c)<0;)h++;for(;r(t[d],c)>0;)d--}0===r(t[n],c)?kn(t,n,d):kn(t,++d,i),d<=e&&(n=d+1),e<=d&&(i=d-1)}}function kn(t,e,n){var i=t[e];t[e]=t[n],t[n]=i}function Nn(t,e){return t<e?-1:t>e?1:0}function Gn(t,e){if(!(this instanceof Gn))return new Gn(t,e);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),e&&this._initFormat(e),this.clear()}function Vn(t,e,n){if(!n)return e.indexOf(t);for(var i=0;i<e.length;i++)if(n(t,e[i]))return i;return-1}function Un(t,e){Bn(t,0,t.children.length,e,t)}function Bn(t,e,n,i,r){r||(r=Qn(null)),r.minX=1/0,r.minY=1/0,r.maxX=-1/0,r.maxY=-1/0;for(var o,a=e;a<n;a++)o=t.children[a],zn(r,t.leaf?i(o):o);return r}function zn(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function Xn(t,e){return t.minX-e.minX}function Hn(t,e){return t.minY-e.minY}function Wn(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function Yn(t){return t.maxX-t.minX+(t.maxY-t.minY)}function jn(t,e){return(Math.max(e.maxX,t.maxX)-Math.min(e.minX,t.minX))*(Math.max(e.maxY,t.maxY)-Math.min(e.minY,t.minY))}function Kn(t,e){var n=Math.max(t.minX,e.minX),i=Math.max(t.minY,e.minY),r=Math.min(t.maxX,e.maxX),o=Math.min(t.maxY,e.maxY);return Math.max(0,r-n)*Math.max(0,o-i)}function qn(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function Zn(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function Qn(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function Jn(t,e,n,i,r){for(var o,a=[e,n];a.length;)(n=a.pop())-(e=a.pop())<=i||(o=e+Math.ceil((n-e)/i/2)*i,Hl(t,o,e,n,r),a.push(e,o,o,n))}var $n=Object.getOwnPropertySymbols,ti=Object.prototype.hasOwnProperty,ei=Object.prototype.propertyIsEnumerable,ni=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(e).map(function(t){return e[t]}).join(""))return!1;var i={};return"abcdefghijklmnopqrst".split("").forEach(function(t){i[t]=t}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},i)).join("")}catch(t){return!1}}()?Object.assign:function(t,n){for(var i,r,o=e(t),a=1;a<arguments.length;a++){i=Object(arguments[a]);for(var s in i)ti.call(i,s)&&(o[s]=i[s]);if($n){r=$n(i);for(var l=0;l<r.length;l++)ei.call(i,r[l])&&(o[r[l]]=i[r[l]])}}return o},ii={},ri=function(){};ri.thatReturns=n,ri.thatReturnsFalse=n(!1),ri.thatReturnsTrue=n(!0),ri.thatReturnsNull=n(null),ri.thatReturnsThis=function(){return this},ri.thatReturnsArgument=function(t){return t};var oi=ri,ai={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}};r.prototype.isReactComponent={},r.prototype.setState=function(t,e){"object"!=typeof t&&"function"!=typeof t&&null!=t&&i("85"),this.updater.enqueueSetState(this,t,e,"setState")},r.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")},a.prototype=r.prototype;var si=o.prototype=new a;si.constructor=o,ni(si,r.prototype),si.isPureReactComponent=!0;var li=s.prototype=new a;li.constructor=s,ni(li,r.prototype),li.unstable_isAsyncReactComponent=!0,li.render=function(){return this.props.children};var ui={current:null},ci=Object.prototype.hasOwnProperty,hi="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103,di={key:!0,ref:!0,__self:!0,__source:!0},fi="function"==typeof Symbol&&Symbol.iterator,pi="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103,gi="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.portal")||60106,_i=/\/+/g,vi=[];"function"==typeof Symbol&&Symbol.for&&Symbol.for("react.fragment");var yi={Children:{map:function(t,e,n){if(null==t)return t;var i=[];return v(t,i,null,e,n),i},forEach:function(t,e,n){if(null==t)return t;e=h(null,null,e,n),null==t||f(t,"",g,e),d(e)},count:function(t){return null==t?0:f(t,"",oi.thatReturnsNull,null)},toArray:function(t){var e=[];return v(t,e,null,oi.thatReturnsArgument),e},only:function(t){return u(t)||i("143"),t}},Component:r,PureComponent:o,unstable_AsyncComponent:s,createElement:l,cloneElement:function(t,e,n){var i=ni({},t.props),r=t.key,o=t.ref,a=t._owner;if(null!=e){if(void 0!==e.ref&&(o=e.ref,a=ui.current),void 0!==e.key&&(r=""+e.key),t.type&&t.type.defaultProps)var s=t.type.defaultProps;for(l in e)ci.call(e,l)&&!di.hasOwnProperty(l)&&(i[l]=void 0===e[l]&&void 0!==s?s[l]:e[l])}var l=arguments.length-2;if(1===l)i.children=n;else if(1<l){s=Array(l);for(var u=0;u<l;u++)s[u]=arguments[u+2];i.children=s}return{$$typeof:hi,type:t.type,key:r,ref:o,props:i,_owner:a}},createFactory:function(t){var e=l.bind(null,t);return e.type=t,e},isValidElement:u,version:"16.1.1",__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:{ReactCurrentOwner:ui,assign:ni}},mi=Object.freeze({default:yi}),xi=mi&&yi||mi,Si=xi.default?xi.default:xi,Ei=t(function(t){t.exports=Si}),Ti=!("undefined"==typeof window||!window.document||!window.document.createElement),wi={canUseDOM:Ti,canUseWorkers:"undefined"!=typeof Worker,canUseEventListeners:Ti&&!(!window.addEventListener&&!window.attachEvent),canUseViewport:Ti&&!!window.screen,isInWorker:!Ti},Ci={listen:function(t,e,n){return t.addEventListener?(t.addEventListener(e,n,!1),{remove:function(){t.removeEventListener(e,n,!1)}}):t.attachEvent?(t.attachEvent("on"+e,n),{remove:function(){t.detachEvent("on"+e,n)}}):void 0},capture:function(t,e,n){return t.addEventListener?(t.addEventListener(e,n,!0),{remove:function(){t.removeEventListener(e,n,!0)}}):{remove:oi}},registerDefault:function(){}},bi=function(t){if(void 0===(t=t||("undefined"!=typeof document?document:void 0)))return null;try{return t.activeElement||t.body}catch(e){return t.body}},Ai=Object.prototype.hasOwnProperty,Ri=function(t,e){if(y(t,e))return!0;if("object"!=typeof t||null===t||"object"!=typeof e||null===e)return!1;var n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!1;for(var r=0;r<n.length;r++)if(!Ai.call(e,n[r])||!y(t[n[r]],e[n[r]]))return!1;return!0},Li=function(t){var e=(t?t.ownerDocument||t:document).defaultView||window;return!(!t||!("function"==typeof e.Node?t instanceof e.Node:"object"==typeof t&&"number"==typeof t.nodeType&&"string"==typeof t.nodeName))},Ii=function(t){return Li(t)&&3==t.nodeType},Pi=m,Mi=function(t){try{t.focus()}catch(t){}};Ei||x("227");var Oi={children:!0,dangerouslySetInnerHTML:!0,defaultValue:!0,defaultChecked:!0,innerHTML:!0,suppressContentEditableWarning:!0,suppressHydrationWarning:!0,style:!0},Di={MUST_USE_PROPERTY:1,HAS_BOOLEAN_VALUE:4,HAS_NUMERIC_VALUE:8,HAS_POSITIVE_NUMERIC_VALUE:24,HAS_OVERLOADED_BOOLEAN_VALUE:32,HAS_STRING_BOOLEAN_VALUE:64,injectDOMPropertyConfig:function(t){var e=Di,n=t.Properties||{},i=t.DOMAttributeNamespaces||{},r=t.DOMAttributeNames||{};t=t.DOMMutationMethods||{};for(var o in n){Fi.hasOwnProperty(o)&&x("48",o);var a=o.toLowerCase(),s=n[o];1>=(a={attributeName:a,attributeNamespace:null,propertyName:o,mutationMethod:null,mustUseProperty:S(s,e.MUST_USE_PROPERTY),hasBooleanValue:S(s,e.HAS_BOOLEAN_VALUE),hasNumericValue:S(s,e.HAS_NUMERIC_VALUE),hasPositiveNumericValue:S(s,e.HAS_POSITIVE_NUMERIC_VALUE),hasOverloadedBooleanValue:S(s,e.HAS_OVERLOADED_BOOLEAN_VALUE),hasStringBooleanValue:S(s,e.HAS_STRING_BOOLEAN_VALUE)}).hasBooleanValue+a.hasNumericValue+a.hasOverloadedBooleanValue||x("50",o),r.hasOwnProperty(o)&&(a.attributeName=r[o]),i.hasOwnProperty(o)&&(a.attributeNamespace=i[o]),t.hasOwnProperty(o)&&(a.mutationMethod=t[o]),Fi[o]=a}}},Fi={},ki=Di,Ni=ki.MUST_USE_PROPERTY,Gi=ki.HAS_BOOLEAN_VALUE,Vi=ki.HAS_NUMERIC_VALUE,Ui=ki.HAS_POSITIVE_NUMERIC_VALUE,Bi=ki.HAS_OVERLOADED_BOOLEAN_VALUE,zi=ki.HAS_STRING_BOOLEAN_VALUE,Xi={Properties:{allowFullScreen:Gi,async:Gi,autoFocus:Gi,autoPlay:Gi,capture:Bi,checked:Ni|Gi,cols:Ui,contentEditable:zi,controls:Gi,default:Gi,defer:Gi,disabled:Gi,download:Bi,draggable:zi,formNoValidate:Gi,hidden:Gi,loop:Gi,multiple:Ni|Gi,muted:Ni|Gi,noValidate:Gi,open:Gi,playsInline:Gi,readOnly:Gi,required:Gi,reversed:Gi,rows:Ui,rowSpan:Vi,scoped:Gi,seamless:Gi,selected:Ni|Gi,size:Ui,start:Vi,span:Ui,spellCheck:zi,style:0,tabIndex:0,itemScope:Gi,acceptCharset:0,className:0,htmlFor:0,httpEquiv:0,value:zi},DOMAttributeNames:{acceptCharset:"accept-charset",className:"class",htmlFor:"for",httpEquiv:"http-equiv"},DOMMutationMethods:{value:function(t,e){if(null==e)return t.removeAttribute("value");"number"!==t.type||!1===t.hasAttribute("value")?t.setAttribute("value",""+e):t.validity&&!t.validity.badInput&&t.ownerDocument.activeElement!==t&&t.setAttribute("value",""+e)}}},Hi=ki.HAS_STRING_BOOLEAN_VALUE,Wi={xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace"},Yi={Properties:{autoReverse:Hi,externalResourcesRequired:Hi,preserveAlpha:Hi},DOMAttributeNames:{autoReverse:"autoReverse",externalResourcesRequired:"externalResourcesRequired",preserveAlpha:"preserveAlpha"},DOMAttributeNamespaces:{xlinkActuate:Wi.xlink,xlinkArcrole:Wi.xlink,xlinkHref:Wi.xlink,xlinkRole:Wi.xlink,xlinkShow:Wi.xlink,xlinkTitle:Wi.xlink,xlinkType:Wi.xlink,xmlBase:Wi.xml,xmlLang:Wi.xml,xmlSpace:Wi.xml}},ji=/[\-\:]([a-z])/g;"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode x-height xlink:actuate xlink:arcrole xlink:href xlink:role xlink:show xlink:title xlink:type xml:base xmlns:xlink xml:lang xml:space".split(" ").forEach(function(t){var e=t.replace(ji,w);Yi.Properties[e]=0,Yi.DOMAttributeNames[e]=t}),ki.injectDOMPropertyConfig(Xi),ki.injectDOMPropertyConfig(Yi);var Ki={_caughtError:null,_hasCaughtError:!1,_rethrowError:null,_hasRethrowError:!1,injection:{injectErrorUtils:function(t){"function"!=typeof t.invokeGuardedCallback&&x("197"),C=t.invokeGuardedCallback}},invokeGuardedCallback:function(t,e,n,i,r,o,a,s,l){C.apply(Ki,arguments)},invokeGuardedCallbackAndCatchFirstError:function(t,e,n,i,r,o,a,s,l){if(Ki.invokeGuardedCallback.apply(this,arguments),Ki.hasCaughtError()){var u=Ki.clearCaughtError();Ki._hasRethrowError||(Ki._hasRethrowError=!0,Ki._rethrowError=u)}},rethrowCaughtError:function(){return b.apply(Ki,arguments)},hasCaughtError:function(){return Ki._hasCaughtError},clearCaughtError:function(){if(Ki._hasCaughtError){var t=Ki._caughtError;return Ki._caughtError=null,Ki._hasCaughtError=!1,t}x("198")}},qi=null,Zi={},Qi=[],Ji={},$i={},tr={},er=Object.freeze({plugins:Qi,eventNameDispatchConfigs:Ji,registrationNameModules:$i,registrationNameDependencies:tr,possibleRegistrationNames:null,injectEventPluginOrder:L,injectEventPluginsByName:I}),nr=null,ir=null,rr=null,or=null,ar={injectEventPluginOrder:L,injectEventPluginsByName:I},sr=Object.freeze({injection:ar,getListener:N,extractEvents:G,enqueueEvents:V,processEventQueue:U}),lr=Math.random().toString(36).slice(2),ur="__reactInternalInstance$"+lr,cr="__reactEventHandlers$"+lr,hr=Object.freeze({precacheFiberNode:function(t,e){e[ur]=t},getClosestInstanceFromNode:B,getInstanceFromNode:function(t){return!(t=t[ur])||5!==t.tag&&6!==t.tag?null:t},getNodeFromInstance:z,getFiberCurrentPropsFromNode:X,updateFiberProps:function(t,e){t[cr]=e}}),dr=Object.freeze({accumulateTwoPhaseDispatches:Q,accumulateTwoPhaseDispatchesSkipTarget:function(t){O(t,K)},accumulateEnterLeaveDispatches:J,accumulateDirectDispatches:function(t){O(t,Z)}}),fr=null,pr={_root:null,_startText:null,_fallbackText:null},gr="dispatchConfig _targetInst nativeEvent isDefaultPrevented isPropagationStopped _dispatchListeners _dispatchInstances".split(" "),_r={type:null,target:null,currentTarget:oi.thatReturnsNull,eventPhase:null,bubbles:null,cancelable:null,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:null,isTrusted:null};ni(nt.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():"unknown"!=typeof t.returnValue&&(t.returnValue=!1),this.isDefaultPrevented=oi.thatReturnsTrue)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():"unknown"!=typeof t.cancelBubble&&(t.cancelBubble=!0),this.isPropagationStopped=oi.thatReturnsTrue)},persist:function(){this.isPersistent=oi.thatReturnsTrue},isPersistent:oi.thatReturnsFalse,destructor:function(){var t,e=this.constructor.Interface;for(t in e)this[t]=null;for(e=0;e<gr.length;e++)this[gr[e]]=null}}),nt.Interface=_r,nt.augmentClass=function(t,e){function n(){}n.prototype=this.prototype;var i=new n;ni(i,t.prototype),t.prototype=i,t.prototype.constructor=t,t.Interface=ni({},this.Interface,e),t.augmentClass=this.augmentClass,ot(t)},ot(nt),nt.augmentClass(at,{data:null}),nt.augmentClass(st,{data:null});var vr=[9,13,27,32],yr=wi.canUseDOM&&"CompositionEvent"in window,mr=null;wi.canUseDOM&&"documentMode"in document&&(mr=document.documentMode);var xr;if(xr=wi.canUseDOM&&"TextEvent"in window&&!mr){var Sr=window.opera;xr=!("object"==typeof Sr&&"function"==typeof Sr.version&&12>=parseInt(Sr.version(),10))}var Er,Tr=xr,wr=wi.canUseDOM&&(!yr||mr&&8<mr&&11>=mr),Cr=String.fromCharCode(32),br={beforeInput:{phasedRegistrationNames:{bubbled:"onBeforeInput",captured:"onBeforeInputCapture"},dependencies:["topCompositionEnd","topKeyPress","topTextInput","topPaste"]},compositionEnd:{phasedRegistrationNames:{bubbled:"onCompositionEnd",captured:"onCompositionEndCapture"},dependencies:"topBlur topCompositionEnd topKeyDown topKeyPress topKeyUp topMouseDown".split(" ")},compositionStart:{phasedRegistrationNames:{bubbled:"onCompositionStart",captured:"onCompositionStartCapture"},dependencies:"topBlur topCompositionStart topKeyDown topKeyPress topKeyUp topMouseDown".split(" ")},compositionUpdate:{phasedRegistrationNames:{bubbled:"onCompositionUpdate",captured:"onCompositionUpdateCapture"},dependencies:"topBlur topCompositionUpdate topKeyDown topKeyPress topKeyUp topMouseDown".split(" ")}},Ar=!1,Rr=!1,Lr={eventTypes:br,extractEvents:function(t,e,n,i){var r;if(yr)t:{switch(t){case"topCompositionStart":var o=br.compositionStart;break t;case"topCompositionEnd":o=br.compositionEnd;break t;case"topCompositionUpdate":o=br.compositionUpdate;break t}o=void 0}else Rr?lt(t,n)&&(o=br.compositionEnd):"topKeyDown"===t&&229===n.keyCode&&(o=br.compositionStart);return o?(wr&&(Rr||o!==br.compositionStart?o===br.compositionEnd&&Rr&&(r=tt()):(pr._root=i,pr._startText=et(),Rr=!0)),o=at.getPooled(o,e,n,i),r?o.data=r:null!==(r=ut(n))&&(o.data=r),Q(o),r=o):r=null,(t=Tr?ct(t,n):ht(t,n))?(e=st.getPooled(br.beforeInput,e,n,i),e.data=t,Q(e)):e=null,[r,e]}},Ir=null,Pr=null,Mr=null,Or={injectFiberControlledHostComponent:function(t){Ir=t}},Dr=Object.freeze({injection:Or,enqueueStateRestore:ft,restoreStateIfNeeded:pt}),Fr=!1,kr={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};wi.canUseDOM&&(Er=document.implementation&&document.implementation.hasFeature&&!0!==document.implementation.hasFeature("",""));var Nr={change:{phasedRegistrationNames:{bubbled:"onChange",captured:"onChangeCapture"},dependencies:"topBlur topChange topClick topFocus topInput topKeyDown topKeyUp topSelectionChange".split(" ")}},Gr=null,Vr=null,Ur=!1;wi.canUseDOM&&(Ur=mt("input")&&(!document.documentMode||9<document.documentMode));var Br={eventTypes:Nr,_isInputEventSupported:Ur,extractEvents:function(t,e,n,i){var r=e?z(e):window,o=r.nodeName&&r.nodeName.toLowerCase();if("select"===o||"input"===o&&"file"===r.type)var a=At;else if(vt(r))if(Ur)a=Ot;else{a=Pt;var s=It}else!(o=r.nodeName)||"input"!==o.toLowerCase()||"checkbox"!==r.type&&"radio"!==r.type||(a=Mt);if(a&&(a=a(t,e)))return wt(a,n,i);s&&s(t,r,e),"topBlur"===t&&null!=e&&(t=e._wrapperState||r._wrapperState)&&t.controlled&&"number"===r.type&&(t=""+r.value,r.getAttribute("value")!==t&&r.setAttribute("value",t))}};nt.augmentClass(Dt,{view:null,detail:null});var zr={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};Dt.augmentClass(Nt,{screenX:null,screenY:null,clientX:null,clientY:null,pageX:null,pageY:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,getModifierState:kt,button:null,buttons:null,relatedTarget:function(t){return t.relatedTarget||(t.fromElement===t.srcElement?t.toElement:t.fromElement)}});var Xr={mouseEnter:{registrationName:"onMouseEnter",dependencies:["topMouseOut","topMouseOver"]},mouseLeave:{registrationName:"onMouseLeave",dependencies:["topMouseOut","topMouseOver"]}},Hr={eventTypes:Xr,extractEvents:function(t,e,n,i){if("topMouseOver"===t&&(n.relatedTarget||n.fromElement)||"topMouseOut"!==t&&"topMouseOver"!==t)return null;var r=i.window===i?i:(r=i.ownerDocument)?r.defaultView||r.parentWindow:window;if("topMouseOut"===t?(t=e,e=(e=n.relatedTarget||n.toElement)?B(e):null):t=null,t===e)return null;var o=null==t?r:z(t);r=null==e?r:z(e);var a=Nt.getPooled(Xr.mouseLeave,t,n,i);return a.type="mouseleave",a.target=o,a.relatedTarget=r,n=Nt.getPooled(Xr.mouseEnter,e,n,i),n.type="mouseenter",n.target=r,n.relatedTarget=o,J(a,n,t,e),[a,n]}},Wr=Ei.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Yr=[],jr=!0,Kr=void 0,qr=Object.freeze({get _enabled(){return jr},get _handleTopLevel(){return Kr},setHandleTopLevel:function(t){Kr=t},setEnabled:Yt,isEnabled:function(){return jr},trapBubbledEvent:jt,trapCapturedEvent:Kt,dispatchEvent:qt}),Zr={animationend:Zt("Animation","AnimationEnd"),animationiteration:Zt("Animation","AnimationIteration"),animationstart:Zt("Animation","AnimationStart"),transitionend:Zt("Transition","TransitionEnd")},Qr={},Jr={};wi.canUseDOM&&(Jr=document.createElement("div").style,"AnimationEvent"in window||(delete Zr.animationend.animation,delete Zr.animationiteration.animation,delete Zr.animationstart.animation),"TransitionEvent"in window||delete Zr.transitionend.transition);var $r={topAbort:"abort",topAnimationEnd:Qt("animationend")||"animationend",topAnimationIteration:Qt("animationiteration")||"animationiteration",topAnimationStart:Qt("animationstart")||"animationstart",topBlur:"blur",topCancel:"cancel",topCanPlay:"canplay",topCanPlayThrough:"canplaythrough",topChange:"change",topClick:"click",topClose:"close",topCompositionEnd:"compositionend",topCompositionStart:"compositionstart",topCompositionUpdate:"compositionupdate",topContextMenu:"contextmenu",topCopy:"copy",topCut:"cut",topDoubleClick:"dblclick",topDrag:"drag",topDragEnd:"dragend",topDragEnter:"dragenter",topDragExit:"dragexit",topDragLeave:"dragleave",topDragOver:"dragover",topDragStart:"dragstart",topDrop:"drop",topDurationChange:"durationchange",topEmptied:"emptied",topEncrypted:"encrypted",topEnded:"ended",topError:"error",topFocus:"focus",topInput:"input",topKeyDown:"keydown",topKeyPress:"keypress",topKeyUp:"keyup",topLoadedData:"loadeddata",topLoad:"load",topLoadedMetadata:"loadedmetadata",topLoadStart:"loadstart",topMouseDown:"mousedown",topMouseMove:"mousemove",topMouseOut:"mouseout",topMouseOver:"mouseover",topMouseUp:"mouseup",topPaste:"paste",topPause:"pause",topPlay:"play",topPlaying:"playing",topProgress:"progress",topRateChange:"ratechange",topScroll:"scroll",topSeeked:"seeked",topSeeking:"seeking",topSelectionChange:"selectionchange",topStalled:"stalled",topSuspend:"suspend",topTextInput:"textInput",topTimeUpdate:"timeupdate",topToggle:"toggle",topTouchCancel:"touchcancel",topTouchEnd:"touchend",topTouchMove:"touchmove",topTouchStart:"touchstart",topTransitionEnd:Qt("transitionend")||"transitionend",topVolumeChange:"volumechange",topWaiting:"waiting",topWheel:"wheel"},to={},eo=0,no="_reactListenersID"+(""+Math.random()).slice(2),io=wi.canUseDOM&&"documentMode"in document&&11>=document.documentMode,ro={select:{phasedRegistrationNames:{bubbled:"onSelect",captured:"onSelectCapture"},dependencies:"topBlur topContextMenu topFocus topKeyDown topKeyUp topMouseDown topMouseUp topSelectionChange".split(" ")}},oo=null,ao=null,so=null,lo=!1,uo={eventTypes:ro,extractEvents:function(t,e,n,i){var r,o=i.window===i?i.document:9===i.nodeType?i:i.ownerDocument;if(!(r=!o)){t:{o=Jt(o),r=tr.onSelect;for(var a=0;a<r.length;a++){var s=r[a];if(!o.hasOwnProperty(s)||!o[s]){o=!1;break t}}o=!0}r=!o}if(r)return null;switch(o=e?z(e):window,t){case"topFocus":(vt(o)||"true"===o.contentEditable)&&(oo=o,ao=e,so=null);break;case"topBlur":so=ao=oo=null;break;case"topMouseDown":lo=!0;break;case"topContextMenu":case"topMouseUp":return lo=!1,ne(n,i);case"topSelectionChange":if(io)break;case"topKeyDown":case"topKeyUp":return ne(n,i)}return null}};nt.augmentClass(ie,{animationName:null,elapsedTime:null,pseudoElement:null}),nt.augmentClass(re,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Dt.augmentClass(oe,{relatedTarget:null});var co={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ho={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"};Dt.augmentClass(se,{key:function(t){if(t.key){var e=co[t.key]||t.key;if("Unidentified"!==e)return e}return"keypress"===t.type?13===(t=ae(t))?"Enter":String.fromCharCode(t):"keydown"===t.type||"keyup"===t.type?ho[t.keyCode]||"Unidentified":""},location:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,repeat:null,locale:null,getModifierState:kt,charCode:function(t){return"keypress"===t.type?ae(t):0},keyCode:function(t){return"keydown"===t.type||"keyup"===t.type?t.keyCode:0},which:function(t){return"keypress"===t.type?ae(t):"keydown"===t.type||"keyup"===t.type?t.keyCode:0}}),Nt.augmentClass(le,{dataTransfer:null}),Dt.augmentClass(ue,{touches:null,targetTouches:null,changedTouches:null,altKey:null,metaKey:null,ctrlKey:null,shiftKey:null,getModifierState:kt}),nt.augmentClass(ce,{propertyName:null,elapsedTime:null,pseudoElement:null}),Nt.augmentClass(he,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:null,deltaMode:null});var fo={},po={};"abort animationEnd animationIteration animationStart blur cancel canPlay canPlayThrough click close contextMenu copy cut doubleClick drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error focus input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing progress rateChange reset scroll seeked seeking stalled submit suspend timeUpdate toggle touchCancel touchEnd touchMove touchStart transitionEnd volumeChange waiting wheel".split(" ").forEach(function(t){var e=t[0].toUpperCase()+t.slice(1),n="on"+e;n={phasedRegistrationNames:{bubbled:n,captured:n+"Capture"},dependencies:[e="top"+e]},fo[t]=n,po[e]=n});var go={eventTypes:fo,extractEvents:function(t,e,n,i){var r=po[t];if(!r)return null;switch(t){case"topKeyPress":if(0===ae(n))return null;case"topKeyDown":case"topKeyUp":t=se;break;case"topBlur":case"topFocus":t=oe;break;case"topClick":if(2===n.button)return null;case"topDoubleClick":case"topMouseDown":case"topMouseMove":case"topMouseUp":case"topMouseOut":case"topMouseOver":case"topContextMenu":t=Nt;break;case"topDrag":case"topDragEnd":case"topDragEnter":case"topDragExit":case"topDragLeave":case"topDragOver":case"topDragStart":case"topDrop":t=le;break;case"topTouchCancel":case"topTouchEnd":case"topTouchMove":case"topTouchStart":t=ue;break;case"topAnimationEnd":case"topAnimationIteration":case"topAnimationStart":t=ie;break;case"topTransitionEnd":t=ce;break;case"topScroll":t=Dt;break;case"topWheel":t=he;break;case"topCopy":case"topCut":case"topPaste":t=re;break;default:t=nt}return e=t.getPooled(r,e,n,i),Q(e),e}};Kr=function(t,e,n,i){V(t=G(t,e,n,i)),U(!1)},ar.injectEventPluginOrder("ResponderEventPlugin SimpleEventPlugin TapEventPlugin EnterLeaveEventPlugin ChangeEventPlugin SelectEventPlugin BeforeInputEventPlugin".split(" ")),nr=hr.getFiberCurrentPropsFromNode,ir=hr.getInstanceFromNode,rr=hr.getNodeFromInstance,ar.injectEventPluginsByName({SimpleEventPlugin:go,EnterLeaveEventPlugin:Hr,ChangeEventPlugin:Br,SelectEventPlugin:uo,BeforeInputEventPlugin:Lr});var _o=[],vo=-1;new Set;var yo,mo,xo,So,Eo={current:ii},To={current:!1},wo=ii,Co=null,bo=null,Ao="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.portal")||60106,Ro=Array.isArray,Lo="function"==typeof Symbol&&Symbol.iterator;"function"==typeof Symbol&&Symbol.for?(yo=Symbol.for("react.element"),mo=Symbol.for("react.call"),xo=Symbol.for("react.return"),So=Symbol.for("react.fragment")):(yo=60103,mo=60104,xo=60105,So=60107);var Io=We(!0,!0),Po=We(!1,!0),Mo=We(!1,!1),Oo={},Do=Object.freeze({default:Je}),Fo=Do&&Je||Do,ko=Fo.default?Fo.default:Fo,No="object"==typeof performance&&"function"==typeof performance.now,Go=void 0;Go=No?function(){return performance.now()}:function(){return Date.now()};var Vo=void 0;if(wi.canUseDOM)if("function"!=typeof requestIdleCallback){var Uo,Bo=null,zo=!1,Xo=!1,Ho=0,Wo=33,Yo=33;Uo=No?{timeRemaining:function(){return Ho-performance.now()}}:{timeRemaining:function(){return Ho-Date.now()}};var jo="__reactIdleCallback$"+Math.random().toString(36).slice(2);window.addEventListener("message",function(t){t.source===window&&t.data===jo&&(zo=!1,t=Bo,Bo=null,null!==t&&t(Uo))},!1);var Ko=function(t){Xo=!1;var e=t-Ho+Yo;e<Yo&&Wo<Yo?(8>e&&(e=8),Yo=e<Wo?Wo:e):Wo=e,Ho=t+Yo,zo||(zo=!0,window.postMessage(jo,"*"))};Vo=function(t){return Bo=t,Xo||(Xo=!0,requestAnimationFrame(Ko)),0}}else Vo=requestIdleCallback;else Vo=function(t){return setTimeout(function(){t({timeRemaining:function(){return 1/0}})}),0};var qo=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Zo={},Qo={},Jo={html:"http://www.w3.org/1999/xhtml",mathml:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg"},$o=void 0,ta=function(t){return"undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,n,i,r){MSApp.execUnsafeLocalFunction(function(){return t(e,n)})}:t}(function(t,e){if(t.namespaceURI!==Jo.svg||"innerHTML"in t)t.innerHTML=e;else{for(($o=$o||document.createElement("div")).innerHTML="<svg>"+e+"</svg>",e=$o.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}}),ea=/["'&<>]/;wi.canUseDOM&&("textContent"in document.documentElement||(yn=function(t,e){if(3===t.nodeType)t.nodeValue=e;else{if("boolean"==typeof e||"number"==typeof e)e=""+e;else{e=""+e;var n=ea.exec(e);if(n){var i,r="",o=0;for(i=n.index;i<e.length;i++){switch(e.charCodeAt(i)){case 34:n="&quot;";break;case 38:n="&amp;";break;case 39:n="&#x27;";break;case 60:n="&lt;";break;case 62:n="&gt;";break;default:continue}o!==i&&(r+=e.substring(o,i)),o=i+1,r+=n}e=o!==i?r+e.substring(o,i):r}}ta(t,e)}}));var na=yn,ia={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ra=["Webkit","ms","Moz","O"];Object.keys(ia).forEach(function(t){ra.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),ia[e]=ia[t]})});var oa=ni({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0}),aa=Jo.html,sa=oi.thatReturns(""),la={topAbort:"abort",topCanPlay:"canplay",topCanPlayThrough:"canplaythrough",topDurationChange:"durationchange",topEmptied:"emptied",topEncrypted:"encrypted",topEnded:"ended",topError:"error",topLoadedData:"loadeddata",topLoadedMetadata:"loadedmetadata",topLoadStart:"loadstart",topPause:"pause",topPlay:"play",topPlaying:"playing",topProgress:"progress",topRateChange:"ratechange",topSeeked:"seeked",topSeeking:"seeking",topStalled:"stalled",topSuspend:"suspend",topTimeUpdate:"timeupdate",topVolumeChange:"volumechange",topWaiting:"waiting"},ua=Object.freeze({createElement:Tn,createTextNode:wn,setInitialProperties:Cn,diffProperties:bn,updateProperties:An,diffHydratedProperties:Rn,diffHydratedText:Ln,warnForUnmatchedText:function(){},warnForDeletedHydratableElement:function(){},warnForDeletedHydratableText:function(){},warnForInsertedHydratedElement:function(){},warnForInsertedHydratedText:function(){},restoreControlledState:function(t,e,n){switch(e){case"input":if(an(t,n),e=n.name,"radio"===n.type&&null!=e){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var i=n[e];if(i!==t&&i.form===t.form){var r=X(i);r||x("90"),an(i,r)}}}break;case"textarea":pn(t,n);break;case"select":null!=(e=n.value)&&cn(t,!!n.multiple,e,!1)}}});Or.injectFiberControlledHostComponent(ua);var ca=null,ha=null,da=ko({getRootHostContext:function(t){var e=t.nodeType;switch(e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:vn(null,"");break;default:t=vn(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}return t},getChildHostContext:function(t,e){return vn(t,e)},getPublicInstance:function(t){return t},prepareForCommit:function(){ca=jr;var t=bi();if(ee(t)){if("selectionStart"in t)var e={start:t.selectionStart,end:t.selectionEnd};else t:{var n=window.getSelection&&window.getSelection();if(n&&0!==n.rangeCount){e=n.anchorNode;var i=n.anchorOffset,r=n.focusNode;n=n.focusOffset;try{e.nodeType,r.nodeType}catch(t){e=null;break t}var o=0,a=-1,s=-1,l=0,u=0,c=t,h=null;e:for(;;){for(var d;c!==e||0!==i&&3!==c.nodeType||(a=o+i),c!==r||0!==n&&3!==c.nodeType||(s=o+n),3===c.nodeType&&(o+=c.nodeValue.length),null!==(d=c.firstChild);)h=c,c=d;for(;;){if(c===t)break e;if(h===e&&++l===i&&(a=o),h===r&&++u===n&&(s=o),null!==(d=c.nextSibling))break;h=(c=h).parentNode}c=d}e=-1===a||-1===s?null:{start:a,end:s}}else e=null}e=e||{start:0,end:0}}else e=null;ha={focusedElem:t,selectionRange:e},Yt(!1)},resetAfterCommit:function(){var t=ha,e=bi(),n=t.focusedElem,i=t.selectionRange;if(e!==n&&Pi(document.documentElement,n)){if(ee(n))if(e=i.start,void 0===(t=i.end)&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(window.getSelection){e=window.getSelection();var r=n[$()].length;t=Math.min(i.start,r),i=void 0===i.end?t:Math.min(i.end,r),!e.extend&&t>i&&(r=i,i=t,t=r),r=te(n,t);var o=te(n,i);if(r&&o&&(1!==e.rangeCount||e.anchorNode!==r.node||e.anchorOffset!==r.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)){var a=document.createRange();a.setStart(r.node,r.offset),e.removeAllRanges(),t>i?(e.addRange(a),e.extend(o.node,o.offset)):(a.setEnd(o.node,o.offset),e.addRange(a))}}for(e=[],t=n;t=t.parentNode;)1===t.nodeType&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(Mi(n),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}ha=null,Yt(ca),ca=null},createInstance:function(t,e,n,i,r){return t=Tn(t,e,n,i),t[ur]=r,t[cr]=e,t},appendInitialChild:function(t,e){t.appendChild(e)},finalizeInitialChildren:function(t,e,n,i){Cn(t,e,n,i);t:{switch(e){case"button":case"input":case"select":case"textarea":t=!!n.autoFocus;break t}t=!1}return t},prepareUpdate:function(t,e,n,i,r){return bn(t,e,n,i,r)},shouldSetTextContent:function(t,e){return"textarea"===t||"string"==typeof e.children||"number"==typeof e.children||"object"==typeof e.dangerouslySetInnerHTML&&null!==e.dangerouslySetInnerHTML&&"string"==typeof e.dangerouslySetInnerHTML.__html},shouldDeprioritizeSubtree:function(t,e){return!!e.hidden},createTextInstance:function(t,e,n,i){return t=wn(t,e),t[ur]=i,t},now:Go,mutation:{commitMount:function(t){t.focus()},commitUpdate:function(t,e,n,i,r){t[cr]=r,An(t,e,n,i,r)},resetTextContent:function(t){t.textContent=""},commitTextUpdate:function(t,e,n){t.nodeValue=n},appendChild:function(t,e){t.appendChild(e)},appendChildToContainer:function(t,e){8===t.nodeType?t.parentNode.insertBefore(e,t):t.appendChild(e)},insertBefore:function(t,e,n){t.insertBefore(e,n)},insertInContainerBefore:function(t,e,n){8===t.nodeType?t.parentNode.insertBefore(e,n):t.insertBefore(e,n)},removeChild:function(t,e){t.removeChild(e)},removeChildFromContainer:function(t,e){8===t.nodeType?t.parentNode.removeChild(e):t.removeChild(e)}},hydration:{canHydrateInstance:function(t,e){return 1!==t.nodeType||e.toLowerCase()!==t.nodeName.toLowerCase()?null:t},canHydrateTextInstance:function(t,e){return""===e||3!==t.nodeType?null:t},getNextHydratableSibling:function(t){for(t=t.nextSibling;t&&1!==t.nodeType&&3!==t.nodeType;)t=t.nextSibling;return t},getFirstHydratableChild:function(t){for(t=t.firstChild;t&&1!==t.nodeType&&3!==t.nodeType;)t=t.nextSibling;return t},hydrateInstance:function(t,e,n,i,r,o){return t[ur]=o,t[cr]=n,Rn(t,e,n,r,i)},hydrateTextInstance:function(t,e,n){return t[ur]=n,Ln(t,e)},didNotMatchHydratedContainerTextInstance:function(){},didNotMatchHydratedTextInstance:function(){},didNotHydrateContainerInstance:function(){},didNotHydrateInstance:function(){},didNotFindHydratableContainerInstance:function(){},didNotFindHydratableContainerTextInstance:function(){},didNotFindHydratableInstance:function(){},didNotFindHydratableTextInstance:function(){}},scheduleDeferredCallback:Vo,useSyncScheduling:!0});gt=da.batchedUpdates,Dn.prototype.render=function(t,e){da.updateContainer(t,this._reactRootContainer,null,e)},Dn.prototype.unmount=function(t){da.updateContainer(null,this._reactRootContainer,null,t)};var fa={createPortal:On,findDOMNode:function(t){if(null==t)return null;if(1===t.nodeType)return t;var e=t._reactInternalFiber;if(e)return da.findHostInstance(e);"function"==typeof t.render?x("188"):x("213",Object.keys(t))},hydrate:function(t,e,n){return Mn(null,t,e,!0,n)},render:function(t,e,n){return Mn(null,t,e,!1,n)},unstable_renderSubtreeIntoContainer:function(t,e,n,i){return(null==t||void 0===t._reactInternalFiber)&&x("38"),Mn(t,e,n,!1,i)},unmountComponentAtNode:function(t){return In(t)||x("40"),!!t._reactRootContainer&&(da.unbatchedUpdates(function(){Mn(null,null,t,!1,function(){t._reactRootContainer=null})}),!0)},unstable_createPortal:On,unstable_batchedUpdates:_t,unstable_deferredUpdates:da.deferredUpdates,flushSync:da.flushSync,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:{EventPluginHub:sr,EventPluginRegistry:er,EventPropagators:dr,ReactControlledComponent:Dr,ReactDOMComponentTree:hr,ReactDOMEventListener:qr}};da.injectIntoDevTools({findFiberByHostInstance:B,bundleType:0,version:"16.1.1",rendererPackageName:"react-dom"});var pa=Object.freeze({default:fa}),ga=pa&&fa||pa,_a=ga.default?ga.default:ga,va=t(function(t){function e(){if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}e(),t.exports=_a}),ya={};ya.ASSUME_TOUCH=!1,ya.DEFAULT_MAX_ZOOM=42,ya.DEFAULT_MIN_ZOOM=0,ya.DEFAULT_RASTER_REPROJECTION_ERROR_THRESHOLD=.5,ya.DEFAULT_TILE_SIZE=256,ya.DEFAULT_WMS_VERSION="1.3.0",ya.ENABLE_CANVAS=!0,ya.ENABLE_PROJ4JS=!0,ya.ENABLE_RASTER_REPROJECTION=!0,ya.ENABLE_WEBGL=!0,ya.DEBUG_WEBGL=!0,ya.INITIAL_ATLAS_SIZE=256,ya.MAX_ATLAS_SIZE=-1,ya.MOUSEWHEELZOOM_MAXDELTA=1,ya.OVERVIEWMAP_MAX_RATIO=.75,ya.OVERVIEWMAP_MIN_RATIO=.1,ya.RASTER_REPROJECTION_MAX_SOURCE_TILES=100,ya.RASTER_REPROJECTION_MAX_SUBDIVISION=10,ya.RASTER_REPROJECTION_MAX_TRIANGLE_WIDTH=.25,ya.SIMPLIFY_TOLERANCE=.5,ya.WEBGL_TEXTURE_CACHE_HIGH_WATER_MARK=1024,ya.VERSION="v4.5.0",ya.WEBGL_MAX_TEXTURE_SIZE,ya.WEBGL_EXTENSIONS,ya.inherits=function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t},ya.nullFunction=function(){},ya.getUid=function(t){return t.ol_uid||(t.ol_uid=++ya.uidCounter_)},ya.uidCounter_=0;var ma=function(t){var e=ya.VERSION?ya.VERSION.split("-")[0]:"latest";this.message="Assertion failed. See https://openlayers.org/en/"+e+"/doc/errors/#"+t+" for details.",this.code=t,this.name="AssertionError"};ya.inherits(ma,Error);var xa={ADD:"add",REMOVE:"remove"},Sa={PROPERTYCHANGE:"propertychange"},Ea={};Ea.assign="function"==typeof Object.assign?Object.assign:function(t,e){if(void 0===t||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(t),i=1,r=arguments.length;i<r;++i){var o=arguments[i];if(void 0!==o&&null!==o)for(var a in o)o.hasOwnProperty(a)&&(n[a]=o[a])}return n},Ea.clear=function(t){for(var e in t)delete t[e]},Ea.getValues=function(t){var e=[];for(var n in t)e.push(t[n]);return e},Ea.isEmpty=function(t){var e;for(e in t)return!1;return!e};var Ta={};Ta.bindListener_=function(t){var e=function(e){var n=t.listener,i=t.bindTo||t.target;return t.callOnce&&Ta.unlistenByKey(t),n.call(i,e)};return t.boundListener=e,e},Ta.findListener_=function(t,e,n,i){for(var r,o=0,a=t.length;o<a;++o)if((r=t[o]).listener===e&&r.bindTo===n)return i&&(r.deleteIndex=o),r},Ta.getListeners=function(t,e){var n=t.ol_lm;return n?n[e]:void 0},Ta.getListenerMap_=function(t){var e=t.ol_lm;return e||(e=t.ol_lm={}),e},Ta.removeListeners_=function(t,e){var n=Ta.getListeners(t,e);if(n){for(var i=0,r=n.length;i<r;++i)t.removeEventListener(e,n[i].boundListener),Ea.clear(n[i]);n.length=0;var o=t.ol_lm;o&&(delete o[e],0===Object.keys(o).length&&delete t.ol_lm)}},Ta.listen=function(t,e,n,i,r){var o=Ta.getListenerMap_(t),a=o[e];a||(a=o[e]=[]);var s=Ta.findListener_(a,n,i,!1);return s?r||(s.callOnce=!1):(s={bindTo:i,callOnce:!!r,listener:n,target:t,type:e},t.addEventListener(e,Ta.bindListener_(s)),a.push(s)),s},Ta.listenOnce=function(t,e,n,i){return Ta.listen(t,e,n,i,!0)},Ta.unlisten=function(t,e,n,i){var r=Ta.getListeners(t,e);if(r){var o=Ta.findListener_(r,n,i,!0);o&&Ta.unlistenByKey(o)}},Ta.unlistenByKey=function(t){if(t&&t.target){t.target.removeEventListener(t.type,t.boundListener);var e=Ta.getListeners(t.target,t.type);if(e){var n="deleteIndex"in t?t.deleteIndex:e.indexOf(t);-1!==n&&e.splice(n,1),0===e.length&&Ta.removeListeners_(t.target,t.type)}Ea.clear(t)}},Ta.unlistenAll=function(t){var e=Ta.getListenerMap_(t);for(var n in e)Ta.removeListeners_(t,n)};var wa=function(){};wa.prototype.disposed_=!1,wa.prototype.dispose=function(){this.disposed_||(this.disposed_=!0,this.disposeInternal())},wa.prototype.disposeInternal=ya.nullFunction;var Ca=function(t){this.propagationStopped,this.type=t,this.target=null};Ca.prototype.preventDefault=Ca.prototype.stopPropagation=function(){this.propagationStopped=!0},Ca.stopPropagation=function(t){t.stopPropagation()},Ca.preventDefault=function(t){t.preventDefault()};var ba=function(){wa.call(this),this.pendingRemovals_={},this.dispatching_={},this.listeners_={}};ya.inherits(ba,wa),ba.prototype.addEventListener=function(t,e){var n=this.listeners_[t];n||(n=this.listeners_[t]=[]),-1===n.indexOf(e)&&n.push(e)},ba.prototype.dispatchEvent=function(t){var e="string"==typeof t?new Ca(t):t,n=e.type;e.target=this;var i,r=this.listeners_[n];if(r){n in this.dispatching_||(this.dispatching_[n]=0,this.pendingRemovals_[n]=0),++this.dispatching_[n];for(var o=0,a=r.length;o<a;++o)if(!1===r[o].call(this,e)||e.propagationStopped){i=!1;break}if(--this.dispatching_[n],0===this.dispatching_[n]){var s=this.pendingRemovals_[n];for(delete this.pendingRemovals_[n];s--;)this.removeEventListener(n,ya.nullFunction);delete this.dispatching_[n]}return i}},ba.prototype.disposeInternal=function(){Ta.unlistenAll(this)},ba.prototype.getListeners=function(t){return this.listeners_[t]},ba.prototype.hasListener=function(t){return t?t in this.listeners_:Object.keys(this.listeners_).length>0},ba.prototype.removeEventListener=function(t,e){var n=this.listeners_[t];if(n){var i=n.indexOf(e);t in this.pendingRemovals_?(n[i]=ya.nullFunction,++this.pendingRemovals_[t]):(n.splice(i,1),0===n.length&&delete this.listeners_[t])}};var Aa={CHANGE:"change",CLEAR:"clear",CLICK:"click",DBLCLICK:"dblclick",DRAGENTER:"dragenter",DRAGOVER:"dragover",DROP:"drop",ERROR:"error",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",MOUSEDOWN:"mousedown",MOUSEMOVE:"mousemove",MOUSEOUT:"mouseout",MOUSEUP:"mouseup",MOUSEWHEEL:"mousewheel",MSPOINTERDOWN:"MSPointerDown",RESIZE:"resize",TOUCHSTART:"touchstart",TOUCHMOVE:"touchmove",TOUCHEND:"touchend",WHEEL:"wheel"},Ra=function(){ba.call(this),this.revision_=0};ya.inherits(Ra,ba),Ra.unByKey=function(t){if(Array.isArray(t))for(var e=0,n=t.length;e<n;++e)Ta.unlistenByKey(t[e]);else Ta.unlistenByKey(t)},Ra.prototype.changed=function(){++this.revision_,this.dispatchEvent(Aa.CHANGE)},Ra.prototype.dispatchEvent,Ra.prototype.getRevision=function(){return this.revision_},Ra.prototype.on=function(t,e,n){if(Array.isArray(t)){for(var i=t.length,r=new Array(i),o=0;o<i;++o)r[o]=Ta.listen(this,t[o],e,n);return r}return Ta.listen(this,t,e,n)},Ra.prototype.once=function(t,e,n){if(Array.isArray(t)){for(var i=t.length,r=new Array(i),o=0;o<i;++o)r[o]=Ta.listenOnce(this,t[o],e,n);return r}return Ta.listenOnce(this,t,e,n)},Ra.prototype.un=function(t,e,n){if(Array.isArray(t))for(var i=0,r=t.length;i<r;++i)Ta.unlisten(this,t[i],e,n);else Ta.unlisten(this,t,e,n)};var La=function(t){Ra.call(this),ya.getUid(this),this.values_={},void 0!==t&&this.setProperties(t)};ya.inherits(La,Ra),La.changeEventTypeCache_={},La.getChangeEventType=function(t){return La.changeEventTypeCache_.hasOwnProperty(t)?La.changeEventTypeCache_[t]:La.changeEventTypeCache_[t]="change:"+t},La.prototype.get=function(t){var e;return this.values_.hasOwnProperty(t)&&(e=this.values_[t]),e},La.prototype.getKeys=function(){return Object.keys(this.values_)},La.prototype.getProperties=function(){return Ea.assign({},this.values_)},La.prototype.notify=function(t,e){var n;n=La.getChangeEventType(t),this.dispatchEvent(new La.Event(n,t,e)),n=Sa.PROPERTYCHANGE,this.dispatchEvent(new La.Event(n,t,e))},La.prototype.set=function(t,e,n){if(n)this.values_[t]=e;else{var i=this.values_[t];this.values_[t]=e,i!==e&&this.notify(t,i)}},La.prototype.setProperties=function(t,e){var n;for(n in t)this.set(n,t[n],e)},La.prototype.unset=function(t,e){if(t in this.values_){var n=this.values_[t];delete this.values_[t],e||this.notify(t,n)}},La.Event=function(t,e,n){Ca.call(this,t),this.key=e,this.oldValue=n},ya.inherits(La.Event,Ca);var Ia=function(t,e){La.call(this);var n=e||{};if(this.unique_=!!n.unique,this.array_=t||[],this.unique_)for(var i=0,r=this.array_.length;i<r;++i)this.assertUnique_(this.array_[i],i);this.updateLength_()};ya.inherits(Ia,La),Ia.prototype.clear=function(){for(;this.getLength()>0;)this.pop()},Ia.prototype.extend=function(t){var e,n;for(e=0,n=t.length;e<n;++e)this.push(t[e]);return this},Ia.prototype.forEach=function(t,e){for(var n=e?t.bind(e):t,i=this.array_,r=0,o=i.length;r<o;++r)n(i[r],r,i)},Ia.prototype.getArray=function(){return this.array_},Ia.prototype.item=function(t){return this.array_[t]},Ia.prototype.getLength=function(){return this.get(Ia.Property_.LENGTH)},Ia.prototype.insertAt=function(t,e){this.unique_&&this.assertUnique_(e),this.array_.splice(t,0,e),this.updateLength_(),this.dispatchEvent(new Ia.Event(xa.ADD,e))},Ia.prototype.pop=function(){return this.removeAt(this.getLength()-1)},Ia.prototype.push=function(t){this.unique_&&this.assertUnique_(t);var e=this.getLength();return this.insertAt(e,t),this.getLength()},Ia.prototype.remove=function(t){var e,n,i=this.array_;for(e=0,n=i.length;e<n;++e)if(i[e]===t)return this.removeAt(e)},Ia.prototype.removeAt=function(t){var e=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new Ia.Event(xa.REMOVE,e)),e},Ia.prototype.setAt=function(t,e){var n=this.getLength();if(t<n){this.unique_&&this.assertUnique_(e,t);var i=this.array_[t];this.array_[t]=e,this.dispatchEvent(new Ia.Event(xa.REMOVE,i)),this.dispatchEvent(new Ia.Event(xa.ADD,e))}else{var r;for(r=n;r<t;++r)this.insertAt(r,void 0);this.insertAt(t,e)}},Ia.prototype.updateLength_=function(){this.set(Ia.Property_.LENGTH,this.array_.length)},Ia.prototype.assertUnique_=function(t,e){for(var n=0,i=this.array_.length;n<i;++n)if(this.array_[n]===t&&n!==e)throw new ma(58)},Ia.Property_={LENGTH:"length"},Ia.Event=function(t,e){Ca.call(this,t),this.element=e},ya.inherits(Ia.Event,Ca);var Pa=function(t,e,n){Ca.call(this,t),this.map=e,this.frameState=void 0!==n?n:null};ya.inherits(Pa,Ca);var Ma=function(t,e,n,i,r){Pa.call(this,t,e,r),this.originalEvent=n,this.pixel=e.getEventPixel(n),this.coordinate=e.getCoordinateFromPixel(this.pixel),this.dragging=void 0!==i&&i};ya.inherits(Ma,Pa),Ma.prototype.preventDefault=function(){Pa.prototype.preventDefault.call(this),this.originalEvent.preventDefault()},Ma.prototype.stopPropagation=function(){Pa.prototype.stopPropagation.call(this),this.originalEvent.stopPropagation()};var Oa={};Oa.ONE=1,Oa.SRC_ALPHA=770,Oa.COLOR_ATTACHMENT0=36064,Oa.COLOR_BUFFER_BIT=16384,Oa.TRIANGLES=4,Oa.TRIANGLE_STRIP=5,Oa.ONE_MINUS_SRC_ALPHA=771,Oa.ARRAY_BUFFER=34962,Oa.ELEMENT_ARRAY_BUFFER=34963,Oa.STREAM_DRAW=35040,Oa.STATIC_DRAW=35044,Oa.DYNAMIC_DRAW=35048,Oa.CULL_FACE=2884,Oa.BLEND=3042,Oa.STENCIL_TEST=2960,Oa.DEPTH_TEST=2929,Oa.SCISSOR_TEST=3089,Oa.UNSIGNED_BYTE=5121,Oa.UNSIGNED_SHORT=5123,Oa.UNSIGNED_INT=5125,Oa.FLOAT=5126,Oa.RGBA=6408,Oa.FRAGMENT_SHADER=35632,Oa.VERTEX_SHADER=35633,Oa.LINK_STATUS=35714,Oa.LINEAR=9729,Oa.TEXTURE_MAG_FILTER=10240,Oa.TEXTURE_MIN_FILTER=10241,Oa.TEXTURE_WRAP_S=10242,Oa.TEXTURE_WRAP_T=10243,Oa.TEXTURE_2D=3553,Oa.TEXTURE0=33984,Oa.CLAMP_TO_EDGE=33071,Oa.COMPILE_STATUS=35713,Oa.FRAMEBUFFER=36160,Oa.CONTEXT_IDS_=["experimental-webgl","webgl","webkit-3d","moz-webgl"],Oa.getContext=function(t,e){var n,i,r=Oa.CONTEXT_IDS_.length;for(i=0;i<r;++i)try{if(n=t.getContext(Oa.CONTEXT_IDS_[i],e))return n}catch(t){}return null};var Da={},Fa="undefined"!=typeof navigator?navigator.userAgent.toLowerCase():"";Da.FIREFOX=-1!==Fa.indexOf("firefox"),Da.SAFARI=-1!==Fa.indexOf("safari")&&-1==Fa.indexOf("chrom"),Da.WEBKIT=-1!==Fa.indexOf("webkit")&&-1==Fa.indexOf("edge"),Da.MAC=-1!==Fa.indexOf("macintosh"),Da.DEVICE_PIXEL_RATIO=window.devicePixelRatio||1,Da.CANVAS_LINE_DASH=!1,Da.CANVAS=ya.ENABLE_CANVAS&&function(){if(!("HTMLCanvasElement"in window))return!1;try{var t=document.createElement("CANVAS").getContext("2d");return!!t&&(void 0!==t.setLineDash&&(Da.CANVAS_LINE_DASH=!0),!0)}catch(t){return!1}}(),Da.DEVICE_ORIENTATION="DeviceOrientationEvent"in window,Da.GEOLOCATION="geolocation"in navigator,Da.TOUCH=ya.ASSUME_TOUCH||"ontouchstart"in window,Da.POINTER="PointerEvent"in window,Da.MSPOINTER=!!navigator.msPointerEnabled,Da.WEBGL,function(){if(ya.ENABLE_WEBGL){var t,e=!1,n=[];if("WebGLRenderingContext"in window)try{var i=document.createElement("CANVAS"),r=Oa.getContext(i,{failIfMajorPerformanceCaveat:!0});r&&(e=!0,t=r.getParameter(r.MAX_TEXTURE_SIZE),n=r.getSupportedExtensions())}catch(t){}Da.WEBGL=e,ya.WEBGL_EXTENSIONS=n,ya.WEBGL_MAX_TEXTURE_SIZE=t}}();var ka={SINGLECLICK:"singleclick",CLICK:Aa.CLICK,DBLCLICK:Aa.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},Na=function(t,e,n,i,r){Ma.call(this,t,e,n.originalEvent,i,r),this.pointerEvent=n};ya.inherits(Na,Ma);var Ga={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},Va=function(t,e){this.dispatcher=t,this.mapping_=e};Va.prototype.getEvents=function(){return Object.keys(this.mapping_)},Va.prototype.getHandlerForEvent=function(t){return this.mapping_[t]};var Ua=function(t){var e={mousedown:this.mousedown,mousemove:this.mousemove,mouseup:this.mouseup,mouseover:this.mouseover,mouseout:this.mouseout};Va.call(this,t,e),this.pointerMap=t.pointerMap,this.lastTouches=[]};ya.inherits(Ua,Va),Ua.POINTER_ID=1,Ua.POINTER_TYPE="mouse",Ua.DEDUP_DIST=25,Ua.prototype.isEventSimulatedFromTouch_=function(t){for(var e,n=this.lastTouches,i=t.clientX,r=t.clientY,o=0,a=n.length;o<a&&(e=n[o]);o++){var s=Math.abs(i-e[0]),l=Math.abs(r-e[1]);if(s<=Ua.DEDUP_DIST&&l<=Ua.DEDUP_DIST)return!0}return!1},Ua.prepareEvent=function(t,e){var n=e.cloneEvent(t,t),i=n.preventDefault;return n.preventDefault=function(){t.preventDefault(),i()},n.pointerId=Ua.POINTER_ID,n.isPrimary=!0,n.pointerType=Ua.POINTER_TYPE,n},Ua.prototype.mousedown=function(t){if(!this.isEventSimulatedFromTouch_(t)){Ua.POINTER_ID.toString()in this.pointerMap&&this.cancel(t);var e=Ua.prepareEvent(t,this.dispatcher);this.pointerMap[Ua.POINTER_ID.toString()]=t,this.dispatcher.down(e,t)}},Ua.prototype.mousemove=function(t){if(!this.isEventSimulatedFromTouch_(t)){var e=Ua.prepareEvent(t,this.dispatcher);this.dispatcher.move(e,t)}},Ua.prototype.mouseup=function(t){if(!this.isEventSimulatedFromTouch_(t)){var e=this.pointerMap[Ua.POINTER_ID.toString()];if(e&&e.button===t.button){var n=Ua.prepareEvent(t,this.dispatcher);this.dispatcher.up(n,t),this.cleanupMouse()}}},Ua.prototype.mouseover=function(t){if(!this.isEventSimulatedFromTouch_(t)){var e=Ua.prepareEvent(t,this.dispatcher);this.dispatcher.enterOver(e,t)}},Ua.prototype.mouseout=function(t){if(!this.isEventSimulatedFromTouch_(t)){var e=Ua.prepareEvent(t,this.dispatcher);this.dispatcher.leaveOut(e,t)}},Ua.prototype.cancel=function(t){var e=Ua.prepareEvent(t,this.dispatcher);this.dispatcher.cancel(e,t),this.cleanupMouse()},Ua.prototype.cleanupMouse=function(){delete this.pointerMap[Ua.POINTER_ID.toString()]};var Ba=function(t){var e={MSPointerDown:this.msPointerDown,MSPointerMove:this.msPointerMove,MSPointerUp:this.msPointerUp,MSPointerOut:this.msPointerOut,MSPointerOver:this.msPointerOver,MSPointerCancel:this.msPointerCancel,MSGotPointerCapture:this.msGotPointerCapture,MSLostPointerCapture:this.msLostPointerCapture};Va.call(this,t,e),this.pointerMap=t.pointerMap,this.POINTER_TYPES=["","unavailable","touch","pen","mouse"]};ya.inherits(Ba,Va),Ba.prototype.prepareEvent_=function(t){var e=t;return"number"==typeof t.pointerType&&((e=this.dispatcher.cloneEvent(t,t)).pointerType=this.POINTER_TYPES[t.pointerType]),e},Ba.prototype.cleanup=function(t){delete this.pointerMap[t.toString()]},Ba.prototype.msPointerDown=function(t){this.pointerMap[t.pointerId.toString()]=t;var e=this.prepareEvent_(t);this.dispatcher.down(e,t)},Ba.prototype.msPointerMove=function(t){var e=this.prepareEvent_(t);this.dispatcher.move(e,t)},Ba.prototype.msPointerUp=function(t){var e=this.prepareEvent_(t);this.dispatcher.up(e,t),this.cleanup(t.pointerId)},Ba.prototype.msPointerOut=function(t){var e=this.prepareEvent_(t);this.dispatcher.leaveOut(e,t)},Ba.prototype.msPointerOver=function(t){var e=this.prepareEvent_(t);this.dispatcher.enterOver(e,t)},Ba.prototype.msPointerCancel=function(t){var e=this.prepareEvent_(t);this.dispatcher.cancel(e,t),this.cleanup(t.pointerId)},Ba.prototype.msLostPointerCapture=function(t){var e=this.dispatcher.makeEvent("lostpointercapture",t,t);this.dispatcher.dispatchEvent(e)},Ba.prototype.msGotPointerCapture=function(t){var e=this.dispatcher.makeEvent("gotpointercapture",t,t);this.dispatcher.dispatchEvent(e)};var za=function(t){var e={pointerdown:this.pointerDown,pointermove:this.pointerMove,pointerup:this.pointerUp,pointerout:this.pointerOut,pointerover:this.pointerOver,pointercancel:this.pointerCancel,gotpointercapture:this.gotPointerCapture,lostpointercapture:this.lostPointerCapture};Va.call(this,t,e)};ya.inherits(za,Va),za.prototype.pointerDown=function(t){this.dispatcher.fireNativeEvent(t)},za.prototype.pointerMove=function(t){this.dispatcher.fireNativeEvent(t)},za.prototype.pointerUp=function(t){this.dispatcher.fireNativeEvent(t)},za.prototype.pointerOut=function(t){this.dispatcher.fireNativeEvent(t)},za.prototype.pointerOver=function(t){this.dispatcher.fireNativeEvent(t)},za.prototype.pointerCancel=function(t){this.dispatcher.fireNativeEvent(t)},za.prototype.lostPointerCapture=function(t){this.dispatcher.fireNativeEvent(t)},za.prototype.gotPointerCapture=function(t){this.dispatcher.fireNativeEvent(t)};var Xa=function(t,e,n){Ca.call(this,t),this.originalEvent=e;var i=n||{};this.buttons=this.getButtons_(i),this.pressure=this.getPressure_(i,this.buttons),this.bubbles="bubbles"in i&&i.bubbles,this.cancelable="cancelable"in i&&i.cancelable,this.view="view"in i?i.view:null,this.detail="detail"in i?i.detail:null,this.screenX="screenX"in i?i.screenX:0,this.screenY="screenY"in i?i.screenY:0,this.clientX="clientX"in i?i.clientX:0,this.clientY="clientY"in i?i.clientY:0,this.ctrlKey="ctrlKey"in i&&i.ctrlKey,this.altKey="altKey"in i&&i.altKey,this.shiftKey="shiftKey"in i&&i.shiftKey,this.metaKey="metaKey"in i&&i.metaKey,this.button="button"in i?i.button:0,this.relatedTarget="relatedTarget"in i?i.relatedTarget:null,this.pointerId="pointerId"in i?i.pointerId:0,this.width="width"in i?i.width:0,this.height="height"in i?i.height:0,this.tiltX="tiltX"in i?i.tiltX:0,this.tiltY="tiltY"in i?i.tiltY:0,this.pointerType="pointerType"in i?i.pointerType:"",this.hwTimestamp="hwTimestamp"in i?i.hwTimestamp:0,this.isPrimary="isPrimary"in i&&i.isPrimary,e.preventDefault&&(this.preventDefault=function(){e.preventDefault()})};ya.inherits(Xa,Ca),Xa.prototype.getButtons_=function(t){var e;if(t.buttons||Xa.HAS_BUTTONS)e=t.buttons;else switch(t.which){case 1:e=1;break;case 2:e=4;break;case 3:e=2;break;default:e=0}return e},Xa.prototype.getPressure_=function(t,e){return t.pressure?t.pressure:e?.5:0},Xa.HAS_BUTTONS=!1,function(){try{var t=new MouseEvent("click",{buttons:1});Xa.HAS_BUTTONS=1===t.buttons}catch(t){}}();var Ha={};Ha.binarySearch=function(t,e,n){for(var i,r,o=n||Ha.numberSafeCompareFunction,a=0,s=t.length,l=!1;a<s;)(r=+o(t[i=a+(s-a>>1)],e))<0?a=i+1:(s=i,l=!r);return l?a:~a},Ha.numberSafeCompareFunction=function(t,e){return t>e?1:t<e?-1:0},Ha.includes=function(t,e){return t.indexOf(e)>=0},Ha.linearFindNearest=function(t,e,n){var i=t.length;if(t[0]<=e)return 0;if(e<=t[i-1])return i-1;var r;if(n>0){for(r=1;r<i;++r)if(t[r]<e)return r-1}else if(n<0){for(r=1;r<i;++r)if(t[r]<=e)return r}else for(r=1;r<i;++r){if(t[r]==e)return r;if(t[r]<e)return t[r-1]-e<e-t[r]?r-1:r}return i-1},Ha.reverseSubArray=function(t,e,n){for(;e<n;){var i=t[e];t[e]=t[n],t[n]=i,++e,--n}},Ha.extend=function(t,e){var n,i=Array.isArray(e)?e:[e],r=i.length;for(n=0;n<r;n++)t[t.length]=i[n]},Ha.remove=function(t,e){var n=t.indexOf(e),i=n>-1;return i&&t.splice(n,1),i},Ha.find=function(t,e){for(var n,i=t.length>>>0,r=0;r<i;r++)if(n=t[r],e(n,r,t))return n;return null},Ha.equals=function(t,e){var n=t.length;if(n!==e.length)return!1;for(var i=0;i<n;i++)if(t[i]!==e[i])return!1;return!0},Ha.stableSort=function(t,e){var n,i=t.length,r=Array(t.length);for(n=0;n<i;n++)r[n]={index:n,value:t[n]};for(r.sort(function(t,n){return e(t.value,n.value)||t.index-n.index}),n=0;n<t.length;n++)t[n]=r[n].value},Ha.findIndex=function(t,e){var n;return!t.every(function(i,r){return n=r,!e(i,r,t)})?n:-1},Ha.isSorted=function(t,e,n){var i=e||Ha.numberSafeCompareFunction;return t.every(function(e,r){if(0===r)return!0;var o=i(t[r-1],e);return!(o>0||n&&0===o)})};var Wa=function(t,e){var n={touchstart:this.touchstart,touchmove:this.touchmove,touchend:this.touchend,touchcancel:this.touchcancel};Va.call(this,t,n),this.pointerMap=t.pointerMap,this.mouseSource=e,this.firstTouchId_=void 0,this.clickCount_=0,this.resetId_=void 0};ya.inherits(Wa,Va),Wa.DEDUP_TIMEOUT=2500,Wa.CLICK_COUNT_TIMEOUT=200,Wa.POINTER_TYPE="touch",Wa.prototype.isPrimaryTouch_=function(t){return this.firstTouchId_===t.identifier},Wa.prototype.setPrimaryTouch_=function(t){var e=Object.keys(this.pointerMap).length;(0===e||1===e&&Ua.POINTER_ID.toString()in this.pointerMap)&&(this.firstTouchId_=t.identifier,this.cancelResetClickCount_())},Wa.prototype.removePrimaryPointer_=function(t){t.isPrimary&&(this.firstTouchId_=void 0,this.resetClickCount_())},Wa.prototype.resetClickCount_=function(){this.resetId_=setTimeout(this.resetClickCountHandler_.bind(this),Wa.CLICK_COUNT_TIMEOUT)},Wa.prototype.resetClickCountHandler_=function(){this.clickCount_=0,this.resetId_=void 0},Wa.prototype.cancelResetClickCount_=function(){void 0!==this.resetId_&&clearTimeout(this.resetId_)},Wa.prototype.touchToPointer_=function(t,e){var n=this.dispatcher.cloneEvent(t,e);return n.pointerId=e.identifier+2,n.bubbles=!0,n.cancelable=!0,n.detail=this.clickCount_,n.button=0,n.buttons=1,n.width=e.webkitRadiusX||e.radiusX||0,n.height=e.webkitRadiusY||e.radiusY||0,n.pressure=e.webkitForce||e.force||.5,n.isPrimary=this.isPrimaryTouch_(e),n.pointerType=Wa.POINTER_TYPE,n.clientX=e.clientX,n.clientY=e.clientY,n.screenX=e.screenX,n.screenY=e.screenY,n},Wa.prototype.processTouches_=function(t,e){var n,i,r=Array.prototype.slice.call(t.changedTouches),o=r.length;for(n=0;n<o;++n)(i=this.touchToPointer_(t,r[n])).preventDefault=function(){t.preventDefault()},e.call(this,t,i)},Wa.prototype.findTouch_=function(t,e){for(var n=t.length,i=0;i<n;i++)if(t[i].identifier===e)return!0;return!1},Wa.prototype.vacuumTouches_=function(t){var e=t.touches,n=Object.keys(this.pointerMap),i=n.length;if(i>=e.length){var r,o,a,s=[];for(r=0;r<i;++r)o=n[r],a=this.pointerMap[o],o==Ua.POINTER_ID||this.findTouch_(e,o-2)||s.push(a.out);for(r=0;r<s.length;++r)this.cancelOut_(t,s[r])}},Wa.prototype.touchstart=function(t){this.vacuumTouches_(t),this.setPrimaryTouch_(t.changedTouches[0]),this.dedupSynthMouse_(t),this.clickCount_++,this.processTouches_(t,this.overDown_)},Wa.prototype.overDown_=function(t,e){this.pointerMap[e.pointerId]={target:e.target,out:e,outTarget:e.target},this.dispatcher.over(e,t),this.dispatcher.enter(e,t),this.dispatcher.down(e,t)},Wa.prototype.touchmove=function(t){t.preventDefault(),this.processTouches_(t,this.moveOverOut_)},Wa.prototype.moveOverOut_=function(t,e){var n=e,i=this.pointerMap[n.pointerId];if(i){var r=i.out,o=i.outTarget;this.dispatcher.move(n,t),r&&o!==n.target&&(r.relatedTarget=n.target,n.relatedTarget=o,r.target=o,n.target?(this.dispatcher.leaveOut(r,t),this.dispatcher.enterOver(n,t)):(n.target=o,n.relatedTarget=null,this.cancelOut_(t,n))),i.out=n,i.outTarget=n.target}},Wa.prototype.touchend=function(t){this.dedupSynthMouse_(t),this.processTouches_(t,this.upOut_)},Wa.prototype.upOut_=function(t,e){this.dispatcher.up(e,t),this.dispatcher.out(e,t),this.dispatcher.leave(e,t),this.cleanUpPointer_(e)},Wa.prototype.touchcancel=function(t){this.processTouches_(t,this.cancelOut_)},Wa.prototype.cancelOut_=function(t,e){this.dispatcher.cancel(e,t),this.dispatcher.out(e,t),this.dispatcher.leave(e,t),this.cleanUpPointer_(e)},Wa.prototype.cleanUpPointer_=function(t){delete this.pointerMap[t.pointerId],this.removePrimaryPointer_(t)},Wa.prototype.dedupSynthMouse_=function(t){var e=this.mouseSource.lastTouches,n=t.changedTouches[0];if(this.isPrimaryTouch_(n)){var i=[n.clientX,n.clientY];e.push(i),setTimeout(function(){Ha.remove(e,i)},Wa.DEDUP_TIMEOUT)}};var Ya=function(t){ba.call(this),this.element_=t,this.pointerMap={},this.eventMap_={},this.eventSourceList_=[],this.registerSources()};ya.inherits(Ya,ba),Ya.prototype.registerSources=function(){if(Da.POINTER)this.registerSource("native",new za(this));else if(Da.MSPOINTER)this.registerSource("ms",new Ba(this));else{var t=new Ua(this);this.registerSource("mouse",t),Da.TOUCH&&this.registerSource("touch",new Wa(this,t))}this.register_()},Ya.prototype.registerSource=function(t,e){var n=e,i=n.getEvents();i&&(i.forEach(function(t){var e=n.getHandlerForEvent(t);e&&(this.eventMap_[t]=e.bind(n))},this),this.eventSourceList_.push(n))},Ya.prototype.register_=function(){for(var t,e=this.eventSourceList_.length,n=0;n<e;n++)t=this.eventSourceList_[n],this.addEvents_(t.getEvents())},Ya.prototype.unregister_=function(){for(var t,e=this.eventSourceList_.length,n=0;n<e;n++)t=this.eventSourceList_[n],this.removeEvents_(t.getEvents())},Ya.prototype.eventHandler_=function(t){var e=t.type,n=this.eventMap_[e];n&&n(t)},Ya.prototype.addEvents_=function(t){t.forEach(function(t){Ta.listen(this.element_,t,this.eventHandler_,this)},this)},Ya.prototype.removeEvents_=function(t){t.forEach(function(t){Ta.unlisten(this.element_,t,this.eventHandler_,this)},this)},Ya.prototype.cloneEvent=function(t,e){for(var n,i={},r=0,o=Ya.CLONE_PROPS.length;r<o;r++)i[n=Ya.CLONE_PROPS[r][0]]=t[n]||e[n]||Ya.CLONE_PROPS[r][1];return i},Ya.prototype.down=function(t,e){this.fireEvent(Ga.POINTERDOWN,t,e)},Ya.prototype.move=function(t,e){this.fireEvent(Ga.POINTERMOVE,t,e)},Ya.prototype.up=function(t,e){this.fireEvent(Ga.POINTERUP,t,e)},Ya.prototype.enter=function(t,e){t.bubbles=!1,this.fireEvent(Ga.POINTERENTER,t,e)},Ya.prototype.leave=function(t,e){t.bubbles=!1,this.fireEvent(Ga.POINTERLEAVE,t,e)},Ya.prototype.over=function(t,e){t.bubbles=!0,this.fireEvent(Ga.POINTEROVER,t,e)},Ya.prototype.out=function(t,e){t.bubbles=!0,this.fireEvent(Ga.POINTEROUT,t,e)},Ya.prototype.cancel=function(t,e){this.fireEvent(Ga.POINTERCANCEL,t,e)},Ya.prototype.leaveOut=function(t,e){this.out(t,e),this.contains_(t.target,t.relatedTarget)||this.leave(t,e)},Ya.prototype.enterOver=function(t,e){this.over(t,e),this.contains_(t.target,t.relatedTarget)||this.enter(t,e)},Ya.prototype.contains_=function(t,e){return!(!t||!e)&&t.contains(e)},Ya.prototype.makeEvent=function(t,e,n){return new Xa(t,n,e)},Ya.prototype.fireEvent=function(t,e,n){var i=this.makeEvent(t,e,n);this.dispatchEvent(i)},Ya.prototype.fireNativeEvent=function(t){var e=this.makeEvent(t.type,t,t);this.dispatchEvent(e)},Ya.prototype.wrapMouseEvent=function(t,e){return this.makeEvent(t,Ua.prepareEvent(e,this),e)},Ya.prototype.disposeInternal=function(){this.unregister_(),ba.prototype.disposeInternal.call(this)},Ya.CLONE_PROPS=[["bubbles",!1],["cancelable",!1],["view",null],["detail",null],["screenX",0],["screenY",0],["clientX",0],["clientY",0],["ctrlKey",!1],["altKey",!1],["shiftKey",!1],["metaKey",!1],["button",0],["relatedTarget",null],["buttons",0],["pointerId",0],["width",0],["height",0],["pressure",0],["tiltX",0],["tiltY",0],["pointerType",""],["hwTimestamp",0],["isPrimary",!1],["type",""],["target",null],["currentTarget",null],["which",0]];var ja=function(t,e){ba.call(this),this.map_=t,this.clickTimeoutId_=0,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=e?e*Da.DEVICE_PIXEL_RATIO:Da.DEVICE_PIXEL_RATIO,this.down_=null;var n=this.map_.getViewport();this.activePointers_=0,this.trackedTouches_={},this.pointerEventHandler_=new Ya(n),this.documentPointerEventHandler_=null,this.pointerdownListenerKey_=Ta.listen(this.pointerEventHandler_,Ga.POINTERDOWN,this.handlePointerDown_,this),this.relayedListenerKey_=Ta.listen(this.pointerEventHandler_,Ga.POINTERMOVE,this.relayEvent_,this)};ya.inherits(ja,ba),ja.prototype.emulateClick_=function(t){var e=new Na(ka.CLICK,this.map_,t);this.dispatchEvent(e),0!==this.clickTimeoutId_?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=0,e=new Na(ka.DBLCLICK,this.map_,t),this.dispatchEvent(e)):this.clickTimeoutId_=setTimeout(function(){this.clickTimeoutId_=0;var e=new Na(ka.SINGLECLICK,this.map_,t);this.dispatchEvent(e)}.bind(this),250)},ja.prototype.updateActivePointers_=function(t){var e=t;e.type==ka.POINTERUP||e.type==ka.POINTERCANCEL?delete this.trackedTouches_[e.pointerId]:e.type==ka.POINTERDOWN&&(this.trackedTouches_[e.pointerId]=!0),this.activePointers_=Object.keys(this.trackedTouches_).length},ja.prototype.handlePointerUp_=function(t){this.updateActivePointers_(t);var e=new Na(ka.POINTERUP,this.map_,t);this.dispatchEvent(e),!this.dragging_&&this.isMouseActionButton_(t)&&this.emulateClick_(this.down_),0===this.activePointers_&&(this.dragListenerKeys_.forEach(Ta.unlistenByKey),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null,this.documentPointerEventHandler_.dispose(),this.documentPointerEventHandler_=null)},ja.prototype.isMouseActionButton_=function(t){return 0===t.button},ja.prototype.handlePointerDown_=function(t){this.updateActivePointers_(t);var e=new Na(ka.POINTERDOWN,this.map_,t);this.dispatchEvent(e),this.down_=t,0===this.dragListenerKeys_.length&&(this.documentPointerEventHandler_=new Ya(document),this.dragListenerKeys_.push(Ta.listen(this.documentPointerEventHandler_,ka.POINTERMOVE,this.handlePointerMove_,this),Ta.listen(this.documentPointerEventHandler_,ka.POINTERUP,this.handlePointerUp_,this),Ta.listen(this.pointerEventHandler_,ka.POINTERCANCEL,this.handlePointerUp_,this)))},ja.prototype.handlePointerMove_=function(t){if(this.isMoving_(t)){this.dragging_=!0;var e=new Na(ka.POINTERDRAG,this.map_,t,this.dragging_);this.dispatchEvent(e)}t.preventDefault()},ja.prototype.relayEvent_=function(t){var e=!(!this.down_||!this.isMoving_(t));this.dispatchEvent(new Na(t.type,this.map_,t,e))},ja.prototype.isMoving_=function(t){return Math.abs(t.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(t.clientY-this.down_.clientY)>this.moveTolerance_},ja.prototype.disposeInternal=function(){this.relayedListenerKey_&&(Ta.unlistenByKey(this.relayedListenerKey_),this.relayedListenerKey_=null),this.pointerdownListenerKey_&&(Ta.unlistenByKey(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(Ta.unlistenByKey),this.dragListenerKeys_.length=0,this.documentPointerEventHandler_&&(this.documentPointerEventHandler_.dispose(),this.documentPointerEventHandler_=null),this.pointerEventHandler_&&(this.pointerEventHandler_.dispose(),this.pointerEventHandler_=null),ba.prototype.disposeInternal.call(this)};var Ka={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend"},qa={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"},Za={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4,ABORT:5},Qa={};Qa.assert=function(t,e){if(!t)throw new ma(e)};var Ja=function(t,e){this.priorityFunction_=t,this.keyFunction_=e,this.elements_=[],this.priorities_=[],this.queuedElements_={}};Ja.DROP=1/0,Ja.prototype.clear=function(){this.elements_.length=0,this.priorities_.length=0,Ea.clear(this.queuedElements_)},Ja.prototype.dequeue=function(){var t=this.elements_,e=this.priorities_,n=t[0];1==t.length?(t.length=0,e.length=0):(t[0]=t.pop(),e[0]=e.pop(),this.siftUp_(0));var i=this.keyFunction_(n);return delete this.queuedElements_[i],n},Ja.prototype.enqueue=function(t){Qa.assert(!(this.keyFunction_(t)in this.queuedElements_),31);var e=this.priorityFunction_(t);return e!=Ja.DROP&&(this.elements_.push(t),this.priorities_.push(e),this.queuedElements_[this.keyFunction_(t)]=!0,this.siftDown_(0,this.elements_.length-1),!0)},Ja.prototype.getCount=function(){return this.elements_.length},Ja.prototype.getLeftChildIndex_=function(t){return 2*t+1},Ja.prototype.getRightChildIndex_=function(t){return 2*t+2},Ja.prototype.getParentIndex_=function(t){return t-1>>1},Ja.prototype.heapify_=function(){var t;for(t=(this.elements_.length>>1)-1;t>=0;t--)this.siftUp_(t)},Ja.prototype.isEmpty=function(){return 0===this.elements_.length},Ja.prototype.isKeyQueued=function(t){return t in this.queuedElements_},Ja.prototype.isQueued=function(t){return this.isKeyQueued(this.keyFunction_(t))},Ja.prototype.siftUp_=function(t){for(var e=this.elements_,n=this.priorities_,i=e.length,r=e[t],o=n[t],a=t;t<i>>1;){var s=this.getLeftChildIndex_(t),l=this.getRightChildIndex_(t),u=l<i&&n[l]<n[s]?l:s;e[t]=e[u],n[t]=n[u],t=u}e[t]=r,n[t]=o,this.siftDown_(a,t)},Ja.prototype.siftDown_=function(t,e){for(var n=this.elements_,i=this.priorities_,r=n[e],o=i[e];e>t;){var a=this.getParentIndex_(e);if(!(i[a]>o))break;n[e]=n[a],i[e]=i[a],e=a}n[e]=r,i[e]=o},Ja.prototype.reprioritize=function(){var t,e,n,i=this.priorityFunction_,r=this.elements_,o=this.priorities_,a=0,s=r.length;for(e=0;e<s;++e)(n=i(t=r[e]))==Ja.DROP?delete this.queuedElements_[this.keyFunction_(t)]:(o[a]=n,r[a++]=t);r.length=a,o.length=a,this.heapify_()};var $a=function(t,e){Ja.call(this,function(e){return t.apply(null,e)},function(t){return t[0].getKey()}),this.tileChangeCallback_=e,this.tilesLoading_=0,this.tilesLoadingKeys_={}};ya.inherits($a,Ja),$a.prototype.enqueue=function(t){var e=Ja.prototype.enqueue.call(this,t);if(e){var n=t[0];Ta.listen(n,Aa.CHANGE,this.handleTileChange,this)}return e},$a.prototype.getTilesLoading=function(){return this.tilesLoading_},$a.prototype.handleTileChange=function(t){var e=t.target,n=e.getState();if(n===Za.LOADED||n===Za.ERROR||n===Za.EMPTY||n===Za.ABORT){Ta.unlisten(e,Aa.CHANGE,this.handleTileChange,this);var i=e.getKey();i in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[i],--this.tilesLoading_),this.tileChangeCallback_()}},$a.prototype.loadMoreTiles=function(t,e){for(var n,i,r,o=0,a=!1;this.tilesLoading_<t&&o<e&&this.getCount()>0;)r=(i=this.dequeue()[0]).getKey(),(n=i.getState())===Za.ABORT?a=!0:n!==Za.IDLE||r in this.tilesLoadingKeys_||(this.tilesLoadingKeys_[r]=!0,++this.tilesLoading_,++o,i.load());0===o&&a&&this.tileChangeCallback_()};var ts={};ts.clamp=function(t,e,n){return Math.min(Math.max(t,e),n)},ts.cosh="cosh"in Math?Math.cosh:function(t){var e=Math.exp(t);return(e+1/e)/2},ts.roundUpToPowerOfTwo=function(t){return Qa.assert(0<t,29),Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},ts.squaredSegmentDistance=function(t,e,n,i,r,o){var a=r-n,s=o-i;if(0!==a||0!==s){var l=((t-n)*a+(e-i)*s)/(a*a+s*s);l>1?(n=r,i=o):l>0&&(n+=a*l,i+=s*l)}return ts.squaredDistance(t,e,n,i)},ts.squaredDistance=function(t,e,n,i){var r=n-t,o=i-e;return r*r+o*o},ts.solveLinearSystem=function(t){for(var e=t.length,n=0;n<e;n++){for(var i=n,r=Math.abs(t[n][n]),o=n+1;o<e;o++){var a=Math.abs(t[o][n]);a>r&&(r=a,i=o)}if(0===r)return null;var s=t[i];t[i]=t[n],t[n]=s;for(var l=n+1;l<e;l++)for(var u=-t[l][n]/t[n][n],c=n;c<e+1;c++)n==c?t[l][c]=0:t[l][c]+=u*t[n][c]}for(var h=new Array(e),d=e-1;d>=0;d--){h[d]=t[d][e]/t[d][d];for(var f=d-1;f>=0;f--)t[f][e]-=t[f][d]*h[d]}return h},ts.toDegrees=function(t){return 180*t/Math.PI},ts.toRadians=function(t){return t*Math.PI/180},ts.modulo=function(t,e){var n=t%e;return n*e<0?n+e:n},ts.lerp=function(t,e,n){return t+n*(e-t)};var es={};es.createExtent=function(t){return function(e){return e?[ts.clamp(e[0],t[0],t[2]),ts.clamp(e[1],t[1],t[3])]:void 0}},es.none=function(t){return t};var ns={};ns.createSnapToResolutions=function(t){return function(e,n,i){if(void 0!==e){var r=Ha.linearFindNearest(t,e,i);r=ts.clamp(r+n,0,t.length-1);var o=Math.floor(r);if(r!=o&&o<t.length-1){var a=t[o]/t[o+1];return t[o]/Math.pow(a,r-o)}return t[o]}}},ns.createSnapToPower=function(t,e,n){return function(i,r,o){if(void 0!==i){var a=-o/2+.5,s=Math.floor(Math.log(e/i)/Math.log(t)+a),l=Math.max(s+r,0);return void 0!==n&&(l=Math.min(l,n)),e/Math.pow(t,l)}}};var is={};is.disable=function(t,e){return void 0!==t?0:void 0},is.none=function(t,e){return void 0!==t?t+e:void 0},is.createSnapToN=function(t){var e=2*Math.PI/t;return function(t,n){return void 0!==t?t=Math.floor((t+n)/e+.5)*e:void 0}},is.createSnapToZero=function(t){var e=t||ts.toRadians(5);return function(t,n){return void 0!==t?Math.abs(t+n)<=e?0:t+n:void 0}};var rs={ANIMATING:0,INTERACTING:1},os={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"},as={};as.padNumber=function(t,e,n){var i=void 0!==n?t.toFixed(n):""+t,r=i.indexOf(".");return(r=-1===r?i.length:r)>e?i:new Array(1+e-r).join("0")+i},as.compareVersions=function(t,e){for(var n=(""+t).split("."),i=(""+e).split("."),r=0;r<Math.max(n.length,i.length);r++){var o=parseInt(n[r]||"0",10),a=parseInt(i[r]||"0",10);if(o>a)return 1;if(a>o)return-1}return 0};var ss={};ss.add=function(t,e){return t[0]+=e[0],t[1]+=e[1],t},ss.closestOnCircle=function(t,e){var n=e.getRadius(),i=e.getCenter(),r=i[0],o=i[1],a=t[0]-r,s=t[1]-o;0===a&&0===s&&(a=1);var l,u,c=Math.sqrt(a*a+s*s);return l=r+n*a/c,u=o+n*s/c,[l,u]},ss.closestOnSegment=function(t,e){var n,i,r=t[0],o=t[1],a=e[0],s=e[1],l=a[0],u=a[1],c=s[0],h=s[1],d=c-l,f=h-u,p=0===d&&0===f?0:(d*(r-l)+f*(o-u))/(d*d+f*f||0);return p<=0?(n=l,i=u):p>=1?(n=c,i=h):(n=l+p*d,i=u+p*f),[n,i]},ss.createStringXY=function(t){return function(e){return ss.toStringXY(e,t)}},ss.degreesToStringHDMS=function(t,e,n){var i=ts.modulo(e+180,360)-180,r=Math.abs(3600*i),o=n||0,a=Math.pow(10,o),s=Math.floor(r/3600),l=Math.floor((r-3600*s)/60),u=r-3600*s-60*l;return(u=Math.ceil(u*a)/a)>=60&&(u=0,l+=1),l>=60&&(l=0,s+=1),s+" "+as.padNumber(l,2)+" "+as.padNumber(u,2,o)+""+(0==i?"":" "+t.charAt(i<0?1:0))},ss.format=function(t,e,n){return t?e.replace("{x}",t[0].toFixed(n)).replace("{y}",t[1].toFixed(n)):""},ss.equals=function(t,e){for(var n=!0,i=t.length-1;i>=0;--i)if(t[i]!=e[i]){n=!1;break}return n},ss.rotate=function(t,e){var n=Math.cos(e),i=Math.sin(e),r=t[0]*n-t[1]*i,o=t[1]*n+t[0]*i;return t[0]=r,t[1]=o,t},ss.scale=function(t,e){return t[0]*=e,t[1]*=e,t},ss.sub=function(t,e){return t[0]-=e[0],t[1]-=e[1],t},ss.squaredDistance=function(t,e){var n=t[0]-e[0],i=t[1]-e[1];return n*n+i*i},ss.distance=function(t,e){return Math.sqrt(ss.squaredDistance(t,e))},ss.squaredDistanceToSegment=function(t,e){return ss.squaredDistance(t,ss.closestOnSegment(t,e))},ss.toStringHDMS=function(t,e){return t?ss.degreesToStringHDMS("NS",t[1],e)+" "+ss.degreesToStringHDMS("EW",t[0],e):""},ss.toStringXY=function(t,e){return ss.format(t,"{x}, {y}",e)};var ls={};ls.easeIn=function(t){return Math.pow(t,3)},ls.easeOut=function(t){return 1-ls.easeIn(1-t)},ls.inAndOut=function(t){return 3*t*t-2*t*t*t},ls.linear=function(t){return t},ls.upAndDown=function(t){return t<.5?ls.inAndOut(2*t):1-ls.inAndOut(2*(t-.5))};var us={BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",TOP_LEFT:"top-left",TOP_RIGHT:"top-right"},cs={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16},hs={};hs.boundingExtent=function(t){for(var e=hs.createEmpty(),n=0,i=t.length;n<i;++n)hs.extendCoordinate(e,t[n]);return e},hs.boundingExtentXYs_=function(t,e,n){var i=Math.min.apply(null,t),r=Math.min.apply(null,e),o=Math.max.apply(null,t),a=Math.max.apply(null,e);return hs.createOrUpdate(i,r,o,a,n)},hs.buffer=function(t,e,n){return n?(n[0]=t[0]-e,n[1]=t[1]-e,n[2]=t[2]+e,n[3]=t[3]+e,n):[t[0]-e,t[1]-e,t[2]+e,t[3]+e]},hs.clone=function(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t.slice()},hs.closestSquaredDistanceXY=function(t,e,n){var i,r;return i=e<t[0]?t[0]-e:t[2]<e?e-t[2]:0,r=n<t[1]?t[1]-n:t[3]<n?n-t[3]:0,i*i+r*r},hs.containsCoordinate=function(t,e){return hs.containsXY(t,e[0],e[1])},hs.containsExtent=function(t,e){return t[0]<=e[0]&&e[2]<=t[2]&&t[1]<=e[1]&&e[3]<=t[3]},hs.containsXY=function(t,e,n){return t[0]<=e&&e<=t[2]&&t[1]<=n&&n<=t[3]},hs.coordinateRelationship=function(t,e){var n=t[0],i=t[1],r=t[2],o=t[3],a=e[0],s=e[1],l=cs.UNKNOWN;return a<n?l|=cs.LEFT:a>r&&(l|=cs.RIGHT),s<i?l|=cs.BELOW:s>o&&(l|=cs.ABOVE),l===cs.UNKNOWN&&(l=cs.INTERSECTING),l},hs.createEmpty=function(){return[1/0,1/0,-1/0,-1/0]},hs.createOrUpdate=function(t,e,n,i,r){return r?(r[0]=t,r[1]=e,r[2]=n,r[3]=i,r):[t,e,n,i]},hs.createOrUpdateEmpty=function(t){return hs.createOrUpdate(1/0,1/0,-1/0,-1/0,t)},hs.createOrUpdateFromCoordinate=function(t,e){var n=t[0],i=t[1];return hs.createOrUpdate(n,i,n,i,e)},hs.createOrUpdateFromCoordinates=function(t,e){var n=hs.createOrUpdateEmpty(e);return hs.extendCoordinates(n,t)},hs.createOrUpdateFromFlatCoordinates=function(t,e,n,i,r){var o=hs.createOrUpdateEmpty(r);return hs.extendFlatCoordinates(o,t,e,n,i)},hs.createOrUpdateFromRings=function(t,e){var n=hs.createOrUpdateEmpty(e);return hs.extendRings(n,t)},hs.equals=function(t,e){return t[0]==e[0]&&t[2]==e[2]&&t[1]==e[1]&&t[3]==e[3]},hs.extend=function(t,e){return e[0]<t[0]&&(t[0]=e[0]),e[2]>t[2]&&(t[2]=e[2]),e[1]<t[1]&&(t[1]=e[1]),e[3]>t[3]&&(t[3]=e[3]),t},hs.extendCoordinate=function(t,e){e[0]<t[0]&&(t[0]=e[0]),e[0]>t[2]&&(t[2]=e[0]),e[1]<t[1]&&(t[1]=e[1]),e[1]>t[3]&&(t[3]=e[1])},hs.extendCoordinates=function(t,e){var n,i;for(n=0,i=e.length;n<i;++n)hs.extendCoordinate(t,e[n]);return t},hs.extendFlatCoordinates=function(t,e,n,i,r){for(;n<i;n+=r)hs.extendXY(t,e[n],e[n+1]);return t},hs.extendRings=function(t,e){var n,i;for(n=0,i=e.length;n<i;++n)hs.extendCoordinates(t,e[n]);return t},hs.extendXY=function(t,e,n){t[0]=Math.min(t[0],e),t[1]=Math.min(t[1],n),t[2]=Math.max(t[2],e),t[3]=Math.max(t[3],n)},hs.forEachCorner=function(t,e,n){var i;return(i=e.call(n,hs.getBottomLeft(t)))?i:(i=e.call(n,hs.getBottomRight(t)))?i:(i=e.call(n,hs.getTopRight(t)))?i:(i=e.call(n,hs.getTopLeft(t)))||!1},hs.getArea=function(t){var e=0;return hs.isEmpty(t)||(e=hs.getWidth(t)*hs.getHeight(t)),e},hs.getBottomLeft=function(t){return[t[0],t[1]]},hs.getBottomRight=function(t){return[t[2],t[1]]},hs.getCenter=function(t){return[(t[0]+t[2])/2,(t[1]+t[3])/2]},hs.getCorner=function(t,e){var n;return e===us.BOTTOM_LEFT?n=hs.getBottomLeft(t):e===us.BOTTOM_RIGHT?n=hs.getBottomRight(t):e===us.TOP_LEFT?n=hs.getTopLeft(t):e===us.TOP_RIGHT?n=hs.getTopRight(t):Qa.assert(!1,13),n},hs.getEnlargedArea=function(t,e){var n=Math.min(t[0],e[0]),i=Math.min(t[1],e[1]);return(Math.max(t[2],e[2])-n)*(Math.max(t[3],e[3])-i)},hs.getForViewAndSize=function(t,e,n,i,r){var o=e*i[0]/2,a=e*i[1]/2,s=Math.cos(n),l=Math.sin(n),u=o*s,c=o*l,h=a*s,d=a*l,f=t[0],p=t[1],g=f-u+d,_=f-u-d,v=f+u-d,y=f+u+d,m=p-c-h,x=p-c+h,S=p+c+h,E=p+c-h;return hs.createOrUpdate(Math.min(g,_,v,y),Math.min(m,x,S,E),Math.max(g,_,v,y),Math.max(m,x,S,E),r)},hs.getHeight=function(t){return t[3]-t[1]},hs.getIntersectionArea=function(t,e){var n=hs.getIntersection(t,e);return hs.getArea(n)},hs.getIntersection=function(t,e,n){var i=n||hs.createEmpty();return hs.intersects(t,e)&&(t[0]>e[0]?i[0]=t[0]:i[0]=e[0],t[1]>e[1]?i[1]=t[1]:i[1]=e[1],t[2]<e[2]?i[2]=t[2]:i[2]=e[2],t[3]<e[3]?i[3]=t[3]:i[3]=e[3]),i},hs.getMargin=function(t){return hs.getWidth(t)+hs.getHeight(t)},hs.getSize=function(t){return[t[2]-t[0],t[3]-t[1]]},hs.getTopLeft=function(t){return[t[0],t[3]]},hs.getTopRight=function(t){return[t[2],t[3]]},hs.getWidth=function(t){return t[2]-t[0]},hs.intersects=function(t,e){return t[0]<=e[2]&&t[2]>=e[0]&&t[1]<=e[3]&&t[3]>=e[1]},hs.isEmpty=function(t){return t[2]<t[0]||t[3]<t[1]},hs.returnOrUpdate=function(t,e){return e?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e):t},hs.scaleFromCenter=function(t,e){var n=(t[2]-t[0])/2*(e-1),i=(t[3]-t[1])/2*(e-1);t[0]-=n,t[2]+=n,t[1]-=i,t[3]+=i},hs.intersectsSegment=function(t,e,n){var i=!1,r=hs.coordinateRelationship(t,e),o=hs.coordinateRelationship(t,n);if(r===cs.INTERSECTING||o===cs.INTERSECTING)i=!0;else{var a,s,l=t[0],u=t[1],c=t[2],h=t[3],d=e[0],f=e[1],p=n[0],g=n[1],_=(g-f)/(p-d);o&cs.ABOVE&&!(r&cs.ABOVE)&&(i=(a=p-(g-h)/_)>=l&&a<=c),i||!(o&cs.RIGHT)||r&cs.RIGHT||(i=(s=g-(p-c)*_)>=u&&s<=h),i||!(o&cs.BELOW)||r&cs.BELOW||(i=(a=p-(g-u)/_)>=l&&a<=c),i||!(o&cs.LEFT)||r&cs.LEFT||(i=(s=g-(p-l)*_)>=u&&s<=h)}return i},hs.applyTransform=function(t,e,n){var i=[t[0],t[1],t[0],t[3],t[2],t[1],t[2],t[3]];e(i,i,2);var r=[i[0],i[2],i[4],i[6]],o=[i[1],i[3],i[5],i[7]];return hs.boundingExtentXYs_(r,o,n)};var ds={POINT:"Point",LINE_STRING:"LineString",LINEAR_RING:"LinearRing",POLYGON:"Polygon",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon",GEOMETRY_COLLECTION:"GeometryCollection",CIRCLE:"Circle"},fs={XY:"XY",XYZ:"XYZ",XYM:"XYM",XYZM:"XYZM"},ps={};ps.TRUE=function(){return!0},ps.FALSE=function(){return!1};var gs={};gs.transform2D=function(t,e,n,i,r,o){var a,s=o||[],l=0;for(a=e;a<n;a+=i){var u=t[a],c=t[a+1];s[l++]=r[0]*u+r[2]*c+r[4],s[l++]=r[1]*u+r[3]*c+r[5]}return o&&s.length!=l&&(s.length=l),s},gs.rotate=function(t,e,n,i,r,o,a){for(var s=a||[],l=Math.cos(r),u=Math.sin(r),c=o[0],h=o[1],d=0,f=e;f<n;f+=i){var p=t[f]-c,g=t[f+1]-h;s[d++]=c+p*l-g*u,s[d++]=h+p*u+g*l;for(var _=f+2;_<f+i;++_)s[d++]=t[_]}return a&&s.length!=d&&(s.length=d),s},gs.scale=function(t,e,n,i,r,o,a,s){for(var l=s||[],u=a[0],c=a[1],h=0,d=e;d<n;d+=i){var f=t[d]-u,p=t[d+1]-c;l[h++]=u+r*f,l[h++]=c+o*p;for(var g=d+2;g<d+i;++g)l[h++]=t[g]}return s&&l.length!=h&&(l.length=h),l},gs.translate=function(t,e,n,i,r,o,a){var s,l,u=a||[],c=0;for(s=e;s<n;s+=i)for(u[c++]=t[s]+r,u[c++]=t[s+1]+o,l=s+2;l<s+i;++l)u[c++]=t[l];return a&&u.length!=c&&(u.length=c),u};var _s=function(t){this.radius=t};_s.prototype.geodesicArea=function(t){return _s.getArea_(t,this.radius)},_s.prototype.haversineDistance=function(t,e){return _s.getDistance_(t,e,this.radius)},_s.prototype.offset=function(t,e,n){var i=ts.toRadians(t[1]),r=ts.toRadians(t[0]),o=e/this.radius,a=Math.asin(Math.sin(i)*Math.cos(o)+Math.cos(i)*Math.sin(o)*Math.cos(n)),s=r+Math.atan2(Math.sin(n)*Math.sin(o)*Math.cos(i),Math.cos(o)-Math.sin(i)*Math.sin(a));return[ts.toDegrees(s),ts.toDegrees(a)]},_s.DEFAULT_RADIUS=6371008.8,_s.getLength=function(t,e){var n,i,r,o,a,s,l=e||{},u=l.radius||_s.DEFAULT_RADIUS,c=l.projection||"EPSG:3857",h=(t=t.clone().transform(c,"EPSG:4326")).getType(),d=0;switch(h){case ds.POINT:case ds.MULTI_POINT:break;case ds.LINE_STRING:case ds.LINEAR_RING:n=t.getCoordinates(),d=_s.getLength_(n,u);break;case ds.MULTI_LINE_STRING:case ds.POLYGON:for(r=0,o=(n=t.getCoordinates()).length;r<o;++r)d+=_s.getLength_(n[r],u);break;case ds.MULTI_POLYGON:for(r=0,o=(n=t.getCoordinates()).length;r<o;++r)for(a=0,s=(i=n[r]).length;a<s;++a)d+=_s.getLength_(i[a],u);break;case ds.GEOMETRY_COLLECTION:var f=t.getGeometries();for(r=0,o=f.length;r<o;++r)d+=_s.getLength(f[r],e);break;default:throw new Error("Unsupported geometry type: "+h)}return d},_s.getLength_=function(t,e){for(var n=0,i=0,r=t.length;i<r-1;++i)n+=_s.getDistance_(t[i],t[i+1],e);return n},_s.getDistance_=function(t,e,n){var i=ts.toRadians(t[1]),r=ts.toRadians(e[1]),o=(r-i)/2,a=ts.toRadians(e[0]-t[0])/2,s=Math.sin(o)*Math.sin(o)+Math.sin(a)*Math.sin(a)*Math.cos(i)*Math.cos(r);return 2*n*Math.atan2(Math.sqrt(s),Math.sqrt(1-s))},_s.getArea=function(t,e){var n,i,r,o,a,s,l=e||{},u=l.radius||_s.DEFAULT_RADIUS,c=l.projection||"EPSG:3857",h=(t=t.clone().transform(c,"EPSG:4326")).getType(),d=0;switch(h){case ds.POINT:case ds.MULTI_POINT:case ds.LINE_STRING:case ds.MULTI_LINE_STRING:case ds.LINEAR_RING:break;case ds.POLYGON:for(n=t.getCoordinates(),d=Math.abs(_s.getArea_(n[0],u)),r=1,o=n.length;r<o;++r)d-=Math.abs(_s.getArea_(n[r],u));break;case ds.MULTI_POLYGON:for(r=0,o=(n=t.getCoordinates()).length;r<o;++r)for(i=n[r],d+=Math.abs(_s.getArea_(i[0],u)),a=1,s=i.length;a<s;++a)d-=Math.abs(_s.getArea_(i[a],u));break;case ds.GEOMETRY_COLLECTION:var f=t.getGeometries();for(r=0,o=f.length;r<o;++r)d+=_s.getArea(f[r],e);break;default:throw new Error("Unsupported geometry type: "+h)}return d},_s.getArea_=function(t,e){for(var n=0,i=t.length,r=t[i-1][0],o=t[i-1][1],a=0;a<i;a++){var s=t[a][0],l=t[a][1];n+=ts.toRadians(s-r)*(2+Math.sin(ts.toRadians(o))+Math.sin(ts.toRadians(l))),r=s,o=l}return n*e*e/2};var vs={DEGREES:"degrees",FEET:"ft",METERS:"m",PIXELS:"pixels",TILE_PIXELS:"tile-pixels",USFEET:"us-ft"};vs.METERS_PER_UNIT={},vs.METERS_PER_UNIT[vs.DEGREES]=2*Math.PI*6370997/360,vs.METERS_PER_UNIT[vs.FEET]=.3048,vs.METERS_PER_UNIT[vs.METERS]=1,vs.METERS_PER_UNIT[vs.USFEET]=1200/3937;var ys={};ys.cache_=null,ys.set=function(t){ys.cache_=t},ys.get=function(){return ys.cache_||window.proj4};var ms=function(t){this.code_=t.code,this.units_=t.units,this.extent_=void 0!==t.extent?t.extent:null,this.worldExtent_=void 0!==t.worldExtent?t.worldExtent:null,this.axisOrientation_=void 0!==t.axisOrientation?t.axisOrientation:"enu",this.global_=void 0!==t.global&&t.global,this.canWrapX_=!(!this.global_||!this.extent_),this.getPointResolutionFunc_=t.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=t.metersPerUnit;var e=t.code;if(ya.ENABLE_PROJ4JS){var n=ys.get();if("function"==typeof n){var i=n.defs(e);void 0!==i&&(void 0!==i.axis&&void 0===t.axisOrientation&&(this.axisOrientation_=i.axis),void 0===t.metersPerUnit&&(this.metersPerUnit_=i.to_meter),void 0===t.units&&(this.units_=i.units))}}};ms.prototype.canWrapX=function(){return this.canWrapX_},ms.prototype.getCode=function(){return this.code_},ms.prototype.getExtent=function(){return this.extent_},ms.prototype.getUnits=function(){return this.units_},ms.prototype.getMetersPerUnit=function(){return this.metersPerUnit_||vs.METERS_PER_UNIT[this.units_]},ms.prototype.getWorldExtent=function(){return this.worldExtent_},ms.prototype.getAxisOrientation=function(){return this.axisOrientation_},ms.prototype.isGlobal=function(){return this.global_},ms.prototype.setGlobal=function(t){this.global_=t,this.canWrapX_=!(!t||!this.extent_)},ms.prototype.getDefaultTileGrid=function(){return this.defaultTileGrid_},ms.prototype.setDefaultTileGrid=function(t){this.defaultTileGrid_=t},ms.prototype.setExtent=function(t){this.extent_=t,this.canWrapX_=!(!this.global_||!t)},ms.prototype.setWorldExtent=function(t){this.worldExtent_=t},ms.prototype.setGetPointResolution=function(t){this.getPointResolutionFunc_=t},ms.prototype.getPointResolutionFunc=function(){return this.getPointResolutionFunc_};var xs={};xs.Projection_=function(t){ms.call(this,{code:t,units:vs.METERS,extent:xs.EXTENT,global:!0,worldExtent:xs.WORLD_EXTENT,getPointResolution:function(t,e){return t/ts.cosh(e[1]/xs.RADIUS)}})},ya.inherits(xs.Projection_,ms),xs.RADIUS=6378137,xs.HALF_SIZE=Math.PI*xs.RADIUS,xs.EXTENT=[-xs.HALF_SIZE,-xs.HALF_SIZE,xs.HALF_SIZE,xs.HALF_SIZE],xs.WORLD_EXTENT=[-180,-85,180,85],xs.PROJECTIONS=[new xs.Projection_("EPSG:3857"),new xs.Projection_("EPSG:102100"),new xs.Projection_("EPSG:102113"),new xs.Projection_("EPSG:900913"),new xs.Projection_("urn:ogc:def:crs:EPSG:6.18:3:3857"),new xs.Projection_("urn:ogc:def:crs:EPSG::3857"),new xs.Projection_("http://www.opengis.net/gml/srs/epsg.xml#3857")],xs.fromEPSG4326=function(t,e,n){var i=t.length,r=n>1?n:2,o=e;void 0===o&&(o=r>2?t.slice():new Array(i));for(var a=xs.HALF_SIZE,s=0;s<i;s+=r){o[s]=a*t[s]/180;var l=xs.RADIUS*Math.log(Math.tan(Math.PI*(t[s+1]+90)/360));l>a?l=a:l<-a&&(l=-a),o[s+1]=l}return o},xs.toEPSG4326=function(t,e,n){var i=t.length,r=n>1?n:2,o=e;void 0===o&&(o=r>2?t.slice():new Array(i));for(var a=0;a<i;a+=r)o[a]=180*t[a]/xs.HALF_SIZE,o[a+1]=360*Math.atan(Math.exp(t[a+1]/xs.RADIUS))/Math.PI-90;return o};var Ss={};Ss.Projection_=function(t,e){ms.call(this,{code:t,units:vs.DEGREES,extent:Ss.EXTENT,axisOrientation:e,global:!0,metersPerUnit:Ss.METERS_PER_UNIT,worldExtent:Ss.EXTENT})},ya.inherits(Ss.Projection_,ms),Ss.RADIUS=6378137,Ss.EXTENT=[-180,-90,180,90],Ss.METERS_PER_UNIT=Math.PI*Ss.RADIUS/180,Ss.PROJECTIONS=[new Ss.Projection_("CRS:84"),new Ss.Projection_("EPSG:4326","neu"),new Ss.Projection_("urn:ogc:def:crs:EPSG::4326","neu"),new Ss.Projection_("urn:ogc:def:crs:EPSG:6.6:4326","neu"),new Ss.Projection_("urn:ogc:def:crs:OGC:1.3:CRS84"),new Ss.Projection_("urn:ogc:def:crs:OGC:2:84"),new Ss.Projection_("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new Ss.Projection_("urn:x-ogc:def:crs:EPSG:4326","neu")];var Es={};Es.cache_={},Es.clear=function(){Es.cache_={}},Es.get=function(t){return Es.cache_[t]||null},Es.add=function(t,e){Es.cache_[t]=e};var Ts={};Ts.cache_={},Ts.clear=function(){Ts.cache_={}},Ts.add=function(t,e,n){var i=t.getCode(),r=e.getCode(),o=Ts.cache_;i in o||(o[i]={}),o[i][r]=n},Ts.remove=function(t,e){var n=t.getCode(),i=e.getCode(),r=Ts.cache_,o=r[n][i];return delete r[n][i],Ea.isEmpty(r[n])&&delete r[n],o},Ts.get=function(t,e){var n,i=Ts.cache_;return t in i&&e in i[t]&&(n=i[t][e]),n};var ws={};ws.METERS_PER_UNIT=vs.METERS_PER_UNIT,ws.SPHERE_=new _s(_s.DEFAULT_RADIUS),ya.ENABLE_PROJ4JS&&(ws.setProj4=function(t){ys.set(t)}),ws.getPointResolution=function(t,e,n,i){var r,o=(t=ws.get(t)).getPointResolutionFunc();if(o)r=o(e,n);else if(t.getUnits()==vs.DEGREES&&!i||i==vs.DEGREES)r=e;else{var a=ws.getTransformFromProjections(t,ws.get("EPSG:4326")),s=[n[0]-e/2,n[1],n[0]+e/2,n[1],n[0],n[1]-e/2,n[0],n[1]+e/2];s=a(s,s,2),r=(ws.SPHERE_.haversineDistance(s.slice(0,2),s.slice(2,4))+ws.SPHERE_.haversineDistance(s.slice(4,6),s.slice(6,8)))/2;var l=i?vs.METERS_PER_UNIT[i]:t.getMetersPerUnit();void 0!==l&&(r/=l)}return r},ws.addEquivalentProjections=function(t){ws.addProjections(t),t.forEach(function(e){t.forEach(function(t){e!==t&&Ts.add(e,t,ws.cloneTransform)})})},ws.addEquivalentTransforms=function(t,e,n,i){t.forEach(function(t){e.forEach(function(e){Ts.add(t,e,n),Ts.add(e,t,i)})})},ws.addProjection=function(t){Es.add(t.getCode(),t),Ts.add(t,t,ws.cloneTransform)},ws.addProjections=function(t){t.forEach(ws.addProjection)},ws.clearAllProjections=function(){Es.clear(),Ts.clear()},ws.createProjection=function(t,e){return t?"string"==typeof t?ws.get(t):t:ws.get(e)},ws.addCoordinateTransforms=function(t,e,n,i){var r=ws.get(t),o=ws.get(e);Ts.add(r,o,ws.createTransformFromCoordinateTransform(n)),Ts.add(o,r,ws.createTransformFromCoordinateTransform(i))},ws.createTransformFromCoordinateTransform=function(t){return function(e,n,i){var r,o,a,s=e.length,l=void 0!==i?i:2,u=void 0!==n?n:new Array(s);for(o=0;o<s;o+=l)for(r=t([e[o],e[o+1]]),u[o]=r[0],u[o+1]=r[1],a=l-1;a>=2;--a)u[o+a]=e[o+a];return u}},ws.fromLonLat=function(t,e){return ws.transform(t,"EPSG:4326",void 0!==e?e:"EPSG:3857")},ws.toLonLat=function(t,e){var n=ws.transform(t,void 0!==e?e:"EPSG:3857","EPSG:4326"),i=n[0];return(i<-180||i>180)&&(n[0]=ts.modulo(i+180,360)-180),n},ws.get=function(t){var e=null;if(t instanceof ms)e=t;else if("string"==typeof t){var n=t;if(e=Es.get(n),ya.ENABLE_PROJ4JS&&!e){var i=ys.get();"function"==typeof i&&void 0!==i.defs(n)&&(e=new ms({code:n}),ws.addProjection(e))}}return e},ws.equivalent=function(t,e){if(t===e)return!0;var n=t.getUnits()===e.getUnits();return t.getCode()===e.getCode()?n:ws.getTransformFromProjections(t,e)===ws.cloneTransform&&n},ws.getTransform=function(t,e){var n=ws.get(t),i=ws.get(e);return ws.getTransformFromProjections(n,i)},ws.getTransformFromProjections=function(t,e){var n=t.getCode(),i=e.getCode(),r=Ts.get(n,i);if(ya.ENABLE_PROJ4JS&&!r){var o=ys.get();if("function"==typeof o){var a=o.defs(n),s=o.defs(i);if(void 0!==a&&void 0!==s){if(a===s)ws.addEquivalentProjections([e,t]);else{var l=o(i,n);ws.addCoordinateTransforms(e,t,l.forward,l.inverse)}r=Ts.get(n,i)}}}return r||(r=ws.identityTransform),r},ws.identityTransform=function(t,e,n){if(void 0!==e&&t!==e){for(var i=0,r=t.length;i<r;++i)e[i]=t[i];t=e}return t},ws.cloneTransform=function(t,e,n){var i;if(void 0!==e){for(var r=0,o=t.length;r<o;++r)e[r]=t[r];i=e}else i=t.slice();return i},ws.transform=function(t,e,n){return ws.getTransform(e,n)(t,void 0,t.length)},ws.transformExtent=function(t,e,n){var i=ws.getTransform(e,n);return hs.applyTransform(t,i)},ws.transformWithProjections=function(t,e,n){return ws.getTransformFromProjections(e,n)(t)},ws.addCommon=function(){ws.addEquivalentProjections(xs.PROJECTIONS),ws.addEquivalentProjections(Ss.PROJECTIONS),ws.addEquivalentTransforms(Ss.PROJECTIONS,xs.PROJECTIONS,xs.fromEPSG4326,xs.toEPSG4326)},ws.addCommon();var Cs={};Cs.tmp_=new Array(6),Cs.create=function(){return[1,0,0,1,0,0]},Cs.reset=function(t){return Cs.set(t,1,0,0,1,0,0)},Cs.multiply=function(t,e){var n=t[0],i=t[1],r=t[2],o=t[3],a=t[4],s=t[5],l=e[0],u=e[1],c=e[2],h=e[3],d=e[4],f=e[5];return t[0]=n*l+r*u,t[1]=i*l+o*u,t[2]=n*c+r*h,t[3]=i*c+o*h,t[4]=n*d+r*f+a,t[5]=i*d+o*f+s,t},Cs.set=function(t,e,n,i,r,o,a){return t[0]=e,t[1]=n,t[2]=i,t[3]=r,t[4]=o,t[5]=a,t},Cs.setFromArray=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},Cs.apply=function(t,e){var n=e[0],i=e[1];return e[0]=t[0]*n+t[2]*i+t[4],e[1]=t[1]*n+t[3]*i+t[5],e},Cs.rotate=function(t,e){var n=Math.cos(e),i=Math.sin(e);return Cs.multiply(t,Cs.set(Cs.tmp_,n,i,-i,n,0,0))},Cs.scale=function(t,e,n){return Cs.multiply(t,Cs.set(Cs.tmp_,e,0,0,n,0,0))},Cs.translate=function(t,e,n){return Cs.multiply(t,Cs.set(Cs.tmp_,1,0,0,1,e,n))},Cs.compose=function(t,e,n,i,r,o,a,s){var l=Math.sin(o),u=Math.cos(o);return t[0]=i*u,t[1]=r*l,t[2]=-i*l,t[3]=r*u,t[4]=a*i*u-s*i*l+e,t[5]=a*r*l+s*r*u+n,t},Cs.invert=function(t){var e=Cs.determinant(t);Qa.assert(0!==e,32);var n=t[0],i=t[1],r=t[2],o=t[3],a=t[4],s=t[5];return t[0]=o/e,t[1]=-i/e,t[2]=-r/e,t[3]=n/e,t[4]=(r*s-o*a)/e,t[5]=-(n*s-i*a)/e,t},Cs.determinant=function(t){return t[0]*t[3]-t[1]*t[2]};var bs=function(){La.call(this),this.extent_=hs.createEmpty(),this.extentRevision_=-1,this.simplifiedGeometryCache={},this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.tmpTransform_=Cs.create()};ya.inherits(bs,La),bs.prototype.clone=function(){},bs.prototype.closestPointXY=function(t,e,n,i){},bs.prototype.getClosestPoint=function(t,e){var n=e||[NaN,NaN];return this.closestPointXY(t[0],t[1],n,1/0),n},bs.prototype.intersectsCoordinate=function(t){return this.containsXY(t[0],t[1])},bs.prototype.computeExtent=function(t){},bs.prototype.containsXY=ps.FALSE,bs.prototype.getExtent=function(t){return this.extentRevision_!=this.getRevision()&&(this.extent_=this.computeExtent(this.extent_),this.extentRevision_=this.getRevision()),hs.returnOrUpdate(this.extent_,t)},bs.prototype.rotate=function(t,e){},bs.prototype.scale=function(t,e,n){},bs.prototype.simplify=function(t){return this.getSimplifiedGeometry(t*t)},bs.prototype.getSimplifiedGeometry=function(t){},bs.prototype.getType=function(){},bs.prototype.applyTransform=function(t){},bs.prototype.intersectsExtent=function(t){},bs.prototype.translate=function(t,e){},bs.prototype.transform=function(t,e){var n=this.tmpTransform_,i=(t=ws.get(t)).getUnits()==vs.TILE_PIXELS?function(i,r,o){var a=t.getExtent(),s=t.getWorldExtent(),l=hs.getHeight(s)/hs.getHeight(a);return Cs.compose(n,s[0],s[3],l,-l,0,0,0),gs.transform2D(i,0,i.length,o,n,r),ws.getTransform(t,e)(i,r,o)}:ws.getTransform(t,e);return this.applyTransform(i),this};var As=function(){bs.call(this),this.layout=fs.XY,this.stride=2,this.flatCoordinates=null};ya.inherits(As,bs),As.getLayoutForStride_=function(t){var e;return 2==t?e=fs.XY:3==t?e=fs.XYZ:4==t&&(e=fs.XYZM),e},As.getStrideForLayout=function(t){var e;return t==fs.XY?e=2:t==fs.XYZ||t==fs.XYM?e=3:t==fs.XYZM&&(e=4),e},As.prototype.containsXY=ps.FALSE,As.prototype.computeExtent=function(t){return hs.createOrUpdateFromFlatCoordinates(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)},As.prototype.getCoordinates=function(){},As.prototype.getFirstCoordinate=function(){return this.flatCoordinates.slice(0,this.stride)},As.prototype.getFlatCoordinates=function(){return this.flatCoordinates},As.prototype.getLastCoordinate=function(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)},As.prototype.getLayout=function(){return this.layout},As.prototype.getSimplifiedGeometry=function(t){if(this.simplifiedGeometryRevision!=this.getRevision()&&(Ea.clear(this.simplifiedGeometryCache),this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||0!==this.simplifiedGeometryMaxMinSquaredTolerance&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;var e=t.toString();if(this.simplifiedGeometryCache.hasOwnProperty(e))return this.simplifiedGeometryCache[e];var n=this.getSimplifiedGeometryInternal(t);return n.getFlatCoordinates().length<this.flatCoordinates.length?(this.simplifiedGeometryCache[e]=n,n):(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)},As.prototype.getSimplifiedGeometryInternal=function(t){return this},As.prototype.getStride=function(){return this.stride},As.prototype.setFlatCoordinatesInternal=function(t,e){this.stride=As.getStrideForLayout(t),this.layout=t,this.flatCoordinates=e},As.prototype.setCoordinates=function(t,e){},As.prototype.setLayout=function(t,e,n){var i;if(t)i=As.getStrideForLayout(t);else{var r;for(r=0;r<n;++r){if(0===e.length)return this.layout=fs.XY,void(this.stride=2);e=e[0]}i=e.length,t=As.getLayoutForStride_(i)}this.layout=t,this.stride=i},As.prototype.applyTransform=function(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.stride),this.changed())},As.prototype.rotate=function(t,e){var n=this.getFlatCoordinates();if(n){var i=this.getStride();gs.rotate(n,0,n.length,i,t,e,n),this.changed()}},As.prototype.scale=function(t,e,n){var i=e;void 0===i&&(i=t);var r=n;r||(r=hs.getCenter(this.getExtent()));var o=this.getFlatCoordinates();if(o){var a=this.getStride();gs.scale(o,0,o.length,a,t,i,r,o),this.changed()}},As.prototype.translate=function(t,e){var n=this.getFlatCoordinates();if(n){var i=this.getStride();gs.translate(n,0,n.length,i,t,e,n),this.changed()}},As.transform2D=function(t,e,n){var i=t.getFlatCoordinates();if(i){var r=t.getStride();return gs.transform2D(i,0,i.length,r,e,n)}return null};var Rs={};Rs.linearRing=function(t,e,n,i){for(var r=0,o=t[n-i],a=t[n-i+1];e<n;e+=i){var s=t[e],l=t[e+1];r+=a*s-o*l,o=s,a=l}return r/2},Rs.linearRings=function(t,e,n,i){var r,o,a=0;for(r=0,o=n.length;r<o;++r){var s=n[r];a+=Rs.linearRing(t,e,s,i),e=s}return a},Rs.linearRingss=function(t,e,n,i){var r,o,a=0;for(r=0,o=n.length;r<o;++r){var s=n[r];a+=Rs.linearRings(t,e,s,i),e=s[s.length-1]}return a};var Ls={};Ls.point=function(t,e,n,i,r,o,a){var s,l,u=t[e],c=t[e+1],h=t[n]-u,d=t[n+1]-c;if(0===h&&0===d)l=e;else{var f=((r-u)*h+(o-c)*d)/(h*h+d*d);if(f>1)l=n;else{if(f>0){for(s=0;s<i;++s)a[s]=ts.lerp(t[e+s],t[n+s],f);return void(a.length=i)}l=e}}for(s=0;s<i;++s)a[s]=t[l+s];a.length=i},Ls.getMaxSquaredDelta=function(t,e,n,i,r){var o=t[e],a=t[e+1];for(e+=i;e<n;e+=i){var s=t[e],l=t[e+1],u=ts.squaredDistance(o,a,s,l);u>r&&(r=u),o=s,a=l}return r},Ls.getsMaxSquaredDelta=function(t,e,n,i,r){var o,a;for(o=0,a=n.length;o<a;++o){var s=n[o];r=Ls.getMaxSquaredDelta(t,e,s,i,r),e=s}return r},Ls.getssMaxSquaredDelta=function(t,e,n,i,r){var o,a;for(o=0,a=n.length;o<a;++o){var s=n[o];r=Ls.getsMaxSquaredDelta(t,e,s,i,r),e=s[s.length-1]}return r},Ls.getClosestPoint=function(t,e,n,i,r,o,a,s,l,u,c){if(e==n)return u;var h,d;if(0===r){if((d=ts.squaredDistance(a,s,t[e],t[e+1]))<u){for(h=0;h<i;++h)l[h]=t[e+h];return l.length=i,d}return u}for(var f=c||[NaN,NaN],p=e+i;p<n;)if(Ls.point(t,p-i,p,i,a,s,f),(d=ts.squaredDistance(a,s,f[0],f[1]))<u){for(u=d,h=0;h<i;++h)l[h]=f[h];l.length=i,p+=i}else p+=i*Math.max((Math.sqrt(d)-Math.sqrt(u))/r|0,1);if(o&&(Ls.point(t,n-i,e,i,a,s,f),(d=ts.squaredDistance(a,s,f[0],f[1]))<u)){for(u=d,h=0;h<i;++h)l[h]=f[h];l.length=i}return u},Ls.getsClosestPoint=function(t,e,n,i,r,o,a,s,l,u,c){var h,d,f=c||[NaN,NaN];for(h=0,d=n.length;h<d;++h){var p=n[h];u=Ls.getClosestPoint(t,e,p,i,r,o,a,s,l,u,f),e=p}return u},Ls.getssClosestPoint=function(t,e,n,i,r,o,a,s,l,u,c){var h,d,f=c||[NaN,NaN];for(h=0,d=n.length;h<d;++h){var p=n[h];u=Ls.getsClosestPoint(t,e,p,i,r,o,a,s,l,u,f),e=p[p.length-1]}return u};var Is={};Is.coordinate=function(t,e,n,i){var r,o;for(r=0,o=n.length;r<o;++r)t[e++]=n[r];return e},Is.coordinates=function(t,e,n,i){var r,o;for(r=0,o=n.length;r<o;++r){var a,s=n[r];for(a=0;a<i;++a)t[e++]=s[a]}return e},Is.coordinatess=function(t,e,n,i,r){var o,a,s=r||[],l=0;for(o=0,a=n.length;o<a;++o){var u=Is.coordinates(t,e,n[o],i);s[l++]=u,e=u}return s.length=l,s},Is.coordinatesss=function(t,e,n,i,r){var o,a,s=r||[],l=0;for(o=0,a=n.length;o<a;++o){var u=Is.coordinatess(t,e,n[o],i,s[l]);s[l++]=u,e=u[u.length-1]}return s.length=l,s};var Ps={};Ps.coordinates=function(t,e,n,i,r){var o,a=void 0!==r?r:[],s=0;for(o=e;o<n;o+=i)a[s++]=t.slice(o,o+i);return a.length=s,a},Ps.coordinatess=function(t,e,n,i,r){var o,a,s=void 0!==r?r:[],l=0;for(o=0,a=n.length;o<a;++o){var u=n[o];s[l++]=Ps.coordinates(t,e,u,i,s[l]),e=u}return s.length=l,s},Ps.coordinatesss=function(t,e,n,i,r){var o,a,s=void 0!==r?r:[],l=0;for(o=0,a=n.length;o<a;++o){var u=n[o];s[l++]=Ps.coordinatess(t,e,u,i,s[l]),e=u[u.length-1]}return s.length=l,s};var Ms={};Ms.lineString=function(t,e,n,i,r,o,a){var s=void 0!==a?a:[];return o||(n=Ms.radialDistance(t,e,n,i,r,s,0),t=s,e=0,i=2),s.length=Ms.douglasPeucker(t,e,n,i,r,s,0),s},Ms.douglasPeucker=function(t,e,n,i,r,o,a){var s=(n-e)/i;if(s<3){for(;e<n;e+=i)o[a++]=t[e],o[a++]=t[e+1];return a}var l=new Array(s);l[0]=1,l[s-1]=1;for(var u,c=[e,n-i],h=0;c.length>0;){var d=c.pop(),f=c.pop(),p=0,g=t[f],_=t[f+1],v=t[d],y=t[d+1];for(u=f+i;u<d;u+=i){var m=t[u],x=t[u+1],S=ts.squaredSegmentDistance(m,x,g,_,v,y);S>p&&(h=u,p=S)}p>r&&(l[(h-e)/i]=1,f+i<h&&c.push(f,h),h+i<d&&c.push(h,d))}for(u=0;u<s;++u)l[u]&&(o[a++]=t[e+u*i],o[a++]=t[e+u*i+1]);return a},Ms.douglasPeuckers=function(t,e,n,i,r,o,a,s){var l,u;for(l=0,u=n.length;l<u;++l){var c=n[l];a=Ms.douglasPeucker(t,e,c,i,r,o,a),s.push(a),e=c}return a},Ms.douglasPeuckerss=function(t,e,n,i,r,o,a,s){var l,u;for(l=0,u=n.length;l<u;++l){var c=n[l],h=[];a=Ms.douglasPeuckers(t,e,c,i,r,o,a,h),s.push(h),e=c[c.length-1]}return a},Ms.radialDistance=function(t,e,n,i,r,o,a){if(n<=e+i){for(;e<n;e+=i)o[a++]=t[e],o[a++]=t[e+1];return a}var s=t[e],l=t[e+1];o[a++]=s,o[a++]=l;var u=s,c=l;for(e+=i;e<n;e+=i)u=t[e],c=t[e+1],ts.squaredDistance(s,l,u,c)>r&&(o[a++]=u,o[a++]=c,s=u,l=c);return u==s&&c==l||(o[a++]=u,o[a++]=c),a},Ms.snap=function(t,e){return e*Math.round(t/e)},Ms.quantize=function(t,e,n,i,r,o,a){if(e==n)return a;var s=Ms.snap(t[e],r),l=Ms.snap(t[e+1],r);e+=i,o[a++]=s,o[a++]=l;var u,c;do{if(u=Ms.snap(t[e],r),c=Ms.snap(t[e+1],r),(e+=i)==n)return o[a++]=u,o[a++]=c,a}while(u==s&&c==l);for(;e<n;){var h,d;if(h=Ms.snap(t[e],r),d=Ms.snap(t[e+1],r),e+=i,h!=u||d!=c){var f=u-s,p=c-l,g=h-s,_=d-l;f*_==p*g&&(f<0&&g<f||f==g||f>0&&g>f)&&(p<0&&_<p||p==_||p>0&&_>p)?(u=h,c=d):(o[a++]=u,o[a++]=c,s=u,l=c,u=h,c=d)}}return o[a++]=u,o[a++]=c,a},Ms.quantizes=function(t,e,n,i,r,o,a,s){var l,u;for(l=0,u=n.length;l<u;++l){var c=n[l];a=Ms.quantize(t,e,c,i,r,o,a),s.push(a),e=c}return a},Ms.quantizess=function(t,e,n,i,r,o,a,s){var l,u;for(l=0,u=n.length;l<u;++l){var c=n[l],h=[];a=Ms.quantizes(t,e,c,i,r,o,a,h),s.push(h),e=c[c.length-1]}return a};var Os=function(t,e){As.call(this),this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.setCoordinates(t,e)};ya.inherits(Os,As),Os.prototype.clone=function(){var t=new Os(null);return t.setFlatCoordinates(this.layout,this.flatCoordinates.slice()),t},Os.prototype.closestPointXY=function(t,e,n,i){return i<hs.closestSquaredDistanceXY(this.getExtent(),t,e)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Ls.getMaxSquaredDelta(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Ls.getClosestPoint(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,e,n,i))},Os.prototype.getArea=function(){return Rs.linearRing(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},Os.prototype.getCoordinates=function(){return Ps.coordinates(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},Os.prototype.getSimplifiedGeometryInternal=function(t){var e=[];e.length=Ms.douglasPeucker(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0);var n=new Os(null);return n.setFlatCoordinates(fs.XY,e),n},Os.prototype.getType=function(){return ds.LINEAR_RING},Os.prototype.intersectsExtent=function(t){},Os.prototype.setCoordinates=function(t,e){t?(this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Is.coordinates(this.flatCoordinates,0,t,this.stride),this.changed()):this.setFlatCoordinates(fs.XY,null)},Os.prototype.setFlatCoordinates=function(t,e){this.setFlatCoordinatesInternal(t,e),this.changed()};var Ds=function(t,e){As.call(this),this.setCoordinates(t,e)};ya.inherits(Ds,As),Ds.prototype.clone=function(){var t=new Ds(null);return t.setFlatCoordinates(this.layout,this.flatCoordinates.slice()),t},Ds.prototype.closestPointXY=function(t,e,n,i){var r=this.flatCoordinates,o=ts.squaredDistance(t,e,r[0],r[1]);if(o<i){var a,s=this.stride;for(a=0;a<s;++a)n[a]=r[a];return n.length=s,o}return i},Ds.prototype.getCoordinates=function(){return this.flatCoordinates?this.flatCoordinates.slice():[]},Ds.prototype.computeExtent=function(t){return hs.createOrUpdateFromCoordinate(this.flatCoordinates,t)},Ds.prototype.getType=function(){return ds.POINT},Ds.prototype.intersectsExtent=function(t){return hs.containsXY(t,this.flatCoordinates[0],this.flatCoordinates[1])},Ds.prototype.setCoordinates=function(t,e){t?(this.setLayout(e,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Is.coordinate(this.flatCoordinates,0,t,this.stride),this.changed()):this.setFlatCoordinates(fs.XY,null)},Ds.prototype.setFlatCoordinates=function(t,e){this.setFlatCoordinatesInternal(t,e),this.changed()};var Fs={};Fs.linearRingContainsExtent=function(t,e,n,i,r){return!hs.forEachCorner(r,function(r){return!Fs.linearRingContainsXY(t,e,n,i,r[0],r[1])})},Fs.linearRingContainsXY=function(t,e,n,i,r,o){for(var a=0,s=t[n-i],l=t[n-i+1];e<n;e+=i){var u=t[e],c=t[e+1];l<=o?c>o&&(u-s)*(o-l)-(r-s)*(c-l)>0&&a++:c<=o&&(u-s)*(o-l)-(r-s)*(c-l)<0&&a--,s=u,l=c}return 0!==a},Fs.linearRingsContainsXY=function(t,e,n,i,r,o){if(0===n.length)return!1;if(!Fs.linearRingContainsXY(t,e,n[0],i,r,o))return!1;var a,s;for(a=1,s=n.length;a<s;++a)if(Fs.linearRingContainsXY(t,n[a-1],n[a],i,r,o))return!1;return!0},Fs.linearRingssContainsXY=function(t,e,n,i,r,o){if(0===n.length)return!1;var a,s;for(a=0,s=n.length;a<s;++a){var l=n[a];if(Fs.linearRingsContainsXY(t,e,l,i,r,o))return!0;e=l[l.length-1]}return!1};var ks={};ks.linearRings=function(t,e,n,i,r,o,a){var s,l,u,c,h,d,f,p=r[o+1],g=[],_=n[0];for(c=t[_-i],d=t[_-i+1],s=e;s<_;s+=i)h=t[s],f=t[s+1],(p<=d&&f<=p||d<=p&&p<=f)&&(u=(p-d)/(f-d)*(h-c)+c,g.push(u)),c=h,d=f;var v=NaN,y=-1/0;for(g.sort(Ha.numberSafeCompareFunction),c=g[0],s=1,l=g.length;s<l;++s){h=g[s];var m=Math.abs(h-c);m>y&&(u=(c+h)/2,Fs.linearRingsContainsXY(t,e,n,i,u,p)&&(v=u,y=m)),c=h}return isNaN(v)&&(v=r[o]),a?(a.push(v,p,y),a):[v,p,y]},ks.linearRingss=function(t,e,n,i,r){var o,a,s=[];for(o=0,a=n.length;o<a;++o){var l=n[o];s=ks.linearRings(t,e,l,i,r,2*o,s),e=l[l.length-1]}return s};var Ns={};Ns.forEach=function(t,e,n,i,r,o){for(var a,s=[t[e],t[e+1]],l=[];e+i<n;e+=i){if(l[0]=t[e+i],l[1]=t[e+i+1],a=r.call(o,s,l))return a;s[0]=l[0],s[1]=l[1]}return!1};var Gs={};Gs.lineString=function(t,e,n,i,r){var o=hs.extendFlatCoordinates(hs.createEmpty(),t,e,n,i);return!!hs.intersects(r,o)&&(!!hs.containsExtent(r,o)||(o[0]>=r[0]&&o[2]<=r[2]||(o[1]>=r[1]&&o[3]<=r[3]||Ns.forEach(t,e,n,i,function(t,e){return hs.intersectsSegment(r,t,e)}))))},Gs.lineStrings=function(t,e,n,i,r){var o,a;for(o=0,a=n.length;o<a;++o){if(Gs.lineString(t,e,n[o],i,r))return!0;e=n[o]}return!1},Gs.linearRing=function(t,e,n,i,r){return!!Gs.lineString(t,e,n,i,r)||(!!Fs.linearRingContainsXY(t,e,n,i,r[0],r[1])||(!!Fs.linearRingContainsXY(t,e,n,i,r[0],r[3])||(!!Fs.linearRingContainsXY(t,e,n,i,r[2],r[1])||!!Fs.linearRingContainsXY(t,e,n,i,r[2],r[3]))))},Gs.linearRings=function(t,e,n,i,r){if(!Gs.linearRing(t,e,n[0],i,r))return!1;if(1===n.length)return!0;var o,a;for(o=1,a=n.length;o<a;++o)if(Fs.linearRingContainsExtent(t,n[o-1],n[o],i,r))return!1;return!0},Gs.linearRingss=function(t,e,n,i,r){var o,a;for(o=0,a=n.length;o<a;++o){var s=n[o];if(Gs.linearRings(t,e,s,i,r))return!0;e=s[s.length-1]}return!1};var Vs={};Vs.coordinates=function(t,e,n,i){for(;e<n-i;){var r;for(r=0;r<i;++r){var o=t[e+r];t[e+r]=t[n-i+r],t[n-i+r]=o}e+=i,n-=i}};var Us={};Us.linearRingIsClockwise=function(t,e,n,i){for(var r=0,o=t[n-i],a=t[n-i+1];e<n;e+=i){var s=t[e],l=t[e+1];r+=(s-o)*(l+a),o=s,a=l}return r>0},Us.linearRingsAreOriented=function(t,e,n,i,r){var o,a,s=void 0!==r&&r;for(o=0,a=n.length;o<a;++o){var l=n[o],u=Us.linearRingIsClockwise(t,e,l,i);if(0===o){if(s&&u||!s&&!u)return!1}else if(s&&!u||!s&&u)return!1;e=l}return!0},Us.linearRingssAreOriented=function(t,e,n,i,r){var o,a;for(o=0,a=n.length;o<a;++o)if(!Us.linearRingsAreOriented(t,e,n[o],i,r))return!1;return!0},Us.orientLinearRings=function(t,e,n,i,r){var o,a,s=void 0!==r&&r;for(o=0,a=n.length;o<a;++o){var l=n[o],u=Us.linearRingIsClockwise(t,e,l,i);(0===o?s&&u||!s&&!u:s&&!u||!s&&u)&&Vs.coordinates(t,e,l,i),e=l}return e},Us.orientLinearRingss=function(t,e,n,i,r){var o,a;for(o=0,a=n.length;o<a;++o)e=Us.orientLinearRings(t,e,n[o],i,r);return e};var Bs=function(t,e){As.call(this),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,this.setCoordinates(t,e)};ya.inherits(Bs,As),Bs.prototype.appendLinearRing=function(t){this.flatCoordinates?Ha.extend(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()},Bs.prototype.clone=function(){var t=new Bs(null);return t.setFlatCoordinates(this.layout,this.flatCoordinates.slice(),this.ends_.slice()),t},Bs.prototype.closestPointXY=function(t,e,n,i){return i<hs.closestSquaredDistanceXY(this.getExtent(),t,e)?i:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Ls.getsMaxSquaredDelta(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Ls.getsClosestPoint(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,e,n,i))},Bs.prototype.containsXY=function(t,e){return Fs.linearRingsContainsXY(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,e)},Bs.prototype.getArea=function(){return Rs.linearRings(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)},Bs.prototype.getCoordinates=function(t){var e;return void 0!==t?(e=this.getOrientedFlatCoordinates().slice(),Us.orientLinearRings(e,0,this.ends_,this.stride,t)):e=this.flatCoordinates,Ps.coordinatess(e,0,this.ends_,this.stride)},Bs.prototype.getEnds=function(){return this.ends_},Bs.prototype.getFlatInteriorPoint=function(){if(this.flatInteriorPointRevision_!=this.getRevision()){var t=hs.getCenter(this.getExtent());this.flatInteriorPoint_=ks.linearRings(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_},Bs.prototype.getInteriorPoint=function(){return new Ds(this.getFlatInteriorPoint(),fs.XYM)},Bs.prototype.getLinearRingCount=function(){return this.ends_.length},Bs.prototype.getLinearRing=function(t){if(t<0||this.ends_.length<=t)return null;var e=new Os(null);return e.setFlatCoordinates(this.layout,this.flatCoordinates.slice(0===t?0:this.ends_[t-1],this.ends_[t])),e},Bs.prototype.getLinearRings=function(){var t,e,n=this.layout,i=this.flatCoordinates,r=this.ends_,o=[],a=0;for(t=0,e=r.length;t<e;++t){var s=r[t],l=new Os(null);l.setFlatCoordinates(n,i.slice(a,s)),o.push(l),a=s}return o},Bs.prototype.getOrientedFlatCoordinates=function(){if(this.orientedRevision_!=this.getRevision()){var t=this.flatCoordinates;Us.linearRingsAreOriented(t,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=Us.orientLinearRings(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_},Bs.prototype.getSimplifiedGeometryInternal=function(t){var e=[],n=[];e.length=Ms.quantizes(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),e,0,n);var i=new Bs(null);return i.setFlatCoordinates(fs.XY,e,n),i},Bs.prototype.getType=function(){return ds.POLYGON},Bs.prototype.intersectsExtent=function(t){return Gs.linearRings(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)},Bs.prototype.setCoordinates=function(t,e){if(t){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);var n=Is.coordinatess(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=0===n.length?0:n[n.length-1],this.changed()}else this.setFlatCoordinates(fs.XY,null,this.ends_)},Bs.prototype.setFlatCoordinates=function(t,e,n){this.setFlatCoordinatesInternal(t,e),this.ends_=n,this.changed()},Bs.circular=function(t,e,n,i){var r,o=i||32,a=[];for(r=0;r<o;++r)Ha.extend(a,t.offset(e,n,2*Math.PI*r/o));a.push(a[0],a[1]);var s=new Bs(null);return s.setFlatCoordinates(fs.XY,a,[a.length]),s},Bs.fromExtent=function(t){var e=t[0],n=t[1],i=t[2],r=t[3],o=[e,n,e,r,i,r,i,n,e,n],a=new Bs(null);return a.setFlatCoordinates(fs.XY,o,[o.length]),a},Bs.fromCircle=function(t,e,n){for(var i=e||32,r=t.getStride(),o=t.getLayout(),a=new Bs(null,o),s=r*(i+1),l=new Array(s),u=0;u<s;u++)l[u]=0;var c=[l.length];return a.setFlatCoordinates(o,l,c),Bs.makeRegular(a,t.getCenter(),t.getRadius(),n),a},Bs.makeRegular=function(t,e,n,i){for(var r,o,a=t.getFlatCoordinates(),s=t.getLayout(),l=t.getStride(),u=t.getEnds(),c=a.length/l-1,h=i||0,d=0;d<=c;++d)o=d*l,r=h+2*ts.modulo(d,c)*Math.PI/c,a[o]=e[0]+n*Math.cos(r),a[o+1]=e[1]+n*Math.sin(r);t.setFlatCoordinates(s,a,u)};var zs=function(t){La.call(this);var e=Ea.assign({},t);this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.updateAnimations_=this.updateAnimations_.bind(this),this.projection_=ws.createProjection(e.projection,"EPSG:3857"),this.applyOptions_(e)};ya.inherits(zs,La),zs.prototype.applyOptions_=function(t){var e={};e[os.CENTER]=void 0!==t.center?t.center:null;var n=zs.createResolutionConstraint_(t);this.maxResolution_=n.maxResolution,this.minResolution_=n.minResolution,this.zoomFactor_=n.zoomFactor,this.resolutions_=t.resolutions,this.minZoom_=n.minZoom;var i=zs.createCenterConstraint_(t),r=n.constraint,o=zs.createRotationConstraint_(t);this.constraints_={center:i,resolution:r,rotation:o},void 0!==t.resolution?e[os.RESOLUTION]=t.resolution:void 0!==t.zoom&&(e[os.RESOLUTION]=this.constrainResolution(this.maxResolution_,t.zoom-this.minZoom_)),e[os.ROTATION]=void 0!==t.rotation?t.rotation:0,this.setProperties(e),this.options_=t},zs.prototype.getUpdatedOptions_=function(t){var e=Ea.assign({},this.options_);return void 0!==e.resolution?e.resolution=this.getResolution():e.zoom=this.getZoom(),e.center=this.getCenter(),e.rotation=this.getRotation(),Ea.assign({},e,t)},zs.prototype.animate=function(t){var e,n=arguments.length;if(n>1&&"function"==typeof arguments[n-1]&&(e=arguments[n-1],--n),!this.isDef()){var i=arguments[n-1];return i.center&&this.setCenter(i.center),void 0!==i.zoom&&this.setZoom(i.zoom),void 0!==i.rotation&&this.setRotation(i.rotation),void(e&&e(!0))}for(var r=Date.now(),o=this.getCenter().slice(),a=this.getResolution(),s=this.getRotation(),l=[],u=0;u<n;++u){var c=arguments[u],h={start:r,complete:!1,anchor:c.anchor,duration:void 0!==c.duration?c.duration:1e3,easing:c.easing||ls.inAndOut};if(c.center&&(h.sourceCenter=o,h.targetCenter=c.center,o=h.targetCenter),void 0!==c.zoom?(h.sourceResolution=a,h.targetResolution=this.constrainResolution(this.maxResolution_,c.zoom-this.minZoom_,0),a=h.targetResolution):c.resolution&&(h.sourceResolution=a,h.targetResolution=c.resolution,a=h.targetResolution),void 0!==c.rotation){h.sourceRotation=s;var d=ts.modulo(c.rotation-s+Math.PI,2*Math.PI)-Math.PI;h.targetRotation=s+d,s=h.targetRotation}h.callback=e,zs.isNoopAnimation(h)?h.complete=!0:r+=h.duration,l.push(h)}this.animations_.push(l),this.setHint(rs.ANIMATING,1),this.updateAnimations_()},zs.prototype.getAnimating=function(){return this.hints_[rs.ANIMATING]>0},zs.prototype.getInteracting=function(){return this.hints_[rs.INTERACTING]>0},zs.prototype.cancelAnimations=function(){this.setHint(rs.ANIMATING,-this.hints_[rs.ANIMATING]);for(var t=0,e=this.animations_.length;t<e;++t){var n=this.animations_[t];n[0].callback&&n[0].callback(!1)}this.animations_.length=0},zs.prototype.updateAnimations_=function(){if(void 0!==this.updateAnimationKey_&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),this.getAnimating()){for(var t=Date.now(),e=!1,n=this.animations_.length-1;n>=0;--n){for(var i=this.animations_[n],r=!0,o=0,a=i.length;o<a;++o){var s=i[o];if(!s.complete){var l=t-s.start,u=s.duration>0?l/s.duration:1;u>=1?(s.complete=!0,u=1):r=!1;var c=s.easing(u);if(s.sourceCenter){var h=s.sourceCenter[0],d=s.sourceCenter[1],f=h+c*(s.targetCenter[0]-h),p=d+c*(s.targetCenter[1]-d);this.set(os.CENTER,[f,p])}if(s.sourceResolution&&s.targetResolution){var g=1===c?s.targetResolution:s.sourceResolution+c*(s.targetResolution-s.sourceResolution);s.anchor&&this.set(os.CENTER,this.calculateCenterZoom(g,s.anchor)),this.set(os.RESOLUTION,g)}if(void 0!==s.sourceRotation&&void 0!==s.targetRotation){var _=1===c?ts.modulo(s.targetRotation+Math.PI,2*Math.PI)-Math.PI:s.sourceRotation+c*(s.targetRotation-s.sourceRotation);s.anchor&&this.set(os.CENTER,this.calculateCenterRotate(_,s.anchor)),this.set(os.ROTATION,_)}if(e=!0,!s.complete)break}}if(r){this.animations_[n]=null,this.setHint(rs.ANIMATING,-1);var v=i[0].callback;v&&v(!0)}}this.animations_=this.animations_.filter(Boolean),e&&void 0===this.updateAnimationKey_&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_))}},zs.prototype.calculateCenterRotate=function(t,e){var n,i=this.getCenter();return void 0!==i&&(n=[i[0]-e[0],i[1]-e[1]],ss.rotate(n,t-this.getRotation()),ss.add(n,e)),n},zs.prototype.calculateCenterZoom=function(t,e){var n,i=this.getCenter(),r=this.getResolution();return void 0!==i&&void 0!==r&&(n=[e[0]-t*(e[0]-i[0])/r,e[1]-t*(e[1]-i[1])/r]),n},zs.prototype.getSizeFromViewport_=function(){var t=[100,100],e='.ol-viewport[data-view="'+ya.getUid(this)+'"]',n=document.querySelector(e);if(n){var i=getComputedStyle(n);t[0]=parseInt(i.width,10),t[1]=parseInt(i.height,10)}return t},zs.prototype.constrainCenter=function(t){return this.constraints_.center(t)},zs.prototype.constrainResolution=function(t,e,n){var i=e||0,r=n||0;return this.constraints_.resolution(t,i,r)},zs.prototype.constrainRotation=function(t,e){var n=e||0;return this.constraints_.rotation(t,n)},zs.prototype.getCenter=function(){return this.get(os.CENTER)},zs.prototype.getConstraints=function(){return this.constraints_},zs.prototype.getHints=function(t){return void 0!==t?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()},zs.prototype.calculateExtent=function(t){var e=t||this.getSizeFromViewport_(),n=this.getCenter();Qa.assert(n,1);var i=this.getResolution();Qa.assert(void 0!==i,2);var r=this.getRotation();return Qa.assert(void 0!==r,3),hs.getForViewAndSize(n,i,r,e)},zs.prototype.getMaxResolution=function(){return this.maxResolution_},zs.prototype.getMinResolution=function(){return this.minResolution_},zs.prototype.getMaxZoom=function(){return this.getZoomForResolution(this.minResolution_)},zs.prototype.setMaxZoom=function(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))},zs.prototype.getMinZoom=function(){return this.getZoomForResolution(this.maxResolution_)},zs.prototype.setMinZoom=function(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))},zs.prototype.getProjection=function(){return this.projection_},zs.prototype.getResolution=function(){return this.get(os.RESOLUTION)},zs.prototype.getResolutions=function(){return this.resolutions_},zs.prototype.getResolutionForExtent=function(t,e){var n=e||this.getSizeFromViewport_(),i=hs.getWidth(t)/n[0],r=hs.getHeight(t)/n[1];return Math.max(i,r)},zs.prototype.getResolutionForValueFunction=function(t){var e=t||2,n=this.maxResolution_,i=this.minResolution_,r=Math.log(n/i)/Math.log(e);return function(t){return n/Math.pow(e,t*r)}},zs.prototype.getRotation=function(){return this.get(os.ROTATION)},zs.prototype.getValueForResolutionFunction=function(t){var e=t||2,n=this.maxResolution_,i=this.minResolution_,r=Math.log(n/i)/Math.log(e);return function(t){return Math.log(n/t)/Math.log(e)/r}},zs.prototype.getState=function(){var t=this.getCenter(),e=this.getProjection(),n=this.getResolution(),i=this.getRotation();return{center:t.slice(),projection:void 0!==e?e:null,resolution:n,rotation:i,zoom:this.getZoom()}},zs.prototype.getZoom=function(){var t,e=this.getResolution();return void 0!==e&&(t=this.getZoomForResolution(e)),t},zs.prototype.getZoomForResolution=function(t){var e,n,i=this.minZoom_||0;if(this.resolutions_){var r=Ha.linearFindNearest(this.resolutions_,t,1);i+=r,e=this.resolutions_[r],n=r==this.resolutions_.length-1?2:e/this.resolutions_[r+1]}else e=this.maxResolution_,n=this.zoomFactor_;return i+Math.log(e/t)/Math.log(n)},zs.prototype.getResolutionForZoom=function(t){return this.constrainResolution(this.maxResolution_,t-this.minZoom_,0)},zs.prototype.fit=function(t,e){var n=e||{},i=n.size;i||(i=this.getSizeFromViewport_());var r;t instanceof As?t.getType()===ds.CIRCLE?(t=t.getExtent(),(r=Bs.fromExtent(t)).rotate(this.getRotation(),hs.getCenter(t))):r=t:(Qa.assert(Array.isArray(t),24),Qa.assert(!hs.isEmpty(t),25),r=Bs.fromExtent(t));var o,a=void 0!==n.padding?n.padding:[0,0,0,0],s=void 0===n.constrainResolution||n.constrainResolution,l=void 0!==n.nearest&&n.nearest;o=void 0!==n.minResolution?n.minResolution:void 0!==n.maxZoom?this.constrainResolution(this.maxResolution_,n.maxZoom-this.minZoom_,0):0;for(var u=r.getFlatCoordinates(),c=this.getRotation(),h=Math.cos(-c),d=Math.sin(-c),f=1/0,p=1/0,g=-1/0,_=-1/0,v=r.getStride(),y=0,m=u.length;y<m;y+=v){var x=u[y]*h-u[y+1]*d,S=u[y]*d+u[y+1]*h;f=Math.min(f,x),p=Math.min(p,S),g=Math.max(g,x),_=Math.max(_,S)}var E=this.getResolutionForExtent([f,p,g,_],[i[0]-a[1]-a[3],i[1]-a[0]-a[2]]);if(E=isNaN(E)?o:Math.max(E,o),s){var T=this.constrainResolution(E,0,0);!l&&T<E&&(T=this.constrainResolution(T,-1,0)),E=T}d=-d;var w=(f+g)/2,C=(p+_)/2,b=[(w+=(a[1]-a[3])/2*E)*h-(C+=(a[0]-a[2])/2*E)*d,C*h+w*d],A=n.callback?n.callback:ya.nullFunction;void 0!==n.duration?this.animate({resolution:E,center:b,duration:n.duration,easing:n.easing},A):(this.setResolution(E),this.setCenter(b),setTimeout(A.bind(void 0,!0),0))},zs.prototype.centerOn=function(t,e,n){var i=this.getRotation(),r=Math.cos(-i),o=Math.sin(-i),a=t[0]*r-t[1]*o,s=t[1]*r+t[0]*o,l=this.getResolution(),u=(a+=(e[0]/2-n[0])*l)*r-(s+=(n[1]-e[1]/2)*l)*(o=-o),c=s*r+a*o;this.setCenter([u,c])},zs.prototype.isDef=function(){return!!this.getCenter()&&void 0!==this.getResolution()},zs.prototype.rotate=function(t,e){if(void 0!==e){var n=this.calculateCenterRotate(t,e);this.setCenter(n)}this.setRotation(t)},zs.prototype.setCenter=function(t){this.set(os.CENTER,t),this.getAnimating()&&this.cancelAnimations()},zs.prototype.setHint=function(t,e){return this.hints_[t]+=e,this.changed(),this.hints_[t]},zs.prototype.setResolution=function(t){this.set(os.RESOLUTION,t),this.getAnimating()&&this.cancelAnimations()},zs.prototype.setRotation=function(t){this.set(os.ROTATION,t),this.getAnimating()&&this.cancelAnimations()},zs.prototype.setZoom=function(t){this.setResolution(this.getResolutionForZoom(t))},zs.createCenterConstraint_=function(t){return void 0!==t.extent?es.createExtent(t.extent):es.none},zs.createResolutionConstraint_=function(t){var e,n,i,r=void 0!==t.minZoom?t.minZoom:ya.DEFAULT_MIN_ZOOM,o=void 0!==t.maxZoom?t.maxZoom:28,a=void 0!==t.zoomFactor?t.zoomFactor:2;if(void 0!==t.resolutions){var s=t.resolutions;n=s[0],i=s[s.length-1],e=ns.createSnapToResolutions(s)}else{var l=ws.createProjection(t.projection,"EPSG:3857"),u=l.getExtent(),c=(u?Math.max(hs.getWidth(u),hs.getHeight(u)):360*ws.METERS_PER_UNIT[vs.DEGREES]/l.getMetersPerUnit())/ya.DEFAULT_TILE_SIZE/Math.pow(2,ya.DEFAULT_MIN_ZOOM),h=c/Math.pow(2,28-ya.DEFAULT_MIN_ZOOM);void 0!==(n=t.maxResolution)?r=0:n=c/Math.pow(a,r),void 0===(i=t.minResolution)&&(i=void 0!==t.maxZoom?void 0!==t.maxResolution?n/Math.pow(a,o):c/Math.pow(a,o):h),o=r+Math.floor(Math.log(n/i)/Math.log(a)),i=n/Math.pow(a,o-r),e=ns.createSnapToPower(a,n,o-r)}return{constraint:e,maxResolution:n,minResolution:i,minZoom:r,zoomFactor:a}},zs.createRotationConstraint_=function(t){if(void 0===t.enableRotation||t.enableRotation){var e=t.constrainRotation;return void 0===e||!0===e?is.createSnapToZero():!1===e?is.none:"number"==typeof e?is.createSnapToN(e):is.none}return is.disable},zs.isNoopAnimation=function(t){return!(t.sourceCenter&&t.targetCenter&&!ss.equals(t.sourceCenter,t.targetCenter))&&(t.sourceResolution===t.targetResolution&&t.sourceRotation===t.targetRotation)};var Xs={};Xs.createCanvasContext2D=function(t,e){var n=document.createElement("CANVAS");return t&&(n.width=t),e&&(n.height=e),n.getContext("2d")},Xs.outerWidth=function(t){var e=t.offsetWidth,n=getComputedStyle(t);return e+=parseInt(n.marginLeft,10)+parseInt(n.marginRight,10)},Xs.outerHeight=function(t){var e=t.offsetHeight,n=getComputedStyle(t);return e+=parseInt(n.marginTop,10)+parseInt(n.marginBottom,10)},Xs.replaceNode=function(t,e){var n=e.parentNode;n&&n.replaceChild(t,e)},Xs.removeNode=function(t){return t&&t.parentNode?t.parentNode.removeChild(t):null},Xs.removeChildren=function(t){for(;t.lastChild;)t.removeChild(t.lastChild)};var Hs={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",SOURCE:"source"},Ws=function(t){La.call(this);var e=Ea.assign({},t);e[Hs.OPACITY]=void 0!==t.opacity?t.opacity:1,e[Hs.VISIBLE]=void 0===t.visible||t.visible,e[Hs.Z_INDEX]=void 0!==t.zIndex?t.zIndex:0,e[Hs.MAX_RESOLUTION]=void 0!==t.maxResolution?t.maxResolution:1/0,e[Hs.MIN_RESOLUTION]=void 0!==t.minResolution?t.minResolution:0,this.setProperties(e),this.state_={layer:this,managed:!0},this.type};ya.inherits(Ws,La),Ws.prototype.getType=function(){return this.type},Ws.prototype.getLayerState=function(){return this.state_.opacity=ts.clamp(this.getOpacity(),0,1),this.state_.sourceState=this.getSourceState(),this.state_.visible=this.getVisible(),this.state_.extent=this.getExtent(),this.state_.zIndex=this.getZIndex(),this.state_.maxResolution=this.getMaxResolution(),this.state_.minResolution=Math.max(this.getMinResolution(),0),this.state_},Ws.prototype.getLayersArray=function(t){},Ws.prototype.getLayerStatesArray=function(t){},Ws.prototype.getExtent=function(){return this.get(Hs.EXTENT)},Ws.prototype.getMaxResolution=function(){return this.get(Hs.MAX_RESOLUTION)},Ws.prototype.getMinResolution=function(){return this.get(Hs.MIN_RESOLUTION)},Ws.prototype.getOpacity=function(){return this.get(Hs.OPACITY)},Ws.prototype.getSourceState=function(){},Ws.prototype.getVisible=function(){return this.get(Hs.VISIBLE)},Ws.prototype.getZIndex=function(){return this.get(Hs.Z_INDEX)},Ws.prototype.setExtent=function(t){this.set(Hs.EXTENT,t)},Ws.prototype.setMaxResolution=function(t){this.set(Hs.MAX_RESOLUTION,t)},Ws.prototype.setMinResolution=function(t){this.set(Hs.MIN_RESOLUTION,t)},Ws.prototype.setOpacity=function(t){this.set(Hs.OPACITY,t)},Ws.prototype.setVisible=function(t){this.set(Hs.VISIBLE,t)},Ws.prototype.setZIndex=function(t){this.set(Hs.Z_INDEX,t)};var Ys={UNDEFINED:"undefined",LOADING:"loading",READY:"ready",ERROR:"error"},js=function(t){var e=t||{},n=Ea.assign({},e);delete n.layers;var i=e.layers;Ws.call(this,n),this.layersListenerKeys_=[],this.listenerKeys_={},Ta.listen(this,La.getChangeEventType(js.Property_.LAYERS),this.handleLayersChanged_,this),i?Array.isArray(i)?i=new Ia(i.slice(),{unique:!0}):(Qa.assert(i instanceof Ia,43),i=i):i=new Ia(void 0,{unique:!0}),this.setLayers(i)};ya.inherits(js,Ws),js.prototype.handleLayerChange_=function(){this.changed()},js.prototype.handleLayersChanged_=function(t){this.layersListenerKeys_.forEach(Ta.unlistenByKey),this.layersListenerKeys_.length=0;var e=this.getLayers();this.layersListenerKeys_.push(Ta.listen(e,xa.ADD,this.handleLayersAdd_,this),Ta.listen(e,xa.REMOVE,this.handleLayersRemove_,this));for(var n in this.listenerKeys_)this.listenerKeys_[n].forEach(Ta.unlistenByKey);Ea.clear(this.listenerKeys_);var i,r,o,a=e.getArray();for(i=0,r=a.length;i<r;i++)o=a[i],this.listenerKeys_[ya.getUid(o).toString()]=[Ta.listen(o,Sa.PROPERTYCHANGE,this.handleLayerChange_,this),Ta.listen(o,Aa.CHANGE,this.handleLayerChange_,this)];this.changed()},js.prototype.handleLayersAdd_=function(t){var e=t.element,n=ya.getUid(e).toString();this.listenerKeys_[n]=[Ta.listen(e,Sa.PROPERTYCHANGE,this.handleLayerChange_,this),Ta.listen(e,Aa.CHANGE,this.handleLayerChange_,this)],this.changed()},js.prototype.handleLayersRemove_=function(t){var e=t.element,n=ya.getUid(e).toString();this.listenerKeys_[n].forEach(Ta.unlistenByKey),delete this.listenerKeys_[n],this.changed()},js.prototype.getLayers=function(){return this.get(js.Property_.LAYERS)},js.prototype.setLayers=function(t){this.set(js.Property_.LAYERS,t)},js.prototype.getLayersArray=function(t){var e=void 0!==t?t:[];return this.getLayers().forEach(function(t){t.getLayersArray(e)}),e},js.prototype.getLayerStatesArray=function(t){var e=void 0!==t?t:[],n=e.length;this.getLayers().forEach(function(t){t.getLayerStatesArray(e)});var i,r,o,a=this.getLayerState();for(i=n,r=e.length;i<r;i++)(o=e[i]).opacity*=a.opacity,o.visible=o.visible&&a.visible,o.maxResolution=Math.min(o.maxResolution,a.maxResolution),o.minResolution=Math.max(o.minResolution,a.minResolution),void 0!==a.extent&&(void 0!==o.extent?o.extent=hs.getIntersection(o.extent,a.extent):o.extent=a.extent);return e},js.prototype.getSourceState=function(){return Ys.READY},js.Property_={LAYERS:"layers"};var Ks={MAP_RENDERER:"MAP_RENDERER",LAYER_RENDERER:"LAYER_RENDERER"},qs={};qs.mapRendererPlugins_=[],qs.getMapRendererPlugins=function(){return qs.mapRendererPlugins_},qs.layerRendererPlugins_=[],qs.getLayerRendererPlugins=function(){return qs.layerRendererPlugins_},qs.register=function(t,e){switch(t){case Ks.MAP_RENDERER:qs.mapRendererPlugins_.push(e);break;case Ks.LAYER_RENDERER:qs.layerRendererPlugins_.push(e);break;default:throw new Error("Unsupported plugin type: "+t)}},qs.registerMultiple=function(t,e){for(var n=0,i=e.length;n<i;++n)qs.register(t,e[n])};var Zs={CANVAS:"canvas",WEBGL:"webgl"},Qs={};Qs.buffer=function(t,e,n){return void 0===n&&(n=[0,0]),n[0]=t[0]+2*e,n[1]=t[1]+2*e,n},Qs.hasArea=function(t){return t[0]>0&&t[1]>0},Qs.scale=function(t,e,n){return void 0===n&&(n=[0,0]),n[0]=t[0]*e+.5|0,n[1]=t[1]*e+.5|0,n},Qs.toSize=function(t,e){return Array.isArray(t)?t:(void 0===e?e=[t,t]:e[0]=e[1]=t,e)};var Js=function(t){La.call(this);var e=Js.createOptionsInternal(t);this.loadTilesWhileAnimating_=void 0!==t.loadTilesWhileAnimating&&t.loadTilesWhileAnimating,this.loadTilesWhileInteracting_=void 0!==t.loadTilesWhileInteracting&&t.loadTilesWhileInteracting,this.pixelRatio_=void 0!==t.pixelRatio?t.pixelRatio:Da.DEVICE_PIXEL_RATIO,this.logos_=e.logos,this.animationDelayKey_,this.animationDelay_=function(){this.animationDelayKey_=void 0,this.renderFrame_.call(this,Date.now())}.bind(this),this.coordinateToPixelTransform_=Cs.create(),this.pixelToCoordinateTransform_=Cs.create(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,this.viewport_=document.createElement("DIV"),this.viewport_.className="ol-viewport"+(Da.TOUCH?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.viewport_.style.msTouchAction="none",this.viewport_.style.touchAction="none",this.overlayContainer_=document.createElement("DIV"),this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("DIV"),this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent";for(var n=[Aa.CLICK,Aa.DBLCLICK,Aa.MOUSEDOWN,Aa.TOUCHSTART,Aa.MSPOINTERDOWN,ka.POINTERDOWN,Aa.MOUSEWHEEL,Aa.WHEEL],i=0,r=n.length;i<r;++i)Ta.listen(this.overlayContainerStopEvent_,n[i],Ca.stopPropagation);this.viewport_.appendChild(this.overlayContainerStopEvent_),this.mapBrowserEventHandler_=new ja(this,t.moveTolerance);for(var o in ka)Ta.listen(this.mapBrowserEventHandler_,ka[o],this.handleMapBrowserEvent,this);this.keyboardEventTarget_=e.keyboardEventTarget,this.keyHandlerKeys_=null,Ta.listen(this.viewport_,Aa.WHEEL,this.handleBrowserEvent,this),Ta.listen(this.viewport_,Aa.MOUSEWHEEL,this.handleBrowserEvent,this),this.controls=e.controls||new Ia,this.interactions=e.interactions||new Ia,this.overlays_=e.overlays,this.overlayIdIndex_={},this.renderer_=e.mapRendererPlugin.create(this.viewport_,this),this.handleResize_,this.focus_=null,this.postRenderFunctions_=[],this.tileQueue_=new $a(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.skippedFeatureUids_={},Ta.listen(this,La.getChangeEventType(qa.LAYERGROUP),this.handleLayerGroupChanged_,this),Ta.listen(this,La.getChangeEventType(qa.VIEW),this.handleViewChanged_,this),Ta.listen(this,La.getChangeEventType(qa.SIZE),this.handleSizeChanged_,this),Ta.listen(this,La.getChangeEventType(qa.TARGET),this.handleTargetChanged_,this),this.setProperties(e.values),this.controls.forEach(function(t){t.setMap(this)},this),Ta.listen(this.controls,xa.ADD,function(t){t.element.setMap(this)},this),Ta.listen(this.controls,xa.REMOVE,function(t){t.element.setMap(null)},this),this.interactions.forEach(function(t){t.setMap(this)},this),Ta.listen(this.interactions,xa.ADD,function(t){t.element.setMap(this)},this),Ta.listen(this.interactions,xa.REMOVE,function(t){t.element.setMap(null)},this),this.overlays_.forEach(this.addOverlayInternal_,this),Ta.listen(this.overlays_,xa.ADD,function(t){this.addOverlayInternal_(t.element)},this),Ta.listen(this.overlays_,xa.REMOVE,function(t){var e=t.element.getId();void 0!==e&&delete this.overlayIdIndex_[e.toString()],t.element.setMap(null)},this)};ya.inherits(Js,La),Js.prototype.addControl=function(t){this.getControls().push(t)},Js.prototype.addInteraction=function(t){this.getInteractions().push(t)},Js.prototype.addLayer=function(t){this.getLayerGroup().getLayers().push(t)},Js.prototype.addOverlay=function(t){this.getOverlays().push(t)},Js.prototype.addOverlayInternal_=function(t){var e=t.getId();void 0!==e&&(this.overlayIdIndex_[e.toString()]=t),t.setMap(this)},Js.prototype.disposeInternal=function(){this.mapBrowserEventHandler_.dispose(),this.renderer_.dispose(),Ta.unlisten(this.viewport_,Aa.WHEEL,this.handleBrowserEvent,this),Ta.unlisten(this.viewport_,Aa.MOUSEWHEEL,this.handleBrowserEvent,this),void 0!==this.handleResize_&&(window.removeEventListener(Aa.RESIZE,this.handleResize_,!1),this.handleResize_=void 0),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0),this.setTarget(null),La.prototype.disposeInternal.call(this)},Js.prototype.forEachFeatureAtPixel=function(t,e,n){if(this.frameState_){var i=this.getCoordinateFromPixel(t),r=void 0!==(n=void 0!==n?n:{}).hitTolerance?n.hitTolerance*this.frameState_.pixelRatio:0,o=void 0!==n.layerFilter?n.layerFilter:ps.TRUE;return this.renderer_.forEachFeatureAtCoordinate(i,this.frameState_,r,e,null,o,null)}},Js.prototype.getFeaturesAtPixel=function(t,e){var n=null;return this.forEachFeatureAtPixel(t,function(t){n||(n=[]),n.push(t)},e),n},Js.prototype.forEachLayerAtPixel=function(t,e,n,i,r){if(this.frameState_){var o=void 0!==n?n:null,a=void 0!==i?i:ps.TRUE,s=void 0!==r?r:null;return this.renderer_.forEachLayerAtPixel(t,this.frameState_,e,o,a,s)}},Js.prototype.hasFeatureAtPixel=function(t,e){if(!this.frameState_)return!1;var n=this.getCoordinateFromPixel(t),i=void 0!==(e=void 0!==e?e:{}).layerFilter?e.layerFilter:ps.TRUE,r=void 0!==e.hitTolerance?e.hitTolerance*this.frameState_.pixelRatio:0;return this.renderer_.hasFeatureAtCoordinate(n,this.frameState_,r,i,null)},Js.prototype.getEventCoordinate=function(t){return this.getCoordinateFromPixel(this.getEventPixel(t))},Js.prototype.getEventPixel=function(t){var e=this.viewport_.getBoundingClientRect(),n=t.changedTouches?t.changedTouches[0]:t;return[n.clientX-e.left,n.clientY-e.top]},Js.prototype.getTarget=function(){return this.get(qa.TARGET)},Js.prototype.getTargetElement=function(){var t=this.getTarget();return void 0!==t?"string"==typeof t?document.getElementById(t):t:null},Js.prototype.getCoordinateFromPixel=function(t){var e=this.frameState_;return e?Cs.apply(e.pixelToCoordinateTransform,t.slice()):null},Js.prototype.getControls=function(){return this.controls},Js.prototype.getOverlays=function(){return this.overlays_},Js.prototype.getOverlayById=function(t){var e=this.overlayIdIndex_[t.toString()];return void 0!==e?e:null},Js.prototype.getInteractions=function(){return this.interactions},Js.prototype.getLayerGroup=function(){return this.get(qa.LAYERGROUP)},Js.prototype.getLayers=function(){return this.getLayerGroup().getLayers()},Js.prototype.getPixelFromCoordinate=function(t){var e=this.frameState_;return e?Cs.apply(e.coordinateToPixelTransform,t.slice(0,2)):null},Js.prototype.getRenderer=function(){return this.renderer_},Js.prototype.getSize=function(){return this.get(qa.SIZE)},Js.prototype.getView=function(){return this.get(qa.VIEW)},Js.prototype.getViewport=function(){return this.viewport_},Js.prototype.getOverlayContainer=function(){return this.overlayContainer_},Js.prototype.getOverlayContainerStopEvent=function(){return this.overlayContainerStopEvent_},Js.prototype.getTilePriority=function(t,e,n,i){var r=this.frameState_;if(!(r&&e in r.wantedTiles))return Ja.DROP;if(!r.wantedTiles[e][t.getKey()])return Ja.DROP;var o=n[0]-r.focus[0],a=n[1]-r.focus[1];return 65536*Math.log(i)+Math.sqrt(o*o+a*a)/i},Js.prototype.handleBrowserEvent=function(t,e){var n=e||t.type,i=new Ma(n,this,t);this.handleMapBrowserEvent(i)},Js.prototype.handleMapBrowserEvent=function(t){if(this.frameState_){this.focus_=t.coordinate,t.frameState=this.frameState_;var e,n=this.getInteractions().getArray();if(!1!==this.dispatchEvent(t))for(e=n.length-1;e>=0;e--){var i=n[e];if(i.getActive()&&!i.handleEvent(t))break}}},Js.prototype.handlePostRender=function(){var t=this.frameState_,e=this.tileQueue_;if(!e.isEmpty()){var n=16,i=n;if(t){var r=t.viewHints;r[rs.ANIMATING]&&(n=this.loadTilesWhileAnimating_?8:0,i=2),r[rs.INTERACTING]&&(n=this.loadTilesWhileInteracting_?8:0,i=2)}e.getTilesLoading()<n&&(e.reprioritize(),e.loadMoreTiles(n,i))}var o,a,s=this.postRenderFunctions_;for(o=0,a=s.length;o<a;++o)s[o](this,t);s.length=0},Js.prototype.handleSizeChanged_=function(){this.render()},Js.prototype.handleTargetChanged_=function(){var t;if(this.getTarget()&&(t=this.getTargetElement()),this.keyHandlerKeys_){for(var e=0,n=this.keyHandlerKeys_.length;e<n;++e)Ta.unlistenByKey(this.keyHandlerKeys_[e]);this.keyHandlerKeys_=null}if(t){t.appendChild(this.viewport_);var i=this.keyboardEventTarget_?this.keyboardEventTarget_:t;this.keyHandlerKeys_=[Ta.listen(i,Aa.KEYDOWN,this.handleBrowserEvent,this),Ta.listen(i,Aa.KEYPRESS,this.handleBrowserEvent,this)],this.handleResize_||(this.handleResize_=this.updateSize.bind(this),window.addEventListener(Aa.RESIZE,this.handleResize_,!1))}else Xs.removeNode(this.viewport_),void 0!==this.handleResize_&&(window.removeEventListener(Aa.RESIZE,this.handleResize_,!1),this.handleResize_=void 0);this.updateSize()},Js.prototype.handleTileChange_=function(){this.render()},Js.prototype.handleViewPropertyChanged_=function(){this.render()},Js.prototype.handleViewChanged_=function(){this.viewPropertyListenerKey_&&(Ta.unlistenByKey(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(Ta.unlistenByKey(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);var t=this.getView();t&&(this.viewport_.setAttribute("data-view",ya.getUid(t)),this.viewPropertyListenerKey_=Ta.listen(t,Sa.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=Ta.listen(t,Aa.CHANGE,this.handleViewPropertyChanged_,this)),this.render()},Js.prototype.handleLayerGroupChanged_=function(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(Ta.unlistenByKey),this.layerGroupPropertyListenerKeys_=null);var t=this.getLayerGroup();t&&(this.layerGroupPropertyListenerKeys_=[Ta.listen(t,Sa.PROPERTYCHANGE,this.render,this),Ta.listen(t,Aa.CHANGE,this.render,this)]),this.render()},Js.prototype.isRendered=function(){return!!this.frameState_},Js.prototype.renderSync=function(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()},Js.prototype.render=function(){void 0===this.animationDelayKey_&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))},Js.prototype.removeControl=function(t){return this.getControls().remove(t)},Js.prototype.removeInteraction=function(t){return this.getInteractions().remove(t)},Js.prototype.removeLayer=function(t){return this.getLayerGroup().getLayers().remove(t)},Js.prototype.removeOverlay=function(t){return this.getOverlays().remove(t)},Js.prototype.renderFrame_=function(t){var e,n,i,r=this.getSize(),o=this.getView(),a=hs.createEmpty(),s=this.frameState_,l=null;if(void 0!==r&&Qs.hasArea(r)&&o&&o.isDef()){var u=o.getHints(this.frameState_?this.frameState_.viewHints:void 0),c=this.getLayerGroup().getLayerStatesArray(),h={};for(e=0,n=c.length;e<n;++e)h[ya.getUid(c[e].layer)]=c[e];i=o.getState(),l={animate:!1,attributions:{},coordinateToPixelTransform:this.coordinateToPixelTransform_,extent:a,focus:this.focus_?this.focus_:i.center,index:this.frameIndex_++,layerStates:h,layerStatesArray:c,logos:Ea.assign({},this.logos_),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:r,skippedFeatureUids:this.skippedFeatureUids_,tileQueue:this.tileQueue_,time:t,usedTiles:{},viewState:i,viewHints:u,wantedTiles:{}}}l&&(l.extent=hs.getForViewAndSize(i.center,i.resolution,i.rotation,l.size,a)),this.frameState_=l,this.renderer_.renderFrame(l),l&&(l.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,l.postRenderFunctions),s&&(!this.previousExtent_||!hs.isEmpty(this.previousExtent_)&&!hs.equals(l.extent,this.previousExtent_))&&(this.dispatchEvent(new Pa(Ka.MOVESTART,this,s)),this.previousExtent_=hs.createOrUpdateEmpty(this.previousExtent_)),this.previousExtent_&&!l.viewHints[rs.ANIMATING]&&!l.viewHints[rs.INTERACTING]&&!hs.equals(l.extent,this.previousExtent_)&&(this.dispatchEvent(new Pa(Ka.MOVEEND,this,l)),hs.clone(l.extent,this.previousExtent_))),this.dispatchEvent(new Pa(Ka.POSTRENDER,this,l)),setTimeout(this.handlePostRender.bind(this),0)},Js.prototype.setLayerGroup=function(t){this.set(qa.LAYERGROUP,t)},Js.prototype.setSize=function(t){this.set(qa.SIZE,t)},Js.prototype.setTarget=function(t){this.set(qa.TARGET,t)},Js.prototype.setView=function(t){this.set(qa.VIEW,t)},Js.prototype.skipFeature=function(t){var e=ya.getUid(t).toString();this.skippedFeatureUids_[e]=!0,this.render()},Js.prototype.updateSize=function(){var t=this.getTargetElement();if(t){var e=getComputedStyle(t);this.setSize([t.offsetWidth-parseFloat(e.borderLeftWidth)-parseFloat(e.paddingLeft)-parseFloat(e.paddingRight)-parseFloat(e.borderRightWidth),t.offsetHeight-parseFloat(e.borderTopWidth)-parseFloat(e.paddingTop)-parseFloat(e.paddingBottom)-parseFloat(e.borderBottomWidth)])}else this.setSize(void 0)},Js.prototype.unskipFeature=function(t){var e=ya.getUid(t).toString();delete this.skippedFeatureUids_[e],this.render()},Js.DEFAULT_RENDERER_TYPES=[Zs.CANVAS,Zs.WEBGL],Js.LOGO_URL="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAA3NCSVQICAjb4U/gAAAACXBIWXMAAAHGAAABxgEXwfpGAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAAhNQTFRF////AP//AICAgP//AFVVQECA////K1VVSbbbYL/fJ05idsTYJFtbbcjbJllmZszWWMTOIFhoHlNiZszTa9DdUcHNHlNlV8XRIVdiasrUHlZjIVZjaMnVH1RlIFRkH1RkH1ZlasvYasvXVsPQH1VkacnVa8vWIVZjIFRjVMPQa8rXIVVkXsXRsNveIFVkIFZlIVVj3eDeh6GmbMvXH1ZkIFRka8rWbMvXIFVkIFVjIFVkbMvWH1VjbMvWIFVlbcvWIFVla8vVIFVkbMvWbMvVH1VkbMvWIFVlbcvWIFVkbcvVbMvWjNPbIFVkU8LPwMzNIFVkbczWIFVkbsvWbMvXIFVkRnB8bcvW2+TkW8XRIFVkIlZlJVloJlpoKlxrLl9tMmJwOWd0Omh1RXF8TneCT3iDUHiDU8LPVMLPVcLPVcPQVsPPVsPQV8PQWMTQWsTQW8TQXMXSXsXRX4SNX8bSYMfTYcfTYsfTY8jUZcfSZsnUaIqTacrVasrVa8jTa8rWbI2VbMvWbcvWdJObdcvUdszUd8vVeJaee87Yfc3WgJyjhqGnitDYjaarldPZnrK2oNbborW5o9bbo9fbpLa6q9ndrL3ArtndscDDutzfu8fJwN7gwt7gxc/QyuHhy+HizeHi0NfX0+Pj19zb1+Tj2uXk29/e3uLg3+Lh3+bl4uXj4ufl4+fl5Ofl5ufl5ujm5+jmySDnBAAAAFp0Uk5TAAECAgMEBAYHCA0NDg4UGRogIiMmKSssLzU7PkJJT1JTVFliY2hrdHZ3foSFhYeJjY2QkpugqbG1tre5w8zQ09XY3uXn6+zx8vT09vf4+Pj5+fr6/P39/f3+gz7SsAAAAVVJREFUOMtjYKA7EBDnwCPLrObS1BRiLoJLnte6CQy8FLHLCzs2QUG4FjZ5GbcmBDDjxJBXDWxCBrb8aM4zbkIDzpLYnAcE9VXlJSWlZRU13koIeW57mGx5XjoMZEUqwxWYQaQbSzLSkYGfKFSe0QMsX5WbjgY0YS4MBplemI4BdGBW+DQ11eZiymfqQuXZIjqwyadPNoSZ4L+0FVM6e+oGI6g8a9iKNT3o8kVzNkzRg5lgl7p4wyRUL9Yt2jAxVh6mQCogae6GmflI8p0r13VFWTHBQ0rWPW7ahgWVcPm+9cuLoyy4kCJDzCm6d8PSFoh0zvQNC5OjDJhQopPPJqph1doJBUD5tnkbZiUEqaCnB3bTqLTFG1bPn71kw4b+GFdpLElKIzRxxgYgWNYc5SCENVHKeUaltHdXx0dZ8uBI1hJ2UUDgq82CM2MwKeibqAvSO7MCABq0wXEPiqWEAAAAAElFTkSuQmCC",Js.createOptionsInternal=function(t){var e=null;void 0!==t.keyboardEventTarget&&(e="string"==typeof t.keyboardEventTarget?document.getElementById(t.keyboardEventTarget):t.keyboardEventTarget);var n={},i={};if(void 0===t.logo||"boolean"==typeof t.logo&&t.logo)i[Js.LOGO_URL]="https://openlayers.org/";else{var r=t.logo;"string"==typeof r?i[r]="":r instanceof HTMLElement?i[ya.getUid(r).toString()]=r:r&&(Qa.assert("string"==typeof r.href,44),Qa.assert("string"==typeof r.src,45),i[r.src]=r.href)}var o=t.layers instanceof js?t.layers:new js({layers:t.layers});n[qa.LAYERGROUP]=o,n[qa.TARGET]=t.target,n[qa.VIEW]=void 0!==t.view?t.view:new zs;var a;void 0!==t.renderer?(Array.isArray(t.renderer)?a=t.renderer:"string"==typeof t.renderer?a=[t.renderer]:Qa.assert(!1,46),a.indexOf("dom")>=0&&(a=a.concat(Js.DEFAULT_RENDERER_TYPES))):a=Js.DEFAULT_RENDERER_TYPES;var s,l=qs.getMapRendererPlugins();t:for(var u=0,c=a.length;u<c;++u)for(var h=a[u],d=0,f=l.length;d<f;++d){var p=l[d];if(p.handles(h)){s=p;break t}}if(!s)throw new Error("Unable to create a map renderer for types: "+a.join(", "));var g;void 0!==t.controls&&(Array.isArray(t.controls)?g=new Ia(t.controls.slice()):(Qa.assert(t.controls instanceof Ia,47),g=t.controls));var _;void 0!==t.interactions&&(Array.isArray(t.interactions)?_=new Ia(t.interactions.slice()):(Qa.assert(t.interactions instanceof Ia,48),_=t.interactions));var v;return void 0!==t.overlays?Array.isArray(t.overlays)?v=new Ia(t.overlays.slice()):(Qa.assert(t.overlays instanceof Ia,49),v=t.overlays):v=new Ia,{controls:g,interactions:_,keyboardEventTarget:e,logos:i,overlays:v,mapRendererPlugin:s,values:n}};var $s=function(t){La.call(this),this.element=t.element?t.element:null,this.target_=null,this.map_=null,this.listenerKeys=[],this.render=t.render?t.render:ya.nullFunction,t.target&&this.setTarget(t.target)};ya.inherits($s,La),$s.prototype.disposeInternal=function(){Xs.removeNode(this.element),La.prototype.disposeInternal.call(this)},$s.prototype.getMap=function(){return this.map_},$s.prototype.setMap=function(t){this.map_&&Xs.removeNode(this.element);for(var e=0,n=this.listenerKeys.length;e<n;++e)Ta.unlistenByKey(this.listenerKeys[e]);this.listenerKeys.length=0,this.map_=t,this.map_&&((this.target_?this.target_:t.getOverlayContainerStopEvent()).appendChild(this.element),this.render!==ya.nullFunction&&this.listenerKeys.push(Ta.listen(t,Ka.POSTRENDER,this.render,this)),t.render())},$s.prototype.setTarget=function(t){this.target_="string"==typeof t?document.getElementById(t):t};var tl={};tl.CLASS_HIDDEN="ol-hidden",tl.CLASS_SELECTABLE="ol-selectable",tl.CLASS_UNSELECTABLE="ol-unselectable",tl.CLASS_UNSUPPORTED="ol-unsupported",tl.CLASS_CONTROL="ol-control",tl.getFontFamilies=function(){var t,e={};return function(n){if(t||(t=document.createElement("div").style),!(n in e)){t.font=n;var i=t.fontFamily;if(t.font="",!i)return null;e[n]=i.split(/,\s?/)}return e[n]}}();var el={POSTCOMPOSE:"postcompose",PRECOMPOSE:"precompose",RENDER:"render"},nl=function(t){var e=Ea.assign({},t);delete e.source,Ws.call(this,e),this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,t.map&&this.setMap(t.map),Ta.listen(this,La.getChangeEventType(Hs.SOURCE),this.handleSourcePropertyChange_,this);var n=t.source?t.source:null;this.setSource(n)};ya.inherits(nl,Ws),nl.visibleAtResolution=function(t,e){return t.visible&&e>=t.minResolution&&e<t.maxResolution},nl.prototype.getLayersArray=function(t){var e=t||[];return e.push(this),e},nl.prototype.getLayerStatesArray=function(t){var e=t||[];return e.push(this.getLayerState()),e},nl.prototype.getSource=function(){return this.get(Hs.SOURCE)||null},nl.prototype.getSourceState=function(){var t=this.getSource();return t?t.getState():Ys.UNDEFINED},nl.prototype.handleSourceChange_=function(){this.changed()},nl.prototype.handleSourcePropertyChange_=function(){this.sourceChangeKey_&&(Ta.unlistenByKey(this.sourceChangeKey_),this.sourceChangeKey_=null);var t=this.getSource();t&&(this.sourceChangeKey_=Ta.listen(t,Aa.CHANGE,this.handleSourceChange_,this)),this.changed()},nl.prototype.setMap=function(t){this.mapPrecomposeKey_&&(Ta.unlistenByKey(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&(Ta.unlistenByKey(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=Ta.listen(t,el.PRECOMPOSE,function(t){var e=this.getLayerState();e.managed=!1,e.zIndex=1/0,t.frameState.layerStatesArray.push(e),t.frameState.layerStates[ya.getUid(this)]=e},this),this.mapRenderKey_=Ta.listen(this,Aa.CHANGE,t.render,t),this.changed())},nl.prototype.setSource=function(t){this.set(Hs.SOURCE,t)};var il=function(t){var e=t||{};this.ulElement_=document.createElement("UL"),this.logoLi_=document.createElement("LI"),this.ulElement_.appendChild(this.logoLi_),this.logoLi_.style.display="none",this.collapsed_=void 0===e.collapsed||e.collapsed,this.collapsible_=void 0===e.collapsible||e.collapsible,this.collapsible_||(this.collapsed_=!1);var n=void 0!==e.className?e.className:"ol-attribution",i=void 0!==e.tipLabel?e.tipLabel:"Attributions",r=void 0!==e.collapseLabel?e.collapseLabel:"";"string"==typeof r?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=r):this.collapseLabel_=r;var o=void 0!==e.label?e.label:"i";"string"==typeof o?(this.label_=document.createElement("span"),this.label_.textContent=o):this.label_=o;var a=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_,s=document.createElement("button");s.setAttribute("type","button"),s.title=i,s.appendChild(a),Ta.listen(s,Aa.CLICK,this.handleClick_,this);var l=n+" "+tl.CLASS_UNSELECTABLE+" "+tl.CLASS_CONTROL+(this.collapsed_&&this.collapsible_?" ol-collapsed":"")+(this.collapsible_?"":" ol-uncollapsible"),u=document.createElement("div");u.className=l,u.appendChild(this.ulElement_),u.appendChild(s);var c=e.render?e.render:il.render;$s.call(this,{element:u,render:c,target:e.target}),this.renderedAttributions_=[],this.renderedVisible_=!0,this.logoElements_={}};ya.inherits(il,$s),il.prototype.getSourceAttributions_=function(t){for(var e={},n=[],i=t.layerStatesArray,r=t.viewState.resolution,o=0,a=i.length;o<a;++o){var s=i[o];if(nl.visibleAtResolution(s,r)){var l=s.layer.getSource();if(l){var u=l.getAttributions2();if(u){var c=u(t);if(c)if(Array.isArray(c))for(var h=0,d=c.length;h<d;++h)c[h]in e||(n.push(c[h]),e[c[h]]=!0);else c in e||(n.push(c),e[c]=!0)}}}}return n},il.render=function(t){this.updateElement_(t.frameState)},il.prototype.updateElement_=function(t){if(t){var e=this.getSourceAttributions_(t);if(!Ha.equals(e,this.renderedAttributions_)){for(;this.ulElement_.lastChild!==this.logoLi_;)this.ulElement_.removeChild(this.ulElement_.lastChild);for(var n=0,i=e.length;n<i;++n){var r=document.createElement("LI");r.innerHTML=e[n],this.ulElement_.appendChild(r)}0===e.length&&this.renderedAttributions_.length>0?this.element.classList.add("ol-logo-only"):0===this.renderedAttributions_.length&&e.length>0&&this.element.classList.remove("ol-logo-only");var o=e.length>0||!Ea.isEmpty(t.logos);this.renderedVisible_!=o&&(this.element.style.display=o?"":"none",this.renderedVisible_=o),this.renderedAttributions_=e,this.insertLogos_(t)}}else this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1)},il.prototype.insertLogos_=function(t){var e,n=t.logos,i=this.logoElements_;for(e in i)e in n||(Xs.removeNode(i[e]),delete i[e]);var r,o,a;for(a in n){var s=n[a];s instanceof HTMLElement&&(this.logoLi_.appendChild(s),i[a]=s),a in i||((r=new Image).src=a,""===s?o=r:((o=document.createElement("a")).href=s,o.appendChild(r)),this.logoLi_.appendChild(o),i[a]=o)}this.logoLi_.style.display=Ea.isEmpty(n)?"none":""},il.prototype.handleClick_=function(t){t.preventDefault(),this.handleToggle_()},il.prototype.handleToggle_=function(){this.element.classList.toggle("ol-collapsed"),this.collapsed_?Xs.replaceNode(this.collapseLabel_,this.label_):Xs.replaceNode(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_},il.prototype.getCollapsible=function(){return this.collapsible_},il.prototype.setCollapsible=function(t){this.collapsible_!==t&&(this.collapsible_=t,this.element.classList.toggle("ol-uncollapsible"),!t&&this.collapsed_&&this.handleToggle_())},il.prototype.setCollapsed=function(t){this.collapsible_&&this.collapsed_!==t&&this.handleToggle_()},il.prototype.getCollapsed=function(){return this.collapsed_};var rl=function(t){var e=t||{},n=void 0!==e.className?e.className:"ol-rotate",i=void 0!==e.label?e.label:"";this.label_=null,"string"==typeof i?(this.label_=document.createElement("span"),this.label_.className="ol-compass",this.label_.textContent=i):(this.label_=i,this.label_.classList.add("ol-compass"));var r=e.tipLabel?e.tipLabel:"Reset rotation",o=document.createElement("button");o.className=n+"-reset",o.setAttribute("type","button"),o.title=r,o.appendChild(this.label_),Ta.listen(o,Aa.CLICK,rl.prototype.handleClick_,this);var a=n+" "+tl.CLASS_UNSELECTABLE+" "+tl.CLASS_CONTROL,s=document.createElement("div");s.className=a,s.appendChild(o);var l=e.render?e.render:rl.render;this.callResetNorth_=e.resetNorth?e.resetNorth:void 0,$s.call(this,{element:s,render:l,target:e.target}),this.duration_=void 0!==e.duration?e.duration:250,this.autoHide_=void 0===e.autoHide||e.autoHide,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(tl.CLASS_HIDDEN)};ya.inherits(rl,$s),rl.prototype.handleClick_=function(t){t.preventDefault(),void 0!==this.callResetNorth_?this.callResetNorth_():this.resetNorth_()},rl.prototype.resetNorth_=function(){var t=this.getMap().getView();t&&void 0!==t.getRotation()&&(this.duration_>0?t.animate({rotation:0,duration:this.duration_,easing:ls.easeOut}):t.setRotation(0))},rl.render=function(t){var e=t.frameState;if(e){var n=e.viewState.rotation;if(n!=this.rotation_){var i="rotate("+n+"rad)";if(this.autoHide_){var r=this.element.classList.contains(tl.CLASS_HIDDEN);r||0!==n?r&&0!==n&&this.element.classList.remove(tl.CLASS_HIDDEN):this.element.classList.add(tl.CLASS_HIDDEN)}this.label_.style.msTransform=i,this.label_.style.webkitTransform=i,this.label_.style.transform=i}this.rotation_=n}};var ol=function(t){var e=t||{},n=void 0!==e.className?e.className:"ol-zoom",i=void 0!==e.delta?e.delta:1,r=void 0!==e.zoomInLabel?e.zoomInLabel:"+",o=void 0!==e.zoomOutLabel?e.zoomOutLabel:"",a=void 0!==e.zoomInTipLabel?e.zoomInTipLabel:"Zoom in",s=void 0!==e.zoomOutTipLabel?e.zoomOutTipLabel:"Zoom out",l=document.createElement("button");l.className=n+"-in",l.setAttribute("type","button"),l.title=a,l.appendChild("string"==typeof r?document.createTextNode(r):r),Ta.listen(l,Aa.CLICK,ol.prototype.handleClick_.bind(this,i));var u=document.createElement("button");u.className=n+"-out",u.setAttribute("type","button"),u.title=s,u.appendChild("string"==typeof o?document.createTextNode(o):o),Ta.listen(u,Aa.CLICK,ol.prototype.handleClick_.bind(this,-i));var c=n+" "+tl.CLASS_UNSELECTABLE+" "+tl.CLASS_CONTROL,h=document.createElement("div");h.className=c,h.appendChild(l),h.appendChild(u),$s.call(this,{element:h,target:e.target}),this.duration_=void 0!==e.duration?e.duration:250};ya.inherits(ol,$s),ol.prototype.handleClick_=function(t,e){e.preventDefault(),this.zoomByDelta_(t)},ol.prototype.zoomByDelta_=function(t){var e=this.getMap().getView();if(e){var n=e.getResolution();if(n){var i=e.constrainResolution(n,t);this.duration_>0?(e.getAnimating()&&e.cancelAnimations(),e.animate({resolution:i,duration:this.duration_,easing:ls.easeOut})):e.setResolution(i)}}};var al={};al.defaults=function(t){var e=t||{},n=new Ia;return(void 0===e.zoom||e.zoom)&&n.push(new ol(e.zoomOptions)),(void 0===e.rotate||e.rotate)&&n.push(new rl(e.rotateOptions)),(void 0===e.attribution||e.attribution)&&n.push(new il(e.attributionOptions)),n};var sl=function(t,e,n){this.decay_=t,this.minVelocity_=e,this.delay_=n,this.points_=[],this.angle_=0,this.initialVelocity_=0};sl.prototype.begin=function(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0},sl.prototype.update=function(t,e){this.points_.push(t,e,Date.now())},sl.prototype.end=function(){if(this.points_.length<6)return!1;var t=Date.now()-this.delay_,e=this.points_.length-3;if(this.points_[e+2]<t)return!1;for(var n=e-3;n>0&&this.points_[n+2]>t;)n-=3;var i=this.points_[e+2]-this.points_[n+2];if(i<1e3/60)return!1;var r=this.points_[e]-this.points_[n],o=this.points_[e+1]-this.points_[n+1];return this.angle_=Math.atan2(o,r),this.initialVelocity_=Math.sqrt(r*r+o*o)/i,this.initialVelocity_>this.minVelocity_},sl.prototype.getDistance=function(){return(this.minVelocity_-this.initialVelocity_)/this.decay_},sl.prototype.getAngle=function(){return this.angle_};var ll={ACTIVE:"active"},ul=function(t){La.call(this),this.map_=null,this.setActive(!0),this.handleEvent=t.handleEvent};ya.inherits(ul,La),ul.prototype.getActive=function(){return this.get(ll.ACTIVE)},ul.prototype.getMap=function(){return this.map_},ul.prototype.setActive=function(t){this.set(ll.ACTIVE,t)},ul.prototype.setMap=function(t){this.map_=t},ul.pan=function(t,e,n){var i=t.getCenter();if(i){var r=t.constrainCenter([i[0]+e[0],i[1]+e[1]]);n?t.animate({duration:n,easing:ls.linear,center:r}):t.setCenter(r)}},ul.rotate=function(t,e,n,i){e=t.constrainRotation(e,0),ul.rotateWithoutConstraints(t,e,n,i)},ul.rotateWithoutConstraints=function(t,e,n,i){if(void 0!==e){var r=t.getRotation(),o=t.getCenter();void 0!==r&&o&&i>0?t.animate({rotation:e,anchor:n,duration:i,easing:ls.easeOut}):t.rotate(e,n)}},ul.zoom=function(t,e,n,i,r){e=t.constrainResolution(e,0,r),ul.zoomWithoutConstraints(t,e,n,i)},ul.zoomByDelta=function(t,e,n,i){var r=t.getResolution(),o=t.constrainResolution(r,e,0);if(n&&void 0!==o&&o!==r){var a=t.getCenter(),s=t.calculateCenterZoom(o,n);s=t.constrainCenter(s),n=[(o*a[0]-r*s[0])/(o-r),(o*a[1]-r*s[1])/(o-r)]}ul.zoomWithoutConstraints(t,o,n,i)},ul.zoomWithoutConstraints=function(t,e,n,i){if(e){var r=t.getResolution(),o=t.getCenter();if(void 0!==r&&o&&e!==r&&i)t.animate({resolution:e,anchor:n,duration:i,easing:ls.easeOut});else{if(n){var a=t.calculateCenterZoom(e,n);t.setCenter(a)}t.setResolution(e)}}};var cl=function(t){var e=t||{};this.delta_=e.delta?e.delta:1,ul.call(this,{handleEvent:cl.handleEvent}),this.duration_=void 0!==e.duration?e.duration:250};ya.inherits(cl,ul),cl.handleEvent=function(t){var e=!1,n=t.originalEvent;if(t.type==ka.DBLCLICK){var i=t.map,r=t.coordinate,o=n.shiftKey?-this.delta_:this.delta_,a=i.getView();ul.zoomByDelta(a,o,r,this.duration_),t.preventDefault(),e=!0}return!e};var hl={};hl.altKeyOnly=function(t){var e=t.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},hl.altShiftKeysOnly=function(t){var e=t.originalEvent;return e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},hl.always=ps.TRUE,hl.click=function(t){return t.type==ka.CLICK},hl.mouseActionButton=function(t){var e=t.originalEvent;return 0==e.button&&!(Da.WEBKIT&&Da.MAC&&e.ctrlKey)},hl.never=ps.FALSE,hl.pointerMove=function(t){return"pointermove"==t.type},hl.singleClick=function(t){return t.type==ka.SINGLECLICK},hl.doubleClick=function(t){return t.type==ka.DBLCLICK},hl.noModifierKeys=function(t){var e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&!e.shiftKey},hl.platformModifierKeyOnly=function(t){var e=t.originalEvent;return!e.altKey&&(Da.MAC?e.metaKey:e.ctrlKey)&&!e.shiftKey},hl.shiftKeyOnly=function(t){var e=t.originalEvent;return!e.altKey&&!(e.metaKey||e.ctrlKey)&&e.shiftKey},hl.targetNotEditable=function(t){var e=t.originalEvent.target.tagName;return"INPUT"!==e&&"SELECT"!==e&&"TEXTAREA"!==e},hl.mouseOnly=function(t){return Qa.assert(t.pointerEvent,56),"mouse"==t.pointerEvent.pointerType},hl.primaryAction=function(t){var e=t.pointerEvent;return e.isPrimary&&0===e.button};var dl=function(t){var e=t||{},n=e.handleEvent?e.handleEvent:dl.handleEvent;ul.call(this,{handleEvent:n}),this.handleDownEvent_=e.handleDownEvent?e.handleDownEvent:dl.handleDownEvent,this.handleDragEvent_=e.handleDragEvent?e.handleDragEvent:dl.handleDragEvent,this.handleMoveEvent_=e.handleMoveEvent?e.handleMoveEvent:dl.handleMoveEvent,this.handleUpEvent_=e.handleUpEvent?e.handleUpEvent:dl.handleUpEvent,this.handlingDownUpSequence=!1,this.trackedPointers_={},this.targetPointers=[]};ya.inherits(dl,ul),dl.centroid=function(t){for(var e=t.length,n=0,i=0,r=0;r<e;r++)n+=t[r].clientX,i+=t[r].clientY;return[n/e,i/e]},dl.prototype.isPointerDraggingEvent_=function(t){var e=t.type;return e===ka.POINTERDOWN||e===ka.POINTERDRAG||e===ka.POINTERUP},dl.prototype.updateTrackedPointers_=function(t){if(this.isPointerDraggingEvent_(t)){var e=t.pointerEvent,n=e.pointerId.toString();t.type==ka.POINTERUP?delete this.trackedPointers_[n]:t.type==ka.POINTERDOWN?this.trackedPointers_[n]=e:n in this.trackedPointers_&&(this.trackedPointers_[n]=e),this.targetPointers=Ea.getValues(this.trackedPointers_)}},dl.handleDragEvent=ya.nullFunction,dl.handleUpEvent=ps.FALSE,dl.handleDownEvent=ps.FALSE,dl.handleMoveEvent=ya.nullFunction,dl.handleEvent=function(t){if(!(t instanceof Na))return!0;var e=!1;if(this.updateTrackedPointers_(t),this.handlingDownUpSequence){if(t.type==ka.POINTERDRAG)this.handleDragEvent_(t);else if(t.type==ka.POINTERUP){var n=this.handleUpEvent_(t);this.handlingDownUpSequence=n&&this.targetPointers.length>0}}else if(t.type==ka.POINTERDOWN){var i=this.handleDownEvent_(t);this.handlingDownUpSequence=i,e=this.shouldStopEvent(i)}else t.type==ka.POINTERMOVE&&this.handleMoveEvent_(t);return!e},dl.prototype.shouldStopEvent=function(t){return t};var fl=function(t){dl.call(this,{handleDownEvent:fl.handleDownEvent_,handleDragEvent:fl.handleDragEvent_,handleUpEvent:fl.handleUpEvent_});var e=t||{};this.kinetic_=e.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.condition_=e.condition?e.condition:hl.noModifierKeys,this.noKinetic_=!1};ya.inherits(fl,dl),fl.handleDragEvent_=function(t){var e=this.targetPointers,n=dl.centroid(e);if(e.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(n[0],n[1]),this.lastCentroid){var i=this.lastCentroid[0]-n[0],r=n[1]-this.lastCentroid[1],o=t.map.getView(),a=o.getState(),s=[i,r];ss.scale(s,a.resolution),ss.rotate(s,a.rotation),ss.add(s,a.center),s=o.constrainCenter(s),o.setCenter(s)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=n,this.lastPointersCount_=e.length},fl.handleUpEvent_=function(t){var e=t.map,n=e.getView();if(0===this.targetPointers.length){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){var i=this.kinetic_.getDistance(),r=this.kinetic_.getAngle(),o=n.getCenter(),a=e.getPixelFromCoordinate(o),s=e.getCoordinateFromPixel([a[0]-i*Math.cos(r),a[1]-i*Math.sin(r)]);n.animate({center:n.constrainCenter(s),duration:500,easing:ls.easeOut})}return n.setHint(rs.INTERACTING,-1),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0},fl.handleDownEvent_=function(t){if(this.targetPointers.length>0&&this.condition_(t)){var e=t.map.getView();return this.lastCentroid=null,this.handlingDownUpSequence||e.setHint(rs.INTERACTING,1),e.getAnimating()&&e.setCenter(t.frameState.viewState.center),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1},fl.prototype.shouldStopEvent=ps.FALSE;var pl=function(t){var e=t||{};dl.call(this,{handleDownEvent:pl.handleDownEvent_,handleDragEvent:pl.handleDragEvent_,handleUpEvent:pl.handleUpEvent_}),this.condition_=e.condition?e.condition:hl.altShiftKeysOnly,this.lastAngle_=void 0,this.duration_=void 0!==e.duration?e.duration:250};ya.inherits(pl,dl),pl.handleDragEvent_=function(t){if(hl.mouseOnly(t)){var e=t.map,n=e.getView();if(n.getConstraints().rotation!==is.disable){var i=e.getSize(),r=t.pixel,o=Math.atan2(i[1]/2-r[1],r[0]-i[0]/2);if(void 0!==this.lastAngle_){var a=o-this.lastAngle_,s=n.getRotation();ul.rotateWithoutConstraints(n,s-a)}this.lastAngle_=o}}},pl.handleUpEvent_=function(t){if(!hl.mouseOnly(t))return!0;var e=t.map.getView();e.setHint(rs.INTERACTING,-1);var n=e.getRotation();return ul.rotate(e,n,void 0,this.duration_),!1},pl.handleDownEvent_=function(t){return!!hl.mouseOnly(t)&&(!(!hl.mouseActionButton(t)||!this.condition_(t))&&(t.map.getView().setHint(rs.INTERACTING,1),this.lastAngle_=void 0,!0))},pl.prototype.shouldStopEvent=ps.FALSE;var gl=function(t){this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.className="ol-box "+t,this.map_=null,this.startPixel_=null,this.endPixel_=null};ya.inherits(gl,wa),gl.prototype.disposeInternal=function(){this.setMap(null)},gl.prototype.render_=function(){var t=this.startPixel_,e=this.endPixel_,n=this.element_.style;n.left=Math.min(t[0],e[0])+"px",n.top=Math.min(t[1],e[1])+"px",n.width=Math.abs(e[0]-t[0])+"px",n.height=Math.abs(e[1]-t[1])+"px"},gl.prototype.setMap=function(t){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);var e=this.element_.style;e.left=e.top=e.width=e.height="inherit"}this.map_=t,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)},gl.prototype.setPixels=function(t,e){this.startPixel_=t,this.endPixel_=e,this.createOrUpdateGeometry(),this.render_()},gl.prototype.createOrUpdateGeometry=function(){var t=this.startPixel_,e=this.endPixel_,n=[t,[t[0],e[1]],e,[e[0],t[1]]].map(this.map_.getCoordinateFromPixel,this.map_);n[4]=n[0].slice(),this.geometry_?this.geometry_.setCoordinates([n]):this.geometry_=new Bs([n])},gl.prototype.getGeometry=function(){return this.geometry_};var _l=function(t){dl.call(this,{handleDownEvent:_l.handleDownEvent_,handleDragEvent:_l.handleDragEvent_,handleUpEvent:_l.handleUpEvent_});var e=t||{};this.box_=new gl(e.className||"ol-dragbox"),this.minArea_=void 0!==e.minArea?e.minArea:64,this.startPixel_=null,this.condition_=e.condition?e.condition:hl.always,this.boxEndCondition_=e.boxEndCondition?e.boxEndCondition:_l.defaultBoxEndCondition};ya.inherits(_l,dl),_l.defaultBoxEndCondition=function(t,e,n){var i=n[0]-e[0],r=n[1]-e[1];return i*i+r*r>=this.minArea_},_l.handleDragEvent_=function(t){hl.mouseOnly(t)&&(this.box_.setPixels(this.startPixel_,t.pixel),this.dispatchEvent(new _l.Event(_l.EventType_.BOXDRAG,t.coordinate,t)))},_l.prototype.getGeometry=function(){return this.box_.getGeometry()},_l.prototype.onBoxEnd=ya.nullFunction,_l.handleUpEvent_=function(t){return!hl.mouseOnly(t)||(this.box_.setMap(null),this.boxEndCondition_(t,this.startPixel_,t.pixel)&&(this.onBoxEnd(t),this.dispatchEvent(new _l.Event(_l.EventType_.BOXEND,t.coordinate,t))),!1)},_l.handleDownEvent_=function(t){return!!hl.mouseOnly(t)&&(!(!hl.mouseActionButton(t)||!this.condition_(t))&&(this.startPixel_=t.pixel,this.box_.setMap(t.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new _l.Event(_l.EventType_.BOXSTART,t.coordinate,t)),!0))},_l.EventType_={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend"},_l.Event=function(t,e,n){Ca.call(this,t),this.coordinate=e,this.mapBrowserEvent=n},ya.inherits(_l.Event,Ca);var vl=function(t){var e=t||{},n=e.condition?e.condition:hl.shiftKeyOnly;this.duration_=void 0!==e.duration?e.duration:200,this.out_=void 0!==e.out&&e.out,_l.call(this,{condition:n,className:e.className||"ol-dragzoom"})};ya.inherits(vl,_l),vl.prototype.onBoxEnd=function(){var t=this.getMap(),e=t.getView(),n=t.getSize(),i=this.getGeometry().getExtent();if(this.out_){var r=e.calculateExtent(n),o=hs.createOrUpdateFromCoordinates([t.getPixelFromCoordinate(hs.getBottomLeft(i)),t.getPixelFromCoordinate(hs.getTopRight(i))]),a=e.getResolutionForExtent(o,n);hs.scaleFromCenter(r,1/a),i=r}var s=e.constrainResolution(e.getResolutionForExtent(i,n)),l=hs.getCenter(i);l=e.constrainCenter(l),e.animate({resolution:s,center:l,duration:this.duration_,easing:ls.easeOut})};var yl={LEFT:37,UP:38,RIGHT:39,DOWN:40},ml=function(t){ul.call(this,{handleEvent:ml.handleEvent});var e=t||{};this.defaultCondition_=function(t){return hl.noModifierKeys(t)&&hl.targetNotEditable(t)},this.condition_=void 0!==e.condition?e.condition:this.defaultCondition_,this.duration_=void 0!==e.duration?e.duration:100,this.pixelDelta_=void 0!==e.pixelDelta?e.pixelDelta:128};ya.inherits(ml,ul),ml.handleEvent=function(t){var e=!1;if(t.type==Aa.KEYDOWN){var n=t.originalEvent.keyCode;if(this.condition_(t)&&(n==yl.DOWN||n==yl.LEFT||n==yl.RIGHT||n==yl.UP)){var i=t.map.getView(),r=i.getResolution()*this.pixelDelta_,o=0,a=0;n==yl.DOWN?a=-r:n==yl.LEFT?o=-r:n==yl.RIGHT?o=r:a=r;var s=[o,a];ss.rotate(s,i.getRotation()),ul.pan(i,s,this.duration_),t.preventDefault(),e=!0}}return!e};var xl=function(t){ul.call(this,{handleEvent:xl.handleEvent});var e=t||{};this.condition_=e.condition?e.condition:hl.targetNotEditable,this.delta_=e.delta?e.delta:1,this.duration_=void 0!==e.duration?e.duration:100};ya.inherits(xl,ul),xl.handleEvent=function(t){var e=!1;if(t.type==Aa.KEYDOWN||t.type==Aa.KEYPRESS){var n=t.originalEvent.charCode;if(this.condition_(t)&&(n=="+".charCodeAt(0)||n=="-".charCodeAt(0))){var i=t.map,r=n=="+".charCodeAt(0)?this.delta_:-this.delta_,o=i.getView();ul.zoomByDelta(o,r,void 0,this.duration_),t.preventDefault(),e=!0}}return!e};var Sl=function(t){ul.call(this,{handleEvent:Sl.handleEvent});var e=t||{};this.delta_=0,this.duration_=void 0!==e.duration?e.duration:250,this.timeout_=void 0!==e.timeout?e.timeout:80,this.useAnchor_=void 0===e.useAnchor||e.useAnchor,this.constrainResolution_=e.constrainResolution||!1,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_=void 0,this.trackpadDeltaPerZoom_=300,this.trackpadZoomBuffer_=1.5};ya.inherits(Sl,ul),Sl.handleEvent=function(t){var e=t.type;if(e!==Aa.WHEEL&&e!==Aa.MOUSEWHEEL)return!0;t.preventDefault();var n=t.map,i=t.originalEvent;this.useAnchor_&&(this.lastAnchor_=t.coordinate);var r;if(t.type==Aa.WHEEL?(r=i.deltaY,Da.FIREFOX&&i.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(r/=Da.DEVICE_PIXEL_RATIO),i.deltaMode===WheelEvent.DOM_DELTA_LINE&&(r*=40)):t.type==Aa.MOUSEWHEEL&&(r=-i.wheelDeltaY,Da.SAFARI&&(r/=3)),0===r)return!1;var o=Date.now();if(void 0===this.startTime_&&(this.startTime_=o),(!this.mode_||o-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(r)<4?Sl.Mode_.TRACKPAD:Sl.Mode_.WHEEL),this.mode_===Sl.Mode_.TRACKPAD){var a=n.getView();this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):a.setHint(rs.INTERACTING,1),this.trackpadTimeoutId_=setTimeout(this.decrementInteractingHint_.bind(this),this.trackpadEventGap_);var s=a.getResolution()*Math.pow(2,r/this.trackpadDeltaPerZoom_),l=a.getMinResolution(),u=a.getMaxResolution(),c=0;if(s<l?(s=Math.max(s,l/this.trackpadZoomBuffer_),c=1):s>u&&(s=Math.min(s,u*this.trackpadZoomBuffer_),c=-1),this.lastAnchor_){var h=a.calculateCenterZoom(s,this.lastAnchor_);a.setCenter(a.constrainCenter(h))}return a.setResolution(s),0===c&&this.constrainResolution_&&a.animate({resolution:a.constrainResolution(s,r>0?-1:1),easing:ls.easeOut,anchor:this.lastAnchor_,duration:this.duration_}),c>0?a.animate({resolution:l,easing:ls.easeOut,anchor:this.lastAnchor_,duration:500}):c<0&&a.animate({resolution:u,easing:ls.easeOut,anchor:this.lastAnchor_,duration:500}),this.startTime_=o,!1}this.delta_+=r;var d=Math.max(this.timeout_-(o-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,n),d),!1},Sl.prototype.decrementInteractingHint_=function(){this.trackpadTimeoutId_=void 0,this.getMap().getView().setHint(rs.INTERACTING,-1)},Sl.prototype.handleWheelZoom_=function(t){var e=t.getView();e.getAnimating()&&e.cancelAnimations();var n=ya.MOUSEWHEELZOOM_MAXDELTA,i=ts.clamp(this.delta_,-n,n);ul.zoomByDelta(e,-i,this.lastAnchor_,this.duration_),this.mode_=void 0,this.delta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0},Sl.prototype.setMouseAnchor=function(t){this.useAnchor_=t,t||(this.lastAnchor_=null)},Sl.Mode_={TRACKPAD:"trackpad",WHEEL:"wheel"};var El=function(t){dl.call(this,{handleDownEvent:El.handleDownEvent_,handleDragEvent:El.handleDragEvent_,handleUpEvent:El.handleUpEvent_});var e=t||{};this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=void 0!==e.threshold?e.threshold:.3,this.duration_=void 0!==e.duration?e.duration:250};ya.inherits(El,dl),El.handleDragEvent_=function(t){var e=0,n=this.targetPointers[0],i=this.targetPointers[1],r=Math.atan2(i.clientY-n.clientY,i.clientX-n.clientX);if(void 0!==this.lastAngle_){var o=r-this.lastAngle_;this.rotationDelta_+=o,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),e=o}this.lastAngle_=r;var a=t.map,s=a.getView();if(s.getConstraints().rotation!==is.disable){var l=a.getViewport().getBoundingClientRect(),u=dl.centroid(this.targetPointers);if(u[0]-=l.left,u[1]-=l.top,this.anchor_=a.getCoordinateFromPixel(u),this.rotating_){var c=s.getRotation();a.render(),ul.rotateWithoutConstraints(s,c+e,this.anchor_)}}},El.handleUpEvent_=function(t){if(this.targetPointers.length<2){var e=t.map.getView();if(e.setHint(rs.INTERACTING,-1),this.rotating_){var n=e.getRotation();ul.rotate(e,n,this.anchor_,this.duration_)}return!1}return!0},El.handleDownEvent_=function(t){if(this.targetPointers.length>=2){var e=t.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||e.getView().setHint(rs.INTERACTING,1),!0}return!1},El.prototype.shouldStopEvent=ps.FALSE;var Tl=function(t){dl.call(this,{handleDownEvent:Tl.handleDownEvent_,handleDragEvent:Tl.handleDragEvent_,handleUpEvent:Tl.handleUpEvent_});var e=t||{};this.constrainResolution_=e.constrainResolution||!1,this.anchor_=null,this.duration_=void 0!==e.duration?e.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1};ya.inherits(Tl,dl),Tl.handleDragEvent_=function(t){var e=1,n=this.targetPointers[0],i=this.targetPointers[1],r=n.clientX-i.clientX,o=n.clientY-i.clientY,a=Math.sqrt(r*r+o*o);void 0!==this.lastDistance_&&(e=this.lastDistance_/a),this.lastDistance_=a;var s=t.map,l=s.getView(),u=l.getResolution(),c=l.getMaxResolution(),h=l.getMinResolution(),d=u*e;d>c?(e=c/u,d=c):d<h&&(e=h/u,d=h),1!=e&&(this.lastScaleDelta_=e);var f=s.getViewport().getBoundingClientRect(),p=dl.centroid(this.targetPointers);p[0]-=f.left,p[1]-=f.top,this.anchor_=s.getCoordinateFromPixel(p),s.render(),ul.zoomWithoutConstraints(l,d,this.anchor_)},Tl.handleUpEvent_=function(t){if(this.targetPointers.length<2){var e=t.map.getView();e.setHint(rs.INTERACTING,-1);var n=e.getResolution();if(this.constrainResolution_||n<e.getMinResolution()||n>e.getMaxResolution()){var i=this.lastScaleDelta_-1;ul.zoom(e,n,this.anchor_,this.duration_,i)}return!1}return!0},Tl.handleDownEvent_=function(t){if(this.targetPointers.length>=2){var e=t.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||e.getView().setHint(rs.INTERACTING,1),!0}return!1},Tl.prototype.shouldStopEvent=ps.FALSE;var wl={};wl.defaults=function(t){var e=t||{},n=new Ia,i=new sl(-.005,.05,100);return(void 0===e.altShiftDragRotate||e.altShiftDragRotate)&&n.push(new pl),(void 0===e.doubleClickZoom||e.doubleClickZoom)&&n.push(new cl({delta:e.zoomDelta,duration:e.zoomDuration})),(void 0===e.dragPan||e.dragPan)&&n.push(new fl({kinetic:i})),(void 0===e.pinchRotate||e.pinchRotate)&&n.push(new El),(void 0===e.pinchZoom||e.pinchZoom)&&n.push(new Tl({constrainResolution:e.constrainResolution,duration:e.zoomDuration})),(void 0===e.keyboard||e.keyboard)&&(n.push(new ml),n.push(new xl({delta:e.zoomDelta,duration:e.zoomDuration}))),(void 0===e.mouseWheelZoom||e.mouseWheelZoom)&&n.push(new Sl({constrainResolution:e.constrainResolution,duration:e.zoomDuration})),(void 0===e.shiftDragZoom||e.shiftDragZoom)&&n.push(new vl({duration:e.zoomDuration})),n};var Cl={IMAGE:"IMAGE",TILE:"TILE",VECTOR_TILE:"VECTOR_TILE",VECTOR:"VECTOR"},bl=function(t,e,n,i,r){Ca.call(this,t),this.vectorContext=e,this.frameState=n,this.context=i,this.glContext=r};ya.inherits(bl,Ca);var Al=function(t){ba.call(this),this.highWaterMark=void 0!==t?t:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null};ya.inherits(Al,ba),Al.prototype.canExpireCache=function(){return this.getCount()>this.highWaterMark},Al.prototype.clear=function(){this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null,this.dispatchEvent(Aa.CLEAR)},Al.prototype.containsKey=function(t){return this.entries_.hasOwnProperty(t)},Al.prototype.forEach=function(t,e){for(var n=this.oldest_;n;)t.call(e,n.value_,n.key_,this),n=n.newer},Al.prototype.get=function(t){var e=this.entries_[t];return Qa.assert(void 0!==e,15),e===this.newest_?e.value_:(e===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(e.newer.older=e.older,e.older.newer=e.newer),e.newer=null,e.older=this.newest_,this.newest_.newer=e,this.newest_=e,e.value_)},Al.prototype.remove=function(t){var e=this.entries_[t];return Qa.assert(void 0!==e,15),e===this.newest_?(this.newest_=e.older,this.newest_&&(this.newest_.newer=null)):e===this.oldest_?(this.oldest_=e.newer,this.oldest_&&(this.oldest_.older=null)):(e.newer.older=e.older,e.older.newer=e.newer),delete this.entries_[t],--this.count_,e.value_},Al.prototype.getCount=function(){return this.count_},Al.prototype.getKeys=function(){var t,e=new Array(this.count_),n=0;for(t=this.newest_;t;t=t.older)e[n++]=t.key_;return e},Al.prototype.getValues=function(){var t,e=new Array(this.count_),n=0;for(t=this.newest_;t;t=t.older)e[n++]=t.value_;return e},Al.prototype.peekLast=function(){return this.oldest_.value_},Al.prototype.peekLastKey=function(){return this.oldest_.key_},Al.prototype.peekFirstKey=function(){return this.newest_.key_},Al.prototype.pop=function(){var t=this.oldest_;return delete this.entries_[t.key_],t.newer&&(t.newer.older=null),this.oldest_=t.newer,this.oldest_||(this.newest_=null),--this.count_,t.value_},Al.prototype.replace=function(t,e){this.get(t),this.entries_[t].value_=e},Al.prototype.set=function(t,e){Qa.assert(!(t in this.entries_),16);var n={key_:t,newer:null,older:this.newest_,value_:e};this.newest_?this.newest_.newer=n:this.oldest_=n,this.newest_=n,this.entries_[t]=n,++this.count_},Al.prototype.pruneAndSet=function(t,e){for(;this.canExpireCache();)this.pop();this.set(t,e)};var Rl={};Rl.defaultFont="10px sans-serif",Rl.defaultFillStyle=[0,0,0,1],Rl.defaultLineCap="round",Rl.defaultLineDash=[],Rl.defaultLineDashOffset=0,Rl.defaultLineJoin="round",Rl.defaultMiterLimit=10,Rl.defaultStrokeStyle=[0,0,0,1],Rl.defaultTextAlign="center",Rl.defaultTextBaseline="middle",Rl.defaultLineWidth=1,Rl.labelCache=new Al,Rl.checkedFonts_={},Rl.checkFont=function(){function t(t){n||((n=Xs.createCanvasContext2D(1,1)).font=s,r=n.measureText(l).width);var e=!0;return"monospace"!=t&&(n.font="32px "+t+",monospace",e=n.measureText(l).width!=r,n.font=s),e}function e(){var e=!0;for(var n in o)o[n]<60&&(t(n)?(o[n]=60,a.clear()):(++o[n],e=!1));e&&(window.clearInterval(i),i=void 0)}var n,i,r,o=Rl.checkedFonts_,a=Rl.labelCache,s="32px monospace",l="wmytzilWMYTZIL@#/&?$%10";return function(n){var r=tl.getFontFamilies(n);if(r)for(var a=0,s=r.length;a<s;++a){var l=r[a];l in o||(o[l]=60,t(l)||(o[l]=0,void 0===i&&(i=window.setInterval(e,32))))}}}(),Rl.rotateAtOffset=function(t,e,n,i){0!==e&&(t.translate(n,i),t.rotate(e),t.translate(-n,-i))},Rl.resetTransform_=Cs.create(),Rl.drawImage=function(t,e,n,i,r,o,a,s,l,u,c){var h;1!=n&&(h=t.globalAlpha,t.globalAlpha=h*n),e&&t.setTransform.apply(t,e),t.drawImage(i,r,o,a,s,l,u,a*c,s*c),h&&(t.globalAlpha=h),e&&t.setTransform.apply(t,Rl.resetTransform_)};var Ll={};Ll.HEX_COLOR_RE_=/^#(?:[0-9a-f]{3,4}){1,2}$/i,Ll.NAMED_COLOR_RE_=/^([a-z]*)$/i,Ll.asArray=function(t){return Array.isArray(t)?t:Ll.fromString(t)},Ll.asString=function(t){return"string"==typeof t?t:Ll.toString(t)},Ll.fromNamed=function(t){var e=document.createElement("div");e.style.color=t,document.body.appendChild(e);var n=getComputedStyle(e).color;return document.body.removeChild(e),n},Ll.fromString=function(){var t={},e=0;return function(n){var i;if(t.hasOwnProperty(n))i=t[n];else{if(e>=1024){var r,o=0;for(r in t)0==(3&o++)&&(delete t[r],--e)}i=Ll.fromStringInternal_(n),t[n]=i,++e}return i}}(),Ll.fromStringInternal_=function(t){var e,n,i,r,o,a;if(Ll.NAMED_COLOR_RE_.exec(t)&&(t=Ll.fromNamed(t)),Ll.HEX_COLOR_RE_.exec(t)){var s,l=t.length-1;s=l<=4?1:2;var u=4===l||8===l;e=parseInt(t.substr(1+0*s,s),16),n=parseInt(t.substr(1+1*s,s),16),i=parseInt(t.substr(1+2*s,s),16),r=u?parseInt(t.substr(1+3*s,s),16):255,1==s&&(e=(e<<4)+e,n=(n<<4)+n,i=(i<<4)+i,u&&(r=(r<<4)+r)),o=[e,n,i,r/255]}else 0==t.indexOf("rgba(")?(a=t.slice(5,-1).split(",").map(Number),o=Ll.normalize(a)):0==t.indexOf("rgb(")?((a=t.slice(4,-1).split(",").map(Number)).push(1),o=Ll.normalize(a)):Qa.assert(!1,14);return o},Ll.normalize=function(t,e){var n=e||[];return n[0]=ts.clamp(t[0]+.5|0,0,255),n[1]=ts.clamp(t[1]+.5|0,0,255),n[2]=ts.clamp(t[2]+.5|0,0,255),n[3]=ts.clamp(t[3],0,1),n},Ll.toString=function(t){var e=t[0];e!=(0|e)&&(e=e+.5|0);var n=t[1];n!=(0|n)&&(n=n+.5|0);var i=t[2];return i!=(0|i)&&(i=i+.5|0),"rgba("+e+","+n+","+i+","+(void 0===t[3]?1:t[3])+")"};var Il={};Il.asColorLike=function(t){return Il.isColorLike(t)?t:Ll.asString(t)},Il.isColorLike=function(t){return"string"==typeof t||t instanceof CanvasPattern||t instanceof CanvasGradient};var Pl=function(){};Pl.prototype.drawCustom=function(t,e,n){},Pl.prototype.drawGeometry=function(t){},Pl.prototype.setStyle=function(t){},Pl.prototype.drawCircle=function(t,e){},Pl.prototype.drawFeature=function(t,e){},Pl.prototype.drawGeometryCollection=function(t,e){},Pl.prototype.drawLineString=function(t,e){},Pl.prototype.drawMultiLineString=function(t,e){},Pl.prototype.drawMultiPoint=function(t,e){},Pl.prototype.drawMultiPolygon=function(t,e){},Pl.prototype.drawPoint=function(t,e){},Pl.prototype.drawPolygon=function(t,e){},Pl.prototype.drawText=function(t,e){},Pl.prototype.setFillStrokeStyle=function(t,e){},Pl.prototype.setImageStyle=function(t,e){},Pl.prototype.setTextStyle=function(t,e){};var Ml=function(t,e,n,i,r){Pl.call(this),this.context_=t,this.pixelRatio_=e,this.extent_=n,this.transform_=i,this.viewRotation_=r,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=0,this.imageSnapToPixel_=!1,this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=0,this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=Cs.create()};ya.inherits(Ml,Pl),Ml.prototype.drawImages_=function(t,e,n,i){if(this.image_){var r=gs.transform2D(t,e,n,2,this.transform_,this.pixelCoordinates_),o=this.context_,a=this.tmpLocalTransform_,s=o.globalAlpha;1!=this.imageOpacity_&&(o.globalAlpha=s*this.imageOpacity_);var l=this.imageRotation_;this.imageRotateWithView_&&(l+=this.viewRotation_);var u,c;for(u=0,c=r.length;u<c;u+=2){var h=r[u]-this.imageAnchorX_,d=r[u+1]-this.imageAnchorY_;if(this.imageSnapToPixel_&&(h=Math.round(h),d=Math.round(d)),0!==l||1!=this.imageScale_){var f=h+this.imageAnchorX_,p=d+this.imageAnchorY_;Cs.compose(a,f,p,this.imageScale_,this.imageScale_,l,-f,-p),o.setTransform.apply(o,a)}o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,h,d,this.imageWidth_,this.imageHeight_)}0===l&&1==this.imageScale_||o.setTransform(1,0,0,1,0,0),1!=this.imageOpacity_&&(o.globalAlpha=s)}},Ml.prototype.drawText_=function(t,e,n,i){if(this.textState_&&""!==this.text_){this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);var r=gs.transform2D(t,e,n,i,this.transform_,this.pixelCoordinates_),o=this.context_,a=this.textRotation_;for(this.textRotateWithView_&&(a+=this.viewRotation_);e<n;e+=i){var s=r[e]+this.textOffsetX_,l=r[e+1]+this.textOffsetY_;if(0!==a||1!=this.textScale_){var u=Cs.compose(this.tmpLocalTransform_,s,l,this.textScale_,this.textScale_,a,-s,-l);o.setTransform.apply(o,u)}this.textStrokeState_&&o.strokeText(this.text_,s,l),this.textFillState_&&o.fillText(this.text_,s,l)}0===a&&1==this.textScale_||o.setTransform(1,0,0,1,0,0)}},Ml.prototype.moveToLineTo_=function(t,e,n,i,r){var o=this.context_,a=gs.transform2D(t,e,n,i,this.transform_,this.pixelCoordinates_);o.moveTo(a[0],a[1]);var s=a.length;r&&(s-=2);for(var l=2;l<s;l+=2)o.lineTo(a[l],a[l+1]);return r&&o.closePath(),n},Ml.prototype.drawRings_=function(t,e,n,i){var r,o;for(r=0,o=n.length;r<o;++r)e=this.moveToLineTo_(t,e,n[r],i,!0);return e},Ml.prototype.drawCircle=function(t){if(hs.intersects(this.extent_,t.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var e=As.transform2D(t,this.transform_,this.pixelCoordinates_),n=e[2]-e[0],i=e[3]-e[1],r=Math.sqrt(n*n+i*i),o=this.context_;o.beginPath(),o.arc(e[0],e[1],r,0,2*Math.PI),this.fillState_&&o.fill(),this.strokeState_&&o.stroke()}""!==this.text_&&this.drawText_(t.getCenter(),0,2,2)}},Ml.prototype.setStyle=function(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())},Ml.prototype.drawGeometry=function(t){switch(t.getType()){case ds.POINT:this.drawPoint(t);break;case ds.LINE_STRING:this.drawLineString(t);break;case ds.POLYGON:this.drawPolygon(t);break;case ds.MULTI_POINT:this.drawMultiPoint(t);break;case ds.MULTI_LINE_STRING:this.drawMultiLineString(t);break;case ds.MULTI_POLYGON:this.drawMultiPolygon(t);break;case ds.GEOMETRY_COLLECTION:this.drawGeometryCollection(t);break;case ds.CIRCLE:this.drawCircle(t)}},Ml.prototype.drawFeature=function(t,e){var n=e.getGeometryFunction()(t);n&&hs.intersects(this.extent_,n.getExtent())&&(this.setStyle(e),this.drawGeometry(n))},Ml.prototype.drawGeometryCollection=function(t){var e,n,i=t.getGeometriesArray();for(e=0,n=i.length;e<n;++e)this.drawGeometry(i[e])},Ml.prototype.drawPoint=function(t){var e=t.getFlatCoordinates(),n=t.getStride();this.image_&&this.drawImages_(e,0,e.length,n),""!==this.text_&&this.drawText_(e,0,e.length,n)},Ml.prototype.drawMultiPoint=function(t){var e=t.getFlatCoordinates(),n=t.getStride();this.image_&&this.drawImages_(e,0,e.length,n),""!==this.text_&&this.drawText_(e,0,e.length,n)},Ml.prototype.drawLineString=function(t){if(hs.intersects(this.extent_,t.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);var e=this.context_,n=t.getFlatCoordinates();e.beginPath(),this.moveToLineTo_(n,0,n.length,t.getStride(),!1),e.stroke()}if(""!==this.text_){var i=t.getFlatMidpoint();this.drawText_(i,0,2,2)}}},Ml.prototype.drawMultiLineString=function(t){var e=t.getExtent();if(hs.intersects(this.extent_,e)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);var n=this.context_,i=t.getFlatCoordinates(),r=0,o=t.getEnds(),a=t.getStride();n.beginPath();var s,l;for(s=0,l=o.length;s<l;++s)r=this.moveToLineTo_(i,r,o[s],a,!1);n.stroke()}if(""!==this.text_){var u=t.getFlatMidpoints();this.drawText_(u,0,u.length,2)}}},Ml.prototype.drawPolygon=function(t){if(hs.intersects(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var e=this.context_;e.beginPath(),this.drawRings_(t.getOrientedFlatCoordinates(),0,t.getEnds(),t.getStride()),this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(""!==this.text_){var n=t.getFlatInteriorPoint();this.drawText_(n,0,2,2)}}},Ml.prototype.drawMultiPolygon=function(t){if(hs.intersects(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);var e,n,i=this.context_,r=t.getOrientedFlatCoordinates(),o=0,a=t.getEndss(),s=t.getStride();for(i.beginPath(),e=0,n=a.length;e<n;++e){var l=a[e];o=this.drawRings_(r,o,l,s)}this.fillState_&&i.fill(),this.strokeState_&&i.stroke()}if(""!==this.text_){var u=t.getFlatInteriorPoints();this.drawText_(u,0,u.length,2)}}},Ml.prototype.setContextFillState_=function(t){var e=this.context_,n=this.contextFillState_;n?n.fillStyle!=t.fillStyle&&(n.fillStyle=e.fillStyle=t.fillStyle):(e.fillStyle=t.fillStyle,this.contextFillState_={fillStyle:t.fillStyle})},Ml.prototype.setContextStrokeState_=function(t){var e=this.context_,n=this.contextStrokeState_;n?(n.lineCap!=t.lineCap&&(n.lineCap=e.lineCap=t.lineCap),Da.CANVAS_LINE_DASH&&(Ha.equals(n.lineDash,t.lineDash)||e.setLineDash(n.lineDash=t.lineDash),n.lineDashOffset!=t.lineDashOffset&&(n.lineDashOffset=e.lineDashOffset=t.lineDashOffset)),n.lineJoin!=t.lineJoin&&(n.lineJoin=e.lineJoin=t.lineJoin),n.lineWidth!=t.lineWidth&&(n.lineWidth=e.lineWidth=t.lineWidth),n.miterLimit!=t.miterLimit&&(n.miterLimit=e.miterLimit=t.miterLimit),n.strokeStyle!=t.strokeStyle&&(n.strokeStyle=e.strokeStyle=t.strokeStyle)):(e.lineCap=t.lineCap,Da.CANVAS_LINE_DASH&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineJoin=t.lineJoin,e.lineWidth=t.lineWidth,e.miterLimit=t.miterLimit,e.strokeStyle=t.strokeStyle,this.contextStrokeState_={lineCap:t.lineCap,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,lineJoin:t.lineJoin,lineWidth:t.lineWidth,miterLimit:t.miterLimit,strokeStyle:t.strokeStyle})},Ml.prototype.setContextTextState_=function(t){var e=this.context_,n=this.contextTextState_,i=t.textAlign?t.textAlign:Rl.defaultTextAlign;n?(n.font!=t.font&&(n.font=e.font=t.font),n.textAlign!=i&&(n.textAlign=i),n.textBaseline!=t.textBaseline&&(n.textBaseline=e.textBaseline=t.textBaseline)):(e.font=t.font,e.textAlign=i,e.textBaseline=t.textBaseline,this.contextTextState_={font:t.font,textAlign:i,textBaseline:t.textBaseline})},Ml.prototype.setFillStrokeStyle=function(t,e){if(t){var n=t.getColor();this.fillState_={fillStyle:Il.asColorLike(n||Rl.defaultFillStyle)}}else this.fillState_=null;if(e){var i=e.getColor(),r=e.getLineCap(),o=e.getLineDash(),a=e.getLineDashOffset(),s=e.getLineJoin(),l=e.getWidth(),u=e.getMiterLimit();this.strokeState_={lineCap:void 0!==r?r:Rl.defaultLineCap,lineDash:o||Rl.defaultLineDash,lineDashOffset:a||Rl.defaultLineDashOffset,lineJoin:void 0!==s?s:Rl.defaultLineJoin,lineWidth:this.pixelRatio_*(void 0!==l?l:Rl.defaultLineWidth),miterLimit:void 0!==u?u:Rl.defaultMiterLimit,strokeStyle:Il.asColorLike(i||Rl.defaultStrokeStyle)}}else this.strokeState_=null},Ml.prototype.setImageStyle=function(t){if(t){var e=t.getAnchor(),n=t.getImage(1),i=t.getOrigin(),r=t.getSize();this.imageAnchorX_=e[0],this.imageAnchorY_=e[1],this.imageHeight_=r[1],this.image_=n,this.imageOpacity_=t.getOpacity(),this.imageOriginX_=i[0],this.imageOriginY_=i[1],this.imageRotateWithView_=t.getRotateWithView(),this.imageRotation_=t.getRotation(),this.imageScale_=t.getScale()*this.pixelRatio_,this.imageSnapToPixel_=t.getSnapToPixel(),this.imageWidth_=r[0]}else this.image_=null},Ml.prototype.setTextStyle=function(t){if(t){var e=t.getFill();if(e){var n=e.getColor();this.textFillState_={fillStyle:Il.asColorLike(n||Rl.defaultFillStyle)}}else this.textFillState_=null;var i=t.getStroke();if(i){var r=i.getColor(),o=i.getLineCap(),a=i.getLineDash(),s=i.getLineDashOffset(),l=i.getLineJoin(),u=i.getWidth(),c=i.getMiterLimit();this.textStrokeState_={lineCap:void 0!==o?o:Rl.defaultLineCap,lineDash:a||Rl.defaultLineDash,lineDashOffset:s||Rl.defaultLineDashOffset,lineJoin:void 0!==l?l:Rl.defaultLineJoin,lineWidth:void 0!==u?u:Rl.defaultLineWidth,miterLimit:void 0!==c?c:Rl.defaultMiterLimit,strokeStyle:Il.asColorLike(r||Rl.defaultStrokeStyle)}}else this.textStrokeState_=null;var h=t.getFont(),d=t.getOffsetX(),f=t.getOffsetY(),p=t.getRotateWithView(),g=t.getRotation(),_=t.getScale(),v=t.getText(),y=t.getTextAlign(),m=t.getTextBaseline();this.textState_={font:void 0!==h?h:Rl.defaultFont,textAlign:void 0!==y?y:Rl.defaultTextAlign,textBaseline:void 0!==m?m:Rl.defaultTextBaseline},this.text_=void 0!==v?v:"",this.textOffsetX_=void 0!==d?this.pixelRatio_*d:0,this.textOffsetY_=void 0!==f?this.pixelRatio_*f:0,this.textRotateWithView_=void 0!==p&&p,this.textRotation_=void 0!==g?g:0,this.textScale_=this.pixelRatio_*(void 0!==_?_:1)}else this.text_=""};var Ol={IDLE:0,LOADING:1,LOADED:2,ERROR:3},Dl=function(t){Ra.call(this),this.layer_=t};ya.inherits(Dl,Ra),Dl.prototype.forEachFeatureAtCoordinate=ya.nullFunction,Dl.prototype.hasFeatureAtCoordinate=ps.FALSE,Dl.prototype.createLoadedTileFinder=function(t,e,n){return function(i,r){return t.forEachLoadedTile(e,i,r,function(t){n[i]||(n[i]={}),n[i][t.tileCoord.toString()]=t})}},Dl.prototype.getLayer=function(){return this.layer_},Dl.prototype.handleImageChange_=function(t){t.target.getState()===Ol.LOADED&&this.renderIfReadyAndVisible()},Dl.prototype.loadImage=function(t){var e=t.getState();return e!=Ol.LOADED&&e!=Ol.ERROR&&Ta.listen(t,Aa.CHANGE,this.handleImageChange_,this),e==Ol.IDLE&&(t.load(),e=t.getState()),e==Ol.LOADED},Dl.prototype.renderIfReadyAndVisible=function(){var t=this.getLayer();t.getVisible()&&t.getSourceState()==Ys.READY&&this.changed()},Dl.prototype.scheduleExpireCache=function(t,e){if(e.canExpireCache()){var n=function(t,e,n){var i=ya.getUid(t).toString();i in n.usedTiles&&t.expireCache(n.viewState.projection,n.usedTiles[i])}.bind(null,e);t.postRenderFunctions.push(n)}},Dl.prototype.updateLogos=function(t,e){var n=e.getLogo();void 0!==n&&("string"==typeof n?t.logos[n]="":n&&(Qa.assert("string"==typeof n.href,44),Qa.assert("string"==typeof n.src,45),t.logos[n.src]=n.href))},Dl.prototype.updateUsedTiles=function(t,e,n,i){var r=ya.getUid(e).toString(),o=n.toString();r in t?o in t[r]?t[r][o].extend(i):t[r][o]=i:(t[r]={},t[r][o]=i)},Dl.prototype.manageTilePyramid=function(t,e,n,i,r,o,a,s,l,u){var c=ya.getUid(e).toString();c in t.wantedTiles||(t.wantedTiles[c]={});var h,d,f,p,g,_,v=t.wantedTiles[c],y=t.tileQueue;for(_=n.getMinZoom();_<=a;++_)for(d=n.getTileRangeForExtentAndZ(o,_,d),f=n.getResolution(_),p=d.minX;p<=d.maxX;++p)for(g=d.minY;g<=d.maxY;++g)a-_<=s?((h=e.getTile(_,p,g,i,r)).getState()==Za.IDLE&&(v[h.getKey()]=!0,y.isKeyQueued(h.getKey())||y.enqueue([h,c,n.getTileCoordCenter(h.tileCoord),f])),void 0!==l&&l.call(u,h)):e.useTile(_,p,g,r)};var Fl=function(t){Dl.call(this,t),this.renderedResolution,this.transform_=Cs.create()};ya.inherits(Fl,Dl),Fl.prototype.clip=function(t,e,n){var i=e.pixelRatio,r=e.size[0]*i,o=e.size[1]*i,a=e.viewState.rotation,s=hs.getTopLeft(n),l=hs.getTopRight(n),u=hs.getBottomRight(n),c=hs.getBottomLeft(n);Cs.apply(e.coordinateToPixelTransform,s),Cs.apply(e.coordinateToPixelTransform,l),Cs.apply(e.coordinateToPixelTransform,u),Cs.apply(e.coordinateToPixelTransform,c),t.save(),Rl.rotateAtOffset(t,-a,r/2,o/2),t.beginPath(),t.moveTo(s[0]*i,s[1]*i),t.lineTo(l[0]*i,l[1]*i),t.lineTo(u[0]*i,u[1]*i),t.lineTo(c[0]*i,c[1]*i),t.clip(),Rl.rotateAtOffset(t,a,r/2,o/2)},Fl.prototype.dispatchComposeEvent_=function(t,e,n,i){var r=this.getLayer();if(r.hasListener(t)){var o=n.size[0]*n.pixelRatio,a=n.size[1]*n.pixelRatio,s=n.viewState.rotation;Rl.rotateAtOffset(e,-s,o/2,a/2);var l=void 0!==i?i:this.getTransform(n,0),u=new Ml(e,n.pixelRatio,n.extent,l,n.viewState.rotation),c=new bl(t,u,n,e,null);r.dispatchEvent(c),Rl.rotateAtOffset(e,s,o/2,a/2)}},Fl.prototype.forEachLayerAtCoordinate=function(t,e,n,i){return this.forEachFeatureAtCoordinate(t,e,0,ps.TRUE,this)?n.call(i,this.getLayer(),null):void 0},Fl.prototype.postCompose=function(t,e,n,i){this.dispatchComposeEvent_(el.POSTCOMPOSE,t,e,i)},Fl.prototype.preCompose=function(t,e,n){this.dispatchComposeEvent_(el.PRECOMPOSE,t,e,n)},Fl.prototype.dispatchRenderEvent=function(t,e,n){this.dispatchComposeEvent_(el.RENDER,t,e,n)},Fl.prototype.getTransform=function(t,e){var n=t.viewState,i=t.pixelRatio,r=i*t.size[0]/2,o=i*t.size[1]/2,a=i/n.resolution,s=-a,l=-n.rotation,u=-n.center[0]+e,c=-n.center[1];return Cs.compose(this.transform_,r,o,a,s,l,u,c)},Fl.prototype.composeFrame=function(t,e,n){},Fl.prototype.prepareFrame=function(t,e){};var kl=function(t){Fl.call(this,t),this.coordinateToCanvasPixelTransform=Cs.create(),this.hitCanvasContext_=null};ya.inherits(kl,Fl),kl.prototype.composeFrame=function(t,e,n){this.preCompose(n,t);var i=this.getImage();if(i){var r=e.extent,o=void 0!==r&&!hs.containsExtent(r,t.extent)&&hs.intersects(r,t.extent);o&&this.clip(n,t,r);var a=this.getImageTransform(),s=n.globalAlpha;n.globalAlpha=e.opacity;var l=a[4],u=a[5],c=i.width*a[0],h=i.height*a[3];n.drawImage(i,0,0,+i.width,+i.height,Math.round(l),Math.round(u),Math.round(c),Math.round(h)),n.globalAlpha=s,o&&n.restore()}this.postCompose(n,t,e)},kl.prototype.getImage=function(){},kl.prototype.getImageTransform=function(){},kl.prototype.forEachFeatureAtCoordinate=function(t,e,n,i,r){var o=this.getLayer(),a=o.getSource(),s=e.viewState.resolution,l=e.viewState.rotation,u=e.skippedFeatureUids;return a.forEachFeatureAtCoordinate(t,s,l,n,u,function(t){return i.call(r,t,o)})},kl.prototype.forEachLayerAtCoordinate=function(t,e,n,i){if(this.getImage()){if(this.getLayer().getSource().forEachFeatureAtCoordinate!==ya.nullFunction)return Fl.prototype.forEachLayerAtCoordinate.apply(this,arguments);var r=Cs.apply(this.coordinateToCanvasPixelTransform,t.slice());ss.scale(r,e.viewState.resolution/this.renderedResolution),this.hitCanvasContext_||(this.hitCanvasContext_=Xs.createCanvasContext2D(1,1)),this.hitCanvasContext_.clearRect(0,0,1,1),this.hitCanvasContext_.drawImage(this.getImage(),r[0],r[1],1,1,0,0,1,1);var o=this.hitCanvasContext_.getImageData(0,0,1,1).data;return o[3]>0?n.call(i,this.getLayer(),o):void 0}};var Nl=function(t){kl.call(this,t),this.image_=null,this.imageTransform_=Cs.create()};ya.inherits(Nl,kl),Nl.handles=function(t,e){return t===Zs.CANVAS&&e.getType()===Cl.IMAGE},Nl.create=function(t,e){return new Nl(e)},Nl.prototype.getImage=function(){return this.image_?this.image_.getImage():null},Nl.prototype.getImageTransform=function(){return this.imageTransform_},Nl.prototype.prepareFrame=function(t,e){var n,i=t.pixelRatio,r=t.size,o=t.viewState,a=o.center,s=o.resolution,l=this.getLayer().getSource(),u=t.viewHints,c=t.extent;if(void 0!==e.extent&&(c=hs.getIntersection(c,e.extent)),!u[rs.ANIMATING]&&!u[rs.INTERACTING]&&!hs.isEmpty(c)){var h=o.projection;if(!ya.ENABLE_RASTER_REPROJECTION){var d=l.getProjection();d&&(h=d)}(n=l.getImage(c,s,i,h))&&this.loadImage(n)&&(this.image_=n)}if(this.image_){var f=(n=this.image_).getExtent(),p=n.getResolution(),g=n.getPixelRatio(),_=i*p/(s*g),v=Cs.compose(this.imageTransform_,i*r[0]/2,i*r[1]/2,_,_,0,g*(f[0]-a[0])/p,g*(a[1]-f[3])/p);Cs.compose(this.coordinateToCanvasPixelTransform,i*r[0]/2-v[4],i*r[1]/2-v[5],i/s,-i/s,0,-a[0],-a[1]),this.updateLogos(t,l),this.renderedResolution=p*i/g}return!!this.image_};var Gl=function(){this.cache_={},this.cacheSize_=0,this.maxCacheSize_=32};Gl.getKey=function(t,e,n){return e+":"+t+":"+(n?Ll.asString(n):"null")},Gl.prototype.clear=function(){this.cache_={},this.cacheSize_=0},Gl.prototype.expire=function(){if(this.cacheSize_>this.maxCacheSize_){var t,e,n=0;for(t in this.cache_)e=this.cache_[t],0!=(3&n++)||e.hasListener()||(delete this.cache_[t],--this.cacheSize_)}},Gl.prototype.get=function(t,e,n){var i=Gl.getKey(t,e,n);return i in this.cache_?this.cache_[i]:null},Gl.prototype.set=function(t,e,n,i){var r=Gl.getKey(t,e,n);this.cache_[r]=i,++this.cacheSize_};var Vl={};Vl.iconImageCache=new Gl;var Ul=function(t,e){wa.call(this),this.map_=e,this.layerRenderers_={},this.layerRendererListeners_={}};ya.inherits(Ul,wa),Ul.prototype.calculateMatrices2D=function(t){var e=t.viewState,n=t.coordinateToPixelTransform,i=t.pixelToCoordinateTransform;Cs.compose(n,t.size[0]/2,t.size[1]/2,1/e.resolution,-1/e.resolution,-e.rotation,-e.center[0],-e.center[1]),Cs.invert(Cs.setFromArray(i,n))},Ul.prototype.disposeInternal=function(){for(var t in this.layerRenderers_)this.layerRenderers_[t].dispose()},Ul.expireIconCache_=function(t,e){Vl.iconImageCache.expire()},Ul.prototype.forEachFeatureAtCoordinate=function(t,e,n,i,r,o,a){var s,l=e.viewState,u=l.resolution,c=l.projection,h=t;if(c.canWrapX()){var d=c.getExtent(),f=hs.getWidth(d),p=t[0];(p<d[0]||p>d[2])&&(h=[p+f*Math.ceil((d[0]-p)/f),t[1]])}var g,_=e.layerStatesArray;for(g=_.length-1;g>=0;--g){var v=_[g],y=v.layer;if(nl.visibleAtResolution(v,u)&&o.call(a,y)){var m=this.getLayerRenderer(y);if(y.getSource()&&(s=m.forEachFeatureAtCoordinate(y.getSource().getWrapX()?h:t,e,n,function(t,n){var o=ya.getUid(t).toString(),a=e.layerStates[ya.getUid(n)].managed;if(!(o in e.skippedFeatureUids)||a)return i.call(r,t,a?n:null)},r)),s)return s}}},Ul.prototype.forEachLayerAtPixel=function(t,e,n,i,r,o){},Ul.prototype.hasFeatureAtCoordinate=function(t,e,n,i,r){return void 0!==this.forEachFeatureAtCoordinate(t,e,n,ps.TRUE,this,i,r)},Ul.prototype.getLayerRenderer=function(t){var e=ya.getUid(t).toString();if(e in this.layerRenderers_)return this.layerRenderers_[e];for(var n,i=qs.getLayerRendererPlugins(),r=this.getType(),o=0,a=i.length;o<a;++o){var s=i[o];if(s.handles(r,t)){n=s.create(this,t);break}}if(!n)throw new Error("Unable to create renderer for layer: "+t.getType());return this.layerRenderers_[e]=n,this.layerRendererListeners_[e]=Ta.listen(n,Aa.CHANGE,this.handleLayerRendererChange_,this),n},Ul.prototype.getLayerRendererByKey=function(t){return this.layerRenderers_[t]},Ul.prototype.getLayerRenderers=function(){return this.layerRenderers_},Ul.prototype.getMap=function(){return this.map_},Ul.prototype.getType=function(){},Ul.prototype.handleLayerRendererChange_=function(){this.map_.render()},Ul.prototype.removeLayerRendererByKey_=function(t){var e=this.layerRenderers_[t];return delete this.layerRenderers_[t],Ta.unlistenByKey(this.layerRendererListeners_[t]),delete this.layerRendererListeners_[t],e},Ul.prototype.renderFrame=ya.nullFunction,Ul.prototype.removeUnusedLayerRenderers_=function(t,e){var n;for(n in this.layerRenderers_)e&&n in e.layerStates||this.removeLayerRendererByKey_(n).dispose()},Ul.prototype.scheduleExpireIconCache=function(t){t.postRenderFunctions.push(Ul.expireIconCache_)},Ul.prototype.scheduleRemoveUnusedLayerRenderers=function(t){var e;for(e in this.layerRenderers_)if(!(e in t.layerStates))return void t.postRenderFunctions.push(this.removeUnusedLayerRenderers_.bind(this))},Ul.sortByZIndex=function(t,e){return t.zIndex-e.zIndex};var Bl=function(t,e){Ul.call(this,t,e),this.context_=Xs.createCanvasContext2D(),this.canvas_=this.context_.canvas,this.canvas_.style.width="100%",this.canvas_.style.height="100%",this.canvas_.style.display="block",this.canvas_.className=tl.CLASS_UNSELECTABLE,t.insertBefore(this.canvas_,t.childNodes[0]||null),this.renderedVisible_=!0,this.transform_=Cs.create()};ya.inherits(Bl,Ul),Bl.handles=function(t){return t===Zs.CANVAS},Bl.create=function(t,e){return new Bl(t,e)},Bl.prototype.dispatchComposeEvent_=function(t,e){var n=this.getMap(),i=this.context_;if(n.hasListener(t)){var r=e.extent,o=e.pixelRatio,a=e.viewState.rotation,s=this.getTransform(e),l=new Ml(i,o,r,s,a),u=new bl(t,l,e,i,null);n.dispatchEvent(u)}},Bl.prototype.getTransform=function(t){var e=t.viewState,n=this.canvas_.width/2,i=this.canvas_.height/2,r=t.pixelRatio/e.resolution,o=-r,a=-e.rotation,s=-e.center[0],l=-e.center[1];return Cs.compose(this.transform_,n,i,r,o,a,s,l)},Bl.prototype.getType=function(){return Zs.CANVAS},Bl.prototype.renderFrame=function(t){if(t){var e=this.context_,n=t.pixelRatio,i=Math.round(t.size[0]*n),r=Math.round(t.size[1]*n);this.canvas_.width!=i||this.canvas_.height!=r?(this.canvas_.width=i,this.canvas_.height=r):e.clearRect(0,0,i,r);var o=t.viewState.rotation;this.calculateMatrices2D(t),this.dispatchComposeEvent_(el.PRECOMPOSE,t);var a=t.layerStatesArray;Ha.stableSort(a,Ul.sortByZIndex),o&&(e.save(),Rl.rotateAtOffset(e,o,i/2,r/2));var s,l,u,c,h,d=t.viewState.resolution;for(s=0,l=a.length;s<l;++s)u=(h=a[s]).layer,c=this.getLayerRenderer(u),nl.visibleAtResolution(h,d)&&h.sourceState==Ys.READY&&c.prepareFrame(t,h)&&c.composeFrame(t,h,e);o&&e.restore(),this.dispatchComposeEvent_(el.POSTCOMPOSE,t),this.renderedVisible_||(this.canvas_.style.display="",this.renderedVisible_=!0),this.scheduleRemoveUnusedLayerRenderers(t),this.scheduleExpireIconCache(t)}else this.renderedVisible_&&(this.canvas_.style.display="none",this.renderedVisible_=!1)},Bl.prototype.forEachLayerAtPixel=function(t,e,n,i,r,o){var a,s,l=e.viewState.resolution,u=e.layerStatesArray,c=u.length,h=Cs.apply(e.pixelToCoordinateTransform,t.slice());for(s=c-1;s>=0;--s){var d=u[s],f=d.layer;if(nl.visibleAtResolution(d,l)&&r.call(o,f)&&(a=this.getLayerRenderer(f).forEachLayerAtCoordinate(h,e,n,i)))return a}};var zl=function(t,e,n,i){this.minX=t,this.maxX=e,this.minY=n,this.maxY=i};zl.createOrUpdate=function(t,e,n,i,r){return void 0!==r?(r.minX=t,r.maxX=e,r.minY=n,r.maxY=i,r):new zl(t,e,n,i)},zl.prototype.contains=function(t){return this.containsXY(t[1],t[2])},zl.prototype.containsTileRange=function(t){return this.minX<=t.minX&&t.maxX<=this.maxX&&this.minY<=t.minY&&t.maxY<=this.maxY},zl.prototype.containsXY=function(t,e){return this.minX<=t&&t<=this.maxX&&this.minY<=e&&e<=this.maxY},zl.prototype.equals=function(t){return this.minX==t.minX&&this.minY==t.minY&&this.maxX==t.maxX&&this.maxY==t.maxY},zl.prototype.extend=function(t){t.minX<this.minX&&(this.minX=t.minX),t.maxX>this.maxX&&(this.maxX=t.maxX),t.minY<this.minY&&(this.minY=t.minY),t.maxY>this.maxY&&(this.maxY=t.maxY)},zl.prototype.getHeight=function(){return this.maxY-this.minY+1},zl.prototype.getSize=function(){return[this.getWidth(),this.getHeight()]},zl.prototype.getWidth=function(){return this.maxX-this.minX+1},zl.prototype.intersects=function(t){return this.minX<=t.maxX&&this.maxX>=t.minX&&this.minY<=t.maxY&&this.maxY>=t.minY};var Xl=function(t){kl.call(this,t),this.context=null===this.context?null:Xs.createCanvasContext2D(),this.oversampling_,this.renderedExtent_=null,this.renderedRevision,this.renderedTiles=[],this.tmpExtent=hs.createEmpty(),this.tmpTileRange_=new zl(0,0,0,0),this.imageTransform_=Cs.create(),this.zDirection=0};ya.inherits(Xl,kl),Xl.handles=function(t,e){return t===Zs.CANVAS&&e.getType()===Cl.TILE},Xl.create=function(t,e){return new Xl(e)},Xl.prototype.isDrawableTile_=function(t){var e=t.getState(),n=this.getLayer().getUseInterimTilesOnError();return e==Za.LOADED||e==Za.EMPTY||e==Za.ERROR&&!n},Xl.prototype.prepareFrame=function(t,e){var n=t.pixelRatio,i=t.size,r=t.viewState,o=r.projection,a=r.resolution,s=r.center,l=this.getLayer(),u=l.getSource(),c=u.getRevision(),h=u.getTileGridForProjection(o),d=h.getZForResolution(a,this.zDirection),f=h.getResolution(d),p=Math.round(a/f)||1,g=t.extent;if(void 0!==e.extent&&(g=hs.getIntersection(g,e.extent)),hs.isEmpty(g))return!1;var _=h.getTileRangeForExtentAndZ(g,d),v=h.getTileRangeExtent(d,_),y=u.getTilePixelRatio(n),m={};m[d]={};var x,S,E,T=this.createLoadedTileFinder(u,o,m),w=this.tmpExtent,C=this.tmpTileRange_,b=!1;for(S=_.minX;S<=_.maxX;++S)for(E=_.minY;E<=_.maxY;++E){if((x=u.getTile(d,S,E,n,o)).getState()==Za.ERROR&&(l.getUseInterimTilesOnError()?l.getPreload()>0&&(b=!0):x.setState(Za.LOADED)),this.isDrawableTile_(x)||(x=x.getInterimTile()),this.isDrawableTile_(x)){var A=ya.getUid(this);if(x.getState()==Za.LOADED){m[d][x.tileCoord.toString()]=x;var R=x.inTransition(A);b||!R&&-1!==this.renderedTiles.indexOf(x)||(b=!0)}if(1===x.getAlpha(A,t.time))continue}var L=h.getTileCoordChildTileRange(x.tileCoord,C,w),I=!1;L&&(I=T(d+1,L)),I||h.forEachTileCoordParentTileRange(x.tileCoord,T,null,C,w)}var P=f*n/y*p,M=t.viewHints,O=M[rs.ANIMATING]||M[rs.INTERACTING];if(!(this.renderedResolution&&Date.now()-t.time>16&&O)&&(b||!this.renderedExtent_||!hs.containsExtent(this.renderedExtent_,g)||this.renderedRevision!=c||p!=this.oversampling_||!O&&P!=this.renderedResolution)){var D=this.context;if(D){var F=u.getTilePixelSize(d,n,o),k=Math.round(_.getWidth()*F[0]/p),N=Math.round(_.getHeight()*F[1]/p),G=D.canvas;G.width!=k||G.height!=N?(this.oversampling_=p,G.width=k,G.height=N):(this.renderedExtent_&&!hs.equals(v,this.renderedExtent_)&&D.clearRect(0,0,k,N),p=this.oversampling_)}this.renderedTiles.length=0;var V=Object.keys(m).map(Number);V.sort(function(t,e){return t===d?1:e===d?-1:t>e?1:t<e?-1:0});var U,B,z,X,H,W,Y,j,K,q;for(X=0,H=V.length;X<H;++X){z=V[X],B=u.getTilePixelSize(z,n,o),U=h.getResolution(z)/f,Y=y*u.getGutter(o),j=m[z];for(var Z in j)x=j[Z],S=((W=h.getTileCoordExtent(x.getTileCoord(),w))[0]-v[0])/f*y/p,E=(v[3]-W[3])/f*y/p,K=B[0]*U/p,q=B[1]*U/p,this.drawTileImage(x,t,e,S,E,K,q,Y,d===z),this.renderedTiles.push(x)}this.renderedRevision=c,this.renderedResolution=f*n/y*p,this.renderedExtent_=v}var Q=this.renderedResolution/a,J=Cs.compose(this.imageTransform_,n*i[0]/2,n*i[1]/2,Q,Q,0,(this.renderedExtent_[0]-s[0])/this.renderedResolution*n,(s[1]-this.renderedExtent_[3])/this.renderedResolution*n);return Cs.compose(this.coordinateToCanvasPixelTransform,n*i[0]/2-J[4],n*i[1]/2-J[5],n/a,-n/a,0,-s[0],-s[1]),this.updateUsedTiles(t.usedTiles,u,d,_),this.manageTilePyramid(t,u,h,n,o,g,d,l.getPreload()),this.scheduleExpireCache(t,u),this.updateLogos(t,u),this.renderedTiles.length>0},Xl.prototype.drawTileImage=function(t,e,n,i,r,o,a,s,l){var u=t.getImage(this.getLayer());if(u){var c=ya.getUid(this),h=l?t.getAlpha(c,e.time):1;1!==h||this.getLayer().getSource().getOpaque(e.viewState.projection)||this.context.clearRect(i,r,o,a);var d=h!==this.context.globalAlpha;d&&(this.context.save(),this.context.globalAlpha=h),this.context.drawImage(u,s,s,u.width-2*s,u.height-2*s,i,r,o,a),d&&this.context.restore(),1!==h?e.animate=!0:l&&t.endTransition(c)}},Xl.prototype.getImage=function(){var t=this.context;return t?t.canvas:null},Xl.prototype.getLayer,Xl.prototype.getImageTransform=function(){return this.imageTransform_};var Hl=Fn,Wl=Gn;Gn.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,n=[],i=this.toBBox;if(!Zn(t,e))return n;for(var r,o,a,s,l=[];e;){for(r=0,o=e.children.length;r<o;r++)a=e.children[r],Zn(t,s=e.leaf?i(a):a)&&(e.leaf?n.push(a):qn(t,s)?this._all(a,n):l.push(a));e=l.pop()}return n},collides:function(t){var e=this.data,n=this.toBBox;if(!Zn(t,e))return!1;for(var i,r,o,a,s=[];e;){for(i=0,r=e.children.length;i<r;i++)if(o=e.children[i],a=e.leaf?n(o):o,Zn(t,a)){if(e.leaf||qn(t,a))return!0;s.push(o)}e=s.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,n=t.length;e<n;e++)this.insert(t[e]);return this}var i=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===i.height)this._splitRoot(this.data,i);else{if(this.data.height<i.height){var r=this.data;this.data=i,i=r}this._insert(i,this.data.height-i.height-1,!0)}else this.data=i;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=Qn([]),this},remove:function(t,e){if(!t)return this;for(var n,i,r,o,a=this.data,s=this.toBBox(t),l=[],u=[];a||l.length;){if(a||(a=l.pop(),i=l[l.length-1],n=u.pop(),o=!0),a.leaf&&-1!==(r=Vn(t,a.children,e)))return a.children.splice(r,1),l.push(a),this._condense(l),this;o||a.leaf||!qn(a,s)?i?(n++,a=i.children[n],o=!1):a=null:(l.push(a),u.push(n),n=0,i=a,a=a.children[0])}return this},toBBox:function(t){return t},compareMinX:Xn,compareMinY:Hn,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var n=[];t;)t.leaf?e.push.apply(e,t.children):n.push.apply(n,t.children),t=n.pop();return e},_build:function(t,e,n,i){var r,o=n-e+1,a=this._maxEntries;if(o<=a)return r=Qn(t.slice(e,n+1)),Un(r,this.toBBox),r;i||(i=Math.ceil(Math.log(o)/Math.log(a)),a=Math.ceil(o/Math.pow(a,i-1))),(r=Qn([])).leaf=!1,r.height=i;var s,l,u,c,h=Math.ceil(o/a),d=h*Math.ceil(Math.sqrt(a));for(Jn(t,e,n,d,this.compareMinX),s=e;s<=n;s+=d)for(Jn(t,s,u=Math.min(s+d-1,n),h,this.compareMinY),l=s;l<=u;l+=h)c=Math.min(l+h-1,u),r.children.push(this._build(t,l,c,i-1));return Un(r,this.toBBox),r},_chooseSubtree:function(t,e,n,i){for(var r,o,a,s,l,u,c,h;;){if(i.push(e),e.leaf||i.length-1===n)break;for(c=h=1/0,r=0,o=e.children.length;r<o;r++)l=Wn(a=e.children[r]),(u=jn(t,a)-l)<h?(h=u,c=l<c?l:c,s=a):u===h&&l<c&&(c=l,s=a);e=s||e.children[0]}return e},_insert:function(t,e,n){var i=this.toBBox,r=n?t:i(t),o=[],a=this._chooseSubtree(r,this.data,e,o);for(a.children.push(t),zn(a,r);e>=0&&o[e].children.length>this._maxEntries;)this._split(o,e),e--;this._adjustParentBBoxes(r,o,e)},_split:function(t,e){var n=t[e],i=n.children.length,r=this._minEntries;this._chooseSplitAxis(n,r,i);var o=this._chooseSplitIndex(n,r,i),a=Qn(n.children.splice(o,n.children.length-o));a.height=n.height,a.leaf=n.leaf,Un(n,this.toBBox),Un(a,this.toBBox),e?t[e-1].children.push(a):this._splitRoot(n,a)},_splitRoot:function(t,e){this.data=Qn([t,e]),this.data.height=t.height+1,this.data.leaf=!1,Un(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,n){var i,r,o,a,s,l,u,c;for(l=u=1/0,i=e;i<=n-e;i++)a=Kn(r=Bn(t,0,i,this.toBBox),o=Bn(t,i,n,this.toBBox)),s=Wn(r)+Wn(o),a<l?(l=a,c=i,u=s<u?s:u):a===l&&s<u&&(u=s,c=i);return c},_chooseSplitAxis:function(t,e,n){var i=t.leaf?this.compareMinX:Xn,r=t.leaf?this.compareMinY:Hn;this._allDistMargin(t,e,n,i)<this._allDistMargin(t,e,n,r)&&t.children.sort(i)},_allDistMargin:function(t,e,n,i){t.children.sort(i);var r,o,a=this.toBBox,s=Bn(t,0,e,a),l=Bn(t,n-e,n,a),u=Yn(s)+Yn(l);for(r=e;r<n-e;r++)o=t.children[r],zn(s,t.leaf?a(o):o),u+=Yn(s);for(r=n-e-1;r>=e;r--)o=t.children[r],zn(l,t.leaf?a(o):o),u+=Yn(l);return u},_adjustParentBBoxes:function(t,e,n){for(var i=n;i>=0;i--)zn(e[i],t)},_condense:function(t){for(var e,n=t.length-1;n>=0;n--)0===t[n].children.length?n>0?(e=t[n-1].children).splice(e.indexOf(t[n]),1):this.clear():Un(t[n],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}};var Yl=function(){};Yl.prototype.getReplay=function(t,e){},Yl.prototype.isEmpty=function(){};var jl={CIRCLE:"Circle",DEFAULT:"Default",IMAGE:"Image",LINE_STRING:"LineString",POLYGON:"Polygon",TEXT:"Text"},Kl={};Kl.lineString=function(t,e,n,i){var r,o=t[e],a=t[e+1],s=0;for(r=e+i;r<n;r+=i){var l=t[r],u=t[r+1];s+=Math.sqrt((l-o)*(l-o)+(u-a)*(u-a)),o=l,a=u}return s},Kl.linearRing=function(t,e,n,i){var r=Kl.lineString(t,e,n,i),o=t[n-i]-t[e],a=t[n-i+1]-t[e+1];return r+=Math.sqrt(o*o+a*a)};var ql={};ql.lineString=function(t,e,n,i,r,o,a,s){for(var l,u,c,h=[],d=t[e]>t[n-i],f=r.length,p=t[e],g=t[e+1],_=t[e+=i],v=t[e+1],y=0,m=Math.sqrt(Math.pow(_-p,2)+Math.pow(v-g,2)),x="",S=0,E=0;E<f;++E){u=d?f-E-1:E;var T=r.charAt(u),w=o(x=d?T+x:x+T)-S;S+=w;for(var C=a+w/2;e<n-i&&y+m<C;)p=_,g=v,_=t[e+=i],v=t[e+1],y+=m,m=Math.sqrt(Math.pow(_-p,2)+Math.pow(v-g,2));var b=C-y,A=Math.atan2(v-g,_-p);if(d&&(A+=A>0?-Math.PI:Math.PI),void 0!==c){var R=A-c;if(R+=R>Math.PI?-2*Math.PI:R<-Math.PI?2*Math.PI:0,Math.abs(R)>s)return null}var L=b/m,I=ts.lerp(p,_,L),P=ts.lerp(g,v,L);c==A?(d&&(l[0]=I,l[1]=P,l[2]=w/2),l[4]=x):(S=w,l=[I,P,w/2,A,x=T],d?h.unshift(l):h.push(l),c=A),a+=w}return h};var Zl={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},Ql=function(t,e,n,i,r,o){Pl.call(this),this.declutterTree=o,this.tmpExtent_=hs.createEmpty(),this.tolerance=t,this.maxExtent=e,this.overlaps=r,this.pixelRatio=i,this.maxLineWidth=0,this.resolution=n,this.fillOrigin_,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.coordinateCache_={},this.renderedTransform_=Cs.create(),this.hitDetectionInstructions=[],this.pixelCoordinates_=null,this.state={},this.tmpLocalTransform_=Cs.create(),this.resetTransform_=Cs.create()};ya.inherits(Ql,Pl),Ql.prototype.replayImage_=function(t,e,n,i,r,o,a,s,l,u,c,h,d,f,p){var g=this.tmpLocalTransform_;e-=r*=d,n-=o*=d,f&&(e=Math.round(e),n=Math.round(n));var _=p+u>i.width?i.width-u:p,v=s+c>i.height?i.height-c:s,y=this.tmpExtent_,m=null;if(0!==h){var x=e+r,S=n+o;m=Cs.compose(g,x,S,1,1,h,-x,-S),hs.createOrUpdateEmpty(y),hs.extendCoordinate(y,Cs.apply(g,[e,n])),hs.extendCoordinate(y,Cs.apply(g,[e+_,n])),hs.extendCoordinate(y,Cs.apply(g,[e+_,n+v])),hs.extendCoordinate(y,Cs.apply(g,[e,n+_]))}else hs.createOrUpdate(e,n,e+_*d,n+v*d,y);var E=t.canvas,T=y[0]<=E.width&&y[2]>=0&&y[1]<=E.height&&y[3]>=0;if(a){if(!T&&1==a[4])return;hs.extend(a,y),a.push(T?[t,m?m.slice(0):null,l,i,u,c,_,v,e,n,d]:null)}else T&&Rl.drawImage(t,m,l,i,u,c,_,v,e,n,d)},Ql.prototype.applyPixelRatio=function(t){var e=this.pixelRatio;return 1==e?t:t.map(function(t){return t*e})},Ql.prototype.appendFlatCoordinates=function(t,e,n,i,r,o){var a=this.coordinates.length,s=this.getBufferedMaxExtent();o&&(e+=i);var l,u,c,h=[t[e],t[e+1]],d=[NaN,NaN],f=!0;for(l=e+i;l<n;l+=i)d[0]=t[l],d[1]=t[l+1],(c=hs.coordinateRelationship(s,d))!==u?(f&&(this.coordinates[a++]=h[0],this.coordinates[a++]=h[1]),this.coordinates[a++]=d[0],this.coordinates[a++]=d[1],f=!1):c===cs.INTERSECTING?(this.coordinates[a++]=d[0],this.coordinates[a++]=d[1],f=!1):f=!0,h[0]=d[0],h[1]=d[1],u=c;return(r&&f||l===e+i)&&(this.coordinates[a++]=h[0],this.coordinates[a++]=h[1]),a},Ql.prototype.drawCustomCoordinates_=function(t,e,n,i,r){for(var o=0,a=n.length;o<a;++o){var s=n[o],l=this.appendFlatCoordinates(t,e,s,i,!1,!1);r.push(l),e=s}return e},Ql.prototype.drawCustom=function(t,e,n){this.beginGeometry(t,e);var i,r,o,a,s,l=t.getType(),u=t.getStride(),c=this.coordinates.length;if(l==ds.MULTI_POLYGON){i=(t=t).getOrientedFlatCoordinates(),a=[];var h=t.getEndss();s=0;for(var d=0,f=h.length;d<f;++d){var p=[];s=this.drawCustomCoordinates_(i,s,h[d],u,p),a.push(p)}this.instructions.push([Zl.CUSTOM,c,a,t,n,Ps.coordinatesss])}else l==ds.POLYGON||l==ds.MULTI_LINE_STRING?(o=[],i=l==ds.POLYGON?t.getOrientedFlatCoordinates():t.getFlatCoordinates(),s=this.drawCustomCoordinates_(i,0,t.getEnds(),u,o),this.instructions.push([Zl.CUSTOM,c,o,t,n,Ps.coordinatess])):l==ds.LINE_STRING||l==ds.MULTI_POINT?(i=t.getFlatCoordinates(),r=this.appendFlatCoordinates(i,0,i.length,u,!1,!1),this.instructions.push([Zl.CUSTOM,c,r,t,n,Ps.coordinates])):l==ds.POINT&&(i=t.getFlatCoordinates(),this.coordinates.push(i[0],i[1]),r=this.coordinates.length,this.instructions.push([Zl.CUSTOM,c,r,t,n]));this.endGeometry(t,e)},Ql.prototype.beginGeometry=function(t,e){this.beginGeometryInstruction1_=[Zl.BEGIN_GEOMETRY,e,0],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[Zl.BEGIN_GEOMETRY,e,0],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)},Ql.prototype.fill_=function(t,e){if(this.fillOrigin_){var n=Cs.apply(this.renderedTransform_,this.fillOrigin_.slice());t.translate(n[0],n[1]),t.rotate(e)}t.fill(),this.fillOrigin_&&t.setTransform.apply(t,Rl.resetTransform_)},Ql.prototype.renderDeclutter_=function(t){if(t&&t.length>5){var e=t[4];if(1==e||e==t.length-5){var n={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]};if(!this.declutterTree.collides(n)){this.declutterTree.insert(n);for(var i=Rl.drawImage,r=5,o=t.length;r<o;++r)t[r]&&i.apply(void 0,t[r])}t.length=5,hs.createOrUpdateEmpty(t)}}},Ql.prototype.replay_=function(t,e,n,i,r,o,a){var s;this.pixelCoordinates_&&Ha.equals(e,this.renderedTransform_)?s=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),s=gs.transform2D(this.coordinates,0,this.coordinates.length,2,e,this.pixelCoordinates_),Cs.setFromArray(this.renderedTransform_,e));for(var l,u,c,h,d,f,p,g,_=!Ea.isEmpty(i),v=0,y=r.length,m=0,x=0,S=0,E=this.coordinateCache_,T={context:t,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:n},w=this.instructions!=r||this.overlaps?0:200;v<y;){var C,b,A,R=r[v];switch(R[0]){case Zl.BEGIN_GEOMETRY:C=R[1],_&&i[ya.getUid(C).toString()]||!C.getGeometry()?v=R[2]:void 0===a||hs.intersects(a,C.getGeometry().getExtent())?++v:v=R[2]+1;break;case Zl.BEGIN_PATH:x>w&&(this.fill_(t,n),x=0),S>w&&(t.stroke(),S=0),x||S||(t.beginPath(),h=d=NaN),++v;break;case Zl.CIRCLE:var L=s[m=R[1]],I=s[m+1],P=s[m+2]-L,M=s[m+3]-I,O=Math.sqrt(P*P+M*M);t.moveTo(L+O,I),t.arc(L,I,O,0,2*Math.PI,!0),++v;break;case Zl.CLOSE_PATH:t.closePath(),++v;break;case Zl.CUSTOM:m=R[1],l=R[2];var D=R[3],F=R[4],k=6==R.length?R[5]:void 0;T.geometry=D,T.feature=C,v in E||(E[v]=[]);var N=E[v];k?k(s,m,l,2,N):(N[0]=s[m],N[1]=s[m+1],N.length=2),F(N,T),++v;break;case Zl.DRAW_IMAGE:m=R[1],l=R[2];var G=R[3];u=R[4],c=R[5],g=R[6];var V=R[7],U=R[8],B=R[9],z=R[10],X=R[11],H=R[12],W=R[13],Y=R[14],j=R[15];for(X&&(H+=n);m<l;m+=2)this.replayImage_(t,s[m],s[m+1],G,u,c,g,V,U,B,z,H,W,Y,j);this.renderDeclutter_(g),++v;break;case Zl.DRAW_CHARS:var K=R[1],q=R[2],Z=R[3];g=R[4];var Q=R[5],J=R[6],$=R[7],tt=R[8],et=R[9],nt=R[10],it=R[11],rt=R[12],ot=R[13],at=R[14],st=Kl.lineString(s,K,q,2),lt=tt(rt);if(Q||lt<=st){var ut=(st-lt)*ot,ct=ql.lineString(s,K,q,2,rt,tt,ut,$);if(ct){var ht,dt,ft,pt,gt;if(nt)for(ht=0,dt=ct.length;ht<dt;++ht)ft=(gt=ct[ht])[4],pt=this.getImage(ft,!1,!0),u=gt[2]+it,c=Z*pt.height+2*(.5-Z)*it-et,this.replayImage_(t,gt[0],gt[1],pt,u,c,g,pt.height,1,0,0,gt[3],at,!1,pt.width);if(J)for(ht=0,dt=ct.length;ht<dt;++ht)ft=(gt=ct[ht])[4],pt=this.getImage(ft,!0,!1),u=gt[2],c=Z*pt.height-et,this.replayImage_(t,gt[0],gt[1],pt,u,c,g,pt.height,1,0,0,gt[3],at,!1,pt.width)}}this.renderDeclutter_(g),++v;break;case Zl.END_GEOMETRY:if(void 0!==o){var _t=o(C=R[1]);if(_t)return _t}++v;break;case Zl.FILL:w?x++:this.fill_(t,n),++v;break;case Zl.MOVE_TO_LINE_TO:for(m=R[1],l=R[2],b=s[m],p=(A=s[m+1])+.5|0,(f=b+.5|0)===h&&p===d||(t.moveTo(b,A),h=f,d=p),m+=2;m<l;m+=2)f=(b=s[m])+.5|0,p=(A=s[m+1])+.5|0,m!=l-2&&f===h&&p===d||(t.lineTo(b,A),h=f,d=p);++v;break;case Zl.SET_FILL_STYLE:this.fillOrigin_=R[2],x&&(this.fill_(t,n),x=0,S&&(t.stroke(),S=0)),t.fillStyle=R[1],++v;break;case Zl.SET_STROKE_STYLE:S&&(t.stroke(),S=0),t.strokeStyle=R[1],t.lineWidth=R[2],t.lineCap=R[3],t.lineJoin=R[4],t.miterLimit=R[5],Da.CANVAS_LINE_DASH&&(t.lineDashOffset=R[7],t.setLineDash(R[6])),++v;break;case Zl.STROKE:w?S++:t.stroke(),++v;break;default:++v}}x&&this.fill_(t,n),S&&t.stroke()},Ql.prototype.replay=function(t,e,n,i){var r=this.instructions;this.replay_(t,e,n,i,r,void 0,void 0)},Ql.prototype.replayHitDetection=function(t,e,n,i,r,o){var a=this.hitDetectionInstructions;return this.replay_(t,e,n,i,a,r,o)},Ql.prototype.reverseHitDetectionInstructions=function(){var t=this.hitDetectionInstructions;t.reverse();var e,n,i,r=t.length,o=-1;for(e=0;e<r;++e)(i=(n=t[e])[0])==Zl.END_GEOMETRY?o=e:i==Zl.BEGIN_GEOMETRY&&(n[2]=e,Ha.reverseSubArray(this.hitDetectionInstructions,o,e),o=-1)},Ql.prototype.setFillStrokeStyle=function(t,e){var n=this.state;if(t){var i=t.getColor();n.fillStyle=Il.asColorLike(i||Rl.defaultFillStyle)}else n.fillStyle=void 0;if(e){var r=e.getColor();n.strokeStyle=Il.asColorLike(r||Rl.defaultStrokeStyle);var o=e.getLineCap();n.lineCap=void 0!==o?o:Rl.defaultLineCap;var a=e.getLineDash();n.lineDash=a?a.slice():Rl.defaultLineDash;var s=e.getLineDashOffset();n.lineDashOffset=s||Rl.defaultLineDashOffset;var l=e.getLineJoin();n.lineJoin=void 0!==l?l:Rl.defaultLineJoin;var u=e.getWidth();n.lineWidth=void 0!==u?u:Rl.defaultLineWidth;var c=e.getMiterLimit();n.miterLimit=void 0!==c?c:Rl.defaultMiterLimit,n.lineWidth>this.maxLineWidth&&(this.maxLineWidth=n.lineWidth,this.bufferedMaxExtent_=null)}else n.strokeStyle=void 0,n.lineCap=void 0,n.lineDash=null,n.lineDashOffset=void 0,n.lineJoin=void 0,n.lineWidth=void 0,n.miterLimit=void 0},Ql.prototype.updateStrokeStyle=function(t,e){var n=t.strokeStyle,i=t.lineCap,r=t.lineDash,o=t.lineDashOffset,a=t.lineJoin,s=t.lineWidth,l=t.miterLimit;t.currentStrokeStyle==n&&t.currentLineCap==i&&Ha.equals(t.currentLineDash,r)&&t.currentLineDashOffset==o&&t.currentLineJoin==a&&t.currentLineWidth==s&&t.currentMiterLimit==l||(e&&(void 0!=t.lastStroke&&t.lastStroke!=this.coordinates.length&&(this.instructions.push([Zl.STROKE]),t.lastStroke=this.coordinates.length),t.lastStroke=0),this.instructions.push([Zl.SET_STROKE_STYLE,n,s*this.pixelRatio,i,a,l,this.applyPixelRatio(r),o*this.pixelRatio]),e&&this.instructions.push([Zl.BEGIN_PATH]),t.currentStrokeStyle=n,t.currentLineCap=i,t.currentLineDash=r,t.currentLineDashOffset=o,t.currentLineJoin=a,t.currentLineWidth=s,t.currentMiterLimit=l)},Ql.prototype.endGeometry=function(t,e){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;var n=[Zl.END_GEOMETRY,e];this.instructions.push(n),this.hitDetectionInstructions.push(n)},Ql.prototype.finish=ya.nullFunction,Ql.prototype.getBufferedMaxExtent=function(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=hs.clone(this.maxExtent),this.maxLineWidth>0)){var t=this.resolution*(this.maxLineWidth+1)/2;hs.buffer(this.bufferedMaxExtent_,t,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_};var Jl=function(t,e,n,i,r,o){Ql.call(this,t,e,n,i,r,o),this.declutterGroup_=null,this.hitDetectionImage_=null,this.image_=null,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.snapToPixel_=void 0,this.width_=void 0};ya.inherits(Jl,Ql),Jl.prototype.drawCoordinates_=function(t,e,n,i){return this.appendFlatCoordinates(t,e,n,i,!1,!1)},Jl.prototype.drawPoint=function(t,e){if(this.image_){this.beginGeometry(t,e);var n=t.getFlatCoordinates(),i=t.getStride(),r=this.coordinates.length,o=this.drawCoordinates_(n,0,n.length,i);this.instructions.push([Zl.DRAW_IMAGE,r,o,this.image_,this.anchorX_,this.anchorY_,this.declutterGroup_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_*this.pixelRatio,this.snapToPixel_,this.width_]),this.hitDetectionInstructions.push([Zl.DRAW_IMAGE,r,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.declutterGroup_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.snapToPixel_,this.width_]),this.endGeometry(t,e)}},Jl.prototype.drawMultiPoint=function(t,e){if(this.image_){this.beginGeometry(t,e);var n=t.getFlatCoordinates(),i=t.getStride(),r=this.coordinates.length,o=this.drawCoordinates_(n,0,n.length,i);this.instructions.push([Zl.DRAW_IMAGE,r,o,this.image_,this.anchorX_,this.anchorY_,this.declutterGroup_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_*this.pixelRatio,this.snapToPixel_,this.width_]),this.hitDetectionInstructions.push([Zl.DRAW_IMAGE,r,o,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.declutterGroup_,this.height_,this.opacity_,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.snapToPixel_,this.width_]),this.endGeometry(t,e)}},Jl.prototype.finish=function(){this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.snapToPixel_=void 0,this.width_=void 0},Jl.prototype.setImageStyle=function(t,e){var n=t.getAnchor(),i=t.getSize(),r=t.getHitDetectionImage(1),o=t.getImage(1),a=t.getOrigin();this.anchorX_=n[0],this.anchorY_=n[1],this.declutterGroup_=e,this.hitDetectionImage_=r,this.image_=o,this.height_=i[1],this.opacity_=t.getOpacity(),this.originX_=a[0],this.originY_=a[1],this.rotateWithView_=t.getRotateWithView(),this.rotation_=t.getRotation(),this.scale_=t.getScale(),this.snapToPixel_=t.getSnapToPixel(),this.width_=i[0]};var $l=function(t,e,n,i,r,o){Ql.call(this,t,e,n,i,r,o)};ya.inherits($l,Ql),$l.prototype.drawFlatCoordinates_=function(t,e,n,i){var r=this.coordinates.length,o=this.appendFlatCoordinates(t,e,n,i,!1,!1),a=[Zl.MOVE_TO_LINE_TO,r,o];return this.instructions.push(a),this.hitDetectionInstructions.push(a),n},$l.prototype.drawLineString=function(t,e){var n=this.state,i=n.strokeStyle,r=n.lineWidth;if(void 0!==i&&void 0!==r){this.updateStrokeStyle(n,!0),this.beginGeometry(t,e),this.hitDetectionInstructions.push([Zl.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,n.lineDash,n.lineDashOffset],[Zl.BEGIN_PATH]);var o=t.getFlatCoordinates(),a=t.getStride();this.drawFlatCoordinates_(o,0,o.length,a),this.hitDetectionInstructions.push([Zl.STROKE]),this.endGeometry(t,e)}},$l.prototype.drawMultiLineString=function(t,e){var n=this.state,i=n.strokeStyle,r=n.lineWidth;if(void 0!==i&&void 0!==r){this.updateStrokeStyle(n,!0),this.beginGeometry(t,e),this.hitDetectionInstructions.push([Zl.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,n.lineDash,n.lineDashOffset],[Zl.BEGIN_PATH]);var o,a,s=t.getEnds(),l=t.getFlatCoordinates(),u=t.getStride(),c=0;for(o=0,a=s.length;o<a;++o)c=this.drawFlatCoordinates_(l,c,s[o],u);this.hitDetectionInstructions.push([Zl.STROKE]),this.endGeometry(t,e)}},$l.prototype.finish=function(){var t=this.state;void 0!=t.lastStroke&&t.lastStroke!=this.coordinates.length&&this.instructions.push([Zl.STROKE]),this.reverseHitDetectionInstructions(),this.state=null};var tu=function(t,e,n,i,r,o){Ql.call(this,t,e,n,i,r,o)};ya.inherits(tu,Ql),tu.prototype.drawFlatCoordinatess_=function(t,e,n,i){var r=this.state,o=void 0!==r.fillStyle,a=void 0!=r.strokeStyle,s=n.length,l=[Zl.BEGIN_PATH];this.instructions.push(l),this.hitDetectionInstructions.push(l);for(var u=0;u<s;++u){var c=n[u],h=this.coordinates.length,d=this.appendFlatCoordinates(t,e,c,i,!0,!a),f=[Zl.MOVE_TO_LINE_TO,h,d];if(this.instructions.push(f),this.hitDetectionInstructions.push(f),a){var p=[Zl.CLOSE_PATH];this.instructions.push(p),this.hitDetectionInstructions.push(p)}e=c}var g=[Zl.FILL];if(this.hitDetectionInstructions.push(g),o&&this.instructions.push(g),a){var _=[Zl.STROKE];this.instructions.push(_),this.hitDetectionInstructions.push(_)}return e},tu.prototype.drawCircle=function(t,e){var n=this.state,i=n.fillStyle,r=n.strokeStyle;if(void 0!==i||void 0!==r){this.setFillStrokeStyles_(t),this.beginGeometry(t,e),this.hitDetectionInstructions.push([Zl.SET_FILL_STYLE,Ll.asString(Rl.defaultFillStyle)]),void 0!==n.strokeStyle&&this.hitDetectionInstructions.push([Zl.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,n.lineDash,n.lineDashOffset]);var o=t.getFlatCoordinates(),a=t.getStride(),s=this.coordinates.length;this.appendFlatCoordinates(o,0,o.length,a,!1,!1);var l=[Zl.BEGIN_PATH],u=[Zl.CIRCLE,s];this.instructions.push(l,u),this.hitDetectionInstructions.push(l,u);var c=[Zl.FILL];if(this.hitDetectionInstructions.push(c),void 0!==n.fillStyle&&this.instructions.push(c),void 0!==n.strokeStyle){var h=[Zl.STROKE];this.instructions.push(h),this.hitDetectionInstructions.push(h)}this.endGeometry(t,e)}},tu.prototype.drawPolygon=function(t,e){var n=this.state;this.setFillStrokeStyles_(t),this.beginGeometry(t,e),this.hitDetectionInstructions.push([Zl.SET_FILL_STYLE,Ll.asString(Rl.defaultFillStyle)]),void 0!==n.strokeStyle&&this.hitDetectionInstructions.push([Zl.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,n.lineDash,n.lineDashOffset]);var i=t.getEnds(),r=t.getOrientedFlatCoordinates(),o=t.getStride();this.drawFlatCoordinatess_(r,0,i,o),this.endGeometry(t,e)},tu.prototype.drawMultiPolygon=function(t,e){var n=this.state,i=n.fillStyle,r=n.strokeStyle;if(void 0!==i||void 0!==r){this.setFillStrokeStyles_(t),this.beginGeometry(t,e),this.hitDetectionInstructions.push([Zl.SET_FILL_STYLE,Ll.asString(Rl.defaultFillStyle)]),void 0!==n.strokeStyle&&this.hitDetectionInstructions.push([Zl.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,n.lineDash,n.lineDashOffset]);var o,a,s=t.getEndss(),l=t.getOrientedFlatCoordinates(),u=t.getStride(),c=0;for(o=0,a=s.length;o<a;++o)c=this.drawFlatCoordinatess_(l,c,s[o],u);this.endGeometry(t,e)}},tu.prototype.finish=function(){this.reverseHitDetectionInstructions(),this.state=null;var t=this.tolerance;if(0!==t){var e,n,i=this.coordinates;for(e=0,n=i.length;e<n;++e)i[e]=Ms.snap(i[e],t)}},tu.prototype.setFillStrokeStyles_=function(t){var e=this.state,n=e.fillStyle;if(void 0!==n&&("string"!=typeof n||e.currentFillStyle!=n)){var i=[Zl.SET_FILL_STYLE,n];if("string"!=typeof n){var r=t.getExtent();i.push([r[0],r[3]])}this.instructions.push(i),e.currentFillStyle=e.fillStyle}void 0!==e.strokeStyle&&this.updateStrokeStyle(e,!1)};var eu={};eu.lineString=function(t,e,n,i,r){var o,a,s,l,u,c,h,d,f,p=n,g=n,_=0,v=0,y=n;for(o=n;o<i;o+=r){var m=e[o],x=e[o+1];void 0!==l&&(d=m-l,f=x-u,s=Math.sqrt(d*d+f*f),void 0!==c&&(v+=a,Math.acos((c*d+h*f)/(a*s))>t&&(v>_&&(_=v,p=y,g=o),v=0,y=o-r)),a=s,c=d,h=f),l=m,u=x}return(v+=s)>_?[y,o]:[p,g]};var nu={};nu.ORDER=[jl.POLYGON,jl.CIRCLE,jl.LINE_STRING,jl.IMAGE,jl.TEXT,jl.DEFAULT],nu.TEXT_ALIGN={},nu.TEXT_ALIGN.left=0,nu.TEXT_ALIGN.end=0,nu.TEXT_ALIGN.center=.5,nu.TEXT_ALIGN.right=1,nu.TEXT_ALIGN.start=1,nu.TEXT_ALIGN.top=0,nu.TEXT_ALIGN.middle=.5,nu.TEXT_ALIGN.hanging=.2,nu.TEXT_ALIGN.alphabetic=.8,nu.TEXT_ALIGN.ideographic=.8,nu.TEXT_ALIGN.bottom=1;var iu={POINT:"point",LINE:"line"},ru=function(t,e,n,i,r,o){Ql.call(this,t,e,n,i,r,o),this.declutterGroup_,this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textRotation_=0,this.textFillState_=null,this.textStrokeState_=null,this.textState_={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.widths_={}};ya.inherits(ru,Ql),ru.measureTextHeight=function(){var t,e={};return function(n){var i=e[n];return void 0==i&&(t||((t=document.createElement("span")).textContent="M",t.style.margin=t.style.padding="0 !important",t.style.position="absolute !important",t.style.left="-99999px !important"),t.style.font=n,document.body.appendChild(t),i=e[n]=t.offsetHeight,document.body.removeChild(t)),i}}(),ru.measureTextWidth=function(){var t,e;return function(n,i){return t||(t=Xs.createCanvasContext2D(1,1)),n!=e&&(e=t.font=n),t.measureText(i).width}}(),ru.measureTextWidths=function(t,e,n){var i,r,o=e.length,a=0;for(r=0;r<o;++r)i=ru.measureTextWidth(t,e[r]),a=Math.max(a,i),n.push(i);return a},ru.prototype.drawText=function(t,e){var n=this.textFillState_,i=this.textStrokeState_,r=this.textState_;if(""!==this.text_&&r&&(n||i)){var o,a,s=this.coordinates.length,l=t.getType(),u=null,c=2,h=2;if(r.placement===iu.LINE){if(!hs.intersects(this.getBufferedMaxExtent(),t.getExtent()))return;var d;if(u=t.getFlatCoordinates(),h=t.getStride(),l==ds.LINE_STRING)d=[u.length];else if(l==ds.MULTI_LINE_STRING)d=t.getEnds();else if(l==ds.POLYGON)d=t.getEnds().slice(0,1);else if(l==ds.MULTI_POLYGON){var f=t.getEndss();for(d=[],o=0,a=f.length;o<a;++o)d.push(f[o][0])}this.beginGeometry(t,e);for(var p,g=r.textAlign,_=0,v=0,y=d.length;v<y;++v){if(void 0==g){var m=eu.lineString(r.maxAngle,u,_,d[v],h);_=m[0],p=m[1]}else p=d[v];for(o=_;o<p;o+=h)this.coordinates.push(u[o],u[o+1]);c=this.coordinates.length,_=d[v],this.drawChars_(s,c,this.declutterGroup_),s=c}this.endGeometry(t,e)}else{var x=this.getImage(this.text_,!!this.textFillState_,!!this.textStrokeState_),S=x.width/this.pixelRatio;switch(l){case ds.POINT:case ds.MULTI_POINT:c=(u=t.getFlatCoordinates()).length;break;case ds.LINE_STRING:u=t.getFlatMidpoint();break;case ds.CIRCLE:u=t.getCenter();break;case ds.MULTI_LINE_STRING:c=(u=t.getFlatMidpoints()).length;break;case ds.POLYGON:if(u=t.getFlatInteriorPoint(),!r.exceedLength&&u[2]/this.resolution<S)return;h=3;break;case ds.MULTI_POLYGON:var E=t.getFlatInteriorPoints();for(u=[],o=0,a=E.length;o<a;o+=3)(r.exceedLength||E[o+2]/this.resolution>=S)&&u.push(E[o],E[o+1]);if(0==(c=u.length))return}c=this.appendFlatCoordinates(u,0,c,h,!1,!1),this.beginGeometry(t,e),this.drawTextImage_(x,s,c),this.endGeometry(t,e)}}},ru.prototype.getImage=function(t,e,n){var i,r=(n?this.strokeKey_:"")+this.textKey_+t+(e?this.fillKey_:""),o=Rl.labelCache;if(!o.containsKey(r)){var a=this.textStrokeState_,s=this.textFillState_,l=this.textState_,u=this.pixelRatio,c=l.scale*u,h=nu.TEXT_ALIGN[l.textAlign||Rl.defaultTextAlign],d=n&&a.lineWidth?a.lineWidth:0,f=t.split("\n"),p=f.length,g=[],_=ru.measureTextWidths(l.font,f,g),v=ru.measureTextHeight(l.font),y=v*p,m=_+d,x=Xs.createCanvasContext2D(Math.ceil(m*c),Math.ceil((y+d)*c));i=x.canvas,o.pruneAndSet(r,i),1!=c&&x.scale(c,c),x.font=l.font,n&&(x.strokeStyle=a.strokeStyle,x.lineWidth=d*(Da.SAFARI?c:1),x.lineCap=a.lineCap,x.lineJoin=a.lineJoin,x.miterLimit=a.miterLimit,Da.CANVAS_LINE_DASH&&a.lineDash.length&&(x.setLineDash(a.lineDash),x.lineDashOffset=a.lineDashOffset)),e&&(x.fillStyle=s.fillStyle),x.textBaseline="top",x.textAlign="center";var S,E=.5-h,T=h*i.width/c+E*d;if(n)for(S=0;S<p;++S)x.strokeText(f[S],T+E*g[S],.5*d+S*v);if(e)for(S=0;S<p;++S)x.fillText(f[S],T+E*g[S],.5*d+S*v)}return o.get(r)},ru.prototype.drawTextImage_=function(t,e,n){var i=this.textState_,r=this.textStrokeState_,o=this.pixelRatio,a=nu.TEXT_ALIGN[i.textAlign||Rl.defaultTextAlign],s=nu.TEXT_ALIGN[i.textBaseline],l=r&&r.lineWidth?r.lineWidth:0,u=a*t.width/o+2*(.5-a)*l,c=s*t.height/o+2*(.5-s)*l;this.instructions.push([Zl.DRAW_IMAGE,e,n,t,(u-this.textOffsetX_)*o,(c-this.textOffsetY_)*o,this.declutterGroup_,t.height,1,0,0,this.textRotateWithView_,this.textRotation_,1,!0,t.width]),this.hitDetectionInstructions.push([Zl.DRAW_IMAGE,e,n,t,(u-this.textOffsetX_)*o,(c-this.textOffsetY_)*o,this.declutterGroup_,t.height,1,0,0,this.textRotateWithView_,this.textRotation_,1/o,!0,t.width])},ru.prototype.drawChars_=function(t,e,n){var i=this.pixelRatio,r=this.textStrokeState_,o=!!this.textFillState_,a=!!r,s=this.textState_,l=nu.TEXT_ALIGN[s.textBaseline],u=this.textOffsetY_*i,c=nu.TEXT_ALIGN[s.textAlign||Rl.defaultTextAlign],h=this.text_,d=s.font,f=s.scale,p=r?r.lineWidth*f/2:0,g=this.widths_;this.instructions.push([Zl.DRAW_CHARS,t,e,l,n,s.exceedLength,o,s.maxAngle,function(t){var e=g[t];return e||(e=g[t]=ru.measureTextWidth(d,t)),e*f*i},u,a,p*i,h,c,1]),this.hitDetectionInstructions.push([Zl.DRAW_CHARS,t,e,l,n,s.exceedLength,o,s.maxAngle,function(t){var e=g[t];return e||(e=g[t]=ru.measureTextWidth(d,t)),e*f},u,a,p,h,c,1/i])},ru.prototype.setTextStyle=function(t,e){var n,i,r;if(t){this.declutterGroup_=e;var o=t.getFill();o?((i=this.textFillState_)||(i=this.textFillState_={}),i.fillStyle=Il.asColorLike(o.getColor()||Rl.defaultFillStyle)):i=this.textFillState_=null;var a=t.getStroke();if(a){(r=this.textStrokeState_)||(r=this.textStrokeState_={});var s=a.getLineDash(),l=a.getLineDashOffset(),u=a.getWidth(),c=a.getMiterLimit();r.lineCap=a.getLineCap()||Rl.defaultLineCap,r.lineDash=s?s.slice():Rl.defaultLineDash,r.lineDashOffset=void 0===l?Rl.defaultLineDashOffset:l,r.lineJoin=a.getLineJoin()||Rl.defaultLineJoin,r.lineWidth=void 0===u?Rl.defaultLineWidth:u,r.miterLimit=void 0===c?Rl.defaultMiterLimit:c,r.strokeStyle=Il.asColorLike(a.getColor()||Rl.defaultStrokeStyle)}else r=this.textStrokeState_=null;n=this.textState_;var h=t.getFont()||Rl.defaultFont;Rl.checkFont(h);var d=t.getScale();n.exceedLength=t.getExceedLength(),n.font=h,n.maxAngle=t.getMaxAngle(),n.placement=t.getPlacement(),n.textAlign=t.getTextAlign(),n.textBaseline=t.getTextBaseline()||Rl.defaultTextBaseline,n.scale=void 0===d?1:d;var f=t.getOffsetX(),p=t.getOffsetY(),g=t.getRotateWithView(),_=t.getRotation();this.text_=t.getText()||"",this.textOffsetX_=void 0===f?0:f,this.textOffsetY_=void 0===p?0:p,this.textRotateWithView_=void 0!==g&&g,this.textRotation_=void 0===_?0:_,this.strokeKey_=r?("string"==typeof r.strokeStyle?r.strokeStyle:ya.getUid(r.strokeStyle))+r.lineCap+r.lineDashOffset+"|"+r.lineWidth+r.lineJoin+r.miterLimit+"["+r.lineDash.join()+"]":"",this.textKey_=n.font+(n.textAlign||"?")+n.scale,this.fillKey_=i?"string"==typeof i.fillStyle?i.fillStyle:"|"+ya.getUid(i.fillStyle):""}else this.text_=""};var ou=function(t,e,n,i,r,o,a){Yl.call(this),this.declutterTree_=o,this.declutterGroup_=null,this.tolerance_=t,this.maxExtent_=e,this.overlaps_=r,this.pixelRatio_=i,this.resolution_=n,this.renderBuffer_=a,this.replaysByZIndex_={},this.hitDetectionContext_=Xs.createCanvasContext2D(1,1),this.hitDetectionTransform_=Cs.create()};ya.inherits(ou,Yl),ou.circleArrayCache_={0:[[!0]]},ou.fillCircleArrayRowToMiddle_=function(t,e,n){var i,r=Math.floor(t.length/2);if(e>=r)for(i=r;i<e;i++)t[i][n]=!0;else if(e<r)for(i=e+1;i<r;i++)t[i][n]=!0},ou.getCircleArray_=function(t){if(void 0!==ou.circleArrayCache_[t])return ou.circleArrayCache_[t];for(var e=2*t+1,n=new Array(e),i=0;i<e;i++)n[i]=new Array(e);for(var r=t,o=0,a=0;r>=o;)ou.fillCircleArrayRowToMiddle_(n,t+r,t+o),ou.fillCircleArrayRowToMiddle_(n,t+o,t+r),ou.fillCircleArrayRowToMiddle_(n,t-o,t+r),ou.fillCircleArrayRowToMiddle_(n,t-r,t+o),ou.fillCircleArrayRowToMiddle_(n,t-r,t-o),ou.fillCircleArrayRowToMiddle_(n,t-o,t-r),ou.fillCircleArrayRowToMiddle_(n,t+o,t-r),ou.fillCircleArrayRowToMiddle_(n,t+r,t-o),2*((a+=1+2*++o)-r)+1>0&&(a+=1-2*(r-=1));return ou.circleArrayCache_[t]=n,n},ou.replayDeclutter=function(t,e,n){for(var i=Object.keys(t).map(Number).sort(Ha.numberSafeCompareFunction),r=0,o=i.length;r<o;++r)for(var a=t[i[r].toString()],s=0,l=a.length;s<l;){var u=a[s++],c=a[s++];u.replay(e,c,n,{})}},ou.replayDeclutterHitDetection=function(t,e,n,i,r){for(var o=Object.keys(t).map(Number).sort(Ha.numberSafeCompareFunction),a=0,s=o.length;a<s;++a)for(var l=t[o[a].toString()],u=l.length-1;u>=0;){var c=l[u--],h=l[u--].replayHitDetection(e,c,n,{},i,r);if(h)return h}},ou.prototype.addDeclutter=function(t){var e=null;return this.declutterTree_&&(t?(e=this.declutterGroup_)[4]++:(e=this.declutterGroup_=hs.createEmpty()).push(1)),e},ou.prototype.clip=function(t,e){var n=this.getClipCoords(e);t.beginPath(),t.moveTo(n[0],n[1]),t.lineTo(n[2],n[3]),t.lineTo(n[4],n[5]),t.lineTo(n[6],n[7]),t.clip()},ou.prototype.hasReplays=function(t){for(var e in this.replaysByZIndex_)for(var n=this.replaysByZIndex_[e],i=0,r=t.length;i<r;++i)if(t[i]in n)return!0;return!1},ou.prototype.finish=function(){var t;for(t in this.replaysByZIndex_){var e,n=this.replaysByZIndex_[t];for(e in n)n[e].finish()}},ou.prototype.forEachFeatureAtCoordinate=function(t,e,n,i,r,o,a){function s(t){for(var e=c.getImageData(0,0,l,l).data,n=0;n<l;n++)for(var i=0;i<l;i++)if(d[n][i]&&e[4*(i*l+n)+3]>0){var r=o(t);return r||void c.clearRect(0,0,l,l)}}var l=2*(i=Math.round(i))+1,u=Cs.compose(this.hitDetectionTransform_,i+.5,i+.5,1/e,-1/e,-n,-t[0],-t[1]),c=this.hitDetectionContext_;c.canvas.width!==l||c.canvas.height!==l?(c.canvas.width=l,c.canvas.height=l):c.clearRect(0,0,l,l);var h;void 0!==this.renderBuffer_&&(h=hs.createEmpty(),hs.extendCoordinate(h,t),hs.buffer(h,e*(this.renderBuffer_+i),h));var d=ou.getCircleArray_(i),f=this.replayHitDetection_(c,u,n,r,s,h,a);return!f&&a&&(f=ou.replayDeclutterHitDetection(a,c,n,s,h)),f},ou.prototype.getClipCoords=function(t){var e=this.maxExtent_,n=e[0],i=e[1],r=e[2],o=e[3],a=[n,i,n,o,r,o,r,i];return gs.transform2D(a,0,8,2,t,a),a},ou.prototype.getReplay=function(t,e){var n=void 0!==t?t.toString():"0",i=this.replaysByZIndex_[n];void 0===i&&(i={},this.replaysByZIndex_[n]=i);var r=i[e];return void 0===r&&(r=new(0,ou.BATCH_CONSTRUCTORS_[e])(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_,this.overlaps_,this.declutterTree_),i[e]=r),r},ou.prototype.getReplays=function(){return this.replaysByZIndex_},ou.prototype.isEmpty=function(){return Ea.isEmpty(this.replaysByZIndex_)},ou.prototype.replay=function(t,e,n,i,r,o){var a=Object.keys(this.replaysByZIndex_).map(Number);a.sort(Ha.numberSafeCompareFunction),t.save(),this.clip(t,e);var s,l,u,c,h,d,f=r||nu.ORDER;for(s=0,l=a.length;s<l;++s){var p=a[s].toString();for(h=this.replaysByZIndex_[p],u=0,c=f.length;u<c;++u){var g=f[u];if(void 0!==(d=h[g]))if(!o||g!=jl.IMAGE&&g!=jl.TEXT)d.replay(t,e,n,i);else{var _=o[p];_?_.push(d,e.slice(0)):o[p]=[d,e.slice(0)]}}}t.restore()},ou.prototype.replayHitDetection_=function(t,e,n,i,r,o,a){var s=Object.keys(this.replaysByZIndex_).map(Number);s.sort(Ha.numberSafeCompareFunction);var l,u,c,h,d;for(l=s.length-1;l>=0;--l){var f=s[l].toString();for(c=this.replaysByZIndex_[f],u=nu.ORDER.length-1;u>=0;--u){var p=nu.ORDER[u];if(void 0!==(h=c[p]))if(!a||p!=jl.IMAGE&&p!=jl.TEXT){if(d=h.replayHitDetection(t,e,n,i,r,o))return d}else{var g=a[f];g?g.push(h,e.slice(0)):a[f]=[h,e.slice(0)]}}}},ou.BATCH_CONSTRUCTORS_={Circle:tu,Default:Ql,Image:Jl,LineString:$l,Polygon:tu,Text:ru};var au={};au.defaultOrder=function(t,e){return ya.getUid(t)-ya.getUid(e)},au.getSquaredTolerance=function(t,e){var n=au.getTolerance(t,e);return n*n},au.getTolerance=function(t,e){return ya.SIMPLIFY_TOLERANCE*t/e},au.renderCircleGeometry_=function(t,e,n,i){var r=n.getFill(),o=n.getStroke();if(r||o){var a=t.getReplay(n.getZIndex(),jl.CIRCLE);a.setFillStrokeStyle(r,o),a.drawCircle(e,i)}var s=n.getText();if(s){var l=t.getReplay(n.getZIndex(),jl.TEXT);l.setTextStyle(s,t.addDeclutter(!1)),l.drawText(e,i)}},au.renderFeature=function(t,e,n,i,r,o){var a,s,l=!1;return(a=n.getImage())&&((s=a.getImageState())==Ol.LOADED||s==Ol.ERROR?a.unlistenImageChange(r,o):(s==Ol.IDLE&&a.load(),s=a.getImageState(),a.listenImageChange(r,o),l=!0)),au.renderFeature_(t,e,n,i),l},au.renderFeature_=function(t,e,n,i){var r=n.getGeometryFunction()(e);if(r){var o=r.getSimplifiedGeometry(i);n.getRenderer()?au.renderGeometry_(t,o,n,e):(0,au.GEOMETRY_RENDERERS_[o.getType()])(t,o,n,e)}},au.renderGeometry_=function(t,e,n,i){if(e.getType()!=ds.GEOMETRY_COLLECTION)t.getReplay(n.getZIndex(),jl.DEFAULT).drawCustom(e,i,n.getRenderer());else for(var r=e.getGeometries(),o=0,a=r.length;o<a;++o)au.renderGeometry_(t,r[o],n,i)},au.renderGeometryCollectionGeometry_=function(t,e,n,i){var r,o,a=e.getGeometriesArray();for(r=0,o=a.length;r<o;++r)(0,au.GEOMETRY_RENDERERS_[a[r].getType()])(t,a[r],n,i)},au.renderLineStringGeometry_=function(t,e,n,i){var r=n.getStroke();if(r){var o=t.getReplay(n.getZIndex(),jl.LINE_STRING);o.setFillStrokeStyle(null,r),o.drawLineString(e,i)}var a=n.getText();if(a){var s=t.getReplay(n.getZIndex(),jl.TEXT);s.setTextStyle(a,t.addDeclutter(!1)),s.drawText(e,i)}},au.renderMultiLineStringGeometry_=function(t,e,n,i){var r=n.getStroke();if(r){var o=t.getReplay(n.getZIndex(),jl.LINE_STRING);o.setFillStrokeStyle(null,r),o.drawMultiLineString(e,i)}var a=n.getText();if(a){var s=t.getReplay(n.getZIndex(),jl.TEXT);s.setTextStyle(a,t.addDeclutter(!1)),s.drawText(e,i)}},au.renderMultiPolygonGeometry_=function(t,e,n,i){var r=n.getFill(),o=n.getStroke();if(o||r){var a=t.getReplay(n.getZIndex(),jl.POLYGON);a.setFillStrokeStyle(r,o),a.drawMultiPolygon(e,i)}var s=n.getText();if(s){var l=t.getReplay(n.getZIndex(),jl.TEXT);l.setTextStyle(s,t.addDeclutter(!1)),l.drawText(e,i)}},au.renderPointGeometry_=function(t,e,n,i){var r=n.getImage();if(r){if(r.getImageState()!=Ol.LOADED)return;var o=t.getReplay(n.getZIndex(),jl.IMAGE);o.setImageStyle(r,t.addDeclutter(!1)),o.drawPoint(e,i)}var a=n.getText();if(a){var s=t.getReplay(n.getZIndex(),jl.TEXT);s.setTextStyle(a,t.addDeclutter(!!r)),s.drawText(e,i)}},au.renderMultiPointGeometry_=function(t,e,n,i){var r=n.getImage();if(r){if(r.getImageState()!=Ol.LOADED)return;var o=t.getReplay(n.getZIndex(),jl.IMAGE);o.setImageStyle(r,t.addDeclutter(!1)),o.drawMultiPoint(e,i)}var a=n.getText();if(a){var s=t.getReplay(n.getZIndex(),jl.TEXT);s.setTextStyle(a,t.addDeclutter(!!r)),s.drawText(e,i)}},au.renderPolygonGeometry_=function(t,e,n,i){var r=n.getFill(),o=n.getStroke();if(r||o){var a=t.getReplay(n.getZIndex(),jl.POLYGON);a.setFillStrokeStyle(r,o),a.drawPolygon(e,i)}var s=n.getText();if(s){var l=t.getReplay(n.getZIndex(),jl.TEXT);l.setTextStyle(s,t.addDeclutter(!1)),l.drawText(e,i)}},au.GEOMETRY_RENDERERS_={Point:au.renderPointGeometry_,LineString:au.renderLineStringGeometry_,Polygon:au.renderPolygonGeometry_,MultiPoint:au.renderMultiPointGeometry_,MultiLineString:au.renderMultiLineStringGeometry_,MultiPolygon:au.renderMultiPolygonGeometry_,GeometryCollection:au.renderGeometryCollectionGeometry_,Circle:au.renderCircleGeometry_};var su=function(t){Fl.call(this,t),this.declutterTree_=t.getDeclutter()?Wl(9):null,this.dirty_=!1,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=hs.createEmpty(),this.renderedRenderOrder_=null,this.replayGroup_=null,this.context_=Xs.createCanvasContext2D(),Ta.listen(Rl.labelCache,Aa.CLEAR,this.handleFontsChanged_,this)};ya.inherits(su,Fl),su.handles=function(t,e){return t===Zs.CANVAS&&e.getType()===Cl.VECTOR},su.create=function(t,e){return new su(e)},su.prototype.disposeInternal=function(){Ta.unlisten(Rl.labelCache,Aa.CLEAR,this.handleFontsChanged_,this),Fl.prototype.disposeInternal.call(this)},su.prototype.composeFrame=function(t,e,n){var i=t.extent,r=t.pixelRatio,o=e.managed?t.skippedFeatureUids:{},a=t.viewState,s=a.projection,l=a.rotation,u=s.getExtent(),c=this.getLayer().getSource(),h=this.getTransform(t,0);this.preCompose(n,t,h);var d=e.extent,f=void 0!==d;f&&this.clip(n,t,d);var p=this.replayGroup_;if(p&&!p.isEmpty()){var g,_=this.getLayer(),v=0,y=0,m=1!==e.opacity,x=_.hasListener(el.RENDER);if(m||x){var S=n.canvas.width,E=n.canvas.height;if(l){var T=Math.round(Math.sqrt(S*S+E*E));v=(T-S)/2,y=(T-E)/2,S=E=T}this.context_.canvas.width=S,this.context_.canvas.height=E,g=this.context_}else g=n;var w=g.globalAlpha;m||(g.globalAlpha=e.opacity),g!=n&&g.translate(v,y);var C=t.size[0]*r,b=t.size[1]*r;if(Rl.rotateAtOffset(g,-l,C/2,b/2),p.replay(g,h,l,o),c.getWrapX()&&s.canWrapX()&&!hs.containsExtent(u,i)){for(var A,R=i[0],L=hs.getWidth(u),I=0;R<u[0];)A=L*--I,h=this.getTransform(t,A),p.replay(g,h,l,o),R+=L;for(I=0,R=i[2];R>u[2];)A=L*++I,h=this.getTransform(t,A),p.replay(g,h,l,o),R-=L;h=this.getTransform(t,0)}if(Rl.rotateAtOffset(g,l,C/2,b/2),g!=n){if(x&&this.dispatchRenderEvent(g,t,h),m){var P=n.globalAlpha;n.globalAlpha=e.opacity,n.drawImage(g.canvas,-v,-y),n.globalAlpha=P}else n.drawImage(g.canvas,-v,-y);g.translate(-v,-y)}m||(g.globalAlpha=w)}f&&n.restore(),this.declutterTree_&&this.declutterTree_.clear(),this.postCompose(n,t,e,h)},su.prototype.forEachFeatureAtCoordinate=function(t,e,n,i,r){if(this.replayGroup_){var o=e.viewState.resolution,a=e.viewState.rotation,s=this.getLayer(),l={},u=s.getDeclutter()?{}:null,c=this.replayGroup_.forEachFeatureAtCoordinate(t,o,a,n,{},function(t){var e=ya.getUid(t).toString();if(!(e in l))return l[e]=!0,i.call(r,t,s)},u);return this.declutterTree_&&this.declutterTree_.clear(),c}},su.prototype.handleFontsChanged_=function(t){var e=this.getLayer();e.getVisible()&&this.replayGroup_&&e.changed()},su.prototype.handleStyleImageChange_=function(t){this.renderIfReadyAndVisible()},su.prototype.prepareFrame=function(t,e){var n=this.getLayer(),i=n.getSource();this.updateLogos(t,i);var r=t.viewHints[rs.ANIMATING],o=t.viewHints[rs.INTERACTING],a=n.getUpdateWhileAnimating(),s=n.getUpdateWhileInteracting();if(!this.dirty_&&!a&&r||!s&&o)return!0;var l=t.extent,u=t.viewState,c=u.projection,h=u.resolution,d=t.pixelRatio,f=n.getRevision(),p=n.getRenderBuffer(),g=n.getRenderOrder();void 0===g&&(g=au.defaultOrder);var _=hs.buffer(l,p*h),v=u.projection.getExtent();if(i.getWrapX()&&u.projection.canWrapX()&&!hs.containsExtent(v,t.extent)){var y=hs.getWidth(v),m=Math.max(hs.getWidth(_)/2,y);_[0]=v[0]-m,_[2]=v[2]+m}if(!this.dirty_&&this.renderedResolution_==h&&this.renderedRevision_==f&&this.renderedRenderOrder_==g&&hs.containsExtent(this.renderedExtent_,_))return!0;this.replayGroup_=null,this.dirty_=!1;var x=new ou(au.getTolerance(h,d),_,h,d,i.getOverlaps(),this.declutterTree_,n.getRenderBuffer());i.loadFeatures(_,h,c);var S=function(t){var e,i=t.getStyleFunction();if(i?e=i.call(t,h):(i=n.getStyleFunction())&&(e=i(t,h)),e){var r=this.renderFeature(t,h,d,e,x);this.dirty_=this.dirty_||r}}.bind(this);if(g){var E=[];i.forEachFeatureInExtent(_,function(t){E.push(t)},this),E.sort(g);for(var T=0,w=E.length;T<w;++T)S(E[T])}else i.forEachFeatureInExtent(_,S,this);return x.finish(),this.renderedResolution_=h,this.renderedRevision_=f,this.renderedRenderOrder_=g,this.renderedExtent_=_,this.replayGroup_=x,!0},su.prototype.renderFeature=function(t,e,n,i,r){if(!i)return!1;var o=!1;if(Array.isArray(i))for(var a=0,s=i.length;a<s;++a)o=au.renderFeature(r,t,i[a],au.getSquaredTolerance(e,n),this.handleStyleImageChange_,this)||o;else o=au.renderFeature(r,t,i,au.getSquaredTolerance(e,n),this.handleStyleImageChange_,this);return o};var lu={IMAGE:"image",HYBRID:"hybrid",VECTOR:"vector"},uu=function(t){this.context=null,Xl.call(this,t),this.declutterTree_=t.getDeclutter()?Wl(9):null,this.dirty_=!1,this.renderedLayerRevision_,this.tmpTransform_=Cs.create(),this.zDirection=t.getRenderMode()==lu.VECTOR?1:0,Ta.listen(Rl.labelCache,Aa.CLEAR,this.handleFontsChanged_,this)};ya.inherits(uu,Xl),uu.handles=function(t,e){return t===Zs.CANVAS&&e.getType()===Cl.VECTOR_TILE},uu.create=function(t,e){return new uu(e)},uu.IMAGE_REPLAYS={image:[jl.POLYGON,jl.CIRCLE,jl.LINE_STRING,jl.IMAGE,jl.TEXT],hybrid:[jl.POLYGON,jl.LINE_STRING]},uu.VECTOR_REPLAYS={image:[jl.DEFAULT],hybrid:[jl.IMAGE,jl.TEXT,jl.DEFAULT],vector:nu.ORDER},uu.prototype.disposeInternal=function(){Ta.unlisten(Rl.labelCache,Aa.CLEAR,this.handleFontsChanged_,this),Xl.prototype.disposeInternal.call(this)},uu.prototype.prepareFrame=function(t,e){var n=this.getLayer(),i=n.getRevision();if(this.renderedLayerRevision_!=i){this.renderedTiles.length=0;var r=n.getRenderMode();this.context||r==lu.VECTOR||(this.context=Xs.createCanvasContext2D()),this.context&&r==lu.VECTOR&&(this.context=null)}return this.renderedLayerRevision_=i,Xl.prototype.prepareFrame.apply(this,arguments)},uu.prototype.createReplayGroup_=function(t,e){var n=this.getLayer(),i=e.pixelRatio,r=e.viewState.projection,o=n.getRevision(),a=n.getRenderOrder()||null,s=t.getReplayState(n);if(s.dirty||s.renderedRevision!=o||s.renderedRenderOrder!=a){for(var l=n.getSource(),u=l.getTileGrid(),c=l.getTileGridForProjection(r),h=c.getResolution(t.tileCoord[0]),d=c.getTileCoordExtent(t.wrappedTileCoord),f=0,p=t.tileKeys.length;f<p;++f){var g=t.getTile(t.tileKeys[f]);if(g.getState()!=Za.ERROR){var _=g.tileCoord,v=u.getTileCoordExtent(_),y=hs.getIntersection(d,v),m=hs.equals(v,y)?null:hs.buffer(y,n.getRenderBuffer()*h),x=g.getProjection(),S=!1;ws.equivalent(r,x)||(S=!0,g.setProjection(r)),s.dirty=!1;var E=new ou(0,y,h,i,l.getOverlaps(),this.declutterTree_,n.getRenderBuffer()),T=au.getSquaredTolerance(h,i),w=g.getFeatures();a&&a!==s.renderedRenderOrder&&w.sort(a);for(var C,b=0,A=w.length;b<A;++b)C=w[b],S&&(x.getUnits()==vs.TILE_PIXELS&&(x.setWorldExtent(v),x.setExtent(g.getExtent())),C.getGeometry().transform(x,r)),m&&!hs.intersects(m,C.getExtent())||function(t){var e,i=t.getStyleFunction();if(i?e=i.call(t,h):(i=n.getStyleFunction())&&(e=i(t,h)),e){var r=this.renderFeature(t,T,e,E);this.dirty_=this.dirty_||r,s.dirty=s.dirty||r}}.call(this,C);E.finish();for(var R in E.getReplays());g.setReplayGroup(n,t.tileCoord.toString(),E)}}s.renderedRevision=o,s.renderedRenderOrder=a}},uu.prototype.drawTileImage=function(t,e,n,i,r,o,a,s,l){var u=t;this.createReplayGroup_(u,e),this.context&&(this.renderTileImage_(u,e,n),Xl.prototype.drawTileImage.apply(this,arguments))},uu.prototype.forEachFeatureAtCoordinate=function(t,e,n,i,r){var o=e.viewState.resolution,a=e.viewState.rotation;n=void 0==n?0:n;var s,l,u,c,h,d,f,p,g=this.getLayer(),_=g.getDeclutter()?{}:null,v={},y=this.renderedTiles,m=g.getSource().getTileGridForProjection(e.viewState.projection);for(u=0,c=y.length;u<c;++u)if(d=y[u],f=d.wrappedTileCoord,p=m.getTileCoordExtent(f,this.tmpExtent),s=hs.buffer(p,n*o,s),hs.containsCoordinate(s,t))for(var x=0,S=d.tileKeys.length;x<S;++x){var E=d.getTile(d.tileKeys[x]);E.getState()!=Za.ERROR&&(h=E.getReplayGroup(g,d.tileCoord.toString()),l=l||h.forEachFeatureAtCoordinate(t,o,a,n,{},function(t){var e=ya.getUid(t).toString();if(!(e in v))return v[e]=!0,i.call(r,t,g)},_))}return this.declutterTree_&&this.declutterTree_.clear(),l},uu.prototype.getReplayTransform_=function(t,e){var n=this.getLayer().getSource().getTileGrid(),i=t.tileCoord,r=n.getResolution(i[0]),o=e.viewState,a=e.pixelRatio,s=o.resolution/a,l=n.getTileCoordExtent(i,this.tmpExtent),u=o.center,c=hs.getTopLeft(l),h=e.size,d=Math.round(a*h[0]/2),f=Math.round(a*h[1]/2);return Cs.compose(this.tmpTransform_,d,f,r/s,r/s,o.rotation,(c[0]-u[0])/r,(u[1]-c[1])/r)},uu.prototype.handleFontsChanged_=function(t){var e=this.getLayer();e.getVisible()&&void 0!==this.renderedLayerRevision_&&e.changed()},uu.prototype.handleStyleImageChange_=function(t){this.renderIfReadyAndVisible()},uu.prototype.postCompose=function(t,e,n){var i=this.getLayer(),r=i.getDeclutter()?{}:null,o=i.getSource(),a=i.getRenderMode(),s=uu.VECTOR_REPLAYS[a],l=e.pixelRatio,u=e.viewState.rotation,c=e.size,h=Math.round(l*c[0]/2),d=Math.round(l*c[1]/2);Rl.rotateAtOffset(t,-u,h,d);for(var f=this.renderedTiles,p=o.getTileGridForProjection(e.viewState.projection),g=[],_=[],v=f.length-1;v>=0;--v){var y=f[v];if(y.getState()!=Za.ABORT)for(var m=y.tileCoord,x=p.getTileCoordExtent(m)[0]-p.getTileCoordExtent(y.wrappedTileCoord)[0],S=void 0,E=0,T=y.tileKeys.length;E<T;++E){var w=y.getTile(y.tileKeys[E]);if(w.getState()!=Za.ERROR){var C=w.getReplayGroup(i,m.toString());if(a==lu.VECTOR||C.hasReplays(s)){S||(S=this.getTransform(e,x));var b=w.tileCoord[0],A=C.getClipCoords(S);t.save(),t.globalAlpha=n.opacity;for(var R=0,L=g.length;R<L;++R){var I=g[R];b<_[R]&&(t.beginPath(),t.moveTo(A[0],A[1]),t.lineTo(A[2],A[3]),t.lineTo(A[4],A[5]),t.lineTo(A[6],A[7]),t.moveTo(I[6],I[7]),t.lineTo(I[4],I[5]),t.lineTo(I[2],I[3]),t.lineTo(I[0],I[1]),t.clip())}C.replay(t,S,u,{},s,r),t.restore(),g.push(A),_.push(b)}}}}r&&(ou.replayDeclutter(r,t,u),this.declutterTree_.clear()),Xl.prototype.postCompose.apply(this,arguments)},uu.prototype.renderFeature=function(t,e,n,i){if(!n)return!1;var r=!1;if(Array.isArray(n))for(var o=0,a=n.length;o<a;++o)r=au.renderFeature(i,t,n[o],e,this.handleStyleImageChange_,this)||r;else r=au.renderFeature(i,t,n,e,this.handleStyleImageChange_,this);return r},uu.prototype.renderTileImage_=function(t,e,n){var i=this.getLayer(),r=t.getReplayState(i),o=i.getRevision(),a=uu.IMAGE_REPLAYS[i.getRenderMode()];if(a&&r.renderedTileRevision!==o){r.renderedTileRevision=o;var s=t.wrappedTileCoord,l=s[0],u=e.pixelRatio,c=i.getSource(),h=c.getTileGridForProjection(e.viewState.projection),d=h.getResolution(l),f=t.getContext(i),p=c.getTilePixelSize(l,u,e.viewState.projection);f.canvas.width=p[0],f.canvas.height=p[1];for(var g=h.getTileCoordExtent(s),_=0,v=t.tileKeys.length;_<v;++_){var y=t.getTile(t.tileKeys[_]);if(y.getState()!=Za.ERROR){var m=u/d,x=Cs.reset(this.tmpTransform_);Cs.scale(x,m,-m),Cs.translate(x,-g[0],-g[3]),y.getReplayGroup(i,t.tileCoord.toString()).replay(f,x,0,{},a)}}}};var cu=function(t){this.source_=t};cu.prototype.getType=function(){},cu.prototype.getSource=function(){return this.source_},cu.prototype.isAnimated=ps.FALSE;var hu=function(t){cu.call(this,t)};ya.inherits(hu,cu),hu.prototype.getType=function(){return Oa.FRAGMENT_SHADER};var du=function(t){cu.call(this,t)};ya.inherits(du,cu),du.prototype.getType=function(){return Oa.VERTEX_SHADER};var fu={};fu.fragment=new hu(ya.DEBUG_WEBGL?"precision mediump float;\nvarying vec2 v_center;\nvarying vec2 v_offset;\nvarying float v_halfWidth;\nvarying float v_pixelRatio;\n\n\n\nuniform float u_opacity;\nuniform vec4 u_fillColor;\nuniform vec4 u_strokeColor;\nuniform vec2 u_size;\n\nvoid main(void) {\n  vec2 windowCenter = vec2((v_center.x + 1.0) / 2.0 * u_size.x * v_pixelRatio,\n      (v_center.y + 1.0) / 2.0 * u_size.y * v_pixelRatio);\n  vec2 windowOffset = vec2((v_offset.x + 1.0) / 2.0 * u_size.x * v_pixelRatio,\n      (v_offset.y + 1.0) / 2.0 * u_size.y * v_pixelRatio);\n  float radius = length(windowCenter - windowOffset);\n  float dist = length(windowCenter - gl_FragCoord.xy);\n  if (dist > radius + v_halfWidth) {\n    if (u_strokeColor.a == 0.0) {\n      gl_FragColor = u_fillColor;\n    } else {\n      gl_FragColor = u_strokeColor;\n    }\n    gl_FragColor.a = gl_FragColor.a - (dist - (radius + v_halfWidth));\n  } else if (u_fillColor.a == 0.0) {\n    // Hooray, no fill, just stroke. We can use real antialiasing.\n    gl_FragColor = u_strokeColor;\n    if (dist < radius - v_halfWidth) {\n      gl_FragColor.a = gl_FragColor.a - (radius - v_halfWidth - dist);\n    }\n  } else {\n    gl_FragColor = u_fillColor;\n    float strokeDist = radius - v_halfWidth;\n    float antialias = 2.0 * v_pixelRatio;\n    if (dist > strokeDist) {\n      gl_FragColor = u_strokeColor;\n    } else if (dist >= strokeDist - antialias) {\n      float step = smoothstep(strokeDist - antialias, strokeDist, dist);\n      gl_FragColor = mix(u_fillColor, u_strokeColor, step);\n    }\n  }\n  gl_FragColor.a = gl_FragColor.a * u_opacity;\n  if (gl_FragColor.a <= 0.0) {\n    discard;\n  }\n}\n":"precision mediump float;varying vec2 a;varying vec2 b;varying float c;varying float d;uniform float m;uniform vec4 n;uniform vec4 o;uniform vec2 p;void main(void){vec2 windowCenter=vec2((a.x+1.0)/2.0*p.x*d,(a.y+1.0)/2.0*p.y*d);vec2 windowOffset=vec2((b.x+1.0)/2.0*p.x*d,(b.y+1.0)/2.0*p.y*d);float radius=length(windowCenter-windowOffset);float dist=length(windowCenter-gl_FragCoord.xy);if(dist>radius+c){if(o.a==0.0){gl_FragColor=n;}else{gl_FragColor=o;}gl_FragColor.a=gl_FragColor.a-(dist-(radius+c));}else if(n.a==0.0){gl_FragColor=o;if(dist<radius-c){gl_FragColor.a=gl_FragColor.a-(radius-c-dist);}} else{gl_FragColor=n;float strokeDist=radius-c;float antialias=2.0*d;if(dist>strokeDist){gl_FragColor=o;}else if(dist>=strokeDist-antialias){float step=smoothstep(strokeDist-antialias,strokeDist,dist);gl_FragColor=mix(n,o,step);}} gl_FragColor.a=gl_FragColor.a*m;if(gl_FragColor.a<=0.0){discard;}}"),fu.vertex=new du(ya.DEBUG_WEBGL?"varying vec2 v_center;\nvarying vec2 v_offset;\nvarying float v_halfWidth;\nvarying float v_pixelRatio;\n\n\nattribute vec2 a_position;\nattribute float a_instruction;\nattribute float a_radius;\n\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_offsetScaleMatrix;\nuniform mat4 u_offsetRotateMatrix;\nuniform float u_lineWidth;\nuniform float u_pixelRatio;\n\nvoid main(void) {\n  mat4 offsetMatrix = u_offsetScaleMatrix * u_offsetRotateMatrix;\n  v_center = vec4(u_projectionMatrix * vec4(a_position, 0.0, 1.0)).xy;\n  v_pixelRatio = u_pixelRatio;\n  float lineWidth = u_lineWidth * u_pixelRatio;\n  v_halfWidth = lineWidth / 2.0;\n  if (lineWidth == 0.0) {\n    lineWidth = 2.0 * u_pixelRatio;\n  }\n  vec2 offset;\n  // Radius with anitaliasing (roughly).\n  float radius = a_radius + 3.0 * u_pixelRatio;\n  // Until we get gl_VertexID in WebGL, we store an instruction.\n  if (a_instruction == 0.0) {\n    // Offsetting the edges of the triangle by lineWidth / 2 is necessary, however\n    // we should also leave some space for the antialiasing, thus we offset by lineWidth.\n    offset = vec2(-1.0, 1.0);\n  } else if (a_instruction == 1.0) {\n    offset = vec2(-1.0, -1.0);\n  } else if (a_instruction == 2.0) {\n    offset = vec2(1.0, -1.0);\n  } else {\n    offset = vec2(1.0, 1.0);\n  }\n\n  gl_Position = u_projectionMatrix * vec4(a_position + offset * radius, 0.0, 1.0) +\n      offsetMatrix * vec4(offset * lineWidth, 0.0, 0.0);\n  v_offset = vec4(u_projectionMatrix * vec4(a_position.x + a_radius, a_position.y,\n      0.0, 1.0)).xy;\n\n  if (distance(v_center, v_offset) > 20000.0) {\n    gl_Position = vec4(v_center, 0.0, 1.0);\n  }\n}\n\n\n":"varying vec2 a;varying vec2 b;varying float c;varying float d;attribute vec2 e;attribute float f;attribute float g;uniform mat4 h;uniform mat4 i;uniform mat4 j;uniform float k;uniform float l;void main(void){mat4 offsetMatrix=i*j;a=vec4(h*vec4(e,0.0,1.0)).xy;d=l;float lineWidth=k*l;c=lineWidth/2.0;if(lineWidth==0.0){lineWidth=2.0*l;}vec2 offset;float radius=g+3.0*l;//Until we get gl_VertexID in WebGL,we store an instruction.if(f==0.0){//Offsetting the edges of the triangle by lineWidth/2 is necessary,however//we should also leave some space for the antialiasing,thus we offset by lineWidth.offset=vec2(-1.0,1.0);}else if(f==1.0){offset=vec2(-1.0,-1.0);}else if(f==2.0){offset=vec2(1.0,-1.0);}else{offset=vec2(1.0,1.0);}gl_Position=h*vec4(e+offset*radius,0.0,1.0)+offsetMatrix*vec4(offset*lineWidth,0.0,0.0);b=vec4(h*vec4(e.x+g,e.y,0.0,1.0)).xy;if(distance(a,b)>20000.0){gl_Position=vec4(a,0.0,1.0);}}");var pu=function(t,e){this.u_projectionMatrix=t.getUniformLocation(e,ya.DEBUG_WEBGL?"u_projectionMatrix":"h"),this.u_offsetScaleMatrix=t.getUniformLocation(e,ya.DEBUG_WEBGL?"u_offsetScaleMatrix":"i"),this.u_offsetRotateMatrix=t.getUniformLocation(e,ya.DEBUG_WEBGL?"u_offsetRotateMatrix":"j"),this.u_lineWidth=t.getUniformLocation(e,ya.DEBUG_WEBGL?"u_lineWidth":"k"),this.u_pixelRatio=t.getUniformLocation(e,ya.DEBUG_WEBGL?"u_pixelRatio":"l"),this.u_opacity=t.getUniformLocation(e,ya.DEBUG_WEBGL?"u_opacity":"m"),this.u_fillColor=t.getUniformLocation(e,ya.DEBUG_WEBGL?"u_fillColor":"n"),this.u_strokeColor=t.getUniformLocation(e,ya.DEBUG_WEBGL?"u_strokeColor":"o"),this.u_size=t.getUniformLocation(e,ya.DEBUG_WEBGL?"u_size":"p"),this.a_position=t.getAttribLocation(e,ya.DEBUG_WEBGL?"a_position":"e"),this.a_instruction=t.getAttribLocation(e,ya.DEBUG_WEBGL?"a_instruction":"f"),this.a_radius=t.getAttribLocation(e,ya.DEBUG_WEBGL?"a_radius":"g")},gu={};gu.create=function(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},gu.fromTransform=function(t,e){return t[0]=e[0],t[1]=e[1],t[4]=e[2],t[5]=e[3],t[12]=e[4],t[13]=e[5],t};var _u=function(t,e){Pl.call(this),this.tolerance=t,this.maxExtent=e,this.origin=hs.getCenter(e),this.projectionMatrix_=Cs.create(),this.offsetRotateMatrix_=Cs.create(),this.offsetScaleMatrix_=Cs.create(),this.tmpMat4_=gu.create(),this.indices=[],this.indicesBuffer=null,this.startIndices=[],this.startIndicesFeature=[],this.vertices=[],this.verticesBuffer=null,this.lineStringReplay=void 0};ya.inherits(_u,Pl),_u.prototype.getDeleteResourcesFunction=function(t){},_u.prototype.finish=function(t){},_u.prototype.setUpProgram=function(t,e,n,i){},_u.prototype.shutDownProgram=function(t,e){},_u.prototype.drawReplay=function(t,e,n,i){},_u.prototype.drawHitDetectionReplayOneByOne=function(t,e,n,i,r){},_u.prototype.drawHitDetectionReplay=function(t,e,n,i,r,o){return r?this.drawHitDetectionReplayOneByOne(t,e,n,i,o):this.drawHitDetectionReplayAll(t,e,n,i)},_u.prototype.drawHitDetectionReplayAll=function(t,e,n,i){t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),this.drawReplay(t,e,n,!0);var r=i(null);return r||void 0},_u.prototype.replay=function(t,e,n,i,r,o,a,s,l,u,c){var h,d,f,p,g,_,v,y,m=t.getGL();this.lineStringReplay&&(h=m.isEnabled(m.STENCIL_TEST),d=m.getParameter(m.STENCIL_FUNC),f=m.getParameter(m.STENCIL_VALUE_MASK),p=m.getParameter(m.STENCIL_REF),g=m.getParameter(m.STENCIL_WRITEMASK),_=m.getParameter(m.STENCIL_FAIL),v=m.getParameter(m.STENCIL_PASS_DEPTH_PASS),y=m.getParameter(m.STENCIL_PASS_DEPTH_FAIL),m.enable(m.STENCIL_TEST),m.clear(m.STENCIL_BUFFER_BIT),m.stencilMask(255),m.stencilFunc(m.ALWAYS,1,255),m.stencilOp(m.KEEP,m.KEEP,m.REPLACE),this.lineStringReplay.replay(t,e,n,i,r,o,a,s,l,u,c),m.stencilMask(0),m.stencilFunc(m.NOTEQUAL,1,255)),t.bindBuffer(Oa.ARRAY_BUFFER,this.verticesBuffer),t.bindBuffer(Oa.ELEMENT_ARRAY_BUFFER,this.indicesBuffer);var x=this.setUpProgram(m,t,r,o),S=Cs.reset(this.projectionMatrix_);Cs.scale(S,2/(n*r[0]),2/(n*r[1])),Cs.rotate(S,-i),Cs.translate(S,-(e[0]-this.origin[0]),-(e[1]-this.origin[1]));var E=Cs.reset(this.offsetScaleMatrix_);Cs.scale(E,2/r[0],2/r[1]);var T=Cs.reset(this.offsetRotateMatrix_);0!==i&&Cs.rotate(T,-i),m.uniformMatrix4fv(x.u_projectionMatrix,!1,gu.fromTransform(this.tmpMat4_,S)),m.uniformMatrix4fv(x.u_offsetScaleMatrix,!1,gu.fromTransform(this.tmpMat4_,E)),m.uniformMatrix4fv(x.u_offsetRotateMatrix,!1,gu.fromTransform(this.tmpMat4_,T)),m.uniform1f(x.u_opacity,a);var w;return void 0===l?this.drawReplay(m,t,s,!1):w=this.drawHitDetectionReplay(m,t,s,l,u,c),this.shutDownProgram(m,x),this.lineStringReplay&&(h||m.disable(m.STENCIL_TEST),m.clear(m.STENCIL_BUFFER_BIT),m.stencilFunc(d,p,f),m.stencilMask(g),m.stencilOp(_,y,v)),w},_u.prototype.drawElements=function(t,e,n,i){var r=e.hasOESElementIndexUint?Oa.UNSIGNED_INT:Oa.UNSIGNED_SHORT,o=i-n,a=n*(e.hasOESElementIndexUint?4:2);t.drawElements(Oa.TRIANGLES,o,r,a)};var vu={};vu.defaultFont="10px sans-serif",vu.defaultFillStyle=[0,0,0,1],vu.defaultLineCap="round",vu.defaultLineDash=[],vu.defaultLineDashOffset=0,vu.defaultLineJoin="round",vu.defaultMiterLimit=10,vu.defaultStrokeStyle=[0,0,0,1],vu.defaultTextAlign=.5,vu.defaultTextBaseline=.5,vu.defaultLineWidth=1,vu.triangleIsCounterClockwise=function(t,e,n,i,r,o){var a=(n-t)*(o-e)-(r-t)*(i-e);return a<=vu.EPSILON&&a>=-vu.EPSILON?void 0:a>0},vu.EPSILON=Number.EPSILON||2.220446049250313e-16;var yu=function(t,e){this.arr_=void 0!==t?t:[],this.usage_=void 0!==e?e:yu.Usage_.STATIC_DRAW};yu.prototype.getArray=function(){return this.arr_},yu.prototype.getUsage=function(){return this.usage_},yu.Usage_={STATIC_DRAW:Oa.STATIC_DRAW,STREAM_DRAW:Oa.STREAM_DRAW,DYNAMIC_DRAW:Oa.DYNAMIC_DRAW};var mu=function(t,e){_u.call(this,t,e),this.defaultLocations_=null,this.styles_=[],this.styleIndices_=[],this.radius_=0,this.state_={fillColor:null,strokeColor:null,lineDash:null,lineDashOffset:void 0,lineWidth:void 0,changed:!1}};ya.inherits(mu,_u),mu.prototype.drawCoordinates_=function(t,e,n,i){var r,o,a=this.vertices.length,s=this.indices.length,l=a/4;for(r=e,o=n;r<o;r+=i)this.vertices[a++]=t[r],this.vertices[a++]=t[r+1],this.vertices[a++]=0,this.vertices[a++]=this.radius_,this.vertices[a++]=t[r],this.vertices[a++]=t[r+1],this.vertices[a++]=1,this.vertices[a++]=this.radius_,this.vertices[a++]=t[r],this.vertices[a++]=t[r+1],this.vertices[a++]=2,this.vertices[a++]=this.radius_,this.vertices[a++]=t[r],this.vertices[a++]=t[r+1],this.vertices[a++]=3,this.vertices[a++]=this.radius_,this.indices[s++]=l,this.indices[s++]=l+1,this.indices[s++]=l+2,this.indices[s++]=l+2,this.indices[s++]=l+3,this.indices[s++]=l,l+=4},mu.prototype.drawCircle=function(t,e){var n=t.getRadius(),i=t.getStride();if(n){this.startIndices.push(this.indices.length),this.startIndicesFeature.push(e),this.state_.changed&&(this.styleIndices_.push(this.indices.length),this.state_.changed=!1),this.radius_=n;var r=t.getFlatCoordinates();r=gs.translate(r,0,2,i,-this.origin[0],-this.origin[1]),this.drawCoordinates_(r,0,2,i)}else if(this.state_.changed&&(this.styles_.pop(),this.styles_.length)){var o=this.styles_[this.styles_.length-1];this.state_.fillColor=o[0],this.state_.strokeColor=o[1],this.state_.lineWidth=o[2],this.state_.changed=!1}},mu.prototype.finish=function(t){this.verticesBuffer=new yu(this.vertices),this.indicesBuffer=new yu(this.indices),this.startIndices.push(this.indices.length),0===this.styleIndices_.length&&this.styles_.length>0&&(this.styles_=[]),this.vertices=null,this.indices=null},mu.prototype.getDeleteResourcesFunction=function(t){var e=this.verticesBuffer,n=this.indicesBuffer;return function(){t.deleteBuffer(e),t.deleteBuffer(n)}},mu.prototype.setUpProgram=function(t,e,n,i){var r,o;r=fu.fragment,o=fu.vertex;var a,s=e.getProgram(r,o);return this.defaultLocations_?a=this.defaultLocations_:(a=new pu(t,s),this.defaultLocations_=a),e.useProgram(s),t.enableVertexAttribArray(a.a_position),t.vertexAttribPointer(a.a_position,2,Oa.FLOAT,!1,16,0),t.enableVertexAttribArray(a.a_instruction),t.vertexAttribPointer(a.a_instruction,1,Oa.FLOAT,!1,16,8),t.enableVertexAttribArray(a.a_radius),t.vertexAttribPointer(a.a_radius,1,Oa.FLOAT,!1,16,12),t.uniform2fv(a.u_size,n),t.uniform1f(a.u_pixelRatio,i),a},mu.prototype.shutDownProgram=function(t,e){t.disableVertexAttribArray(e.a_position),t.disableVertexAttribArray(e.a_instruction),t.disableVertexAttribArray(e.a_radius)},mu.prototype.drawReplay=function(t,e,n,i){if(Ea.isEmpty(n)){var r,o,a,s;for(a=this.startIndices[this.startIndices.length-1],r=this.styleIndices_.length-1;r>=0;--r)o=this.styleIndices_[r],s=this.styles_[r],this.setFillStyle_(t,s[0]),this.setStrokeStyle_(t,s[1],s[2]),this.drawElements(t,e,o,a),a=o}else this.drawReplaySkipping_(t,e,n)},mu.prototype.drawHitDetectionReplayOneByOne=function(t,e,n,i,r){var o,a,s,l,u,c,h,d;for(d=this.startIndices.length-2,s=this.startIndices[d+1],o=this.styleIndices_.length-1;o>=0;--o)for(l=this.styles_[o],this.setFillStyle_(t,l[0]),this.setStrokeStyle_(t,l[1],l[2]),u=this.styleIndices_[o];d>=0&&this.startIndices[d]>=u;){if(a=this.startIndices[d],c=this.startIndicesFeature[d],h=ya.getUid(c).toString(),void 0===n[h]&&c.getGeometry()&&(void 0===r||hs.intersects(r,c.getGeometry().getExtent()))){t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),this.drawElements(t,e,a,s);var f=i(c);if(f)return f}d--,s=a}},mu.prototype.drawReplaySkipping_=function(t,e,n){var i,r,o,a,s,l,u,c;for(u=this.startIndices.length-2,o=r=this.startIndices[u+1],i=this.styleIndices_.length-1;i>=0;--i){for(a=this.styles_[i],this.setFillStyle_(t,a[0]),this.setStrokeStyle_(t,a[1],a[2]),s=this.styleIndices_[i];u>=0&&this.startIndices[u]>=s;)c=this.startIndices[u],l=this.startIndicesFeature[u],n[ya.getUid(l).toString()]&&(r!==o&&this.drawElements(t,e,r,o),o=c),u--,r=c;r!==o&&this.drawElements(t,e,r,o),r=o=s}},mu.prototype.setFillStyle_=function(t,e){t.uniform4fv(this.defaultLocations_.u_fillColor,e)},mu.prototype.setStrokeStyle_=function(t,e,n){t.uniform4fv(this.defaultLocations_.u_strokeColor,e),t.uniform1f(this.defaultLocations_.u_lineWidth,n)},mu.prototype.setFillStrokeStyle=function(t,e){var n,i;if(e){var r=e.getLineDash();this.state_.lineDash=r||vu.defaultLineDash;var o=e.getLineDashOffset();this.state_.lineDashOffset=o||vu.defaultLineDashOffset,n=(n=e.getColor())instanceof CanvasGradient||n instanceof CanvasPattern?vu.defaultStrokeStyle:Ll.asArray(n).map(function(t,e){return 3!=e?t/255:t})||vu.defaultStrokeStyle,i=void 0!==(i=e.getWidth())?i:vu.defaultLineWidth}else n=[0,0,0,0],i=0;var a=t?t.getColor():[0,0,0,0];a=a instanceof CanvasGradient||a instanceof CanvasPattern?vu.defaultFillStyle:Ll.asArray(a).map(function(t,e){return 3!=e?t/255:t})||vu.defaultFillStyle,this.state_.strokeColor&&Ha.equals(this.state_.strokeColor,n)&&this.state_.fillColor&&Ha.equals(this.state_.fillColor,a)&&this.state_.lineWidth===i||(this.state_.changed=!0,this.state_.fillColor=a,this.state_.strokeColor=n,this.state_.lineWidth=i,this.styles_.push([a,n,i]))};var xu={};xu.fragment=new hu(ya.DEBUG_WEBGL?"precision mediump float;\nvarying vec2 v_texCoord;\nvarying float v_opacity;\n\nuniform float u_opacity;\nuniform sampler2D u_image;\n\nvoid main(void) {\n  vec4 texColor = texture2D(u_image, v_texCoord);\n  gl_FragColor.rgb = texColor.rgb;\n  float alpha = texColor.a * v_opacity * u_opacity;\n  if (alpha == 0.0) {\n    discard;\n  }\n  gl_FragColor.a = alpha;\n}\n":"precision mediump float;varying vec2 a;varying float b;uniform float k;uniform sampler2D l;void main(void){vec4 texColor=texture2D(l,a);gl_FragColor.rgb=texColor.rgb;float alpha=texColor.a*b*k;if(alpha==0.0){discard;}gl_FragColor.a=alpha;}"),xu.vertex=new du(ya.DEBUG_WEBGL?"varying vec2 v_texCoord;\nvarying float v_opacity;\n\nattribute vec2 a_position;\nattribute vec2 a_texCoord;\nattribute vec2 a_offsets;\nattribute float a_opacity;\nattribute float a_rotateWithView;\n\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_offsetScaleMatrix;\nuniform mat4 u_offsetRotateMatrix;\n\nvoid main(void) {\n  mat4 offsetMatrix = u_offsetScaleMatrix;\n  if (a_rotateWithView == 1.0) {\n    offsetMatrix = u_offsetScaleMatrix * u_offsetRotateMatrix;\n  }\n  vec4 offsets = offsetMatrix * vec4(a_offsets, 0.0, 0.0);\n  gl_Position = u_projectionMatrix * vec4(a_position, 0.0, 1.0) + offsets;\n  v_texCoord = a_texCoord;\n  v_opacity = a_opacity;\n}\n\n\n":"varying vec2 a;varying float b;attribute vec2 c;attribute vec2 d;attribute vec2 e;attribute float f;attribute float g;uniform mat4 h;uniform mat4 i;uniform mat4 j;void main(void){mat4 offsetMatrix=i;if(g==1.0){offsetMatrix=i*j;}vec4 offsets=offsetMatrix*vec4(e,0.0,0.0);gl_Position=h*vec4(c,0.0,1.0)+offsets;a=d;b=f;}");var Su=function(t,e){this.u_projectionMatrix=t.getUniformLocation(e,ya.DEBUG_WEBGL?"u_projectionMatrix":"h"),this.u_offsetScaleMatrix=t.getUniformLocation(e,ya.DEBUG_WEBGL?"u_offsetScaleMatrix":"i"),this.u_offsetRotateMatrix=t.getUniformLocation(e,ya.DEBUG_WEBGL?"u_offsetRotateMatrix":"j"),this.u_opacity=t.getUniformLocation(e,ya.DEBUG_WEBGL?"u_opacity":"k"),this.u_image=t.getUniformLocation(e,ya.DEBUG_WEBGL?"u_image":"l"),this.a_position=t.getAttribLocation(e,ya.DEBUG_WEBGL?"a_position":"c"),this.a_texCoord=t.getAttribLocation(e,ya.DEBUG_WEBGL?"a_texCoord":"d"),this.a_offsets=t.getAttribLocation(e,ya.DEBUG_WEBGL?"a_offsets":"e"),this.a_opacity=t.getAttribLocation(e,ya.DEBUG_WEBGL?"a_opacity":"f"),this.a_rotateWithView=t.getAttribLocation(e,ya.DEBUG_WEBGL?"a_rotateWithView":"g")},Eu={LOST:"webglcontextlost",RESTORED:"webglcontextrestored"},Tu=function(t,e){this.canvas_=t,this.gl_=e,this.bufferCache_={},this.shaderCache_={},this.programCache_={},this.currentProgram_=null,this.hitDetectionFramebuffer_=null,this.hitDetectionTexture_=null,this.hitDetectionRenderbuffer_=null,this.hasOESElementIndexUint=Ha.includes(ya.WEBGL_EXTENSIONS,"OES_element_index_uint"),this.hasOESElementIndexUint&&e.getExtension("OES_element_index_uint"),Ta.listen(this.canvas_,Eu.LOST,this.handleWebGLContextLost,this),Ta.listen(this.canvas_,Eu.RESTORED,this.handleWebGLContextRestored,this)};ya.inherits(Tu,wa),Tu.prototype.bindBuffer=function(t,e){var n=this.getGL(),i=e.getArray(),r=String(ya.getUid(e));if(r in this.bufferCache_){var o=this.bufferCache_[r];n.bindBuffer(t,o.buffer)}else{var a=n.createBuffer();n.bindBuffer(t,a);var s;t==Oa.ARRAY_BUFFER?s=new Float32Array(i):t==Oa.ELEMENT_ARRAY_BUFFER&&(s=this.hasOESElementIndexUint?new Uint32Array(i):new Uint16Array(i)),n.bufferData(t,s,e.getUsage()),this.bufferCache_[r]={buf:e,buffer:a}}},Tu.prototype.deleteBuffer=function(t){var e=this.getGL(),n=String(ya.getUid(t)),i=this.bufferCache_[n];e.isContextLost()||e.deleteBuffer(i.buffer),delete this.bufferCache_[n]},Tu.prototype.disposeInternal=function(){Ta.unlistenAll(this.canvas_);var t=this.getGL();if(!t.isContextLost()){var e;for(e in this.bufferCache_)t.deleteBuffer(this.bufferCache_[e].buffer);for(e in this.programCache_)t.deleteProgram(this.programCache_[e]);for(e in this.shaderCache_)t.deleteShader(this.shaderCache_[e]);t.deleteFramebuffer(this.hitDetectionFramebuffer_),t.deleteRenderbuffer(this.hitDetectionRenderbuffer_),t.deleteTexture(this.hitDetectionTexture_)}},Tu.prototype.getCanvas=function(){return this.canvas_},Tu.prototype.getGL=function(){return this.gl_},Tu.prototype.getHitDetectionFramebuffer=function(){return this.hitDetectionFramebuffer_||this.initHitDetectionFramebuffer_(),this.hitDetectionFramebuffer_},Tu.prototype.getShader=function(t){var e=String(ya.getUid(t));if(e in this.shaderCache_)return this.shaderCache_[e];var n=this.getGL(),i=n.createShader(t.getType());return n.shaderSource(i,t.getSource()),n.compileShader(i),this.shaderCache_[e]=i,i},Tu.prototype.getProgram=function(t,e){var n=ya.getUid(t)+"/"+ya.getUid(e);if(n in this.programCache_)return this.programCache_[n];var i=this.getGL(),r=i.createProgram();return i.attachShader(r,this.getShader(t)),i.attachShader(r,this.getShader(e)),i.linkProgram(r),this.programCache_[n]=r,r},Tu.prototype.handleWebGLContextLost=function(){Ea.clear(this.bufferCache_),Ea.clear(this.shaderCache_),Ea.clear(this.programCache_),this.currentProgram_=null,this.hitDetectionFramebuffer_=null,this.hitDetectionTexture_=null,this.hitDetectionRenderbuffer_=null},Tu.prototype.handleWebGLContextRestored=function(){},Tu.prototype.initHitDetectionFramebuffer_=function(){var t=this.gl_,e=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,e);var n=Tu.createEmptyTexture(t,1,1),i=t.createRenderbuffer();t.bindRenderbuffer(t.RENDERBUFFER,i),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT16,1,1),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,i),t.bindTexture(t.TEXTURE_2D,null),t.bindRenderbuffer(t.RENDERBUFFER,null),t.bindFramebuffer(t.FRAMEBUFFER,null),this.hitDetectionFramebuffer_=e,this.hitDetectionTexture_=n,this.hitDetectionRenderbuffer_=i},Tu.prototype.useProgram=function(t){return t!=this.currentProgram_&&(this.getGL().useProgram(t),this.currentProgram_=t,!0)},Tu.createTexture_=function(t,e,n){var i=t.createTexture();return t.bindTexture(t.TEXTURE_2D,i),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),void 0!==e&&t.texParameteri(Oa.TEXTURE_2D,Oa.TEXTURE_WRAP_S,e),void 0!==n&&t.texParameteri(Oa.TEXTURE_2D,Oa.TEXTURE_WRAP_T,n),i},Tu.createEmptyTexture=function(t,e,n,i,r){var o=Tu.createTexture_(t,i,r);return t.texImage2D(t.TEXTURE_2D,0,t.RGBA,e,n,0,t.RGBA,t.UNSIGNED_BYTE,null),o},Tu.createTexture=function(t,e,n,i){var r=Tu.createTexture_(t,n,i);return t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e),r};var wu=function(t,e){_u.call(this,t,e),this.anchorX=void 0,this.anchorY=void 0,this.groupIndices=[],this.hitDetectionGroupIndices=[],this.height=void 0,this.imageHeight=void 0,this.imageWidth=void 0,this.defaultLocations=null,this.opacity=void 0,this.originX=void 0,this.originY=void 0,this.rotateWithView=void 0,this.rotation=void 0,this.scale=void 0,this.width=void 0};ya.inherits(wu,_u),wu.prototype.getDeleteResourcesFunction=function(t){var e=this.verticesBuffer,n=this.indicesBuffer,i=this.getTextures(!0),r=t.getGL();return function(){if(!r.isContextLost()){var o,a;for(o=0,a=i.length;o<a;++o)r.deleteTexture(i[o])}t.deleteBuffer(e),t.deleteBuffer(n)}},wu.prototype.drawCoordinates=function(t,e,n,i){var r,o,a,s,l,u,c=this.anchorX,h=this.anchorY,d=this.height,f=this.imageHeight,p=this.imageWidth,g=this.opacity,_=this.originX,v=this.originY,y=this.rotateWithView?1:0,m=-this.rotation,x=this.scale,S=this.width,E=Math.cos(m),T=Math.sin(m),w=this.indices.length,C=this.vertices.length;for(r=e;r<n;r+=i)l=t[r]-this.origin[0],u=t[r+1]-this.origin[1],o=C/8,a=-x*c,s=-x*(d-h),this.vertices[C++]=l,this.vertices[C++]=u,this.vertices[C++]=a*E-s*T,this.vertices[C++]=a*T+s*E,this.vertices[C++]=_/p,this.vertices[C++]=(v+d)/f,this.vertices[C++]=g,this.vertices[C++]=y,a=x*(S-c),s=-x*(d-h),this.vertices[C++]=l,this.vertices[C++]=u,this.vertices[C++]=a*E-s*T,this.vertices[C++]=a*T+s*E,this.vertices[C++]=(_+S)/p,this.vertices[C++]=(v+d)/f,this.vertices[C++]=g,this.vertices[C++]=y,a=x*(S-c),s=x*h,this.vertices[C++]=l,this.vertices[C++]=u,this.vertices[C++]=a*E-s*T,this.vertices[C++]=a*T+s*E,this.vertices[C++]=(_+S)/p,this.vertices[C++]=v/f,this.vertices[C++]=g,this.vertices[C++]=y,a=-x*c,s=x*h,this.vertices[C++]=l,this.vertices[C++]=u,this.vertices[C++]=a*E-s*T,this.vertices[C++]=a*T+s*E,this.vertices[C++]=_/p,this.vertices[C++]=v/f,this.vertices[C++]=g,this.vertices[C++]=y,this.indices[w++]=o,this.indices[w++]=o+1,this.indices[w++]=o+2,this.indices[w++]=o,this.indices[w++]=o+2,this.indices[w++]=o+3;return C},wu.prototype.createTextures=function(t,e,n,i){var r,o,a,s,l=e.length;for(s=0;s<l;++s)o=e[s],(a=ya.getUid(o).toString())in n?r=n[a]:(r=Tu.createTexture(i,o,Oa.CLAMP_TO_EDGE,Oa.CLAMP_TO_EDGE),n[a]=r),t[s]=r},wu.prototype.setUpProgram=function(t,e,n,i){var r,o=xu.fragment,a=xu.vertex,s=e.getProgram(o,a);return this.defaultLocations?r=this.defaultLocations:(r=new Su(t,s),this.defaultLocations=r),e.useProgram(s),t.enableVertexAttribArray(r.a_position),t.vertexAttribPointer(r.a_position,2,Oa.FLOAT,!1,32,0),t.enableVertexAttribArray(r.a_offsets),t.vertexAttribPointer(r.a_offsets,2,Oa.FLOAT,!1,32,8),t.enableVertexAttribArray(r.a_texCoord),t.vertexAttribPointer(r.a_texCoord,2,Oa.FLOAT,!1,32,16),t.enableVertexAttribArray(r.a_opacity),t.vertexAttribPointer(r.a_opacity,1,Oa.FLOAT,!1,32,24),t.enableVertexAttribArray(r.a_rotateWithView),t.vertexAttribPointer(r.a_rotateWithView,1,Oa.FLOAT,!1,32,28),r},wu.prototype.shutDownProgram=function(t,e){t.disableVertexAttribArray(e.a_position),t.disableVertexAttribArray(e.a_offsets),t.disableVertexAttribArray(e.a_texCoord),t.disableVertexAttribArray(e.a_opacity),t.disableVertexAttribArray(e.a_rotateWithView)},wu.prototype.drawReplay=function(t,e,n,i){var r=i?this.getHitDetectionTextures():this.getTextures(),o=i?this.hitDetectionGroupIndices:this.groupIndices;if(Ea.isEmpty(n)){var a,s,l;for(a=0,s=r.length,l=0;a<s;++a){t.bindTexture(Oa.TEXTURE_2D,r[a]);var u=o[a];this.drawElements(t,e,l,u),l=u}}else this.drawReplaySkipping(t,e,n,r,o)},wu.prototype.drawReplaySkipping=function(t,e,n,i,r){var o,a,s=0;for(o=0,a=i.length;o<a;++o){t.bindTexture(Oa.TEXTURE_2D,i[o]);for(var l=o>0?r[o-1]:0,u=r[o],c=l,h=l;s<this.startIndices.length&&this.startIndices[s]<=u;){var d=this.startIndicesFeature[s];void 0!==n[ya.getUid(d).toString()]?(c!==h&&this.drawElements(t,e,c,h),h=c=s===this.startIndices.length-1?u:this.startIndices[s+1]):h=s===this.startIndices.length-1?u:this.startIndices[s+1],s++}c!==h&&this.drawElements(t,e,c,h)}},wu.prototype.drawHitDetectionReplayOneByOne=function(t,e,n,i,r){var o,a,s,l,u,c,h=this.startIndices.length-1,d=this.getHitDetectionTextures();for(o=d.length-1;o>=0;--o)for(t.bindTexture(Oa.TEXTURE_2D,d[o]),a=o>0?this.hitDetectionGroupIndices[o-1]:0,l=this.hitDetectionGroupIndices[o];h>=0&&this.startIndices[h]>=a;){if(s=this.startIndices[h],u=this.startIndicesFeature[h],c=ya.getUid(u).toString(),void 0===n[c]&&u.getGeometry()&&(void 0===r||hs.intersects(r,u.getGeometry().getExtent()))){t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),this.drawElements(t,e,s,l);var f=i(u);if(f)return f}l=s,h--}},wu.prototype.finish=function(t){this.anchorX=void 0,this.anchorY=void 0,this.height=void 0,this.imageHeight=void 0,this.imageWidth=void 0,this.indices=null,this.opacity=void 0,this.originX=void 0,this.originY=void 0,this.rotateWithView=void 0,this.rotation=void 0,this.scale=void 0,this.vertices=null,this.width=void 0},wu.prototype.getTextures=function(t){},wu.prototype.getHitDetectionTextures=function(){};var Cu=function(t,e){wu.call(this,t,e),this.images_=[],this.hitDetectionImages_=[],this.textures_=[],this.hitDetectionTextures_=[]};ya.inherits(Cu,wu),Cu.prototype.drawMultiPoint=function(t,e){this.startIndices.push(this.indices.length),this.startIndicesFeature.push(e);var n=t.getFlatCoordinates(),i=t.getStride();this.drawCoordinates(n,0,n.length,i)},Cu.prototype.drawPoint=function(t,e){this.startIndices.push(this.indices.length),this.startIndicesFeature.push(e);var n=t.getFlatCoordinates(),i=t.getStride();this.drawCoordinates(n,0,n.length,i)},Cu.prototype.finish=function(t){var e=t.getGL();this.groupIndices.push(this.indices.length),this.hitDetectionGroupIndices.push(this.indices.length),this.verticesBuffer=new yu(this.vertices);var n=this.indices;this.indicesBuffer=new yu(n);var i={};this.createTextures(this.textures_,this.images_,i,e),this.createTextures(this.hitDetectionTextures_,this.hitDetectionImages_,i,e),this.images_=null,this.hitDetectionImages_=null,wu.prototype.finish.call(this,t)},Cu.prototype.setImageStyle=function(t){var e,n=t.getAnchor(),i=t.getImage(1),r=t.getImageSize(),o=t.getHitDetectionImage(1),a=t.getOpacity(),s=t.getOrigin(),l=t.getRotateWithView(),u=t.getRotation(),c=t.getSize(),h=t.getScale();0===this.images_.length?this.images_.push(i):(e=this.images_[this.images_.length-1],ya.getUid(e)!=ya.getUid(i)&&(this.groupIndices.push(this.indices.length),this.images_.push(i))),0===this.hitDetectionImages_.length?this.hitDetectionImages_.push(o):(e=this.hitDetectionImages_[this.hitDetectionImages_.length-1],ya.getUid(e)!=ya.getUid(o)&&(this.hitDetectionGroupIndices.push(this.indices.length),this.hitDetectionImages_.push(o))),this.anchorX=n[0],this.anchorY=n[1],this.height=c[1],this.imageHeight=r[1],this.imageWidth=r[0],this.opacity=a,this.originX=s[0],this.originY=s[1],this.rotation=u,this.rotateWithView=l,this.scale=h,this.width=c[0]},Cu.prototype.getTextures=function(t){return t?this.textures_.concat(this.hitDetectionTextures_):this.textures_},Cu.prototype.getHitDetectionTextures=function(){return this.hitDetectionTextures_};var bu={};bu.lineStringIsClosed=function(t,e,n,i){var r=n-i;return t[e]===t[r]&&t[e+1]===t[r+1]&&(n-e)/i>3&&!!Rs.linearRing(t,e,n,i)};var Au={};Au.fragment=new hu(ya.DEBUG_WEBGL?"precision mediump float;\nvarying float v_round;\nvarying vec2 v_roundVertex;\nvarying float v_halfWidth;\n\n\n\nuniform float u_opacity;\nuniform vec4 u_color;\nuniform vec2 u_size;\nuniform float u_pixelRatio;\n\nvoid main(void) {\n  if (v_round > 0.0) {\n    vec2 windowCoords = vec2((v_roundVertex.x + 1.0) / 2.0 * u_size.x * u_pixelRatio,\n        (v_roundVertex.y + 1.0) / 2.0 * u_size.y * u_pixelRatio);\n    if (length(windowCoords - gl_FragCoord.xy) > v_halfWidth * u_pixelRatio) {\n      discard;\n    }\n  }\n  gl_FragColor = u_color;\n  float alpha = u_color.a * u_opacity;\n  if (alpha == 0.0) {\n    discard;\n  }\n  gl_FragColor.a = alpha;\n}\n":"precision mediump float;varying float a;varying vec2 aVertex;varying float c;uniform float m;uniform vec4 n;uniform vec2 o;uniform float p;void main(void){if(a>0.0){vec2 windowCoords=vec2((aVertex.x+1.0)/2.0*o.x*p,(aVertex.y+1.0)/2.0*o.y*p);if(length(windowCoords-gl_FragCoord.xy)>c*p){discard;}} gl_FragColor=n;float alpha=n.a*m;if(alpha==0.0){discard;}gl_FragColor.a=alpha;}"),Au.vertex=new du(ya.DEBUG_WEBGL?"varying float v_round;\nvarying vec2 v_roundVertex;\nvarying float v_halfWidth;\n\n\nattribute vec2 a_lastPos;\nattribute vec2 a_position;\nattribute vec2 a_nextPos;\nattribute float a_direction;\n\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_offsetScaleMatrix;\nuniform mat4 u_offsetRotateMatrix;\nuniform float u_lineWidth;\nuniform float u_miterLimit;\n\nbool nearlyEquals(in float value, in float ref) {\n  float epsilon = 0.000000000001;\n  return value >= ref - epsilon && value <= ref + epsilon;\n}\n\nvoid alongNormal(out vec2 offset, in vec2 nextP, in float turnDir, in float direction) {\n  vec2 dirVect = nextP - a_position;\n  vec2 normal = normalize(vec2(-turnDir * dirVect.y, turnDir * dirVect.x));\n  offset = u_lineWidth / 2.0 * normal * direction;\n}\n\nvoid miterUp(out vec2 offset, out float round, in bool isRound, in float direction) {\n  float halfWidth = u_lineWidth / 2.0;\n  vec2 tangent = normalize(normalize(a_nextPos - a_position) + normalize(a_position - a_lastPos));\n  vec2 normal = vec2(-tangent.y, tangent.x);\n  vec2 dirVect = a_nextPos - a_position;\n  vec2 tmpNormal = normalize(vec2(-dirVect.y, dirVect.x));\n  float miterLength = abs(halfWidth / dot(normal, tmpNormal));\n  offset = normal * direction * miterLength;\n  round = 0.0;\n  if (isRound) {\n    round = 1.0;\n  } else if (miterLength > u_miterLimit + u_lineWidth) {\n    offset = halfWidth * tmpNormal * direction;\n  }\n}\n\nbool miterDown(out vec2 offset, in vec4 projPos, in mat4 offsetMatrix, in float direction) {\n  bool degenerate = false;\n  vec2 tangent = normalize(normalize(a_nextPos - a_position) + normalize(a_position - a_lastPos));\n  vec2 normal = vec2(-tangent.y, tangent.x);\n  vec2 dirVect = a_lastPos - a_position;\n  vec2 tmpNormal = normalize(vec2(-dirVect.y, dirVect.x));\n  vec2 longOffset, shortOffset, longVertex;\n  vec4 shortProjVertex;\n  float halfWidth = u_lineWidth / 2.0;\n  if (length(a_nextPos - a_position) > length(a_lastPos - a_position)) {\n    longOffset = tmpNormal * direction * halfWidth;\n    shortOffset = normalize(vec2(dirVect.y, -dirVect.x)) * direction * halfWidth;\n    longVertex = a_nextPos;\n    shortProjVertex = u_projectionMatrix * vec4(a_lastPos, 0.0, 1.0);\n  } else {\n    shortOffset = tmpNormal * direction * halfWidth;\n    longOffset = normalize(vec2(dirVect.y, -dirVect.x)) * direction * halfWidth;\n    longVertex = a_lastPos;\n    shortProjVertex = u_projectionMatrix * vec4(a_nextPos, 0.0, 1.0);\n  }\n  //Intersection algorithm based on theory by Paul Bourke (http://paulbourke.net/geometry/pointlineplane/).\n  vec4 p1 = u_projectionMatrix * vec4(longVertex, 0.0, 1.0) + offsetMatrix * vec4(longOffset, 0.0, 0.0);\n  vec4 p2 = projPos + offsetMatrix * vec4(longOffset, 0.0, 0.0);\n  vec4 p3 = shortProjVertex + offsetMatrix * vec4(-shortOffset, 0.0, 0.0);\n  vec4 p4 = shortProjVertex + offsetMatrix * vec4(shortOffset, 0.0, 0.0);\n  float denom = (p4.y - p3.y) * (p2.x - p1.x) - (p4.x - p3.x) * (p2.y - p1.y);\n  float firstU = ((p4.x - p3.x) * (p1.y - p3.y) - (p4.y - p3.y) * (p1.x - p3.x)) / denom;\n  float secondU = ((p2.x - p1.x) * (p1.y - p3.y) - (p2.y - p1.y) * (p1.x - p3.x)) / denom;\n  float epsilon = 0.000000000001;\n  if (firstU > epsilon && firstU < 1.0 - epsilon && secondU > epsilon && secondU < 1.0 - epsilon) {\n    shortProjVertex.x = p1.x + firstU * (p2.x - p1.x);\n    shortProjVertex.y = p1.y + firstU * (p2.y - p1.y);\n    offset = shortProjVertex.xy;\n    degenerate = true;\n  } else {\n    float miterLength = abs(halfWidth / dot(normal, tmpNormal));\n    offset = normal * direction * miterLength;\n  }\n  return degenerate;\n}\n\nvoid squareCap(out vec2 offset, out float round, in bool isRound, in vec2 nextP,\n    in float turnDir, in float direction) {\n  round = 0.0;\n  vec2 dirVect = a_position - nextP;\n  vec2 firstNormal = normalize(dirVect);\n  vec2 secondNormal = vec2(turnDir * firstNormal.y * direction, -turnDir * firstNormal.x * direction);\n  vec2 hypotenuse = normalize(firstNormal - secondNormal);\n  vec2 normal = vec2(turnDir * hypotenuse.y * direction, -turnDir * hypotenuse.x * direction);\n  float length = sqrt(v_halfWidth * v_halfWidth * 2.0);\n  offset = normal * length;\n  if (isRound) {\n    round = 1.0;\n  }\n}\n\nvoid main(void) {\n  bool degenerate = false;\n  float direction = float(sign(a_direction));\n  mat4 offsetMatrix = u_offsetScaleMatrix * u_offsetRotateMatrix;\n  vec2 offset;\n  vec4 projPos = u_projectionMatrix * vec4(a_position, 0.0, 1.0);\n  bool round = nearlyEquals(mod(a_direction, 2.0), 0.0);\n\n  v_round = 0.0;\n  v_halfWidth = u_lineWidth / 2.0;\n  v_roundVertex = projPos.xy;\n\n  if (nearlyEquals(mod(a_direction, 3.0), 0.0) || nearlyEquals(mod(a_direction, 17.0), 0.0)) {\n    alongNormal(offset, a_nextPos, 1.0, direction);\n  } else if (nearlyEquals(mod(a_direction, 5.0), 0.0) || nearlyEquals(mod(a_direction, 13.0), 0.0)) {\n    alongNormal(offset, a_lastPos, -1.0, direction);\n  } else if (nearlyEquals(mod(a_direction, 23.0), 0.0)) {\n    miterUp(offset, v_round, round, direction);\n  } else if (nearlyEquals(mod(a_direction, 19.0), 0.0)) {\n    degenerate = miterDown(offset, projPos, offsetMatrix, direction);\n  } else if (nearlyEquals(mod(a_direction, 7.0), 0.0)) {\n    squareCap(offset, v_round, round, a_nextPos, 1.0, direction);\n  } else if (nearlyEquals(mod(a_direction, 11.0), 0.0)) {\n    squareCap(offset, v_round, round, a_lastPos, -1.0, direction);\n  }\n  if (!degenerate) {\n    vec4 offsets = offsetMatrix * vec4(offset, 0.0, 0.0);\n    gl_Position = projPos + offsets;\n  } else {\n    gl_Position = vec4(offset, 0.0, 1.0);\n  }\n}\n\n\n":"varying float a;varying vec2 aVertex;varying float c;attribute vec2 d;attribute vec2 e;attribute vec2 f;attribute float g;uniform mat4 h;uniform mat4 i;uniform mat4 j;uniform float k;uniform float l;bool nearlyEquals(in float value,in float ref){float epsilon=0.000000000001;return value>=ref-epsilon&&value<=ref+epsilon;}void alongNormal(out vec2 offset,in vec2 nextP,in float turnDir,in float direction){vec2 dirVect=nextP-e;vec2 normal=normalize(vec2(-turnDir*dirVect.y,turnDir*dirVect.x));offset=k/2.0*normal*direction;}void miterUp(out vec2 offset,out float round,in bool isRound,in float direction){float halfWidth=k/2.0;vec2 tangent=normalize(normalize(f-e)+normalize(e-d));vec2 normal=vec2(-tangent.y,tangent.x);vec2 dirVect=f-e;vec2 tmpNormal=normalize(vec2(-dirVect.y,dirVect.x));float miterLength=abs(halfWidth/dot(normal,tmpNormal));offset=normal*direction*miterLength;round=0.0;if(isRound){round=1.0;}else if(miterLength>l+k){offset=halfWidth*tmpNormal*direction;}} bool miterDown(out vec2 offset,in vec4 projPos,in mat4 offsetMatrix,in float direction){bool degenerate=false;vec2 tangent=normalize(normalize(f-e)+normalize(e-d));vec2 normal=vec2(-tangent.y,tangent.x);vec2 dirVect=d-e;vec2 tmpNormal=normalize(vec2(-dirVect.y,dirVect.x));vec2 longOffset,shortOffset,longVertex;vec4 shortProjVertex;float halfWidth=k/2.0;if(length(f-e)>length(d-e)){longOffset=tmpNormal*direction*halfWidth;shortOffset=normalize(vec2(dirVect.y,-dirVect.x))*direction*halfWidth;longVertex=f;shortProjVertex=h*vec4(d,0.0,1.0);}else{shortOffset=tmpNormal*direction*halfWidth;longOffset=normalize(vec2(dirVect.y,-dirVect.x))*direction*halfWidth;longVertex=d;shortProjVertex=h*vec4(f,0.0,1.0);}vec4 p1=h*vec4(longVertex,0.0,1.0)+offsetMatrix*vec4(longOffset,0.0,0.0);vec4 p2=projPos+offsetMatrix*vec4(longOffset,0.0,0.0);vec4 p3=shortProjVertex+offsetMatrix*vec4(-shortOffset,0.0,0.0);vec4 p4=shortProjVertex+offsetMatrix*vec4(shortOffset,0.0,0.0);float denom=(p4.y-p3.y)*(p2.x-p1.x)-(p4.x-p3.x)*(p2.y-p1.y);float firstU=((p4.x-p3.x)*(p1.y-p3.y)-(p4.y-p3.y)*(p1.x-p3.x))/denom;float secondU=((p2.x-p1.x)*(p1.y-p3.y)-(p2.y-p1.y)*(p1.x-p3.x))/denom;float epsilon=0.000000000001;if(firstU>epsilon&&firstU<1.0-epsilon&&secondU>epsilon&&secondU<1.0-epsilon){shortProjVertex.x=p1.x+firstU*(p2.x-p1.x);shortProjVertex.y=p1.y+firstU*(p2.y-p1.y);offset=shortProjVertex.xy;degenerate=true;}else{float miterLength=abs(halfWidth/dot(normal,tmpNormal));offset=normal*direction*miterLength;}return degenerate;}void squareCap(out vec2 offset,out float round,in bool isRound,in vec2 nextP,in float turnDir,in float direction){round=0.0;vec2 dirVect=e-nextP;vec2 firstNormal=normalize(dirVect);vec2 secondNormal=vec2(turnDir*firstNormal.y*direction,-turnDir*firstNormal.x*direction);vec2 hypotenuse=normalize(firstNormal-secondNormal);vec2 normal=vec2(turnDir*hypotenuse.y*direction,-turnDir*hypotenuse.x*direction);float length=sqrt(c*c*2.0);offset=normal*length;if(isRound){round=1.0;}} void main(void){bool degenerate=false;float direction=float(sign(g));mat4 offsetMatrix=i*j;vec2 offset;vec4 projPos=h*vec4(e,0.0,1.0);bool round=nearlyEquals(mod(g,2.0),0.0);a=0.0;c=k/2.0;aVertex=projPos.xy;if(nearlyEquals(mod(g,3.0),0.0)||nearlyEquals(mod(g,17.0),0.0)){alongNormal(offset,f,1.0,direction);}else if(nearlyEquals(mod(g,5.0),0.0)||nearlyEquals(mod(g,13.0),0.0)){alongNormal(offset,d,-1.0,direction);}else if(nearlyEquals(mod(g,23.0),0.0)){miterUp(offset,a,round,direction);}else if(nearlyEquals(mod(g,19.0),0.0)){degenerate=miterDown(offset,projPos,offsetMatrix,direction);}else if(nearlyEquals(mod(g,7.0),0.0)){squareCap(offset,a,round,f,1.0,direction);}else if(nearlyEquals(mod(g,11.0),0.0)){squareCap(offset,a,round,d,-1.0,direction);}if(!degenerate){vec4 offsets=offsetMatrix*vec4(offset,0.0,0.0);gl_Position=projPos+offsets;}else{gl_Position=vec4(offset,0.0,1.0);}}");var Ru=function(t,e){this.u_projectionMatrix=t.getUniformLocation(e,ya.DEBUG_WEBGL?"u_projectionMatrix":"h"),this.u_offsetScaleMatrix=t.getUniformLocation(e,ya.DEBUG_WEBGL?"u_offsetScaleMatrix":"i"),this.u_offsetRotateMatrix=t.getUniformLocation(e,ya.DEBUG_WEBGL?"u_offsetRotateMatrix":"j"),this.u_lineWidth=t.getUniformLocation(e,ya.DEBUG_WEBGL?"u_lineWidth":"k"),this.u_miterLimit=t.getUniformLocation(e,ya.DEBUG_WEBGL?"u_miterLimit":"l"),this.u_opacity=t.getUniformLocation(e,ya.DEBUG_WEBGL?"u_opacity":"m"),this.u_color=t.getUniformLocation(e,ya.DEBUG_WEBGL?"u_color":"n"),this.u_size=t.getUniformLocation(e,ya.DEBUG_WEBGL?"u_size":"o"),this.u_pixelRatio=t.getUniformLocation(e,ya.DEBUG_WEBGL?"u_pixelRatio":"p"),this.a_lastPos=t.getAttribLocation(e,ya.DEBUG_WEBGL?"a_lastPos":"d"),this.a_position=t.getAttribLocation(e,ya.DEBUG_WEBGL?"a_position":"e"),this.a_nextPos=t.getAttribLocation(e,ya.DEBUG_WEBGL?"a_nextPos":"f"),this.a_direction=t.getAttribLocation(e,ya.DEBUG_WEBGL?"a_direction":"g")},Lu=function(t,e){_u.call(this,t,e),this.defaultLocations_=null,this.styles_=[],this.styleIndices_=[],this.state_={strokeColor:null,lineCap:void 0,lineDash:null,lineDashOffset:void 0,lineJoin:void 0,lineWidth:void 0,miterLimit:void 0,changed:!1}};ya.inherits(Lu,_u),Lu.prototype.drawCoordinates_=function(t,e,n,i){var r,o,a,s,l,u,c,h,d=this.vertices.length,f=this.indices.length,p="bevel"===this.state_.lineJoin?0:"miter"===this.state_.lineJoin?1:2,g="butt"===this.state_.lineCap?0:"square"===this.state_.lineCap?1:2,_=bu.lineStringIsClosed(t,e,n,i),v=f,y=1;for(r=e,o=n;r<o;r+=i){if(l=d/7,u=c,c=h||[t[r],t[r+1]],r===e){if(h=[t[r+i],t[r+i+1]],n-e==2*i&&Ha.equals(c,h))break;if(!_){g&&(d=this.addVertices_([0,0],c,h,y*Lu.Instruction_.BEGIN_LINE_CAP*g,d),d=this.addVertices_([0,0],c,h,-y*Lu.Instruction_.BEGIN_LINE_CAP*g,d),this.indices[f++]=l+2,this.indices[f++]=l,this.indices[f++]=l+1,this.indices[f++]=l+1,this.indices[f++]=l+3,this.indices[f++]=l+2),d=this.addVertices_([0,0],c,h,y*Lu.Instruction_.BEGIN_LINE*(g||1),d),v=(d=this.addVertices_([0,0],c,h,-y*Lu.Instruction_.BEGIN_LINE*(g||1),d))/7-1;continue}u=[t[n-2*i],t[n-2*i+1]],a=h}else{if(r===n-i){if(_){h=a;break}u=u||[0,0],d=this.addVertices_(u,c,[0,0],y*Lu.Instruction_.END_LINE*(g||1),d),d=this.addVertices_(u,c,[0,0],-y*Lu.Instruction_.END_LINE*(g||1),d),this.indices[f++]=l,this.indices[f++]=v-1,this.indices[f++]=v,this.indices[f++]=v,this.indices[f++]=l+1,this.indices[f++]=l,g&&(d=this.addVertices_(u,c,[0,0],y*Lu.Instruction_.END_LINE_CAP*g,d),d=this.addVertices_(u,c,[0,0],-y*Lu.Instruction_.END_LINE_CAP*g,d),this.indices[f++]=l+2,this.indices[f++]=l,this.indices[f++]=l+1,this.indices[f++]=l+1,this.indices[f++]=l+3,this.indices[f++]=l+2);break}h=[t[r+i],t[r+i+1]]}s=vu.triangleIsCounterClockwise(u[0],u[1],c[0],c[1],h[0],h[1])?-1:1,d=this.addVertices_(u,c,h,s*Lu.Instruction_.BEVEL_FIRST*(p||1),d),d=this.addVertices_(u,c,h,s*Lu.Instruction_.BEVEL_SECOND*(p||1),d),d=this.addVertices_(u,c,h,-s*Lu.Instruction_.MITER_BOTTOM*(p||1),d),r>e&&(this.indices[f++]=l,this.indices[f++]=v-1,this.indices[f++]=v,this.indices[f++]=l+2,this.indices[f++]=l,this.indices[f++]=y*s>0?v:v-1),this.indices[f++]=l,this.indices[f++]=l+2,this.indices[f++]=l+1,v=l+2,y=s,p&&(d=this.addVertices_(u,c,h,s*Lu.Instruction_.MITER_TOP*p,d),this.indices[f++]=l+1,this.indices[f++]=l+3,this.indices[f++]=l)}_&&(l=l||d/7,s=Us.linearRingIsClockwise([u[0],u[1],c[0],c[1],h[0],h[1]],0,6,2)?1:-1,d=this.addVertices_(u,c,h,s*Lu.Instruction_.BEVEL_FIRST*(p||1),d),d=this.addVertices_(u,c,h,-s*Lu.Instruction_.MITER_BOTTOM*(p||1),d),this.indices[f++]=l,this.indices[f++]=v-1,this.indices[f++]=v,this.indices[f++]=l+1,this.indices[f++]=l,this.indices[f++]=y*s>0?v:v-1)},Lu.prototype.addVertices_=function(t,e,n,i,r){return this.vertices[r++]=t[0],this.vertices[r++]=t[1],this.vertices[r++]=e[0],this.vertices[r++]=e[1],this.vertices[r++]=n[0],this.vertices[r++]=n[1],this.vertices[r++]=i,r},Lu.prototype.isValid_=function(t,e,n,i){var r=n-e;if(r<2*i)return!1;if(r===2*i){var o=[t[e],t[e+1]],a=[t[e+i],t[e+i+1]];return!Ha.equals(o,a)}return!0},Lu.prototype.drawLineString=function(t,e){var n=t.getFlatCoordinates(),i=t.getStride();this.isValid_(n,0,n.length,i)&&(n=gs.translate(n,0,n.length,i,-this.origin[0],-this.origin[1]),this.state_.changed&&(this.styleIndices_.push(this.indices.length),this.state_.changed=!1),this.startIndices.push(this.indices.length),this.startIndicesFeature.push(e),this.drawCoordinates_(n,0,n.length,i))},Lu.prototype.drawMultiLineString=function(t,e){var n=this.indices.length,i=t.getEnds();i.unshift(0);var r,o,a=t.getFlatCoordinates(),s=t.getStride();if(i.length>1)for(r=1,o=i.length;r<o;++r)if(this.isValid_(a,i[r-1],i[r],s)){var l=gs.translate(a,i[r-1],i[r],s,-this.origin[0],-this.origin[1]);this.drawCoordinates_(l,0,l.length,s)}this.indices.length>n&&(this.startIndices.push(n),this.startIndicesFeature.push(e),this.state_.changed&&(this.styleIndices_.push(n),this.state_.changed=!1))},Lu.prototype.drawPolygonCoordinates=function(t,e,n){if(bu.lineStringIsClosed(t,0,t.length,n)||(t.push(t[0]),t.push(t[1])),this.drawCoordinates_(t,0,t.length,n),e.length){var i,r;for(i=0,r=e.length;i<r;++i)bu.lineStringIsClosed(e[i],0,e[i].length,n)||(e[i].push(e[i][0]),e[i].push(e[i][1])),this.drawCoordinates_(e[i],0,e[i].length,n)}},Lu.prototype.setPolygonStyle=function(t,e){var n=void 0===e?this.indices.length:e;this.startIndices.push(n),this.startIndicesFeature.push(t),this.state_.changed&&(this.styleIndices_.push(n),this.state_.changed=!1)},Lu.prototype.getCurrentIndex=function(){return this.indices.length},Lu.prototype.finish=function(t){this.verticesBuffer=new yu(this.vertices),this.indicesBuffer=new yu(this.indices),this.startIndices.push(this.indices.length),0===this.styleIndices_.length&&this.styles_.length>0&&(this.styles_=[]),this.vertices=null,this.indices=null},Lu.prototype.getDeleteResourcesFunction=function(t){var e=this.verticesBuffer,n=this.indicesBuffer;return function(){t.deleteBuffer(e),t.deleteBuffer(n)}},Lu.prototype.setUpProgram=function(t,e,n,i){var r,o;r=Au.fragment,o=Au.vertex;var a,s=e.getProgram(r,o);return this.defaultLocations_?a=this.defaultLocations_:(a=new Ru(t,s),this.defaultLocations_=a),e.useProgram(s),t.enableVertexAttribArray(a.a_lastPos),t.vertexAttribPointer(a.a_lastPos,2,Oa.FLOAT,!1,28,0),t.enableVertexAttribArray(a.a_position),t.vertexAttribPointer(a.a_position,2,Oa.FLOAT,!1,28,8),t.enableVertexAttribArray(a.a_nextPos),t.vertexAttribPointer(a.a_nextPos,2,Oa.FLOAT,!1,28,16),t.enableVertexAttribArray(a.a_direction),t.vertexAttribPointer(a.a_direction,1,Oa.FLOAT,!1,28,24),t.uniform2fv(a.u_size,n),t.uniform1f(a.u_pixelRatio,i),a},Lu.prototype.shutDownProgram=function(t,e){t.disableVertexAttribArray(e.a_lastPos),t.disableVertexAttribArray(e.a_position),t.disableVertexAttribArray(e.a_nextPos),t.disableVertexAttribArray(e.a_direction)},Lu.prototype.drawReplay=function(t,e,n,i){var r=t.getParameter(t.DEPTH_FUNC),o=t.getParameter(t.DEPTH_WRITEMASK);if(i||(t.enable(t.DEPTH_TEST),t.depthMask(!0),t.depthFunc(t.NOTEQUAL)),Ea.isEmpty(n)){var a,s,l,u;for(l=this.startIndices[this.startIndices.length-1],a=this.styleIndices_.length-1;a>=0;--a)s=this.styleIndices_[a],u=this.styles_[a],this.setStrokeStyle_(t,u[0],u[1],u[2]),this.drawElements(t,e,s,l),t.clear(t.DEPTH_BUFFER_BIT),l=s}else this.drawReplaySkipping_(t,e,n);i||(t.disable(t.DEPTH_TEST),t.clear(t.DEPTH_BUFFER_BIT),t.depthMask(o),t.depthFunc(r))},Lu.prototype.drawReplaySkipping_=function(t,e,n){var i,r,o,a,s,l,u,c;for(u=this.startIndices.length-2,o=r=this.startIndices[u+1],i=this.styleIndices_.length-1;i>=0;--i){for(a=this.styles_[i],this.setStrokeStyle_(t,a[0],a[1],a[2]),s=this.styleIndices_[i];u>=0&&this.startIndices[u]>=s;)c=this.startIndices[u],l=this.startIndicesFeature[u],n[ya.getUid(l).toString()]&&(r!==o&&(this.drawElements(t,e,r,o),t.clear(t.DEPTH_BUFFER_BIT)),o=c),u--,r=c;r!==o&&(this.drawElements(t,e,r,o),t.clear(t.DEPTH_BUFFER_BIT)),r=o=s}},Lu.prototype.drawHitDetectionReplayOneByOne=function(t,e,n,i,r){var o,a,s,l,u,c,h,d;for(d=this.startIndices.length-2,s=this.startIndices[d+1],o=this.styleIndices_.length-1;o>=0;--o)for(l=this.styles_[o],this.setStrokeStyle_(t,l[0],l[1],l[2]),u=this.styleIndices_[o];d>=0&&this.startIndices[d]>=u;){if(a=this.startIndices[d],c=this.startIndicesFeature[d],h=ya.getUid(c).toString(),void 0===n[h]&&c.getGeometry()&&(void 0===r||hs.intersects(r,c.getGeometry().getExtent()))){t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),this.drawElements(t,e,a,s);var f=i(c);if(f)return f}d--,s=a}},Lu.prototype.setStrokeStyle_=function(t,e,n,i){t.uniform4fv(this.defaultLocations_.u_color,e),t.uniform1f(this.defaultLocations_.u_lineWidth,n),t.uniform1f(this.defaultLocations_.u_miterLimit,i)},Lu.prototype.setFillStrokeStyle=function(t,e){var n=e.getLineCap();this.state_.lineCap=void 0!==n?n:vu.defaultLineCap;var i=e.getLineDash();this.state_.lineDash=i||vu.defaultLineDash;var r=e.getLineDashOffset();this.state_.lineDashOffset=r||vu.defaultLineDashOffset;var o=e.getLineJoin();this.state_.lineJoin=void 0!==o?o:vu.defaultLineJoin;var a=e.getColor();a=a instanceof CanvasGradient||a instanceof CanvasPattern?vu.defaultStrokeStyle:Ll.asArray(a).map(function(t,e){return 3!=e?t/255:t})||vu.defaultStrokeStyle;var s=e.getWidth();s=void 0!==s?s:vu.defaultLineWidth;var l=e.getMiterLimit();l=void 0!==l?l:vu.defaultMiterLimit,this.state_.strokeColor&&Ha.equals(this.state_.strokeColor,a)&&this.state_.lineWidth===s&&this.state_.miterLimit===l||(this.state_.changed=!0,this.state_.strokeColor=a,this.state_.lineWidth=s,this.state_.miterLimit=l,this.styles_.push([a,s,l]))},Lu.Instruction_={ROUND:2,BEGIN_LINE:3,END_LINE:5,BEGIN_LINE_CAP:7,END_LINE_CAP:11,BEVEL_FIRST:13,BEVEL_SECOND:17,MITER_BOTTOM:19,MITER_TOP:23};var Iu={};Iu.fragment=new hu(ya.DEBUG_WEBGL?"precision mediump float;\n\n\n\nuniform vec4 u_color;\nuniform float u_opacity;\n\nvoid main(void) {\n  gl_FragColor = u_color;\n  float alpha = u_color.a * u_opacity;\n  if (alpha == 0.0) {\n    discard;\n  }\n  gl_FragColor.a = alpha;\n}\n":"precision mediump float;uniform vec4 e;uniform float f;void main(void){gl_FragColor=e;float alpha=e.a*f;if(alpha==0.0){discard;}gl_FragColor.a=alpha;}"),Iu.vertex=new du(ya.DEBUG_WEBGL?"\n\nattribute vec2 a_position;\n\nuniform mat4 u_projectionMatrix;\nuniform mat4 u_offsetScaleMatrix;\nuniform mat4 u_offsetRotateMatrix;\n\nvoid main(void) {\n  gl_Position = u_projectionMatrix * vec4(a_position, 0.0, 1.0);\n}\n\n\n":"attribute vec2 a;uniform mat4 b;uniform mat4 c;uniform mat4 d;void main(void){gl_Position=b*vec4(a,0.0,1.0);}");var Pu=function(t,e){this.u_projectionMatrix=t.getUniformLocation(e,ya.DEBUG_WEBGL?"u_projectionMatrix":"b"),this.u_offsetScaleMatrix=t.getUniformLocation(e,ya.DEBUG_WEBGL?"u_offsetScaleMatrix":"c"),this.u_offsetRotateMatrix=t.getUniformLocation(e,ya.DEBUG_WEBGL?"u_offsetRotateMatrix":"d"),this.u_color=t.getUniformLocation(e,ya.DEBUG_WEBGL?"u_color":"e"),this.u_opacity=t.getUniformLocation(e,ya.DEBUG_WEBGL?"u_opacity":"f"),this.a_position=t.getAttribLocation(e,ya.DEBUG_WEBGL?"a_position":"a")},Mu=function(t){var e=t||{};this.color_=void 0!==e.color?e.color:null,this.lineCap_=e.lineCap,this.lineDash_=void 0!==e.lineDash?e.lineDash:null,this.lineDashOffset_=e.lineDashOffset,this.lineJoin_=e.lineJoin,this.miterLimit_=e.miterLimit,this.width_=e.width,this.checksum_=void 0};Mu.prototype.clone=function(){var t=this.getColor();return new Mu({color:t&&t.slice?t.slice():t||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})},Mu.prototype.getColor=function(){return this.color_},Mu.prototype.getLineCap=function(){return this.lineCap_},Mu.prototype.getLineDash=function(){return this.lineDash_},Mu.prototype.getLineDashOffset=function(){return this.lineDashOffset_},Mu.prototype.getLineJoin=function(){return this.lineJoin_},Mu.prototype.getMiterLimit=function(){return this.miterLimit_},Mu.prototype.getWidth=function(){return this.width_},Mu.prototype.setColor=function(t){this.color_=t,this.checksum_=void 0},Mu.prototype.setLineCap=function(t){this.lineCap_=t,this.checksum_=void 0},Mu.prototype.setLineDash=function(t){this.lineDash_=t,this.checksum_=void 0},Mu.prototype.setLineDashOffset=function(t){this.lineDashOffset_=t,this.checksum_=void 0},Mu.prototype.setLineJoin=function(t){this.lineJoin_=t,this.checksum_=void 0},Mu.prototype.setMiterLimit=function(t){this.miterLimit_=t,this.checksum_=void 0},Mu.prototype.setWidth=function(t){this.width_=t,this.checksum_=void 0},Mu.prototype.getChecksum=function(){return void 0===this.checksum_&&(this.checksum_="s",this.color_?"string"==typeof this.color_?this.checksum_+=this.color_:this.checksum_+=ya.getUid(this.color_).toString():this.checksum_+="-",this.checksum_+=","+(void 0!==this.lineCap_?this.lineCap_.toString():"-")+","+(this.lineDash_?this.lineDash_.toString():"-")+","+(void 0!==this.lineDashOffset_?this.lineDashOffset_:"-")+","+(void 0!==this.lineJoin_?this.lineJoin_:"-")+","+(void 0!==this.miterLimit_?this.miterLimit_.toString():"-")+","+(void 0!==this.width_?this.width_.toString():"-")),this.checksum_};var Ou=function(t){this.first_=void 0,this.last_=void 0,this.head_=void 0,this.circular_=void 0===t||t,this.length_=0};Ou.prototype.insertItem=function(t){var e={prev:void 0,next:void 0,data:t},n=this.head_;if(n){var i=n.next;e.prev=n,e.next=i,n.next=e,i&&(i.prev=e),n===this.last_&&(this.last_=e)}else this.first_=e,this.last_=e,this.circular_&&(e.next=e,e.prev=e);this.head_=e,this.length_++},Ou.prototype.removeItem=function(){var t=this.head_;if(t){var e=t.next,n=t.prev;e&&(e.prev=n),n&&(n.next=e),this.head_=e||n,this.first_===this.last_?(this.head_=void 0,this.first_=void 0,this.last_=void 0):this.first_===t?this.first_=this.head_:this.last_===t&&(this.last_=n?this.head_.prev:this.head_),this.length_--}},Ou.prototype.firstItem=function(){if(this.head_=this.first_,this.head_)return this.head_.data},Ou.prototype.lastItem=function(){if(this.head_=this.last_,this.head_)return this.head_.data},Ou.prototype.nextItem=function(){if(this.head_&&this.head_.next)return this.head_=this.head_.next,this.head_.data},Ou.prototype.getNextItem=function(){if(this.head_&&this.head_.next)return this.head_.next.data},Ou.prototype.prevItem=function(){if(this.head_&&this.head_.prev)return this.head_=this.head_.prev,this.head_.data},Ou.prototype.getPrevItem=function(){if(this.head_&&this.head_.prev)return this.head_.prev.data},Ou.prototype.getCurrItem=function(){if(this.head_)return this.head_.data},Ou.prototype.setFirstItem=function(){this.circular_&&this.head_&&(this.first_=this.head_,this.last_=this.head_.prev)},Ou.prototype.concat=function(t){if(t.head_){if(this.head_){var e=this.head_.next;this.head_.next=t.first_,t.first_.prev=this.head_,e.prev=t.last_,t.last_.next=e,this.length_+=t.length_}else this.head_=t.head_,this.first_=t.first_,this.last_=t.last_,this.length_=t.length_;t.head_=void 0,t.first_=void 0,t.last_=void 0,t.length_=0}},Ou.prototype.getLength=function(){return this.length_};var Du=function(t){this.rbush_=Wl(t),this.items_={}};Du.prototype.insert=function(t,e){var n={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:e};this.rbush_.insert(n),this.items_[ya.getUid(e)]=n},Du.prototype.load=function(t,e){for(var n=new Array(e.length),i=0,r=e.length;i<r;i++){var o=t[i],a=e[i],s={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3],value:a};n[i]=s,this.items_[ya.getUid(a)]=s}this.rbush_.load(n)},Du.prototype.remove=function(t){var e=ya.getUid(t),n=this.items_[e];return delete this.items_[e],null!==this.rbush_.remove(n)},Du.prototype.update=function(t,e){var n=this.items_[ya.getUid(e)],i=[n.minX,n.minY,n.maxX,n.maxY];hs.equals(i,t)||(this.remove(e),this.insert(t,e))},Du.prototype.getAll=function(){return this.rbush_.all().map(function(t){return t.value})},Du.prototype.getInExtent=function(t){var e={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]};return this.rbush_.search(e).map(function(t){return t.value})},Du.prototype.forEach=function(t,e){return this.forEach_(this.getAll(),t,e)},Du.prototype.forEachInExtent=function(t,e,n){return this.forEach_(this.getInExtent(t),e,n)},Du.prototype.forEach_=function(t,e,n){for(var i,r=0,o=t.length;r<o;r++)if(i=e.call(n,t[r]))return i;return i},Du.prototype.isEmpty=function(){return Ea.isEmpty(this.items_)},Du.prototype.clear=function(){this.rbush_.clear(),this.items_={}},Du.prototype.getExtent=function(t){var e=this.rbush_.data;return hs.createOrUpdate(e.minX,e.minY,e.maxX,e.maxY,t)},Du.prototype.concat=function(t){this.rbush_.load(t.rbush_.all());for(var e in t.items_)this.items_[0|e]=t.items_[0|e]};var Fu=function(t,e){_u.call(this,t,e),this.lineStringReplay=new Lu(t,e),this.defaultLocations_=null,this.styles_=[],this.styleIndices_=[],this.state_={fillColor:null,changed:!1}};ya.inherits(Fu,_u),Fu.prototype.drawCoordinates_=function(t,e,n){var i=new Ou,r=new Du;this.processFlatCoordinates_(t,n,i,r,!0);var o=this.getMaxCoords_(i);if(e.length){var a,s,l=[];for(a=0,s=e.length;a<s;++a){var u={list:new Ou,maxCoords:void 0,rtree:new Du};l.push(u),this.processFlatCoordinates_(e[a],n,u.list,u.rtree,!1),this.classifyPoints_(u.list,u.rtree,!0),u.maxCoords=this.getMaxCoords_(u.list)}for(l.sort(function(t,e){return e.maxCoords[0]===t.maxCoords[0]?t.maxCoords[1]-e.maxCoords[1]:e.maxCoords[0]-t.maxCoords[0]}),a=0;a<l.length;++a){var c,h=l[a].list,d=h.firstItem(),f=d;do{if(this.getIntersections_(f,r).length){c=!0;break}f=h.nextItem()}while(d!==f);c||this.bridgeHole_(h,l[a].maxCoords[0],i,o[0],r)&&(r.concat(l[a].rtree),this.classifyPoints_(i,r,!1))}}else this.classifyPoints_(i,r,!1);this.triangulate_(i,r)},Fu.prototype.processFlatCoordinates_=function(t,e,n,i,r){var o,a,s,l,u,c=Us.linearRingIsClockwise(t,0,t.length,e),h=this.vertices.length/2,d=[],f=[];if(r===c){for(l=s=this.createPoint_(t[0],t[1],h++),o=e,a=t.length;o<a;o+=e)u=this.createPoint_(t[o],t[o+1],h++),f.push(this.insertItem_(l,u,n)),d.push([Math.min(l.x,u.x),Math.min(l.y,u.y),Math.max(l.x,u.x),Math.max(l.y,u.y)]),l=u;f.push(this.insertItem_(u,s,n)),d.push([Math.min(l.x,u.x),Math.min(l.y,u.y),Math.max(l.x,u.x),Math.max(l.y,u.y)])}else{var p=t.length-e;for(l=s=this.createPoint_(t[p],t[p+1],h++),o=p-e,a=0;o>=a;o-=e)u=this.createPoint_(t[o],t[o+1],h++),f.push(this.insertItem_(l,u,n)),d.push([Math.min(l.x,u.x),Math.min(l.y,u.y),Math.max(l.x,u.x),Math.max(l.y,u.y)]),l=u;f.push(this.insertItem_(u,s,n)),d.push([Math.min(l.x,u.x),Math.min(l.y,u.y),Math.max(l.x,u.x),Math.max(l.y,u.y)])}i.load(d,f)},Fu.prototype.getMaxCoords_=function(t){var e=t.firstItem(),n=e,i=[n.p0.x,n.p0.y];do{(n=t.nextItem()).p0.x>i[0]&&(i=[n.p0.x,n.p0.y])}while(n!==e);return i},Fu.prototype.classifyPoints_=function(t,e,n){var i=t.firstItem(),r=i,o=t.nextItem(),a=!1;do{var s=n?vu.triangleIsCounterClockwise(o.p1.x,o.p1.y,r.p1.x,r.p1.y,r.p0.x,r.p0.y):vu.triangleIsCounterClockwise(r.p0.x,r.p0.y,r.p1.x,r.p1.y,o.p1.x,o.p1.y);void 0===s?(this.removeItem_(r,o,t,e),a=!0,o===i&&(i=t.getNextItem()),o=r,t.prevItem()):r.p1.reflex!==s&&(r.p1.reflex=s,a=!0),r=o,o=t.nextItem()}while(r!==i);return a},Fu.prototype.bridgeHole_=function(t,e,n,i,r){for(var o=t.firstItem();o.p1.x!==e;)o=t.nextItem();var a,s,l,u,c=o.p1,h={x:i,y:c.y,i:-1},d=1/0,f=this.getIntersections_({p0:c,p1:h},r,!0);for(a=0,s=f.length;a<s;++a){var p=f[a],g=this.calculateIntersection_(c,h,p.p0,p.p1,!0),_=Math.abs(c.x-g[0]);_<d&&void 0!==vu.triangleIsCounterClockwise(c.x,c.y,p.p0.x,p.p0.y,p.p1.x,p.p1.y)&&(d=_,u={x:g[0],y:g[1],i:-1},o=p)}if(d===1/0)return!1;if(l=o.p1,d>0){var v=this.getPointsInTriangle_(c,u,o.p1,r);if(v.length){var y=1/0;for(a=0,s=v.length;a<s;++a){var m=v[a],x=Math.atan2(c.y-m.y,h.x-m.x);(x<y||x===y&&m.x<l.x)&&(y=x,l=m)}}}for(o=n.firstItem();o.p1.x!==l.x||o.p1.y!==l.y;)o=n.nextItem();var S={x:c.x,y:c.y,i:c.i,reflex:void 0},E={x:o.p1.x,y:o.p1.y,i:o.p1.i,reflex:void 0};return t.getNextItem().p0=S,this.insertItem_(c,o.p1,t,r),this.insertItem_(E,S,t,r),o.p1=E,t.setFirstItem(),n.concat(t),!0},Fu.prototype.triangulate_=function(t,e){for(var n=!1,i=this.isSimple_(t,e);t.getLength()>3;)if(i){if(!this.clipEars_(t,e,i,n)&&!this.classifyPoints_(t,e,n)&&!this.resolveSelfIntersections_(t,e,!0))break}else if(!this.clipEars_(t,e,i,n)&&!this.classifyPoints_(t,e,n)&&!this.resolveSelfIntersections_(t,e)){if(!(i=this.isSimple_(t,e))){this.splitPolygon_(t,e);break}n=!this.isClockwise_(t),this.classifyPoints_(t,e,n)}if(3===t.getLength()){var r=this.indices.length;this.indices[r++]=t.getPrevItem().p0.i,this.indices[r++]=t.getCurrItem().p0.i,this.indices[r++]=t.getNextItem().p0.i}},Fu.prototype.clipEars_=function(t,e,n,i){var r,o,a,s=this.indices.length,l=t.firstItem(),u=t.getPrevItem(),c=l,h=t.nextItem(),d=t.getNextItem(),f=!1;do{if(r=c.p0,o=c.p1,a=h.p1,!1===o.reflex){var p;p=n?0===this.getPointsInTriangle_(r,o,a,e,!0).length:i?this.diagonalIsInside_(d.p1,a,o,r,u.p0):this.diagonalIsInside_(u.p0,r,o,a,d.p1),(n||0===this.getIntersections_({p0:r,p1:a},e).length)&&p&&(n||!1===r.reflex||!1===a.reflex||Us.linearRingIsClockwise([u.p0.x,u.p0.y,r.x,r.y,o.x,o.y,a.x,a.y,d.p1.x,d.p1.y],0,10,2)===!i)&&(this.indices[s++]=r.i,this.indices[s++]=o.i,this.indices[s++]=a.i,this.removeItem_(c,h,t,e),h===l&&(l=d),f=!0)}u=t.getPrevItem(),c=t.getCurrItem(),h=t.nextItem(),d=t.getNextItem()}while(c!==l&&t.getLength()>3);return f},Fu.prototype.resolveSelfIntersections_=function(t,e,n){var i=t.firstItem();t.nextItem();var r=i,o=t.nextItem(),a=!1;do{var s=this.calculateIntersection_(r.p0,r.p1,o.p0,o.p1,n);if(s){var l=!1,u=this.vertices.length,c=this.indices.length,h=u/2,d=t.prevItem();t.removeItem(),e.remove(d),l=d===i;var f;if(n?(s[0]===r.p0.x&&s[1]===r.p0.y?(t.prevItem(),f=r.p0,o.p0=f,e.remove(r),l=l||r===i):(f=o.p1,r.p1=f,e.remove(o),l=l||o===i),t.removeItem()):(f=this.createPoint_(s[0],s[1],h),r.p1=f,o.p0=f,e.update([Math.min(r.p0.x,r.p1.x),Math.min(r.p0.y,r.p1.y),Math.max(r.p0.x,r.p1.x),Math.max(r.p0.y,r.p1.y)],r),e.update([Math.min(o.p0.x,o.p1.x),Math.min(o.p0.y,o.p1.y),Math.max(o.p0.x,o.p1.x),Math.max(o.p0.y,o.p1.y)],o)),this.indices[c++]=d.p0.i,this.indices[c++]=d.p1.i,this.indices[c++]=f.i,a=!0,l)break}r=t.getPrevItem(),o=t.nextItem()}while(r!==i);return a},Fu.prototype.isSimple_=function(t,e){var n=t.firstItem(),i=n;do{if(this.getIntersections_(i,e).length)return!1;i=t.nextItem()}while(i!==n);return!0},Fu.prototype.isClockwise_=function(t){var e=2*t.getLength(),n=new Array(e),i=t.firstItem(),r=i,o=0;do{n[o++]=r.p0.x,n[o++]=r.p0.y,r=t.nextItem()}while(r!==i);return Us.linearRingIsClockwise(n,0,e,2)},Fu.prototype.splitPolygon_=function(t,e){var n=t.firstItem(),i=n;do{var r=this.getIntersections_(i,e);if(r.length){var o=r[0],a=this.vertices.length/2,s=this.calculateIntersection_(i.p0,i.p1,o.p0,o.p1),l=this.createPoint_(s[0],s[1],a),u=new Ou,c=new Du;this.insertItem_(l,i.p1,u,c),i.p1=l,e.update([Math.min(i.p0.x,l.x),Math.min(i.p0.y,l.y),Math.max(i.p0.x,l.x),Math.max(i.p0.y,l.y)],i);for(var h=t.nextItem();h!==o;)this.insertItem_(h.p0,h.p1,u,c),e.remove(h),t.removeItem(),h=t.getCurrItem();this.insertItem_(o.p0,l,u,c),o.p0=l,e.update([Math.min(o.p1.x,l.x),Math.min(o.p1.y,l.y),Math.max(o.p1.x,l.x),Math.max(o.p1.y,l.y)],o),this.classifyPoints_(t,e,!1),this.triangulate_(t,e),this.classifyPoints_(u,c,!1),this.triangulate_(u,c);break}i=t.nextItem()}while(i!==n)},Fu.prototype.createPoint_=function(t,e,n){var i=this.vertices.length;return this.vertices[i++]=t,this.vertices[i++]=e,{x:t,y:e,i:n,reflex:void 0}},Fu.prototype.insertItem_=function(t,e,n,i){var r={p0:t,p1:e};return n.insertItem(r),i&&i.insert([Math.min(t.x,e.x),Math.min(t.y,e.y),Math.max(t.x,e.x),Math.max(t.y,e.y)],r),r},Fu.prototype.removeItem_=function(t,e,n,i){n.getCurrItem()===e&&(n.removeItem(),t.p1=e.p1,i.remove(e),i.update([Math.min(t.p0.x,t.p1.x),Math.min(t.p0.y,t.p1.y),Math.max(t.p0.x,t.p1.x),Math.max(t.p0.y,t.p1.y)],t))},Fu.prototype.getPointsInTriangle_=function(t,e,n,i,r){var o,a,s,l,u=[],c=i.getInExtent([Math.min(t.x,e.x,n.x),Math.min(t.y,e.y,n.y),Math.max(t.x,e.x,n.x),Math.max(t.y,e.y,n.y)]);for(o=0,a=c.length;o<a;++o)for(s in c[o])"object"!=typeof(l=c[o][s])||r&&!l.reflex||l.x===t.x&&l.y===t.y||l.x===e.x&&l.y===e.y||l.x===n.x&&l.y===n.y||-1!==u.indexOf(l)||!Fs.linearRingContainsXY([t.x,t.y,e.x,e.y,n.x,n.y],0,6,2,l.x,l.y)||u.push(l);return u},Fu.prototype.getIntersections_=function(t,e,n){var i,r,o=t.p0,a=t.p1,s=e.getInExtent([Math.min(o.x,a.x),Math.min(o.y,a.y),Math.max(o.x,a.x),Math.max(o.y,a.y)]),l=[];for(i=0,r=s.length;i<r;++i){var u=s[i];t!==u&&(n||u.p0!==a||u.p1!==o)&&this.calculateIntersection_(o,a,u.p0,u.p1,n)&&l.push(u)}return l},Fu.prototype.calculateIntersection_=function(t,e,n,i,r){var o=(i.y-n.y)*(e.x-t.x)-(i.x-n.x)*(e.y-t.y);if(0!==o){var a=((i.x-n.x)*(t.y-n.y)-(i.y-n.y)*(t.x-n.x))/o,s=((e.x-t.x)*(t.y-n.y)-(e.y-t.y)*(t.x-n.x))/o;if(!r&&a>vu.EPSILON&&a<1-vu.EPSILON&&s>vu.EPSILON&&s<1-vu.EPSILON||r&&a>=0&&a<=1&&s>=0&&s<=1)return[t.x+a*(e.x-t.x),t.y+a*(e.y-t.y)]}},Fu.prototype.diagonalIsInside_=function(t,e,n,i,r){if(void 0===e.reflex||void 0===i.reflex)return!1;var o=(n.x-i.x)*(e.y-i.y)>(n.y-i.y)*(e.x-i.x),a=(r.x-i.x)*(e.y-i.y)<(r.y-i.y)*(e.x-i.x),s=(t.x-e.x)*(i.y-e.y)>(t.y-e.y)*(i.x-e.x),l=(n.x-e.x)*(i.y-e.y)<(n.y-e.y)*(i.x-e.x),u=i.reflex?a||o:a&&o,c=e.reflex?l||s:l&&s;return u&&c},Fu.prototype.drawMultiPolygon=function(t,e){var n,i,r,o,a=t.getEndss(),s=t.getStride(),l=this.indices.length,u=this.lineStringReplay.getCurrentIndex(),c=t.getFlatCoordinates(),h=0;for(n=0,i=a.length;n<i;++n){var d=a[n];if(d.length>0){var f=gs.translate(c,h,d[0],s,-this.origin[0],-this.origin[1]);if(f.length){var p,g=[];for(r=1,o=d.length;r<o;++r)d[r]!==d[r-1]&&(p=gs.translate(c,d[r-1],d[r],s,-this.origin[0],-this.origin[1]),g.push(p));this.lineStringReplay.drawPolygonCoordinates(f,g,s),this.drawCoordinates_(f,g,s)}}h=d[d.length-1]}this.indices.length>l&&(this.startIndices.push(l),this.startIndicesFeature.push(e),this.state_.changed&&(this.styleIndices_.push(l),this.state_.changed=!1)),this.lineStringReplay.getCurrentIndex()>u&&this.lineStringReplay.setPolygonStyle(e,u)},Fu.prototype.drawPolygon=function(t,e){var n=t.getEnds(),i=t.getStride();if(n.length>0){var r=t.getFlatCoordinates().map(Number),o=gs.translate(r,0,n[0],i,-this.origin[0],-this.origin[1]);if(o.length){var a,s,l,u=[];for(a=1,s=n.length;a<s;++a)n[a]!==n[a-1]&&(l=gs.translate(r,n[a-1],n[a],i,-this.origin[0],-this.origin[1]),u.push(l));this.startIndices.push(this.indices.length),this.startIndicesFeature.push(e),this.state_.changed&&(this.styleIndices_.push(this.indices.length),this.state_.changed=!1),this.lineStringReplay.setPolygonStyle(e),this.lineStringReplay.drawPolygonCoordinates(o,u,i),this.drawCoordinates_(o,u,i)}}},Fu.prototype.finish=function(t){this.verticesBuffer=new yu(this.vertices),this.indicesBuffer=new yu(this.indices),this.startIndices.push(this.indices.length),this.lineStringReplay.finish(t),0===this.styleIndices_.length&&this.styles_.length>0&&(this.styles_=[]),this.vertices=null,this.indices=null},Fu.prototype.getDeleteResourcesFunction=function(t){var e=this.verticesBuffer,n=this.indicesBuffer,i=this.lineStringReplay.getDeleteResourcesFunction(t);return function(){t.deleteBuffer(e),t.deleteBuffer(n),i()}},Fu.prototype.setUpProgram=function(t,e,n,i){var r,o;r=Iu.fragment,o=Iu.vertex;var a,s=e.getProgram(r,o);return this.defaultLocations_?a=this.defaultLocations_:(a=new Pu(t,s),this.defaultLocations_=a),e.useProgram(s),t.enableVertexAttribArray(a.a_position),t.vertexAttribPointer(a.a_position,2,Oa.FLOAT,!1,8,0),a},Fu.prototype.shutDownProgram=function(t,e){t.disableVertexAttribArray(e.a_position)},Fu.prototype.drawReplay=function(t,e,n,i){var r=t.getParameter(t.DEPTH_FUNC),o=t.getParameter(t.DEPTH_WRITEMASK);if(i||(t.enable(t.DEPTH_TEST),t.depthMask(!0),t.depthFunc(t.NOTEQUAL)),Ea.isEmpty(n)){var a,s,l,u;for(l=this.startIndices[this.startIndices.length-1],a=this.styleIndices_.length-1;a>=0;--a)s=this.styleIndices_[a],u=this.styles_[a],this.setFillStyle_(t,u),this.drawElements(t,e,s,l),l=s}else this.drawReplaySkipping_(t,e,n);i||(t.disable(t.DEPTH_TEST),t.clear(t.DEPTH_BUFFER_BIT),t.depthMask(o),t.depthFunc(r))},Fu.prototype.drawHitDetectionReplayOneByOne=function(t,e,n,i,r){var o,a,s,l,u,c,h,d;for(d=this.startIndices.length-2,s=this.startIndices[d+1],o=this.styleIndices_.length-1;o>=0;--o)for(l=this.styles_[o],this.setFillStyle_(t,l),u=this.styleIndices_[o];d>=0&&this.startIndices[d]>=u;){if(a=this.startIndices[d],c=this.startIndicesFeature[d],h=ya.getUid(c).toString(),void 0===n[h]&&c.getGeometry()&&(void 0===r||hs.intersects(r,c.getGeometry().getExtent()))){t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),this.drawElements(t,e,a,s);var f=i(c);if(f)return f}d--,s=a}},Fu.prototype.drawReplaySkipping_=function(t,e,n){var i,r,o,a,s,l,u,c;for(u=this.startIndices.length-2,o=r=this.startIndices[u+1],i=this.styleIndices_.length-1;i>=0;--i){for(a=this.styles_[i],this.setFillStyle_(t,a),s=this.styleIndices_[i];u>=0&&this.startIndices[u]>=s;)c=this.startIndices[u],l=this.startIndicesFeature[u],n[ya.getUid(l).toString()]&&(r!==o&&(this.drawElements(t,e,r,o),t.clear(t.DEPTH_BUFFER_BIT)),o=c),u--,r=c;r!==o&&(this.drawElements(t,e,r,o),t.clear(t.DEPTH_BUFFER_BIT)),r=o=s}},Fu.prototype.setFillStyle_=function(t,e){t.uniform4fv(this.defaultLocations_.u_color,e)},Fu.prototype.setFillStrokeStyle=function(t,e){var n=t?t.getColor():[0,0,0,0];if(n=n instanceof CanvasGradient||n instanceof CanvasPattern?vu.defaultFillStyle:Ll.asArray(n).map(function(t,e){return 3!=e?t/255:t})||vu.defaultFillStyle,this.state_.fillColor&&Ha.equals(n,this.state_.fillColor)||(this.state_.fillColor=n,this.state_.changed=!0,this.styles_.push(n)),e)this.lineStringReplay.setFillStrokeStyle(null,e);else{var i=new Mu({color:[0,0,0,0],lineWidth:0});this.lineStringReplay.setFillStrokeStyle(null,i)}};var ku=function(t,e){this.space_=e,this.emptyBlocks_=[{x:0,y:0,width:t,height:t}],this.entries_={},this.context_=Xs.createCanvasContext2D(t,t),this.canvas_=this.context_.canvas};ku.prototype.get=function(t){return this.entries_[t]||null},ku.prototype.add=function(t,e,n,i,r){var o,a,s;for(a=0,s=this.emptyBlocks_.length;a<s;++a)if((o=this.emptyBlocks_[a]).width>=e+this.space_&&o.height>=n+this.space_){var l={offsetX:o.x+this.space_,offsetY:o.y+this.space_,image:this.canvas_};return this.entries_[t]=l,i.call(r,this.context_,o.x+this.space_,o.y+this.space_),this.split_(a,o,e+this.space_,n+this.space_),l}return null},ku.prototype.split_=function(t,e,n,i){var r,o;e.width-n>e.height-i?(r={x:e.x+n,y:e.y,width:e.width-n,height:e.height},o={x:e.x,y:e.y+i,width:n,height:e.height-i},this.updateBlocks_(t,r,o)):(r={x:e.x+n,y:e.y,width:e.width-n,height:i},o={x:e.x,y:e.y+i,width:e.width,height:e.height-i},this.updateBlocks_(t,r,o))},ku.prototype.updateBlocks_=function(t,e,n){var i=[t,1];e.width>0&&e.height>0&&i.push(e),n.width>0&&n.height>0&&i.push(n),this.emptyBlocks_.splice.apply(this.emptyBlocks_,i)};var Nu=function(t){var e=t||{};this.currentSize_=void 0!==e.initialSize?e.initialSize:ya.INITIAL_ATLAS_SIZE,this.maxSize_=void 0!==e.maxSize?e.maxSize:-1!=ya.MAX_ATLAS_SIZE?ya.MAX_ATLAS_SIZE:void 0!==ya.WEBGL_MAX_TEXTURE_SIZE?ya.WEBGL_MAX_TEXTURE_SIZE:2048,this.space_=void 0!==e.space?e.space:1,this.atlases_=[new ku(this.currentSize_,this.space_)],this.currentHitSize_=this.currentSize_,this.hitAtlases_=[new ku(this.currentHitSize_,this.space_)]};Nu.prototype.getInfo=function(t){var e=this.getInfo_(this.atlases_,t);if(!e)return null;var n=this.getInfo_(this.hitAtlases_,t);return this.mergeInfos_(e,n)},Nu.prototype.getInfo_=function(t,e){var n,i,r,o;for(r=0,o=t.length;r<o;++r)if(n=t[r],i=n.get(e))return i;return null},Nu.prototype.mergeInfos_=function(t,e){return{offsetX:t.offsetX,offsetY:t.offsetY,image:t.image,hitImage:e.image}},Nu.prototype.add=function(t,e,n,i,r,o){if(e+this.space_>this.maxSize_||n+this.space_>this.maxSize_)return null;var a=this.add_(!1,t,e,n,i,o);if(!a)return null;var s=void 0!==r?r:ya.nullFunction,l=this.add_(!0,t,e,n,s,o);return this.mergeInfos_(a,l)},Nu.prototype.add_=function(t,e,n,i,r,o){var a,s,l,u,c=t?this.hitAtlases_:this.atlases_;for(l=0,u=c.length;l<u;++l){if(a=c[l],s=a.add(e,n,i,r,o))return s;if(!s&&l===u-1){var h;t?(h=Math.min(2*this.currentHitSize_,this.maxSize_),this.currentHitSize_=h):(h=Math.min(2*this.currentSize_,this.maxSize_),this.currentSize_=h),a=new ku(h,this.space_),c.push(a),++u}}return null};var Gu=function(t,e){wu.call(this,t,e),this.images_=[],this.textures_=[],this.measureCanvas_=Xs.createCanvasContext2D(0,0).canvas,this.state_={strokeColor:null,lineCap:void 0,lineDash:null,lineDashOffset:void 0,lineJoin:void 0,lineWidth:0,miterLimit:void 0,fillColor:null,font:void 0,scale:void 0},this.text_="",this.textAlign_=void 0,this.textBaseline_=void 0,this.offsetX_=void 0,this.offsetY_=void 0,this.atlases_={},this.currAtlas_=void 0,this.scale=1,this.opacity=1};ya.inherits(Gu,wu),Gu.prototype.drawText=function(t,e){if(this.text_){var n=null,i=2,r=2;switch(t.getType()){case ds.POINT:case ds.MULTI_POINT:i=(n=t.getFlatCoordinates()).length,r=t.getStride();break;case ds.CIRCLE:n=t.getCenter();break;case ds.LINE_STRING:n=t.getFlatMidpoint();break;case ds.MULTI_LINE_STRING:i=(n=t.getFlatMidpoints()).length;break;case ds.POLYGON:n=t.getFlatInteriorPoint();break;case ds.MULTI_POLYGON:i=(n=t.getFlatInteriorPoints()).length}this.startIndices.push(this.indices.length),this.startIndicesFeature.push(e);var o,a,s,l,u,c,h,d,f=this.currAtlas_,p=this.text_.split("\n"),g=this.getTextSize_(p),_=Math.round(g[0]*this.textAlign_-this.offsetX_),v=Math.round(g[1]*this.textBaseline_-this.offsetY_),y=this.state_.lineWidth/2*this.state_.scale;for(o=0,a=p.length;o<a;++o)for(u=0,c=f.height*o,s=0,l=(h=p[o].split("")).length;s<l;++s){if(d=f.atlas.getInfo(h[s])){var m=d.image;this.anchorX=_-u,this.anchorY=v-c,this.originX=0===s?d.offsetX-y:d.offsetX,this.originY=d.offsetY,this.height=f.height,this.width=0===s||s===h.length-1?f.width[h[s]]+y:f.width[h[s]],this.imageHeight=m.height,this.imageWidth=m.width;var x;0===this.images_.length?this.images_.push(m):(x=this.images_[this.images_.length-1],ya.getUid(x)!=ya.getUid(m)&&(this.groupIndices.push(this.indices.length),this.images_.push(m))),this.drawText_(n,0,i,r)}u+=this.width}}},Gu.prototype.getTextSize_=function(t){var e=this,n=this.currAtlas_,i=t.length*n.height;return[t.map(function(t){var i,r,o=0;for(i=0,r=t.length;i<r;++i){var a=t[i];n.width[a]||e.addCharToAtlas_(a),o+=n.width[a]?n.width[a]:0}return o}).reduce(function(t,e){return Math.max(t,e)}),i]},Gu.prototype.drawText_=function(t,e,n,i){var r,o;for(r=e,o=n;r<o;r+=i)this.drawCoordinates(t,e,n,i)},Gu.prototype.addCharToAtlas_=function(t){if(1===t.length){var e=this.currAtlas_,n=this.state_,i=this.measureCanvas_.getContext("2d");i.font=n.font;var r=Math.ceil(i.measureText(t).width*n.scale);e.atlas.add(t,r,e.height,function(e,i,r){e.font=n.font,e.fillStyle=n.fillColor,e.strokeStyle=n.strokeColor,e.lineWidth=n.lineWidth,e.lineCap=n.lineCap,e.lineJoin=n.lineJoin,e.miterLimit=n.miterLimit,e.textAlign="left",e.textBaseline="top",Da.CANVAS_LINE_DASH&&n.lineDash&&(e.setLineDash(n.lineDash),e.lineDashOffset=n.lineDashOffset),1!==n.scale&&e.setTransform(n.scale,0,0,n.scale,0,0),n.strokeColor&&e.strokeText(t,i,r),n.fillColor&&e.fillText(t,i,r)})&&(e.width[t]=r)}},Gu.prototype.finish=function(t){var e=t.getGL();this.groupIndices.push(this.indices.length),this.hitDetectionGroupIndices=this.groupIndices,this.verticesBuffer=new yu(this.vertices),this.indicesBuffer=new yu(this.indices);this.createTextures(this.textures_,this.images_,{},e),this.state_={strokeColor:null,lineCap:void 0,lineDash:null,lineDashOffset:void 0,lineJoin:void 0,lineWidth:0,miterLimit:void 0,fillColor:null,font:void 0,scale:void 0},this.text_="",this.textAlign_=void 0,this.textBaseline_=void 0,this.offsetX_=void 0,this.offsetY_=void 0,this.images_=null,this.atlases_={},this.currAtlas_=void 0,wu.prototype.finish.call(this,t)},Gu.prototype.setTextStyle=function(t){var e=this.state_,n=t.getFill(),i=t.getStroke();if(t&&t.getText()&&(n||i)){if(n){var r=n.getColor();e.fillColor=Il.asColorLike(r||vu.defaultFillStyle)}else e.fillColor=null;if(i){var o=i.getColor();e.strokeColor=Il.asColorLike(o||vu.defaultStrokeStyle),e.lineWidth=i.getWidth()||vu.defaultLineWidth,e.lineCap=i.getLineCap()||vu.defaultLineCap,e.lineDashOffset=i.getLineDashOffset()||vu.defaultLineDashOffset,e.lineJoin=i.getLineJoin()||vu.defaultLineJoin,e.miterLimit=i.getMiterLimit()||vu.defaultMiterLimit;var a=i.getLineDash();e.lineDash=a?a.slice():vu.defaultLineDash}else e.strokeColor=null,e.lineWidth=0;e.font=t.getFont()||vu.defaultFont,e.scale=t.getScale()||1,this.text_=t.getText();var s=nu.TEXT_ALIGN[t.getTextAlign()],l=nu.TEXT_ALIGN[t.getTextBaseline()];this.textAlign_=void 0===s?vu.defaultTextAlign:s,this.textBaseline_=void 0===l?vu.defaultTextBaseline:l,this.offsetX_=t.getOffsetX()||0,this.offsetY_=t.getOffsetY()||0,this.rotateWithView=!!t.getRotateWithView(),this.rotation=t.getRotation()||0,this.currAtlas_=this.getAtlas_(e)}else this.text_=""},Gu.prototype.getAtlas_=function(t){var e,n=[];for(e in t)(t[e]||0===t[e])&&(Array.isArray(t[e])?n=n.concat(t[e]):n.push(t[e]));var i=this.calculateHash_(n);if(!this.atlases_[i]){var r=this.measureCanvas_.getContext("2d");r.font=t.font;var o=Math.ceil((1.5*r.measureText("M").width+t.lineWidth/2)*t.scale);this.atlases_[i]={atlas:new Nu({space:t.lineWidth+1}),width:{},height:o}}return this.atlases_[i]},Gu.prototype.calculateHash_=function(t){var e,n,i="";for(e=0,n=t.length;e<n;++e)i+=t[e];return i},Gu.prototype.getTextures=function(t){return this.textures_},Gu.prototype.getHitDetectionTextures=function(){return this.textures_};var Vu=function(t,e,n){Yl.call(this),this.maxExtent_=e,this.tolerance_=t,this.renderBuffer_=n,this.replaysByZIndex_={}};ya.inherits(Vu,Yl),Vu.prototype.addDeclutter=function(t,e){},Vu.prototype.getDeleteResourcesFunction=function(t){var e,n=[];for(e in this.replaysByZIndex_){var i,r=this.replaysByZIndex_[e];for(i in r)n.push(r[i].getDeleteResourcesFunction(t))}return function(){for(var t,e=n.length,i=0;i<e;i++)t=n[i].apply(this,arguments);return t}},Vu.prototype.finish=function(t){var e;for(e in this.replaysByZIndex_){var n,i=this.replaysByZIndex_[e];for(n in i)i[n].finish(t)}},Vu.prototype.getReplay=function(t,e){var n=void 0!==t?t.toString():"0",i=this.replaysByZIndex_[n];void 0===i&&(i={},this.replaysByZIndex_[n]=i);var r=i[e];return void 0===r&&(r=new(0,Vu.BATCH_CONSTRUCTORS_[e])(this.tolerance_,this.maxExtent_),i[e]=r),r},Vu.prototype.isEmpty=function(){return Ea.isEmpty(this.replaysByZIndex_)},Vu.prototype.replay=function(t,e,n,i,r,o,a,s){var l=Object.keys(this.replaysByZIndex_).map(Number);l.sort(Ha.numberSafeCompareFunction);var u,c,h,d,f,p;for(u=0,c=l.length;u<c;++u)for(f=this.replaysByZIndex_[l[u].toString()],h=0,d=nu.ORDER.length;h<d;++h)void 0!==(p=f[nu.ORDER[h]])&&p.replay(t,e,n,i,r,o,a,s,void 0,!1)},Vu.prototype.replayHitDetection_=function(t,e,n,i,r,o,a,s,l,u,c){var h=Object.keys(this.replaysByZIndex_).map(Number);h.sort(function(t,e){return e-t});var d,f,p,g,_,v;for(d=0,f=h.length;d<f;++d)for(g=this.replaysByZIndex_[h[d].toString()],p=nu.ORDER.length-1;p>=0;--p)if(void 0!==(_=g[nu.ORDER[p]])&&(v=_.replay(t,e,n,i,r,o,a,s,l,u,c)))return v},Vu.prototype.forEachFeatureAtCoordinate=function(t,e,n,i,r,o,a,s,l,u){var c=e.getGL();c.bindFramebuffer(c.FRAMEBUFFER,e.getHitDetectionFramebuffer());var h;return void 0!==this.renderBuffer_&&(h=hs.buffer(hs.createOrUpdateFromCoordinate(t),i*this.renderBuffer_)),this.replayHitDetection_(e,t,i,r,Vu.HIT_DETECTION_SIZE_,a,s,l,function(t){var e=new Uint8Array(4);if(c.readPixels(0,0,1,1,c.RGBA,c.UNSIGNED_BYTE,e),e[3]>0){var n=u(t);if(n)return n}},!0,h)},Vu.prototype.hasFeatureAtCoordinate=function(t,e,n,i,r,o,a,s,l){var u=e.getGL();return u.bindFramebuffer(u.FRAMEBUFFER,e.getHitDetectionFramebuffer()),void 0!==this.replayHitDetection_(e,t,i,r,Vu.HIT_DETECTION_SIZE_,a,s,l,function(t){var e=new Uint8Array(4);return u.readPixels(0,0,1,1,u.RGBA,u.UNSIGNED_BYTE,e),e[3]>0},!1)},Vu.HIT_DETECTION_SIZE_=[1,1],Vu.BATCH_CONSTRUCTORS_={Circle:mu,Image:Cu,LineString:Lu,Polygon:Fu,Text:Gu};var Uu=function(t,e,n,i,r,o,a){Pl.call(this),this.context_=t,this.center_=e,this.extent_=o,this.pixelRatio_=a,this.size_=r,this.rotation_=i,this.resolution_=n,this.imageStyle_=null,this.fillStyle_=null,this.strokeStyle_=null,this.textStyle_=null};ya.inherits(Uu,Pl),Uu.prototype.drawText_=function(t,e){var n=this.context_,i=t.getReplay(0,jl.TEXT);i.setTextStyle(this.textStyle_),i.drawText(e,null),i.finish(n);i.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,1,{},void 0,!1),i.getDeleteResourcesFunction(n)()},Uu.prototype.setStyle=function(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())},Uu.prototype.drawGeometry=function(t){switch(t.getType()){case ds.POINT:this.drawPoint(t,null);break;case ds.LINE_STRING:this.drawLineString(t,null);break;case ds.POLYGON:this.drawPolygon(t,null);break;case ds.MULTI_POINT:this.drawMultiPoint(t,null);break;case ds.MULTI_LINE_STRING:this.drawMultiLineString(t,null);break;case ds.MULTI_POLYGON:this.drawMultiPolygon(t,null);break;case ds.GEOMETRY_COLLECTION:this.drawGeometryCollection(t,null);break;case ds.CIRCLE:this.drawCircle(t,null)}},Uu.prototype.drawFeature=function(t,e){var n=e.getGeometryFunction()(t);n&&hs.intersects(this.extent_,n.getExtent())&&(this.setStyle(e),this.drawGeometry(n))},Uu.prototype.drawGeometryCollection=function(t,e){var n,i,r=t.getGeometriesArray();for(n=0,i=r.length;n<i;++n)this.drawGeometry(r[n])},Uu.prototype.drawPoint=function(t,e){var n=this.context_,i=new Vu(1,this.extent_),r=i.getReplay(0,jl.IMAGE);r.setImageStyle(this.imageStyle_),r.drawPoint(t,e),r.finish(n);r.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,1,{},void 0,!1),r.getDeleteResourcesFunction(n)(),this.textStyle_&&this.drawText_(i,t)},Uu.prototype.drawMultiPoint=function(t,e){var n=this.context_,i=new Vu(1,this.extent_),r=i.getReplay(0,jl.IMAGE);r.setImageStyle(this.imageStyle_),r.drawMultiPoint(t,e),r.finish(n);r.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,1,{},void 0,!1),r.getDeleteResourcesFunction(n)(),this.textStyle_&&this.drawText_(i,t)},Uu.prototype.drawLineString=function(t,e){var n=this.context_,i=new Vu(1,this.extent_),r=i.getReplay(0,jl.LINE_STRING);r.setFillStrokeStyle(null,this.strokeStyle_),r.drawLineString(t,e),r.finish(n);r.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,1,{},void 0,!1),r.getDeleteResourcesFunction(n)(),this.textStyle_&&this.drawText_(i,t)},Uu.prototype.drawMultiLineString=function(t,e){var n=this.context_,i=new Vu(1,this.extent_),r=i.getReplay(0,jl.LINE_STRING);r.setFillStrokeStyle(null,this.strokeStyle_),r.drawMultiLineString(t,e),r.finish(n);r.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,1,{},void 0,!1),r.getDeleteResourcesFunction(n)(),this.textStyle_&&this.drawText_(i,t)},Uu.prototype.drawPolygon=function(t,e){var n=this.context_,i=new Vu(1,this.extent_),r=i.getReplay(0,jl.POLYGON);r.setFillStrokeStyle(this.fillStyle_,this.strokeStyle_),r.drawPolygon(t,e),r.finish(n);r.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,1,{},void 0,!1),r.getDeleteResourcesFunction(n)(),this.textStyle_&&this.drawText_(i,t)},Uu.prototype.drawMultiPolygon=function(t,e){var n=this.context_,i=new Vu(1,this.extent_),r=i.getReplay(0,jl.POLYGON);r.setFillStrokeStyle(this.fillStyle_,this.strokeStyle_),r.drawMultiPolygon(t,e),r.finish(n);r.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,1,{},void 0,!1),r.getDeleteResourcesFunction(n)(),this.textStyle_&&this.drawText_(i,t)},Uu.prototype.drawCircle=function(t,e){var n=this.context_,i=new Vu(1,this.extent_),r=i.getReplay(0,jl.CIRCLE);r.setFillStrokeStyle(this.fillStyle_,this.strokeStyle_),r.drawCircle(t,e),r.finish(n);r.replay(this.context_,this.center_,this.resolution_,this.rotation_,this.size_,this.pixelRatio_,1,{},void 0,!1),r.getDeleteResourcesFunction(n)(),this.textStyle_&&this.drawText_(i,t)},Uu.prototype.setImageStyle=function(t){this.imageStyle_=t},Uu.prototype.setFillStrokeStyle=function(t,e){this.fillStyle_=t,this.strokeStyle_=e},Uu.prototype.setTextStyle=function(t){this.textStyle_=t};var Bu={};Bu.fragment=new hu(ya.DEBUG_WEBGL?"precision mediump float;\nvarying vec2 v_texCoord;\n\n\nuniform float u_opacity;\nuniform sampler2D u_texture;\n\nvoid main(void) {\n  vec4 texColor = texture2D(u_texture, v_texCoord);\n  gl_FragColor.rgb = texColor.rgb;\n  gl_FragColor.a = texColor.a * u_opacity;\n}\n":"precision mediump float;varying vec2 a;uniform float f;uniform sampler2D g;void main(void){vec4 texColor=texture2D(g,a);gl_FragColor.rgb=texColor.rgb;gl_FragColor.a=texColor.a*f;}"),Bu.vertex=new du(ya.DEBUG_WEBGL?"varying vec2 v_texCoord;\n\n\nattribute vec2 a_position;\nattribute vec2 a_texCoord;\n\nuniform mat4 u_texCoordMatrix;\nuniform mat4 u_projectionMatrix;\n\nvoid main(void) {\n  gl_Position = u_projectionMatrix * vec4(a_position, 0., 1.);\n  v_texCoord = (u_texCoordMatrix * vec4(a_texCoord, 0., 1.)).st;\n}\n\n\n":"varying vec2 a;attribute vec2 b;attribute vec2 c;uniform mat4 d;uniform mat4 e;void main(void){gl_Position=e*vec4(b,0.,1.);a=(d*vec4(c,0.,1.)).st;}");var zu=function(t,e){this.u_texCoordMatrix=t.getUniformLocation(e,ya.DEBUG_WEBGL?"u_texCoordMatrix":"d"),this.u_projectionMatrix=t.getUniformLocation(e,ya.DEBUG_WEBGL?"u_projectionMatrix":"e"),this.u_opacity=t.getUniformLocation(e,ya.DEBUG_WEBGL?"u_opacity":"f"),this.u_texture=t.getUniformLocation(e,ya.DEBUG_WEBGL?"u_texture":"g"),this.a_position=t.getAttribLocation(e,ya.DEBUG_WEBGL?"a_position":"b"),this.a_texCoord=t.getAttribLocation(e,ya.DEBUG_WEBGL?"a_texCoord":"c")},Xu=function(t,e){Dl.call(this,e),this.mapRenderer=t,this.arrayBuffer_=new yu([-1,-1,0,0,1,-1,1,0,-1,1,0,1,1,1,1,1]),this.texture=null,this.framebuffer=null,this.framebufferDimension=void 0,this.texCoordMatrix=Cs.create(),this.projectionMatrix=Cs.create(),this.tmpMat4_=gu.create(),this.defaultLocations_=null};ya.inherits(Xu,Dl),Xu.prototype.bindFramebuffer=function(t,e){var n=this.mapRenderer.getGL();if(void 0===this.framebufferDimension||this.framebufferDimension!=e){var i=function(t,e,n){t.isContextLost()||(t.deleteFramebuffer(e),t.deleteTexture(n))}.bind(null,n,this.framebuffer,this.texture);t.postRenderFunctions.push(i);var r=Tu.createEmptyTexture(n,e,e),o=n.createFramebuffer();n.bindFramebuffer(Oa.FRAMEBUFFER,o),n.framebufferTexture2D(Oa.FRAMEBUFFER,Oa.COLOR_ATTACHMENT0,Oa.TEXTURE_2D,r,0),this.texture=r,this.framebuffer=o,this.framebufferDimension=e}else n.bindFramebuffer(Oa.FRAMEBUFFER,this.framebuffer)},Xu.prototype.composeFrame=function(t,e,n){this.dispatchComposeEvent_(el.PRECOMPOSE,n,t),n.bindBuffer(Oa.ARRAY_BUFFER,this.arrayBuffer_);var i,r=n.getGL(),o=Bu.fragment,a=Bu.vertex,s=n.getProgram(o,a);this.defaultLocations_?i=this.defaultLocations_:(i=new zu(r,s),this.defaultLocations_=i),n.useProgram(s)&&(r.enableVertexAttribArray(i.a_position),r.vertexAttribPointer(i.a_position,2,Oa.FLOAT,!1,16,0),r.enableVertexAttribArray(i.a_texCoord),r.vertexAttribPointer(i.a_texCoord,2,Oa.FLOAT,!1,16,8),r.uniform1i(i.u_texture,0)),r.uniformMatrix4fv(i.u_texCoordMatrix,!1,gu.fromTransform(this.tmpMat4_,this.getTexCoordMatrix())),r.uniformMatrix4fv(i.u_projectionMatrix,!1,gu.fromTransform(this.tmpMat4_,this.getProjectionMatrix())),r.uniform1f(i.u_opacity,e.opacity),r.bindTexture(Oa.TEXTURE_2D,this.getTexture()),r.drawArrays(Oa.TRIANGLE_STRIP,0,4),this.dispatchComposeEvent_(el.POSTCOMPOSE,n,t)},Xu.prototype.dispatchComposeEvent_=function(t,e,n){var i=this.getLayer();if(i.hasListener(t)){var r=n.viewState,o=r.resolution,a=n.pixelRatio,s=n.extent,l=r.center,u=r.rotation,c=n.size,h=new Uu(e,l,o,u,c,s,a),d=new bl(t,h,n,null,e);i.dispatchEvent(d)}},Xu.prototype.getTexCoordMatrix=function(){return this.texCoordMatrix},Xu.prototype.getTexture=function(){return this.texture},Xu.prototype.getProjectionMatrix=function(){return this.projectionMatrix},Xu.prototype.handleWebGLContextLost=function(){this.texture=null,this.framebuffer=null,this.framebufferDimension=void 0},Xu.prototype.prepareFrame=function(t,e,n){},Xu.prototype.forEachLayerAtPixel=function(t,e,n,i){};var Hu=function(t,e,n,i){ba.call(this),this.extent=t,this.pixelRatio_=n,this.resolution=e,this.state=i};ya.inherits(Hu,ba),Hu.prototype.changed=function(){this.dispatchEvent(Aa.CHANGE)},Hu.prototype.getExtent=function(){return this.extent},Hu.prototype.getImage=function(){},Hu.prototype.getPixelRatio=function(){return this.pixelRatio_},Hu.prototype.getResolution=function(){return this.resolution},Hu.prototype.getState=function(){return this.state},Hu.prototype.load=function(){};var Wu=function(t,e,n,i,r){this.loader_=void 0!==r?r:null,Hu.call(this,t,e,n,void 0!==r?Ol.IDLE:Ol.LOADED),this.canvas_=i,this.error_=null};ya.inherits(Wu,Hu),Wu.prototype.getError=function(){return this.error_},Wu.prototype.handleLoad_=function(t){t?(this.error_=t,this.state=Ol.ERROR):this.state=Ol.LOADED,this.changed()},Wu.prototype.load=function(){this.state==Ol.IDLE&&(this.state=Ol.LOADING,this.changed(),this.loader_(this.handleLoad_.bind(this)))},Wu.prototype.getImage=function(){return this.canvas_};var Yu={};Yu.calculateSourceResolution=function(t,e,n,i){var r=ws.transform(n,e,t),o=ws.getPointResolution(e,i,n),a=e.getMetersPerUnit();void 0!==a&&(o*=a);var s=t.getMetersPerUnit();void 0!==s&&(o/=s);var l=t.getExtent();if(!l||hs.containsCoordinate(l,r)){var u=ws.getPointResolution(t,o,r)/o;isFinite(u)&&u>0&&(o/=u)}return o},Yu.enlargeClipPoint_=function(t,e,n,i){var r=n-t,o=i-e,a=Math.sqrt(r*r+o*o);return[Math.round(n+r/a),Math.round(i+o/a)]},Yu.render=function(t,e,n,i,r,o,a,s,l,u,c){var h=Xs.createCanvasContext2D(Math.round(n*t),Math.round(n*e));if(0===l.length)return h.canvas;h.scale(n,n);var d=hs.createEmpty();l.forEach(function(t,e,n){hs.extend(d,t.extent)});var f=hs.getWidth(d),p=hs.getHeight(d),g=Xs.createCanvasContext2D(Math.round(n*f/i),Math.round(n*p/i)),_=n/i;l.forEach(function(t,e,n){var i=t.extent[0]-d[0],r=-(t.extent[3]-d[3]),o=hs.getWidth(t.extent),a=hs.getHeight(t.extent);g.drawImage(t.image,u,u,t.image.width-2*u,t.image.height-2*u,i*_,r*_,o*_,a*_)});var v=hs.getTopLeft(a);return s.getTriangles().forEach(function(t,e,r){var a=t.source,s=t.target,l=a[0][0],u=a[0][1],c=a[1][0],f=a[1][1],p=a[2][0],_=a[2][1],y=(s[0][0]-v[0])/o,m=-(s[0][1]-v[1])/o,x=(s[1][0]-v[0])/o,S=-(s[1][1]-v[1])/o,E=(s[2][0]-v[0])/o,T=-(s[2][1]-v[1])/o,w=l,C=u;l=0,u=0;var b=[[c-=w,f-=C,0,0,x-y],[p-=w,_-=C,0,0,E-y],[0,0,c,f,S-m],[0,0,p,_,T-m]],A=ts.solveLinearSystem(b);if(A){h.save(),h.beginPath();var R=(y+x+E)/3,L=(m+S+T)/3,I=Yu.enlargeClipPoint_(R,L,y,m),P=Yu.enlargeClipPoint_(R,L,x,S),M=Yu.enlargeClipPoint_(R,L,E,T);h.moveTo(P[0],P[1]),h.lineTo(I[0],I[1]),h.lineTo(M[0],M[1]),h.clip(),h.transform(A[0],A[2],A[1],A[3],y,m),h.translate(d[0]-w,d[3]-C),h.scale(i/n,-i/n),h.drawImage(g.canvas,0,0),h.restore()}}),c&&(h.save(),h.strokeStyle="black",h.lineWidth=1,s.getTriangles().forEach(function(t,e,n){var i=t.target,r=(i[0][0]-v[0])/o,a=-(i[0][1]-v[1])/o,s=(i[1][0]-v[0])/o,l=-(i[1][1]-v[1])/o,u=(i[2][0]-v[0])/o,c=-(i[2][1]-v[1])/o;h.beginPath(),h.moveTo(s,l),h.lineTo(r,a),h.lineTo(u,c),h.closePath(),h.stroke()}),h.restore()),h.canvas};var ju=function(t,e,n,i,r){this.sourceProj_=t,this.targetProj_=e;var o={},a=ws.getTransform(this.targetProj_,this.sourceProj_);this.transformInv_=function(t){var e=t[0]+"/"+t[1];return o[e]||(o[e]=a(t)),o[e]},this.maxSourceExtent_=i,this.errorThresholdSquared_=r*r,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!i&&!!this.sourceProj_.getExtent()&&hs.getWidth(i)==hs.getWidth(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?hs.getWidth(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?hs.getWidth(this.targetProj_.getExtent()):null;var s=hs.getTopLeft(n),l=hs.getTopRight(n),u=hs.getBottomRight(n),c=hs.getBottomLeft(n),h=this.transformInv_(s),d=this.transformInv_(l),f=this.transformInv_(u),p=this.transformInv_(c);if(this.addQuad_(s,l,u,c,h,d,f,p,ya.RASTER_REPROJECTION_MAX_SUBDIVISION),this.wrapsXInSource_){var g=1/0;this.triangles_.forEach(function(t,e,n){g=Math.min(g,t.source[0][0],t.source[1][0],t.source[2][0])}),this.triangles_.forEach(function(t){if(Math.max(t.source[0][0],t.source[1][0],t.source[2][0])-g>this.sourceWorldWidth_/2){var e=[[t.source[0][0],t.source[0][1]],[t.source[1][0],t.source[1][1]],[t.source[2][0],t.source[2][1]]];e[0][0]-g>this.sourceWorldWidth_/2&&(e[0][0]-=this.sourceWorldWidth_),e[1][0]-g>this.sourceWorldWidth_/2&&(e[1][0]-=this.sourceWorldWidth_),e[2][0]-g>this.sourceWorldWidth_/2&&(e[2][0]-=this.sourceWorldWidth_);var n=Math.min(e[0][0],e[1][0],e[2][0]);Math.max(e[0][0],e[1][0],e[2][0])-n<this.sourceWorldWidth_/2&&(t.source=e)}},this)}o={}};ju.prototype.addTriangle_=function(t,e,n,i,r,o){this.triangles_.push({source:[i,r,o],target:[t,e,n]})},ju.prototype.addQuad_=function(t,e,n,i,r,o,a,s,l){var u=hs.boundingExtent([r,o,a,s]),c=this.sourceWorldWidth_?hs.getWidth(u)/this.sourceWorldWidth_:null,h=this.sourceWorldWidth_,d=this.sourceProj_.canWrapX()&&c>.5&&c<1,f=!1;if(l>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){var p=hs.boundingExtent([t,e,n,i]);f|=hs.getWidth(p)/this.targetWorldWidth_>ya.RASTER_REPROJECTION_MAX_TRIANGLE_WIDTH}!d&&this.sourceProj_.isGlobal()&&c&&(f|=c>ya.RASTER_REPROJECTION_MAX_TRIANGLE_WIDTH)}if(f||!this.maxSourceExtent_||hs.intersects(u,this.maxSourceExtent_)){if(!(f||isFinite(r[0])&&isFinite(r[1])&&isFinite(o[0])&&isFinite(o[1])&&isFinite(a[0])&&isFinite(a[1])&&isFinite(s[0])&&isFinite(s[1]))){if(!(l>0))return;f=!0}if(l>0){if(!f){var g,_=[(t[0]+n[0])/2,(t[1]+n[1])/2],v=this.transformInv_(_);g=d?(ts.modulo(r[0],h)+ts.modulo(a[0],h))/2-ts.modulo(v[0],h):(r[0]+a[0])/2-v[0];var y=(r[1]+a[1])/2-v[1];f=g*g+y*y>this.errorThresholdSquared_}if(f){if(Math.abs(t[0]-n[0])<=Math.abs(t[1]-n[1])){var m=[(e[0]+n[0])/2,(e[1]+n[1])/2],x=this.transformInv_(m),S=[(i[0]+t[0])/2,(i[1]+t[1])/2],E=this.transformInv_(S);this.addQuad_(t,e,m,S,r,o,x,E,l-1),this.addQuad_(S,m,n,i,E,x,a,s,l-1)}else{var T=[(t[0]+e[0])/2,(t[1]+e[1])/2],w=this.transformInv_(T),C=[(n[0]+i[0])/2,(n[1]+i[1])/2],b=this.transformInv_(C);this.addQuad_(t,T,C,i,r,w,b,s,l-1),this.addQuad_(T,e,n,C,w,o,a,b,l-1)}return}}if(d){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}this.addTriangle_(t,n,i,r,a,s),this.addTriangle_(t,e,n,r,o,a)}},ju.prototype.calculateSourceExtent=function(){var t=hs.createEmpty();return this.triangles_.forEach(function(e,n,i){var r=e.source;hs.extendCoordinate(t,r[0]),hs.extendCoordinate(t,r[1]),hs.extendCoordinate(t,r[2])}),t},ju.prototype.getTriangles=function(){return this.triangles_};var Ku=function(t,e,n,i,r,o){this.targetProj_=e,this.maxSourceExtent_=t.getExtent();var a=e.getExtent(),s=a?hs.getIntersection(n,a):n,l=hs.getCenter(s),u=Yu.calculateSourceResolution(t,e,l,i),c=ya.DEFAULT_RASTER_REPROJECTION_ERROR_THRESHOLD;this.triangulation_=new ju(t,e,s,this.maxSourceExtent_,u*c),this.targetResolution_=i,this.targetExtent_=n;var h=this.triangulation_.calculateSourceExtent();this.sourceImage_=o(h,u,r),this.sourcePixelRatio_=this.sourceImage_?this.sourceImage_.getPixelRatio():1,this.canvas_=null,this.sourceListenerKey_=null;var d=Ol.LOADED;this.sourceImage_&&(d=Ol.IDLE),Hu.call(this,n,i,this.sourcePixelRatio_,d)};ya.inherits(Ku,Hu),Ku.prototype.disposeInternal=function(){this.state==Ol.LOADING&&this.unlistenSource_(),Hu.prototype.disposeInternal.call(this)},Ku.prototype.getImage=function(){return this.canvas_},Ku.prototype.getProjection=function(){return this.targetProj_},Ku.prototype.reproject_=function(){var t=this.sourceImage_.getState();if(t==Ol.LOADED){var e=hs.getWidth(this.targetExtent_)/this.targetResolution_,n=hs.getHeight(this.targetExtent_)/this.targetResolution_;this.canvas_=Yu.render(e,n,this.sourcePixelRatio_,this.sourceImage_.getResolution(),this.maxSourceExtent_,this.targetResolution_,this.targetExtent_,this.triangulation_,[{extent:this.sourceImage_.getExtent(),image:this.sourceImage_.getImage()}],0)}this.state=t,this.changed()},Ku.prototype.load=function(){if(this.state==Ol.IDLE){this.state=Ol.LOADING,this.changed();var t=this.sourceImage_.getState();t==Ol.LOADED||t==Ol.ERROR?this.reproject_():(this.sourceListenerKey_=Ta.listen(this.sourceImage_,Aa.CHANGE,function(t){var e=this.sourceImage_.getState();e!=Ol.LOADED&&e!=Ol.ERROR||(this.unlistenSource_(),this.reproject_())},this),this.sourceImage_.load())}},Ku.prototype.unlistenSource_=function(){Ta.unlistenByKey(this.sourceListenerKey_),this.sourceListenerKey_=null};var qu={};qu.createOrUpdate=function(t,e,n,i){return void 0!==i?(i[0]=t,i[1]=e,i[2]=n,i):[t,e,n]},qu.getKeyZXY=function(t,e,n){return t+"/"+e+"/"+n},qu.getKey=function(t){return qu.getKeyZXY(t[0],t[1],t[2])},qu.fromKey=function(t){return t.split("/").map(Number)},qu.hash=function(t){return(t[1]<<t[0])+t[2]},qu.quadKey=function(t){var e,n,i=t[0],r=new Array(i),o=1<<i-1;for(e=0;e<i;++e)n=48,t[1]&o&&(n+=1),t[2]&o&&(n+=2),r[e]=String.fromCharCode(n),o>>=1;return r.join("")},qu.withinExtentAndZ=function(t,e){var n=t[0],i=t[1],r=t[2];if(e.getMinZoom()>n||n>e.getMaxZoom())return!1;var o,a=e.getExtent();return!(o=a?e.getTileRangeForExtentAndZ(a,n):e.getFullTileRange(n))||o.containsXY(i,r)};var Zu=function(t){this.minZoom=void 0!==t.minZoom?t.minZoom:0,this.resolutions_=t.resolutions,Qa.assert(Ha.isSorted(this.resolutions_,function(t,e){return e-t},!0),17);var e;if(!t.origins)for(var n=0,i=this.resolutions_.length-1;n<i;++n)if(e){if(this.resolutions_[n]/this.resolutions_[n+1]!==e){e=void 0;break}}else e=this.resolutions_[n]/this.resolutions_[n+1];this.zoomFactor_=e,this.maxZoom=this.resolutions_.length-1,this.origin_=void 0!==t.origin?t.origin:null,this.origins_=null,void 0!==t.origins&&(this.origins_=t.origins,Qa.assert(this.origins_.length==this.resolutions_.length,20));var r=t.extent;void 0===r||this.origin_||this.origins_||(this.origin_=hs.getTopLeft(r)),Qa.assert(!this.origin_&&this.origins_||this.origin_&&!this.origins_,18),this.tileSizes_=null,void 0!==t.tileSizes&&(this.tileSizes_=t.tileSizes,Qa.assert(this.tileSizes_.length==this.resolutions_.length,19)),this.tileSize_=void 0!==t.tileSize?t.tileSize:this.tileSizes_?null:ya.DEFAULT_TILE_SIZE,Qa.assert(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,22),this.extent_=void 0!==r?r:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],void 0!==t.sizes?this.fullTileRanges_=t.sizes.map(function(t,e){return new zl(Math.min(0,t[0]),Math.max(t[0]-1,-1),Math.min(0,t[1]),Math.max(t[1]-1,-1))},this):r&&this.calculateTileRanges_(r)};Zu.tmpTileCoord_=[0,0,0],Zu.prototype.forEachTileCoord=function(t,e,n){for(var i=this.getTileRangeForExtentAndZ(t,e),r=i.minX,o=i.maxX;r<=o;++r)for(var a=i.minY,s=i.maxY;a<=s;++a)n([e,r,a])},Zu.prototype.forEachTileCoordParentTileRange=function(t,e,n,i,r){var o,a,s,l=null,u=t[0]-1;for(2===this.zoomFactor_?(a=t[1],s=t[2]):l=this.getTileCoordExtent(t,r);u>=this.minZoom;){if(2===this.zoomFactor_?(a=Math.floor(a/2),s=Math.floor(s/2),o=zl.createOrUpdate(a,a,s,s,i)):o=this.getTileRangeForExtentAndZ(l,u,i),e.call(n,u,o))return!0;--u}return!1},Zu.prototype.getExtent=function(){return this.extent_},Zu.prototype.getMaxZoom=function(){return this.maxZoom},Zu.prototype.getMinZoom=function(){return this.minZoom},Zu.prototype.getOrigin=function(t){return this.origin_?this.origin_:this.origins_[t]},Zu.prototype.getResolution=function(t){return this.resolutions_[t]},Zu.prototype.getResolutions=function(){return this.resolutions_},Zu.prototype.getTileCoordChildTileRange=function(t,e,n){if(t[0]<this.maxZoom){if(2===this.zoomFactor_){var i=2*t[1],r=2*t[2];return zl.createOrUpdate(i,i+1,r,r+1,e)}var o=this.getTileCoordExtent(t,n);return this.getTileRangeForExtentAndZ(o,t[0]+1,e)}return null},Zu.prototype.getTileRangeExtent=function(t,e,n){var i=this.getOrigin(t),r=this.getResolution(t),o=Qs.toSize(this.getTileSize(t),this.tmpSize_),a=i[0]+e.minX*o[0]*r,s=i[0]+(e.maxX+1)*o[0]*r,l=i[1]+e.minY*o[1]*r,u=i[1]+(e.maxY+1)*o[1]*r;return hs.createOrUpdate(a,l,s,u,n)},Zu.prototype.getTileRangeForExtentAndZ=function(t,e,n){var i=Zu.tmpTileCoord_;this.getTileCoordForXYAndZ_(t[0],t[1],e,!1,i);var r=i[1],o=i[2];return this.getTileCoordForXYAndZ_(t[2],t[3],e,!0,i),zl.createOrUpdate(r,i[1],o,i[2],n)},Zu.prototype.getTileCoordCenter=function(t){var e=this.getOrigin(t[0]),n=this.getResolution(t[0]),i=Qs.toSize(this.getTileSize(t[0]),this.tmpSize_);return[e[0]+(t[1]+.5)*i[0]*n,e[1]+(t[2]+.5)*i[1]*n]},Zu.prototype.getTileCoordExtent=function(t,e){var n=this.getOrigin(t[0]),i=this.getResolution(t[0]),r=Qs.toSize(this.getTileSize(t[0]),this.tmpSize_),o=n[0]+t[1]*r[0]*i,a=n[1]+t[2]*r[1]*i,s=o+r[0]*i,l=a+r[1]*i;return hs.createOrUpdate(o,a,s,l,e)},Zu.prototype.getTileCoordForCoordAndResolution=function(t,e,n){return this.getTileCoordForXYAndResolution_(t[0],t[1],e,!1,n)},Zu.prototype.getTileCoordForXYAndResolution_=function(t,e,n,i,r){var o=this.getZForResolution(n),a=n/this.getResolution(o),s=this.getOrigin(o),l=Qs.toSize(this.getTileSize(o),this.tmpSize_),u=i?.5:0,c=i?0:.5,h=Math.floor((t-s[0])/n+u),d=Math.floor((e-s[1])/n+c),f=a*h/l[0],p=a*d/l[1];return i?(f=Math.ceil(f)-1,p=Math.ceil(p)-1):(f=Math.floor(f),p=Math.floor(p)),qu.createOrUpdate(o,f,p,r)},Zu.prototype.getTileCoordForXYAndZ_=function(t,e,n,i,r){var o=this.getOrigin(n),a=this.getResolution(n),s=Qs.toSize(this.getTileSize(n),this.tmpSize_),l=i?.5:0,u=i?0:.5,c=Math.floor((t-o[0])/a+l),h=Math.floor((e-o[1])/a+u),d=c/s[0],f=h/s[1];return i?(d=Math.ceil(d)-1,f=Math.ceil(f)-1):(d=Math.floor(d),f=Math.floor(f)),qu.createOrUpdate(n,d,f,r)},Zu.prototype.getTileCoordForCoordAndZ=function(t,e,n){return this.getTileCoordForXYAndZ_(t[0],t[1],e,!1,n)},Zu.prototype.getTileCoordResolution=function(t){return this.resolutions_[t[0]]},Zu.prototype.getTileSize=function(t){return this.tileSize_?this.tileSize_:this.tileSizes_[t]},Zu.prototype.getFullTileRange=function(t){return this.fullTileRanges_?this.fullTileRanges_[t]:null},Zu.prototype.getZForResolution=function(t,e){var n=Ha.linearFindNearest(this.resolutions_,t,e||0);return ts.clamp(n,this.minZoom,this.maxZoom)},Zu.prototype.calculateTileRanges_=function(t){for(var e=this.resolutions_.length,n=new Array(e),i=this.minZoom;i<e;++i)n[i]=this.getTileRangeForExtentAndZ(t,i);this.fullTileRanges_=n};var Qu={};Qu.getForProjection=function(t){var e=t.getDefaultTileGrid();return e||(e=Qu.createForProjection(t),t.setDefaultTileGrid(e)),e},Qu.wrapX=function(t,e,n){var i=e[0],r=t.getTileCoordCenter(e),o=Qu.extentFromProjection(n);if(hs.containsCoordinate(o,r))return e;var a=hs.getWidth(o),s=Math.ceil((o[0]-r[0])/a);return r[0]+=a*s,t.getTileCoordForCoordAndZ(r,i)},Qu.createForExtent=function(t,e,n,i){var r=void 0!==i?i:us.TOP_LEFT,o=Qu.resolutionsFromExtent(t,e,n);return new Zu({extent:t,origin:hs.getCorner(t,r),resolutions:o,tileSize:n})},Qu.createXYZ=function(t){var e={};return Ea.assign(e,void 0!==t?t:{}),void 0===e.extent&&(e.extent=ws.get("EPSG:3857").getExtent()),e.resolutions=Qu.resolutionsFromExtent(e.extent,e.maxZoom,e.tileSize),delete e.maxZoom,new Zu(e)},Qu.resolutionsFromExtent=function(t,e,n){for(var i=void 0!==e?e:ya.DEFAULT_MAX_ZOOM,r=hs.getHeight(t),o=hs.getWidth(t),a=Qs.toSize(void 0!==n?n:ya.DEFAULT_TILE_SIZE),s=Math.max(o/a[0],r/a[1]),l=i+1,u=new Array(l),c=0;c<l;++c)u[c]=s/Math.pow(2,c);return u},Qu.createForProjection=function(t,e,n,i){var r=Qu.extentFromProjection(t);return Qu.createForExtent(r,e,n,i)},Qu.extentFromProjection=function(t){var e=(t=ws.get(t)).getExtent();if(!e){var n=180*ws.METERS_PER_UNIT[vs.DEGREES]/t.getMetersPerUnit();e=hs.createOrUpdate(-n,-n,n,n)}return e};var Ju=function(t){this.html_=t.html,this.tileRanges_=t.tileRanges?t.tileRanges:null};Ju.prototype.getHTML=function(){return this.html_},Ju.prototype.intersectsAnyTileRange=function(t,e,n){if(!this.tileRanges_)return!0;var i,r,o,a;for(a in t)if(a in this.tileRanges_){o=t[a];var s;for(i=0,r=this.tileRanges_[a].length;i<r;++i){if((s=this.tileRanges_[a][i]).intersects(o))return!0;var l=e.getTileRangeForExtentAndZ(Qu.extentFromProjection(n),parseInt(a,10)),u=l.getWidth();if(o.minX<l.minX||o.maxX>l.maxX){if(s.intersects(new zl(ts.modulo(o.minX,u),ts.modulo(o.maxX,u),o.minY,o.maxY)))return!0;if(o.getWidth()>u&&s.intersects(l))return!0}}}return!1};var $u=function(t){La.call(this),this.projection_=ws.get(t.projection),this.attributions_=null,this.attributions2_=this.adaptAttributions_(t.attributions),this.logo_=t.logo,this.state_=void 0!==t.state?t.state:Ys.READY,this.wrapX_=void 0!==t.wrapX&&t.wrapX};ya.inherits($u,La),$u.prototype.adaptAttributions_=function(t){if(!t)return null;if(t instanceof Ju)return this.attributions_=[t],function(e){return[t.getHTML()]};if(Array.isArray(t)){if(t[0]instanceof Ju){this.attributions_=t;var e=t.map(function(t){return t.getHTML()});return function(t){return e}}return this.attributions_=t.map(function(t){return new Ju({html:t})}),function(e){return t}}return"function"==typeof t?t:(this.attributions_=[new Ju({html:t})],function(e){return[t]})},$u.prototype.forEachFeatureAtCoordinate=ya.nullFunction,$u.prototype.getAttributions=function(){return this.attributions_},$u.prototype.getAttributions2=function(){return this.attributions2_},$u.prototype.getLogo=function(){return this.logo_},$u.prototype.getProjection=function(){return this.projection_},$u.prototype.getResolutions=function(){},$u.prototype.getState=function(){return this.state_},$u.prototype.getWrapX=function(){return this.wrapX_},$u.prototype.refresh=function(){this.changed()},$u.prototype.setAttributions=function(t){this.attributions2_=this.adaptAttributions_(t),this.changed()},$u.prototype.setLogo=function(t){this.logo_=t},$u.prototype.setState=function(t){this.state_=t,this.changed()};var tc=function(t){$u.call(this,{attributions:t.attributions,extent:t.extent,logo:t.logo,projection:t.projection,state:t.state}),this.resolutions_=void 0!==t.resolutions?t.resolutions:null,this.reprojectedImage_=null,this.reprojectedRevision_=0};ya.inherits(tc,$u),tc.prototype.getResolutions=function(){return this.resolutions_},tc.prototype.findNearestResolution=function(t){if(this.resolutions_){var e=Ha.linearFindNearest(this.resolutions_,t,0);t=this.resolutions_[e]}return t},tc.prototype.getImage=function(t,e,n,i){var r=this.getProjection();if(ya.ENABLE_RASTER_REPROJECTION&&r&&i&&!ws.equivalent(r,i)){if(this.reprojectedImage_){if(this.reprojectedRevision_==this.getRevision()&&ws.equivalent(this.reprojectedImage_.getProjection(),i)&&this.reprojectedImage_.getResolution()==e&&hs.equals(this.reprojectedImage_.getExtent(),t))return this.reprojectedImage_;this.reprojectedImage_.dispose(),this.reprojectedImage_=null}return this.reprojectedImage_=new Ku(r,i,t,e,n,function(t,e,n){return this.getImageInternal(t,e,n,r)}.bind(this)),this.reprojectedRevision_=this.getRevision(),this.reprojectedImage_}return r&&(i=r),this.getImageInternal(t,e,n,i)},tc.prototype.getImageInternal=function(t,e,n,i){},tc.prototype.handleImageChange=function(t){var e=t.target;switch(e.getState()){case Ol.LOADING:this.dispatchEvent(new tc.Event(tc.EventType_.IMAGELOADSTART,e));break;case Ol.LOADED:this.dispatchEvent(new tc.Event(tc.EventType_.IMAGELOADEND,e));break;case Ol.ERROR:this.dispatchEvent(new tc.Event(tc.EventType_.IMAGELOADERROR,e))}},tc.defaultImageLoadFunction=function(t,e){t.getImage().src=e},tc.Event=function(t,e){Ca.call(this,t),this.image=e},ya.inherits(tc.Event,Ca),tc.EventType_={IMAGELOADSTART:"imageloadstart",IMAGELOADEND:"imageloadend",IMAGELOADERROR:"imageloaderror"};var ec=function(t){tc.call(this,{attributions:t.attributions,logo:t.logo,projection:t.projection,resolutions:t.resolutions,state:t.state}),this.canvasFunction_=t.canvasFunction,this.canvas_=null,this.renderedRevision_=0,this.ratio_=void 0!==t.ratio?t.ratio:1.5};ya.inherits(ec,tc),ec.prototype.getImageInternal=function(t,e,n,i){e=this.findNearestResolution(e);var r=this.canvas_;if(r&&this.renderedRevision_==this.getRevision()&&r.getResolution()==e&&r.getPixelRatio()==n&&hs.containsExtent(r.getExtent(),t))return r;t=t.slice(),hs.scaleFromCenter(t,this.ratio_);var o=[hs.getWidth(t)/e*n,hs.getHeight(t)/e*n],a=this.canvasFunction_(t,e,n,o,i);return a&&(r=new Wu(t,e,n,a)),this.canvas_=r,this.renderedRevision_=this.getRevision(),r};var nc=function(t){this.opacity_=t.opacity,this.rotateWithView_=t.rotateWithView,this.rotation_=t.rotation,this.scale_=t.scale,this.snapToPixel_=t.snapToPixel};nc.prototype.getOpacity=function(){return this.opacity_},nc.prototype.getRotateWithView=function(){return this.rotateWithView_},nc.prototype.getRotation=function(){return this.rotation_},nc.prototype.getScale=function(){return this.scale_},nc.prototype.getSnapToPixel=function(){return this.snapToPixel_},nc.prototype.getAnchor=function(){},nc.prototype.getImage=function(t){},nc.prototype.getHitDetectionImage=function(t){},nc.prototype.getImageState=function(){},nc.prototype.getImageSize=function(){},nc.prototype.getHitDetectionImageSize=function(){},nc.prototype.getOrigin=function(){},nc.prototype.getSize=function(){},nc.prototype.setOpacity=function(t){this.opacity_=t},nc.prototype.setRotateWithView=function(t){this.rotateWithView_=t},nc.prototype.setRotation=function(t){this.rotation_=t},nc.prototype.setScale=function(t){this.scale_=t},nc.prototype.setSnapToPixel=function(t){this.snapToPixel_=t},nc.prototype.listenImageChange=function(t,e){},nc.prototype.load=function(){},nc.prototype.unlistenImageChange=function(t,e){};var ic=function(t){this.checksums_=null,this.canvas_=null,this.hitDetectionCanvas_=null,this.fill_=void 0!==t.fill?t.fill:null,this.origin_=[0,0],this.points_=t.points,this.radius_=void 0!==t.radius?t.radius:t.radius1,this.radius2_=t.radius2,this.angle_=void 0!==t.angle?t.angle:0,this.stroke_=void 0!==t.stroke?t.stroke:null,this.anchor_=null,this.size_=null,this.imageSize_=null,this.hitDetectionImageSize_=null,this.atlasManager_=t.atlasManager,this.render_(this.atlasManager_);var e=void 0===t.snapToPixel||t.snapToPixel,n=void 0!==t.rotateWithView&&t.rotateWithView;nc.call(this,{opacity:1,rotateWithView:n,rotation:void 0!==t.rotation?t.rotation:0,scale:1,snapToPixel:e})};ya.inherits(ic,nc),ic.prototype.clone=function(){var t=new ic({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),snapToPixel:this.getSnapToPixel(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),atlasManager:this.atlasManager_});return t.setOpacity(this.getOpacity()),t.setScale(this.getScale()),t},ic.prototype.getAnchor=function(){return this.anchor_},ic.prototype.getAngle=function(){return this.angle_},ic.prototype.getFill=function(){return this.fill_},ic.prototype.getHitDetectionImage=function(t){return this.hitDetectionCanvas_},ic.prototype.getImage=function(t){return this.canvas_},ic.prototype.getImageSize=function(){return this.imageSize_},ic.prototype.getHitDetectionImageSize=function(){return this.hitDetectionImageSize_},ic.prototype.getImageState=function(){return Ol.LOADED},ic.prototype.getOrigin=function(){return this.origin_},ic.prototype.getPoints=function(){return this.points_},ic.prototype.getRadius=function(){return this.radius_},ic.prototype.getRadius2=function(){return this.radius2_},ic.prototype.getSize=function(){return this.size_},ic.prototype.getStroke=function(){return this.stroke_},ic.prototype.listenImageChange=function(t,e){},ic.prototype.load=function(){},ic.prototype.unlistenImageChange=function(t,e){},ic.prototype.render_=function(t){var e,n,i="",r="",o=0,a=null,s=0,l=0;this.stroke_&&(null===(n=this.stroke_.getColor())&&(n=Rl.defaultStrokeStyle),n=Il.asColorLike(n),void 0===(l=this.stroke_.getWidth())&&(l=Rl.defaultLineWidth),a=this.stroke_.getLineDash(),s=this.stroke_.getLineDashOffset(),Da.CANVAS_LINE_DASH||(a=null,s=0),void 0===(r=this.stroke_.getLineJoin())&&(r=Rl.defaultLineJoin),void 0===(i=this.stroke_.getLineCap())&&(i=Rl.defaultLineCap),void 0===(o=this.stroke_.getMiterLimit())&&(o=Rl.defaultMiterLimit));var u=2*(this.radius_+l)+1,c={strokeStyle:n,strokeWidth:l,size:u,lineCap:i,lineDash:a,lineDashOffset:s,lineJoin:r,miterLimit:o};if(void 0===t){var h=Xs.createCanvasContext2D(u,u);this.canvas_=h.canvas,e=u=this.canvas_.width,this.draw_(c,h,0,0),this.createHitDetectionCanvas_(c)}else{u=Math.round(u);var d,f=!this.fill_;f&&(d=this.drawHitDetectionCanvas_.bind(this,c));var p=this.getChecksum(),g=t.add(p,u,u,this.draw_.bind(this,c),d);this.canvas_=g.image,this.origin_=[g.offsetX,g.offsetY],e=g.image.width,f?(this.hitDetectionCanvas_=g.hitImage,this.hitDetectionImageSize_=[g.hitImage.width,g.hitImage.height]):(this.hitDetectionCanvas_=this.canvas_,this.hitDetectionImageSize_=[e,e])}this.anchor_=[u/2,u/2],this.size_=[u,u],this.imageSize_=[e,e]},ic.prototype.draw_=function(t,e,n,i){var r,o,a;e.setTransform(1,0,0,1,0,0),e.translate(n,i),e.beginPath();var s=this.points_;if(s===1/0)e.arc(t.size/2,t.size/2,this.radius_,0,2*Math.PI,!0);else{var l=void 0!==this.radius2_?this.radius2_:this.radius_;for(l!==this.radius_&&(s*=2),r=0;r<=s;r++)o=2*r*Math.PI/s-Math.PI/2+this.angle_,a=r%2==0?this.radius_:l,e.lineTo(t.size/2+a*Math.cos(o),t.size/2+a*Math.sin(o))}if(this.fill_){var u=this.fill_.getColor();null===u&&(u=Rl.defaultFillStyle),e.fillStyle=Il.asColorLike(u),e.fill()}this.stroke_&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineCap=t.lineCap,e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke()),e.closePath()},ic.prototype.createHitDetectionCanvas_=function(t){if(this.hitDetectionImageSize_=[t.size,t.size],this.fill_)this.hitDetectionCanvas_=this.canvas_;else{var e=Xs.createCanvasContext2D(t.size,t.size);this.hitDetectionCanvas_=e.canvas,this.drawHitDetectionCanvas_(t,e,0,0)}},ic.prototype.drawHitDetectionCanvas_=function(t,e,n,i){e.setTransform(1,0,0,1,0,0),e.translate(n,i),e.beginPath();var r=this.points_;if(r===1/0)e.arc(t.size/2,t.size/2,this.radius_,0,2*Math.PI,!0);else{var o=void 0!==this.radius2_?this.radius2_:this.radius_;o!==this.radius_&&(r*=2);var a,s,l;for(a=0;a<=r;a++)l=2*a*Math.PI/r-Math.PI/2+this.angle_,s=a%2==0?this.radius_:o,e.lineTo(t.size/2+s*Math.cos(l),t.size/2+s*Math.sin(l))}e.fillStyle=Rl.defaultFillStyle,e.fill(),this.stroke_&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.stroke()),e.closePath()},ic.prototype.getChecksum=function(){var t=this.stroke_?this.stroke_.getChecksum():"-",e=this.fill_?this.fill_.getChecksum():"-";if(!this.checksums_||t!=this.checksums_[1]||e!=this.checksums_[2]||this.radius_!=this.checksums_[3]||this.radius2_!=this.checksums_[4]||this.angle_!=this.checksums_[5]||this.points_!=this.checksums_[6]){var n="r"+t+e+(void 0!==this.radius_?this.radius_.toString():"-")+(void 0!==this.radius2_?this.radius2_.toString():"-")+(void 0!==this.angle_?this.angle_.toString():"-")+(void 0!==this.points_?this.points_.toString():"-");this.checksums_=[n,t,e,this.radius_,this.radius2_,this.angle_,this.points_]}return this.checksums_[0]};var rc=function(t){var e=t||{};ic.call(this,{points:1/0,fill:e.fill,radius:e.radius,snapToPixel:e.snapToPixel,stroke:e.stroke,atlasManager:e.atlasManager})};ya.inherits(rc,ic),rc.prototype.clone=function(){var t=new rc({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),snapToPixel:this.getSnapToPixel(),atlasManager:this.atlasManager_});return t.setOpacity(this.getOpacity()),t.setScale(this.getScale()),t},rc.prototype.setRadius=function(t){this.radius_=t,this.render_(this.atlasManager_)};var oc=function(t){var e=t||{};this.color_=void 0!==e.color?e.color:null,this.checksum_=void 0};oc.prototype.clone=function(){var t=this.getColor();return new oc({color:t&&t.slice?t.slice():t||void 0})},oc.prototype.getColor=function(){return this.color_},oc.prototype.setColor=function(t){this.color_=t,this.checksum_=void 0},oc.prototype.getChecksum=function(){return void 0===this.checksum_&&(this.color_ instanceof CanvasPattern||this.color_ instanceof CanvasGradient?this.checksum_=ya.getUid(this.color_).toString():this.checksum_="f"+(this.color_?Ll.asString(this.color_):"-")),this.checksum_};var ac=function(t){var e=t||{};this.geometry_=null,this.geometryFunction_=ac.defaultGeometryFunction,void 0!==e.geometry&&this.setGeometry(e.geometry),this.fill_=void 0!==e.fill?e.fill:null,this.image_=void 0!==e.image?e.image:null,this.renderer_=void 0!==e.renderer?e.renderer:null,this.stroke_=void 0!==e.stroke?e.stroke:null,this.text_=void 0!==e.text?e.text:null,this.zIndex_=e.zIndex};ac.prototype.clone=function(){var t=this.getGeometry();return t&&t.clone&&(t=t.clone()),new ac({geometry:t,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})},ac.prototype.getRenderer=function(){return this.renderer_},ac.prototype.setRenderer=function(t){this.renderer_=t},ac.prototype.getGeometry=function(){return this.geometry_},ac.prototype.getGeometryFunction=function(){return this.geometryFunction_},ac.prototype.getFill=function(){return this.fill_},ac.prototype.setFill=function(t){this.fill_=t},ac.prototype.getImage=function(){return this.image_},ac.prototype.setImage=function(t){this.image_=t},ac.prototype.getStroke=function(){return this.stroke_},ac.prototype.setStroke=function(t){this.stroke_=t},ac.prototype.getText=function(){return this.text_},ac.prototype.setText=function(t){this.text_=t},ac.prototype.getZIndex=function(){return this.zIndex_},ac.prototype.setGeometry=function(t){"function"==typeof t?this.geometryFunction_=t:"string"==typeof t?this.geometryFunction_=function(e){return e.get(t)}:t?void 0!==t&&(this.geometryFunction_=function(){return t}):this.geometryFunction_=ac.defaultGeometryFunction,this.geometry_=t},ac.prototype.setZIndex=function(t){this.zIndex_=t},ac.createFunction=function(t){var e;if("function"==typeof t)e=t;else{var n;Array.isArray(t)?n=t:(Qa.assert(t instanceof ac,41),n=[t]),e=function(){return n}}return e},ac.default_=null,ac.defaultFunction=function(t,e){if(!ac.default_){var n=new oc({color:"rgba(255,255,255,0.4)"}),i=new Mu({color:"#3399CC",width:1.25});ac.default_=[new ac({image:new rc({fill:n,stroke:i,radius:5}),fill:n,stroke:i})]}return ac.default_},ac.createDefaultEditing=function(){var t={},e=[255,255,255,1],n=[0,153,255,1];return t[ds.POLYGON]=[new ac({fill:new oc({color:[255,255,255,.5]})})],t[ds.MULTI_POLYGON]=t[ds.POLYGON],t[ds.LINE_STRING]=[new ac({stroke:new Mu({color:e,width:5})}),new ac({stroke:new Mu({color:n,width:3})})],t[ds.MULTI_LINE_STRING]=t[ds.LINE_STRING],t[ds.CIRCLE]=t[ds.POLYGON].concat(t[ds.LINE_STRING]),t[ds.POINT]=[new ac({image:new rc({radius:6,fill:new oc({color:n}),stroke:new Mu({color:e,width:1.5})}),zIndex:1/0})],t[ds.MULTI_POINT]=t[ds.POINT],t[ds.GEOMETRY_COLLECTION]=t[ds.POLYGON].concat(t[ds.LINE_STRING],t[ds.POINT]),t},ac.defaultGeometryFunction=function(t){return t.getGeometry()};var sc=function(t){this.source_=t.source,this.transform_=Cs.create(),this.canvasContext_=Xs.createCanvasContext2D(),this.canvasSize_=[0,0],this.declutterTree_=Wl(9),this.renderBuffer_=void 0==t.renderBuffer?100:t.renderBuffer,this.replayGroup_=null,ec.call(this,{attributions:t.attributions,canvasFunction:this.canvasFunctionInternal_.bind(this),logo:t.logo,projection:t.projection,ratio:t.ratio,resolutions:t.resolutions,state:this.source_.getState()}),this.style_=null,this.styleFunction_=void 0,this.setStyle(t.style),Ta.listen(this.source_,Aa.CHANGE,this.handleSourceChange_,this)};ya.inherits(sc,ec),sc.prototype.canvasFunctionInternal_=function(t,e,n,i,r){var o=new ou(au.getTolerance(e,n),t,e,n,this.source_.getOverlaps(),this.declutterTree_,this.renderBuffer_);this.source_.loadFeatures(t,e,r);var a=!1;if(this.source_.forEachFeatureInExtent(t,function(t){a=a||this.renderFeature_(t,e,n,o)},this),o.finish(),a)return null;this.canvasSize_[0]!=i[0]||this.canvasSize_[1]!=i[1]?(this.canvasContext_.canvas.width=i[0],this.canvasContext_.canvas.height=i[1],this.canvasSize_[0]=i[0],this.canvasSize_[1]=i[1]):this.canvasContext_.clearRect(0,0,i[0],i[1]);var s=this.getTransform_(hs.getCenter(t),e,n,i);return o.replay(this.canvasContext_,s,0,{}),this.replayGroup_=o,this.declutterTree_.clear(),this.canvasContext_.canvas},sc.prototype.forEachFeatureAtCoordinate=function(t,e,n,i,r,o){if(this.replayGroup_){var a={},s=this.replayGroup_.forEachFeatureAtCoordinate(t,e,0,i,r,function(t){var e=ya.getUid(t).toString();if(!(e in a))return a[e]=!0,o(t)},null);return this.declutterTree_.clear(),s}},sc.prototype.getSource=function(){return this.source_},sc.prototype.getStyle=function(){return this.style_},sc.prototype.getStyleFunction=function(){return this.styleFunction_},sc.prototype.getTransform_=function(t,e,n,i){var r=i[0]/2,o=i[1]/2,a=n/e,s=-a,l=-t[0],u=-t[1];return Cs.compose(this.transform_,r,o,a,s,0,l,u)},sc.prototype.handleImageChange_=function(t){this.changed()},sc.prototype.handleSourceChange_=function(){this.setState(this.source_.getState())},sc.prototype.renderFeature_=function(t,e,n,i){var r,o=t.getStyleFunction();if(o?r=o.call(t,e):this.styleFunction_&&(r=this.styleFunction_(t,e)),!r)return!1;var a,s,l=!1;for(Array.isArray(r)||(r=[r]),a=0,s=r.length;a<s;++a)l=au.renderFeature(i,t,r[a],au.getSquaredTolerance(e,n),this.handleImageChange_,this)||l;return l},sc.prototype.setStyle=function(t){this.style_=void 0!==t?t:ac.defaultFunction,this.styleFunction_=t?ac.createFunction(this.style_):void 0,this.changed()};var lc=function(t,e){Xu.call(this,t,e),this.image_=null,this.hitCanvasContext_=null,this.hitTransformationMatrix_=null};ya.inherits(lc,Xu),lc.handles=function(t,e){return t===Zs.WEBGL&&e.getType()===Cl.IMAGE},lc.create=function(t,e){return new lc(t,e)},lc.prototype.createTexture_=function(t){var e=t.getImage(),n=this.mapRenderer.getGL();return Tu.createTexture(n,e,Oa.CLAMP_TO_EDGE,Oa.CLAMP_TO_EDGE)},lc.prototype.forEachFeatureAtCoordinate=function(t,e,n,i,r){var o=this.getLayer(),a=o.getSource(),s=e.viewState.resolution,l=e.viewState.rotation,u=e.skippedFeatureUids;return a.forEachFeatureAtCoordinate(t,s,l,n,u,function(t){return i.call(r,t,o)})},lc.prototype.prepareFrame=function(t,e,n){var i=this.mapRenderer.getGL(),r=t.pixelRatio,o=t.viewState,a=o.center,s=o.resolution,l=o.rotation,u=this.image_,c=this.texture,h=this.getLayer().getSource(),d=t.viewHints,f=t.extent;if(void 0!==e.extent&&(f=hs.getIntersection(f,e.extent)),!d[rs.ANIMATING]&&!d[rs.INTERACTING]&&!hs.isEmpty(f)){var p=o.projection;if(!ya.ENABLE_RASTER_REPROJECTION){var g=h.getProjection();g&&(p=g)}var _=h.getImage(f,s,r,p);if(_&&this.loadImage(_)&&(u=_,c=this.createTexture_(_),this.texture)){var v=function(t,e){t.isContextLost()||t.deleteTexture(e)}.bind(null,i,this.texture);t.postRenderFunctions.push(v)}}if(u){var y=this.mapRenderer.getContext().getCanvas();this.updateProjectionMatrix_(y.width,y.height,r,a,s,l,u.getExtent()),this.hitTransformationMatrix_=null;var m=this.texCoordMatrix;Cs.reset(m),Cs.scale(m,1,-1),Cs.translate(m,0,-1),this.image_=u,this.texture=c,this.updateLogos(t,h)}return!!u},lc.prototype.updateProjectionMatrix_=function(t,e,n,i,r,o,a){var s=t*r,l=e*r,u=this.projectionMatrix;Cs.reset(u),Cs.scale(u,2*n/s,2*n/l),Cs.rotate(u,-o),Cs.translate(u,a[0]-i[0],a[1]-i[1]),Cs.scale(u,(a[2]-a[0])/2,(a[3]-a[1])/2),Cs.translate(u,1,1)},lc.prototype.hasFeatureAtCoordinate=function(t,e){return void 0!==this.forEachFeatureAtCoordinate(t,e,0,ps.TRUE,this)},lc.prototype.forEachLayerAtPixel=function(t,e,n,i){if(this.image_&&this.image_.getImage()){if(this.getLayer().getSource()instanceof sc){var r=Cs.apply(e.pixelToCoordinateTransform,t.slice());return this.forEachFeatureAtCoordinate(r,e,0,ps.TRUE,this)?n.call(i,this.getLayer(),null):void 0}var o=[this.image_.getImage().width,this.image_.getImage().height];this.hitTransformationMatrix_||(this.hitTransformationMatrix_=this.getHitTransformationMatrix_(e.size,o));var a=Cs.apply(this.hitTransformationMatrix_,t.slice());if(!(a[0]<0||a[0]>o[0]||a[1]<0||a[1]>o[1])){this.hitCanvasContext_||(this.hitCanvasContext_=Xs.createCanvasContext2D(1,1)),this.hitCanvasContext_.clearRect(0,0,1,1),this.hitCanvasContext_.drawImage(this.image_.getImage(),a[0],a[1],1,1,0,0,1,1);var s=this.hitCanvasContext_.getImageData(0,0,1,1).data;return s[3]>0?n.call(i,this.getLayer(),s):void 0}}},lc.prototype.getHitTransformationMatrix_=function(t,e){var n=Cs.create();Cs.translate(n,-1,-1),Cs.scale(n,2/t[0],2/t[1]),Cs.translate(n,0,t[1]),Cs.scale(n,1,-1);var i=Cs.invert(this.projectionMatrix.slice()),r=Cs.create();return Cs.translate(r,0,e[1]),Cs.scale(r,1,-1),Cs.scale(r,e[0]/2,e[1]/2),Cs.translate(r,1,1),Cs.multiply(r,i),Cs.multiply(r,n),r};var uc=function(t,e){Ul.call(this,t,e),this.canvas_=document.createElement("CANVAS"),this.canvas_.style.width="100%",this.canvas_.style.height="100%",this.canvas_.style.display="block",this.canvas_.className=tl.CLASS_UNSELECTABLE,t.insertBefore(this.canvas_,t.childNodes[0]||null),this.clipTileCanvasWidth_=0,this.clipTileCanvasHeight_=0,this.clipTileContext_=Xs.createCanvasContext2D(),this.renderedVisible_=!0,this.gl_=Oa.getContext(this.canvas_,{antialias:!0,depth:!0,failIfMajorPerformanceCaveat:!0,preserveDrawingBuffer:!1,stencil:!0}),this.context_=new Tu(this.canvas_,this.gl_),Ta.listen(this.canvas_,Eu.LOST,this.handleWebGLContextLost,this),Ta.listen(this.canvas_,Eu.RESTORED,this.handleWebGLContextRestored,this),this.textureCache_=new Al,this.focus_=null,this.tileTextureQueue_=new Ja(function(t){var e=t[1],n=t[2],i=e[0]-this.focus_[0],r=e[1]-this.focus_[1];return 65536*Math.log(n)+Math.sqrt(i*i+r*r)/n}.bind(this),function(t){return t[0].getKey()}),this.loadNextTileTexture_=function(t,e){if(!this.tileTextureQueue_.isEmpty()){this.tileTextureQueue_.reprioritize();var n=this.tileTextureQueue_.dequeue(),i=n[0],r=n[3],o=n[4];this.bindTileTexture(i,r,o,Oa.LINEAR,Oa.LINEAR)}return!1}.bind(this),this.textureCacheFrameMarkerCount_=0,this.initializeGL_()};ya.inherits(uc,Ul),uc.handles=function(t){return Da.WEBGL&&t===Zs.WEBGL},uc.create=function(t,e){return new uc(t,e)},uc.prototype.bindTileTexture=function(t,e,n,i,r){var o=this.getGL(),a=t.getKey();if(this.textureCache_.containsKey(a)){var s=this.textureCache_.get(a);o.bindTexture(Oa.TEXTURE_2D,s.texture),s.magFilter!=i&&(o.texParameteri(Oa.TEXTURE_2D,Oa.TEXTURE_MAG_FILTER,i),s.magFilter=i),s.minFilter!=r&&(o.texParameteri(Oa.TEXTURE_2D,Oa.TEXTURE_MIN_FILTER,r),s.minFilter=r)}else{var l=o.createTexture();if(o.bindTexture(Oa.TEXTURE_2D,l),n>0){var u=this.clipTileContext_.canvas,c=this.clipTileContext_;this.clipTileCanvasWidth_!==e[0]||this.clipTileCanvasHeight_!==e[1]?(u.width=e[0],u.height=e[1],this.clipTileCanvasWidth_=e[0],this.clipTileCanvasHeight_=e[1]):c.clearRect(0,0,e[0],e[1]),c.drawImage(t.getImage(),n,n,e[0],e[1],0,0,e[0],e[1]),o.texImage2D(Oa.TEXTURE_2D,0,Oa.RGBA,Oa.RGBA,Oa.UNSIGNED_BYTE,u)}else o.texImage2D(Oa.TEXTURE_2D,0,Oa.RGBA,Oa.RGBA,Oa.UNSIGNED_BYTE,t.getImage());o.texParameteri(Oa.TEXTURE_2D,Oa.TEXTURE_MAG_FILTER,i),o.texParameteri(Oa.TEXTURE_2D,Oa.TEXTURE_MIN_FILTER,r),o.texParameteri(Oa.TEXTURE_2D,Oa.TEXTURE_WRAP_S,Oa.CLAMP_TO_EDGE),o.texParameteri(Oa.TEXTURE_2D,Oa.TEXTURE_WRAP_T,Oa.CLAMP_TO_EDGE),this.textureCache_.set(a,{texture:l,magFilter:i,minFilter:r})}},uc.prototype.dispatchComposeEvent_=function(t,e){var n=this.getMap();if(n.hasListener(t)){var i=this.context_,r=e.extent,o=e.size,a=e.viewState,s=e.pixelRatio,l=a.resolution,u=a.center,c=a.rotation,h=new Uu(i,u,l,c,o,r,s),d=new bl(t,h,e,null,i);n.dispatchEvent(d)}},uc.prototype.disposeInternal=function(){var t=this.getGL();t.isContextLost()||this.textureCache_.forEach(function(e){e&&t.deleteTexture(e.texture)}),this.context_.dispose(),Ul.prototype.disposeInternal.call(this)},uc.prototype.expireCache_=function(t,e){for(var n,i=this.getGL();this.textureCache_.getCount()-this.textureCacheFrameMarkerCount_>ya.WEBGL_TEXTURE_CACHE_HIGH_WATER_MARK;){if(n=this.textureCache_.peekLast())i.deleteTexture(n.texture);else{if(+this.textureCache_.peekLastKey()==e.index)break;--this.textureCacheFrameMarkerCount_}this.textureCache_.pop()}},uc.prototype.getContext=function(){return this.context_},uc.prototype.getGL=function(){return this.gl_},uc.prototype.getTileTextureQueue=function(){return this.tileTextureQueue_},uc.prototype.getType=function(){return Zs.WEBGL},uc.prototype.handleWebGLContextLost=function(t){t.preventDefault(),this.textureCache_.clear(),this.textureCacheFrameMarkerCount_=0;var e=this.getLayerRenderers();for(var n in e)e[n].handleWebGLContextLost()},uc.prototype.handleWebGLContextRestored=function(){this.initializeGL_(),this.getMap().render()},uc.prototype.initializeGL_=function(){var t=this.gl_;t.activeTexture(Oa.TEXTURE0),t.blendFuncSeparate(Oa.SRC_ALPHA,Oa.ONE_MINUS_SRC_ALPHA,Oa.ONE,Oa.ONE_MINUS_SRC_ALPHA),t.disable(Oa.CULL_FACE),t.disable(Oa.DEPTH_TEST),t.disable(Oa.SCISSOR_TEST),t.disable(Oa.STENCIL_TEST)},uc.prototype.isTileTextureLoaded=function(t){return this.textureCache_.containsKey(t.getKey())},uc.prototype.renderFrame=function(t){var e=this.getContext(),n=this.getGL();if(n.isContextLost())return!1;if(!t)return this.renderedVisible_&&(this.canvas_.style.display="none",this.renderedVisible_=!1),!1;this.focus_=t.focus,this.textureCache_.set((-t.index).toString(),null),++this.textureCacheFrameMarkerCount_,this.dispatchComposeEvent_(el.PRECOMPOSE,t);var i=[],r=t.layerStatesArray;Ha.stableSort(r,Ul.sortByZIndex);var o,a,s,l=t.viewState.resolution;for(o=0,a=r.length;o<a;++o)s=r[o],nl.visibleAtResolution(s,l)&&s.sourceState==Ys.READY&&this.getLayerRenderer(s.layer).prepareFrame(t,s,e)&&i.push(s);var u=t.size[0]*t.pixelRatio,c=t.size[1]*t.pixelRatio;for(this.canvas_.width==u&&this.canvas_.height==c||(this.canvas_.width=u,this.canvas_.height=c),n.bindFramebuffer(Oa.FRAMEBUFFER,null),n.clearColor(0,0,0,0),n.clear(Oa.COLOR_BUFFER_BIT),n.enable(Oa.BLEND),n.viewport(0,0,this.canvas_.width,this.canvas_.height),o=0,a=i.length;o<a;++o)s=i[o],this.getLayerRenderer(s.layer).composeFrame(t,s,e);this.renderedVisible_||(this.canvas_.style.display="",this.renderedVisible_=!0),this.calculateMatrices2D(t),this.textureCache_.getCount()-this.textureCacheFrameMarkerCount_>ya.WEBGL_TEXTURE_CACHE_HIGH_WATER_MARK&&t.postRenderFunctions.push(this.expireCache_.bind(this)),this.tileTextureQueue_.isEmpty()||(t.postRenderFunctions.push(this.loadNextTileTexture_),t.animate=!0),this.dispatchComposeEvent_(el.POSTCOMPOSE,t),this.scheduleRemoveUnusedLayerRenderers(t),this.scheduleExpireIconCache(t)},uc.prototype.forEachFeatureAtCoordinate=function(t,e,n,i,r,o,a){var s;if(this.getGL().isContextLost())return!1;var l,u=e.viewState,c=e.layerStatesArray;for(l=c.length-1;l>=0;--l){var h=c[l],d=h.layer;if(nl.visibleAtResolution(h,u.resolution)&&o.call(a,d)&&(s=this.getLayerRenderer(d).forEachFeatureAtCoordinate(t,e,n,i,r)))return s}},uc.prototype.hasFeatureAtCoordinate=function(t,e,n,i,r){var o=!1;if(this.getGL().isContextLost())return!1;var a,s=e.viewState,l=e.layerStatesArray;for(a=l.length-1;a>=0;--a){var u=l[a],c=u.layer;if(nl.visibleAtResolution(u,s.resolution)&&i.call(r,c)&&(o=this.getLayerRenderer(c).hasFeatureAtCoordinate(t,e)))return!0}return o},uc.prototype.forEachLayerAtPixel=function(t,e,n,i,r,o){if(this.getGL().isContextLost())return!1;var a,s,l=e.viewState,u=e.layerStatesArray;for(s=u.length-1;s>=0;--s){var c=u[s],h=c.layer;if(nl.visibleAtResolution(c,l.resolution)&&r.call(i,h)&&(a=this.getLayerRenderer(h).forEachLayerAtPixel(t,e,n,i)))return a}};var cc={};cc.fragment=new hu(ya.DEBUG_WEBGL?"precision mediump float;\nvarying vec2 v_texCoord;\n\n\nuniform sampler2D u_texture;\n\nvoid main(void) {\n  gl_FragColor = texture2D(u_texture, v_texCoord);\n}\n":"precision mediump float;varying vec2 a;uniform sampler2D e;void main(void){gl_FragColor=texture2D(e,a);}"),cc.vertex=new du(ya.DEBUG_WEBGL?"varying vec2 v_texCoord;\n\n\nattribute vec2 a_position;\nattribute vec2 a_texCoord;\nuniform vec4 u_tileOffset;\n\nvoid main(void) {\n  gl_Position = vec4(a_position * u_tileOffset.xy + u_tileOffset.zw, 0., 1.);\n  v_texCoord = a_texCoord;\n}\n\n\n":"varying vec2 a;attribute vec2 b;attribute vec2 c;uniform vec4 d;void main(void){gl_Position=vec4(b*d.xy+d.zw,0.,1.);a=c;}");var hc=function(t,e){this.u_tileOffset=t.getUniformLocation(e,ya.DEBUG_WEBGL?"u_tileOffset":"d"),this.u_texture=t.getUniformLocation(e,ya.DEBUG_WEBGL?"u_texture":"e"),this.a_position=t.getAttribLocation(e,ya.DEBUG_WEBGL?"a_position":"b"),this.a_texCoord=t.getAttribLocation(e,ya.DEBUG_WEBGL?"a_texCoord":"c")},dc=function(t,e){Xu.call(this,t,e),this.fragmentShader_=cc.fragment,this.vertexShader_=cc.vertex,this.locations_=null,this.renderArrayBuffer_=new yu([0,0,0,1,1,0,1,1,0,1,0,0,1,1,1,0]),this.renderedTileRange_=null,this.renderedFramebufferExtent_=null,this.renderedRevision_=-1,this.tmpSize_=[0,0]};ya.inherits(dc,Xu),dc.handles=function(t,e){return t===Zs.WEBGL&&e.getType()===Cl.TILE},dc.create=function(t,e){return new dc(t,e)},dc.prototype.disposeInternal=function(){this.mapRenderer.getContext().deleteBuffer(this.renderArrayBuffer_),Xu.prototype.disposeInternal.call(this)},dc.prototype.createLoadedTileFinder=function(t,e,n){var i=this.mapRenderer;return function(r,o){return t.forEachLoadedTile(e,r,o,function(t){var e=i.isTileTextureLoaded(t);return e&&(n[r]||(n[r]={}),n[r][t.tileCoord.toString()]=t),e})}},dc.prototype.handleWebGLContextLost=function(){Xu.prototype.handleWebGLContextLost.call(this),this.locations_=null},dc.prototype.prepareFrame=function(t,e,n){var i,r=this.mapRenderer,o=n.getGL(),a=t.viewState,s=a.projection,l=this.getLayer(),u=l.getSource(),c=u.getTileGridForProjection(s),h=c.getZForResolution(a.resolution),d=c.getResolution(h),f=u.getTilePixelSize(h,t.pixelRatio,s),p=f[0]/Qs.toSize(c.getTileSize(h),this.tmpSize_)[0],g=d/p,_=u.getTilePixelRatio(p)*u.getGutter(s),v=a.center,y=t.extent,m=c.getTileRangeForExtentAndZ(y,h);if(this.renderedTileRange_&&this.renderedTileRange_.equals(m)&&this.renderedRevision_==u.getRevision())i=this.renderedFramebufferExtent_;else{var x=m.getSize(),S=Math.max(x[0]*f[0],x[1]*f[1]),E=ts.roundUpToPowerOfTwo(S),T=g*E,w=c.getOrigin(h),C=w[0]+m.minX*f[0]*g,b=w[1]+m.minY*f[1]*g;i=[C,b,C+T,b+T],this.bindFramebuffer(t,E),o.viewport(0,0,E,E),o.clearColor(0,0,0,0),o.clear(Oa.COLOR_BUFFER_BIT),o.disable(Oa.BLEND);var A=n.getProgram(this.fragmentShader_,this.vertexShader_);n.useProgram(A),this.locations_||(this.locations_=new hc(o,A)),n.bindBuffer(Oa.ARRAY_BUFFER,this.renderArrayBuffer_),o.enableVertexAttribArray(this.locations_.a_position),o.vertexAttribPointer(this.locations_.a_position,2,Oa.FLOAT,!1,16,0),o.enableVertexAttribArray(this.locations_.a_texCoord),o.vertexAttribPointer(this.locations_.a_texCoord,2,Oa.FLOAT,!1,16,8),o.uniform1i(this.locations_.u_texture,0);var R={};R[h]={};var L,I,P,M,O,D,F=this.createLoadedTileFinder(u,s,R),k=l.getUseInterimTilesOnError(),N=!0,G=hs.createEmpty(),V=new zl(0,0,0,0);for(M=m.minX;M<=m.maxX;++M)for(O=m.minY;O<=m.maxY;++O)if(I=u.getTile(h,M,O,p,s),void 0===e.extent||(D=c.getTileCoordExtent(I.tileCoord,G),hs.intersects(D,e.extent))){if(P=I.getState(),P==Za.LOADED||P==Za.EMPTY||P==Za.ERROR&&!k||(I=I.getInterimTile()),(P=I.getState())==Za.LOADED){if(r.isTileTextureLoaded(I)){R[h][I.tileCoord.toString()]=I;continue}}else if(P==Za.EMPTY||P==Za.ERROR&&!k)continue;N=!1,c.forEachTileCoordParentTileRange(I.tileCoord,F,null,V,G)||(L=c.getTileCoordChildTileRange(I.tileCoord,V,G))&&F(h+1,L)}var U=Object.keys(R).map(Number);U.sort(Ha.numberSafeCompareFunction);var B,z,X,H,W=new Float32Array(4);for(B=0,z=U.length;B<z;++B){H=R[U[B]];for(X in H)I=H[X],D=c.getTileCoordExtent(I.tileCoord,G),W[0]=2*(D[2]-D[0])/T,W[1]=2*(D[3]-D[1])/T,W[2]=2*(D[0]-i[0])/T-1,W[3]=2*(D[1]-i[1])/T-1,o.uniform4fv(this.locations_.u_tileOffset,W),r.bindTileTexture(I,f,_*p,Oa.LINEAR,Oa.LINEAR),o.drawArrays(Oa.TRIANGLE_STRIP,0,4)}N?(this.renderedTileRange_=m,this.renderedFramebufferExtent_=i,this.renderedRevision_=u.getRevision()):(this.renderedTileRange_=null,this.renderedFramebufferExtent_=null,this.renderedRevision_=-1,t.animate=!0)}this.updateUsedTiles(t.usedTiles,u,h,m);var Y=r.getTileTextureQueue();this.manageTilePyramid(t,u,c,p,s,y,h,l.getPreload(),function(t){t.getState()!=Za.LOADED||r.isTileTextureLoaded(t)||Y.isKeyQueued(t.getKey())||Y.enqueue([t,c.getTileCoordCenter(t.tileCoord),c.getResolution(t.tileCoord[0]),f,_*p])},this),this.scheduleExpireCache(t,u),this.updateLogos(t,u);var j=this.texCoordMatrix;return Cs.reset(j),Cs.translate(j,(Math.round(v[0]/d)*d-i[0])/(i[2]-i[0]),(Math.round(v[1]/d)*d-i[1])/(i[3]-i[1])),0!==a.rotation&&Cs.rotate(j,a.rotation),Cs.scale(j,t.size[0]*a.resolution/(i[2]-i[0]),t.size[1]*a.resolution/(i[3]-i[1])),Cs.translate(j,-.5,-.5),!0},dc.prototype.forEachLayerAtPixel=function(t,e,n,i){if(this.framebuffer){var r=[t[0]/e.size[0],(e.size[1]-t[1])/e.size[1]],o=Cs.apply(this.texCoordMatrix,r.slice()),a=[o[0]*this.framebufferDimension,o[1]*this.framebufferDimension],s=this.mapRenderer.getContext().getGL();s.bindFramebuffer(s.FRAMEBUFFER,this.framebuffer);var l=new Uint8Array(4);return s.readPixels(a[0],a[1],1,1,s.RGBA,s.UNSIGNED_BYTE,l),l[3]>0?n.call(i,this.getLayer(),l):void 0}};var fc=function(t,e){Xu.call(this,t,e),this.dirty_=!1,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=hs.createEmpty(),this.renderedRenderOrder_=null,this.replayGroup_=null,this.layerState_=null};ya.inherits(fc,Xu),fc.handles=function(t,e){return t===Zs.WEBGL&&e.getType()===Cl.VECTOR},fc.create=function(t,e){return new fc(t,e)},fc.prototype.composeFrame=function(t,e,n){this.layerState_=e;var i=t.viewState,r=this.replayGroup_,o=t.size,a=t.pixelRatio,s=this.mapRenderer.getGL();r&&!r.isEmpty()&&(s.enable(s.SCISSOR_TEST),s.scissor(0,0,o[0]*a,o[1]*a),r.replay(n,i.center,i.resolution,i.rotation,o,a,e.opacity,e.managed?t.skippedFeatureUids:{}),s.disable(s.SCISSOR_TEST))},fc.prototype.disposeInternal=function(){var t=this.replayGroup_;if(t){var e=this.mapRenderer.getContext();t.getDeleteResourcesFunction(e)(),this.replayGroup_=null}Xu.prototype.disposeInternal.call(this)},fc.prototype.forEachFeatureAtCoordinate=function(t,e,n,i,r){if(this.replayGroup_&&this.layerState_){var o=this.mapRenderer.getContext(),a=e.viewState,s=this.getLayer(),l=this.layerState_,u={};return this.replayGroup_.forEachFeatureAtCoordinate(t,o,a.center,a.resolution,a.rotation,e.size,e.pixelRatio,l.opacity,{},function(t){var e=ya.getUid(t).toString();if(!(e in u))return u[e]=!0,i.call(r,t,s)})}},fc.prototype.hasFeatureAtCoordinate=function(t,e){if(this.replayGroup_&&this.layerState_){var n=this.mapRenderer.getContext(),i=e.viewState,r=this.layerState_;return this.replayGroup_.hasFeatureAtCoordinate(t,n,i.center,i.resolution,i.rotation,e.size,e.pixelRatio,r.opacity,e.skippedFeatureUids)}return!1},fc.prototype.forEachLayerAtPixel=function(t,e,n,i){var r=Cs.apply(e.pixelToCoordinateTransform,t.slice());return this.hasFeatureAtCoordinate(r,e)?n.call(i,this.getLayer(),null):void 0},fc.prototype.handleStyleImageChange_=function(t){this.renderIfReadyAndVisible()},fc.prototype.prepareFrame=function(t,e,n){var i=this.getLayer(),r=i.getSource();this.updateLogos(t,r);var o=t.viewHints[rs.ANIMATING],a=t.viewHints[rs.INTERACTING],s=i.getUpdateWhileAnimating(),l=i.getUpdateWhileInteracting();if(!this.dirty_&&!s&&o||!l&&a)return!0;var u=t.extent,c=t.viewState,h=c.projection,d=c.resolution,f=t.pixelRatio,p=i.getRevision(),g=i.getRenderBuffer(),_=i.getRenderOrder();void 0===_&&(_=au.defaultOrder);var v=hs.buffer(u,g*d);if(!this.dirty_&&this.renderedResolution_==d&&this.renderedRevision_==p&&this.renderedRenderOrder_==_&&hs.containsExtent(this.renderedExtent_,v))return!0;this.replayGroup_&&t.postRenderFunctions.push(this.replayGroup_.getDeleteResourcesFunction(n)),this.dirty_=!1;var y=new Vu(au.getTolerance(d,f),v,i.getRenderBuffer());r.loadFeatures(v,d,h);var m=function(t){var e,n=t.getStyleFunction();if(n?e=n.call(t,d):(n=i.getStyleFunction())&&(e=n(t,d)),e){var r=this.renderFeature(t,d,f,e,y);this.dirty_=this.dirty_||r}};if(_){var x=[];r.forEachFeatureInExtent(v,function(t){x.push(t)},this),x.sort(_),x.forEach(m,this)}else r.forEachFeatureInExtent(v,m,this);return y.finish(n),this.renderedResolution_=d,this.renderedRevision_=p,this.renderedRenderOrder_=_,this.renderedExtent_=v,this.replayGroup_=y,!0},fc.prototype.renderFeature=function(t,e,n,i,r){if(!i)return!1;var o=!1;if(Array.isArray(i))for(var a=i.length-1;a>=0;--a)o=au.renderFeature(r,t,i[a],au.getSquaredTolerance(e,n),this.handleStyleImageChange_,this)||o;else o=au.renderFeature(r,t,i,au.getSquaredTolerance(e,n),this.handleStyleImageChange_,this)||o;return o},ya.ENABLE_CANVAS&&(qs.register(Ks.MAP_RENDERER,Bl),qs.registerMultiple(Ks.LAYER_RENDERER,[Nl,Xl,su,uu])),ya.ENABLE_WEBGL&&(qs.register(Ks.MAP_RENDERER,uc),qs.registerMultiple(Ks.LAYER_RENDERER,[lc,dc,fc]));var pc=function(t){(t=Ea.assign({},t)).controls||(t.controls=al.defaults()),t.interactions||(t.interactions=wl.defaults()),Js.call(this,t)};ya.inherits(pc,Js);var gc={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"},_c=function(t){var e=t||{},n=Ea.assign({},e);delete n.preload,delete n.useInterimTilesOnError,nl.call(this,n),this.setPreload(void 0!==e.preload?e.preload:0),this.setUseInterimTilesOnError(void 0===e.useInterimTilesOnError||e.useInterimTilesOnError),this.type=Cl.TILE};ya.inherits(_c,nl),_c.prototype.getPreload=function(){return this.get(gc.PRELOAD)},_c.prototype.getSource,_c.prototype.setPreload=function(t){this.set(gc.PRELOAD,t)},_c.prototype.getUseInterimTilesOnError=function(){return this.get(gc.USE_INTERIM_TILES_ON_ERROR)},_c.prototype.setUseInterimTilesOnError=function(t){this.set(gc.USE_INTERIM_TILES_ON_ERROR,t)};var vc=function(t){if(La.call(this),this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,Ta.listen(this,La.getChangeEventType(this.geometryName_),this.handleGeometryChanged_,this),void 0!==t)if(t instanceof bs||!t){var e=t;this.setGeometry(e)}else{var n=t;this.setProperties(n)}};ya.inherits(vc,La),vc.prototype.clone=function(){var t=new vc(this.getProperties());t.setGeometryName(this.getGeometryName());var e=this.getGeometry();e&&t.setGeometry(e.clone());var n=this.getStyle();return n&&t.setStyle(n),t},vc.prototype.getGeometry=function(){return this.get(this.geometryName_)},vc.prototype.getId=function(){return this.id_},vc.prototype.getGeometryName=function(){return this.geometryName_},vc.prototype.getStyle=function(){return this.style_},vc.prototype.getStyleFunction=function(){return this.styleFunction_},vc.prototype.handleGeometryChange_=function(){this.changed()},vc.prototype.handleGeometryChanged_=function(){this.geometryChangeKey_&&(Ta.unlistenByKey(this.geometryChangeKey_),this.geometryChangeKey_=null);var t=this.getGeometry();t&&(this.geometryChangeKey_=Ta.listen(t,Aa.CHANGE,this.handleGeometryChange_,this)),this.changed()},vc.prototype.setGeometry=function(t){this.set(this.geometryName_,t)},vc.prototype.setStyle=function(t){this.style_=t,this.styleFunction_=t?vc.createStyleFunction(t):void 0,this.changed()},vc.prototype.setId=function(t){this.id_=t,this.changed()},vc.prototype.setGeometryName=function(t){Ta.unlisten(this,La.getChangeEventType(this.geometryName_),this.handleGeometryChanged_,this),this.geometryName_=t,Ta.listen(this,La.getChangeEventType(this.geometryName_),this.handleGeometryChanged_,this),this.handleGeometryChanged_()},vc.createStyleFunction=function(t){var e;if("function"==typeof t)e=2==t.length?function(e){return t(this,e)}:t;else{var n;Array.isArray(t)?n=t:(Qa.assert(t instanceof ac,41),n=[t]),e=function(){return n}}return e};var yc=function(t){var e=t||{},n=Ea.assign({},e);delete n.style,delete n.renderBuffer,delete n.updateWhileAnimating,delete n.updateWhileInteracting,nl.call(this,n),this.declutter_=void 0!==e.declutter&&e.declutter,this.renderBuffer_=void 0!==e.renderBuffer?e.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(e.style),this.updateWhileAnimating_=void 0!==e.updateWhileAnimating&&e.updateWhileAnimating,this.updateWhileInteracting_=void 0!==e.updateWhileInteracting&&e.updateWhileInteracting,this.type=Cl.VECTOR};ya.inherits(yc,nl),yc.prototype.getDeclutter=function(){return this.declutter_},yc.prototype.setDeclutter=function(t){this.declutter_=t},yc.prototype.getRenderBuffer=function(){return this.renderBuffer_},yc.prototype.getRenderOrder=function(){return this.get(yc.Property_.RENDER_ORDER)},yc.prototype.getSource,yc.prototype.getStyle=function(){return this.style_},yc.prototype.getStyleFunction=function(){return this.styleFunction_},yc.prototype.getUpdateWhileAnimating=function(){return this.updateWhileAnimating_},yc.prototype.getUpdateWhileInteracting=function(){return this.updateWhileInteracting_},yc.prototype.setRenderOrder=function(t){this.set(yc.Property_.RENDER_ORDER,t)},yc.prototype.setStyle=function(t){this.style_=void 0!==t?t:ac.defaultFunction,this.styleFunction_=null===t?void 0:ac.createFunction(this.style_),this.changed()},yc.Property_={RENDER_ORDER:"renderOrder"};var mc={FRACTION:"fraction",PIXELS:"pixels"},xc=function(t,e,n,i,r,o){ba.call(this),this.hitDetectionImage_=null,this.image_=t||new Image,null!==i&&(this.image_.crossOrigin=i),this.canvas_=o?document.createElement("CANVAS"):null,this.color_=o,this.imageListenerKeys_=null,this.imageState_=r,this.size_=n,this.src_=e,this.tainting_=!1,this.imageState_==Ol.LOADED&&this.determineTainting_()};ya.inherits(xc,ba),xc.get=function(t,e,n,i,r,o){var a=Vl.iconImageCache,s=a.get(e,i,o);return s||(s=new xc(t,e,n,i,r,o),a.set(e,i,o,s)),s},xc.prototype.determineTainting_=function(){var t=Xs.createCanvasContext2D(1,1);try{t.drawImage(this.image_,0,0),t.getImageData(0,0,1,1)}catch(t){this.tainting_=!0}},xc.prototype.dispatchChangeEvent_=function(){this.dispatchEvent(Aa.CHANGE)},xc.prototype.handleImageError_=function(){this.imageState_=Ol.ERROR,this.unlistenImage_(),this.dispatchChangeEvent_()},xc.prototype.handleImageLoad_=function(){this.imageState_=Ol.LOADED,this.size_&&(this.image_.width=this.size_[0],this.image_.height=this.size_[1]),this.size_=[this.image_.width,this.image_.height],this.unlistenImage_(),this.determineTainting_(),this.replaceColor_(),this.dispatchChangeEvent_()},xc.prototype.getImage=function(t){return this.canvas_?this.canvas_:this.image_},xc.prototype.getImageState=function(){return this.imageState_},xc.prototype.getHitDetectionImage=function(t){if(!this.hitDetectionImage_)if(this.tainting_){var e=this.size_[0],n=this.size_[1],i=Xs.createCanvasContext2D(e,n);i.fillRect(0,0,e,n),this.hitDetectionImage_=i.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_},xc.prototype.getSize=function(){return this.size_},xc.prototype.getSrc=function(){return this.src_},xc.prototype.load=function(){if(this.imageState_==Ol.IDLE){this.imageState_=Ol.LOADING,this.imageListenerKeys_=[Ta.listenOnce(this.image_,Aa.ERROR,this.handleImageError_,this),Ta.listenOnce(this.image_,Aa.LOAD,this.handleImageLoad_,this)];try{this.image_.src=this.src_}catch(t){this.handleImageError_()}}},xc.prototype.replaceColor_=function(){if(!this.tainting_&&null!==this.color_){this.canvas_.width=this.image_.width,this.canvas_.height=this.image_.height;var t=this.canvas_.getContext("2d");t.drawImage(this.image_,0,0);for(var e=t.getImageData(0,0,this.image_.width,this.image_.height),n=e.data,i=this.color_[0]/255,r=this.color_[1]/255,o=this.color_[2]/255,a=0,s=n.length;a<s;a+=4)n[a]*=i,n[a+1]*=r,n[a+2]*=o;t.putImageData(e,0,0)}},xc.prototype.unlistenImage_=function(){this.imageListenerKeys_.forEach(Ta.unlistenByKey),this.imageListenerKeys_=null};var Sc={BOTTOM_LEFT:"bottom-left",BOTTOM_RIGHT:"bottom-right",TOP_LEFT:"top-left",TOP_RIGHT:"top-right"},Ec=function(t){var e=t||{};this.anchor_=void 0!==e.anchor?e.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=void 0!==e.anchorOrigin?e.anchorOrigin:Sc.TOP_LEFT,this.anchorXUnits_=void 0!==e.anchorXUnits?e.anchorXUnits:mc.FRACTION,this.anchorYUnits_=void 0!==e.anchorYUnits?e.anchorYUnits:mc.FRACTION,this.crossOrigin_=void 0!==e.crossOrigin?e.crossOrigin:null;var n=void 0!==e.img?e.img:null,i=void 0!==e.imgSize?e.imgSize:null,r=e.src;Qa.assert(!(void 0!==r&&n),4),Qa.assert(!n||n&&i,5),void 0!==r&&0!==r.length||!n||(r=n.src||ya.getUid(n).toString()),Qa.assert(void 0!==r&&r.length>0,6);var o=void 0!==e.src?Ol.IDLE:Ol.LOADED;this.color_=void 0!==e.color?Ll.asArray(e.color):null,this.iconImage_=xc.get(n,r,i,this.crossOrigin_,o,this.color_),this.offset_=void 0!==e.offset?e.offset:[0,0],this.offsetOrigin_=void 0!==e.offsetOrigin?e.offsetOrigin:Sc.TOP_LEFT,this.origin_=null,this.size_=void 0!==e.size?e.size:null,nc.call(this,{opacity:void 0!==e.opacity?e.opacity:1,rotation:void 0!==e.rotation?e.rotation:0,scale:void 0!==e.scale?e.scale:1,snapToPixel:void 0===e.snapToPixel||e.snapToPixel,rotateWithView:void 0!==e.rotateWithView&&e.rotateWithView})};ya.inherits(Ec,nc),Ec.prototype.clone=function(){return new Ec({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,crossOrigin:this.crossOrigin_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,src:this.getSrc(),offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,size:null!==this.size_?this.size_.slice():void 0,opacity:this.getOpacity(),scale:this.getScale(),snapToPixel:this.getSnapToPixel(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView()})},Ec.prototype.getAnchor=function(){if(this.normalizedAnchor_)return this.normalizedAnchor_;var t=this.anchor_,e=this.getSize();if(this.anchorXUnits_==mc.FRACTION||this.anchorYUnits_==mc.FRACTION){if(!e)return null;t=this.anchor_.slice(),this.anchorXUnits_==mc.FRACTION&&(t[0]*=e[0]),this.anchorYUnits_==mc.FRACTION&&(t[1]*=e[1])}if(this.anchorOrigin_!=Sc.TOP_LEFT){if(!e)return null;t===this.anchor_&&(t=this.anchor_.slice()),this.anchorOrigin_!=Sc.TOP_RIGHT&&this.anchorOrigin_!=Sc.BOTTOM_RIGHT||(t[0]=-t[0]+e[0]),this.anchorOrigin_!=Sc.BOTTOM_LEFT&&this.anchorOrigin_!=Sc.BOTTOM_RIGHT||(t[1]=-t[1]+e[1])}return this.normalizedAnchor_=t,this.normalizedAnchor_},Ec.prototype.getColor=function(){return this.color_},Ec.prototype.getImage=function(t){return this.iconImage_.getImage(t)},Ec.prototype.getImageSize=function(){return this.iconImage_.getSize()},Ec.prototype.getHitDetectionImageSize=function(){return this.getImageSize()},Ec.prototype.getImageState=function(){return this.iconImage_.getImageState()},Ec.prototype.getHitDetectionImage=function(t){return this.iconImage_.getHitDetectionImage(t)},Ec.prototype.getOrigin=function(){if(this.origin_)return this.origin_;var t=this.offset_;if(this.offsetOrigin_!=Sc.TOP_LEFT){var e=this.getSize(),n=this.iconImage_.getSize();if(!e||!n)return null;t=t.slice(),this.offsetOrigin_!=Sc.TOP_RIGHT&&this.offsetOrigin_!=Sc.BOTTOM_RIGHT||(t[0]=n[0]-e[0]-t[0]),this.offsetOrigin_!=Sc.BOTTOM_LEFT&&this.offsetOrigin_!=Sc.BOTTOM_RIGHT||(t[1]=n[1]-e[1]-t[1])}return this.origin_=t,this.origin_},Ec.prototype.getSrc=function(){return this.iconImage_.getSrc()},Ec.prototype.getSize=function(){return this.size_?this.size_:this.iconImage_.getSize()},Ec.prototype.listenImageChange=function(t,e){return Ta.listen(this.iconImage_,Aa.CHANGE,t,e)},Ec.prototype.load=function(){this.iconImage_.load()},Ec.prototype.unlistenImageChange=function(t,e){Ta.unlisten(this.iconImage_,Aa.CHANGE,t,e)};var Tc=function(t){var e=t||{},n=Ea.assign({},e);delete n.gradient,delete n.radius,delete n.blur,delete n.shadow,delete n.weight,yc.call(this,n),this.gradient_=null,this.shadow_=void 0!==e.shadow?e.shadow:250,this.circleImage_=void 0,this.styleCache_=null,Ta.listen(this,La.getChangeEventType(Tc.Property_.GRADIENT),this.handleGradientChanged_,this),this.setGradient(e.gradient?e.gradient:Tc.DEFAULT_GRADIENT),this.setBlur(void 0!==e.blur?e.blur:15),this.setRadius(void 0!==e.radius?e.radius:8),Ta.listen(this,La.getChangeEventType(Tc.Property_.BLUR),this.handleStyleChanged_,this),Ta.listen(this,La.getChangeEventType(Tc.Property_.RADIUS),this.handleStyleChanged_,this),this.handleStyleChanged_();var i,r=e.weight?e.weight:"weight";i="string"==typeof r?function(t){return t.get(r)}:r,this.setStyle(function(t,e){var n=i(t),r=void 0!==n?ts.clamp(n,0,1):1,o=255*r|0,a=this.styleCache_[o];return a||(a=[new ac({image:new Ec({opacity:r,src:this.circleImage_})})],this.styleCache_[o]=a),a}.bind(this)),this.setRenderOrder(null),Ta.listen(this,el.RENDER,this.handleRender_,this)};ya.inherits(Tc,yc),Tc.DEFAULT_GRADIENT=["#00f","#0ff","#0f0","#ff0","#f00"],Tc.createGradient_=function(t){for(var e=Xs.createCanvasContext2D(1,256),n=e.createLinearGradient(0,0,1,256),i=1/(t.length-1),r=0,o=t.length;r<o;++r)n.addColorStop(r*i,t[r]);return e.fillStyle=n,e.fillRect(0,0,1,256),e.getImageData(0,0,1,256).data},Tc.prototype.createCircle_=function(){var t=this.getRadius(),e=this.getBlur(),n=t+e+1,i=2*n,r=Xs.createCanvasContext2D(i,i);r.shadowOffsetX=r.shadowOffsetY=this.shadow_,r.shadowBlur=e,r.shadowColor="#000",r.beginPath();var o=n-this.shadow_;return r.arc(o,o,t,0,2*Math.PI,!0),r.fill(),r.canvas.toDataURL()},Tc.prototype.getBlur=function(){return this.get(Tc.Property_.BLUR)},Tc.prototype.getGradient=function(){return this.get(Tc.Property_.GRADIENT)},Tc.prototype.getRadius=function(){return this.get(Tc.Property_.RADIUS)},Tc.prototype.handleGradientChanged_=function(){this.gradient_=Tc.createGradient_(this.getGradient())},Tc.prototype.handleStyleChanged_=function(){this.circleImage_=this.createCircle_(),this.styleCache_=new Array(256),this.changed()},Tc.prototype.handleRender_=function(t){var e,n,i,r=t.context,o=r.canvas,a=r.getImageData(0,0,o.width,o.height),s=a.data;for(e=0,n=s.length;e<n;e+=4)(i=4*s[e+3])&&(s[e]=this.gradient_[i],s[e+1]=this.gradient_[i+1],s[e+2]=this.gradient_[i+2]);r.putImageData(a,0,0)},Tc.prototype.setBlur=function(t){this.set(Tc.Property_.BLUR,t)},Tc.prototype.setGradient=function(t){this.set(Tc.Property_.GRADIENT,t)},Tc.prototype.setRadius=function(t){this.set(Tc.Property_.RADIUS,t)},Tc.Property_={BLUR:"blur",GRADIENT:"gradient",RADIUS:"radius"};var wc={ARRAY_BUFFER:"arraybuffer",JSON:"json",TEXT:"text",XML:"xml"},Cc={};Cc.DOCUMENT=document.implementation.createDocument("","",null),Cc.createElementNS=function(t,e){return Cc.DOCUMENT.createElementNS(t,e)},Cc.getAllTextContent=function(t,e){return Cc.getAllTextContent_(t,e,[]).join("")},Cc.getAllTextContent_=function(t,e,n){if(t.nodeType==Node.CDATA_SECTION_NODE||t.nodeType==Node.TEXT_NODE)e?n.push(String(t.nodeValue).replace(/(\r\n|\r|\n)/g,"")):n.push(t.nodeValue);else{var i;for(i=t.firstChild;i;i=i.nextSibling)Cc.getAllTextContent_(i,e,n)}return n},Cc.isDocument=function(t){return t instanceof Document},Cc.isNode=function(t){return t instanceof Node},Cc.getAttributeNS=function(t,e,n){return t.getAttributeNS(e,n)||""},Cc.setAttributeNS=function(t,e,n,i){t.setAttributeNS(e,n,i)},Cc.parse=function(t){return(new DOMParser).parseFromString(t,"application/xml")},Cc.makeArrayExtender=function(t,e){return function(n,i){var r=t.call(e,n,i);if(void 0!==r){var o=i[i.length-1];Ha.extend(o,r)}}},Cc.makeArrayPusher=function(t,e){return function(n,i){var r=t.call(void 0!==e?e:this,n,i);void 0!==r&&i[i.length-1].push(r)}},Cc.makeReplacer=function(t,e){return function(n,i){var r=t.call(void 0!==e?e:this,n,i);void 0!==r&&(i[i.length-1]=r)}},Cc.makeObjectPropertyPusher=function(t,e,n){return function(i,r){var o=t.call(void 0!==n?n:this,i,r);if(void 0!==o){var a=r[r.length-1],s=void 0!==e?e:i.localName;(s in a?a[s]:a[s]=[]).push(o)}}},Cc.makeObjectPropertySetter=function(t,e,n){return function(i,r){var o=t.call(void 0!==n?n:this,i,r);void 0!==o&&(r[r.length-1][void 0!==e?e:i.localName]=o)}},Cc.makeChildAppender=function(t,e){return function(n,i,r){t.call(void 0!==e?e:this,n,i,r),r[r.length-1].node.appendChild(n)}},Cc.makeArraySerializer=function(t,e){var n,i;return function(e,r,o){if(void 0===n){n={};var a={};a[e.localName]=t,n[e.namespaceURI]=a,i=Cc.makeSimpleNodeFactory(e.localName)}Cc.serialize(n,i,r,o)}},Cc.makeSimpleNodeFactory=function(t,e){var n=t;return function(t,i,r){var o=i[i.length-1].node,a=n;void 0===a&&(a=r);var s=e;return void 0===e&&(s=o.namespaceURI),Cc.createElementNS(s,a)}},Cc.OBJECT_PROPERTY_NODE_FACTORY=Cc.makeSimpleNodeFactory(),Cc.makeSequence=function(t,e){for(var n=e.length,i=new Array(n),r=0;r<n;++r)i[r]=t[e[r]];return i},Cc.makeStructureNS=function(t,e,n){var i,r,o=void 0!==n?n:{};for(i=0,r=t.length;i<r;++i)o[t[i]]=e;return o},Cc.parseNode=function(t,e,n,i){var r;for(r=e.firstElementChild;r;r=r.nextElementSibling){var o=t[r.namespaceURI];if(void 0!==o){var a=o[r.localName];void 0!==a&&a.call(i,r,n)}}},Cc.pushParseAndPop=function(t,e,n,i,r){return i.push(t),Cc.parseNode(e,n,i,r),i.pop()},Cc.serialize=function(t,e,n,i,r,o){for(var a,s,l=(void 0!==r?r:n).length,u=0;u<l;++u)void 0!==(a=n[u])&&void 0!==(s=e.call(o,a,i,void 0!==r?r[u]:void 0))&&t[s.namespaceURI][s.localName].call(o,s,a,i)},Cc.pushSerializeAndPop=function(t,e,n,i,r,o,a){return r.push(t),Cc.serialize(e,n,i,r,o,a),r.pop()};var bc={};bc.loadFeaturesXhr=function(t,e,n,i){return function(r,o,a){var s=new XMLHttpRequest;s.open("GET","function"==typeof t?t(r,o,a):t,!0),e.getType()==wc.ARRAY_BUFFER&&(s.responseType="arraybuffer"),s.onload=function(t){if(!s.status||s.status>=200&&s.status<300){var r,o=e.getType();o==wc.JSON||o==wc.TEXT?r=s.responseText:o==wc.XML?(r=s.responseXML)||(r=Cc.parse(s.responseText)):o==wc.ARRAY_BUFFER&&(r=s.response),r?n.call(this,e.readFeatures(r,{featureProjection:a}),e.readProjection(r),e.getLastExtent()):i.call(this)}else i.call(this)}.bind(this),s.onerror=function(){i.call(this)}.bind(this),s.send()}},bc.xhr=function(t,e){return bc.loadFeaturesXhr(t,e,function(t,e){this.addFeatures(t)},ya.nullFunction)};var Ac={};Ac.all=function(t,e){return[[-1/0,-1/0,1/0,1/0]]},Ac.bbox=function(t,e){return[t]},Ac.tile=function(t){return function(e,n){var i=t.getZForResolution(n),r=t.getTileRangeForExtentAndZ(e,i),o=[],a=[i,0,0];for(a[1]=r.minX;a[1]<=r.maxX;++a[1])for(a[2]=r.minY;a[2]<=r.maxY;++a[2])o.push(t.getTileCoordExtent(a));return o}};var Rc={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature"},Lc=function(t){var e=t||{};$u.call(this,{attributions:e.attributions,logo:e.logo,projection:void 0,state:Ys.READY,wrapX:void 0===e.wrapX||e.wrapX}),this.loader_=ya.nullFunction,this.format_=e.format,this.overlaps_=void 0==e.overlaps||e.overlaps,this.url_=e.url,void 0!==e.loader?this.loader_=e.loader:void 0!==this.url_&&(Qa.assert(this.format_,7),this.loader_=bc.xhr(this.url_,this.format_)),this.strategy_=void 0!==e.strategy?e.strategy:Ac.all;var n=void 0===e.useSpatialIndex||e.useSpatialIndex;this.featuresRtree_=n?new Du:null,this.loadedExtentsRtree_=new Du,this.nullGeometryFeatures_={},this.idIndex_={},this.undefIdIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null;var i,r;e.features instanceof Ia?r=(i=e.features).getArray():Array.isArray(e.features)&&(r=e.features),n||void 0!==i||(i=new Ia(r)),void 0!==r&&this.addFeaturesInternal(r),void 0!==i&&this.bindFeaturesCollection_(i)};ya.inherits(Lc,$u),Lc.prototype.addFeature=function(t){this.addFeatureInternal(t),this.changed()},Lc.prototype.addFeatureInternal=function(t){var e=ya.getUid(t).toString();if(this.addToIndex_(e,t)){this.setupChangeEvents_(e,t);var n=t.getGeometry();if(n){var i=n.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(i,t)}else this.nullGeometryFeatures_[e]=t;this.dispatchEvent(new Lc.Event(Rc.ADDFEATURE,t))}},Lc.prototype.setupChangeEvents_=function(t,e){this.featureChangeKeys_[t]=[Ta.listen(e,Aa.CHANGE,this.handleFeatureChange_,this),Ta.listen(e,Sa.PROPERTYCHANGE,this.handleFeatureChange_,this)]},Lc.prototype.addToIndex_=function(t,e){var n=!0,i=e.getId();return void 0!==i?i.toString()in this.idIndex_?n=!1:this.idIndex_[i.toString()]=e:(Qa.assert(!(t in this.undefIdIndex_),30),this.undefIdIndex_[t]=e),n},Lc.prototype.addFeatures=function(t){this.addFeaturesInternal(t),this.changed()},Lc.prototype.addFeaturesInternal=function(t){var e,n,i,r,o=[],a=[],s=[];for(n=0,i=t.length;n<i;n++)r=t[n],e=ya.getUid(r).toString(),this.addToIndex_(e,r)&&a.push(r);for(n=0,i=a.length;n<i;n++){r=a[n],e=ya.getUid(r).toString(),this.setupChangeEvents_(e,r);var l=r.getGeometry();if(l){var u=l.getExtent();o.push(u),s.push(r)}else this.nullGeometryFeatures_[e]=r}for(this.featuresRtree_&&this.featuresRtree_.load(o,s),n=0,i=a.length;n<i;n++)this.dispatchEvent(new Lc.Event(Rc.ADDFEATURE,a[n]))},Lc.prototype.bindFeaturesCollection_=function(t){var e=!1;Ta.listen(this,Rc.ADDFEATURE,function(n){e||(e=!0,t.push(n.feature),e=!1)}),Ta.listen(this,Rc.REMOVEFEATURE,function(n){e||(e=!0,t.remove(n.feature),e=!1)}),Ta.listen(t,xa.ADD,function(t){e||(e=!0,this.addFeature(t.element),e=!1)},this),Ta.listen(t,xa.REMOVE,function(t){e||(e=!0,this.removeFeature(t.element),e=!1)},this),this.featuresCollection_=t},Lc.prototype.clear=function(t){if(t){for(var e in this.featureChangeKeys_)this.featureChangeKeys_[e].forEach(Ta.unlistenByKey);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.undefIdIndex_={})}else if(this.featuresRtree_){this.featuresRtree_.forEach(this.removeFeatureInternal,this);for(var n in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[n])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.loadedExtentsRtree_.clear(),this.nullGeometryFeatures_={};var i=new Lc.Event(Rc.CLEAR);this.dispatchEvent(i),this.changed()},Lc.prototype.forEachFeature=function(t,e){return this.featuresRtree_?this.featuresRtree_.forEach(t,e):this.featuresCollection_?this.featuresCollection_.forEach(t,e):void 0},Lc.prototype.forEachFeatureAtCoordinateDirect=function(t,e,n){var i=[t[0],t[1],t[0],t[1]];return this.forEachFeatureInExtent(i,function(i){return i.getGeometry().intersectsCoordinate(t)?e.call(n,i):void 0})},Lc.prototype.forEachFeatureInExtent=function(t,e,n){return this.featuresRtree_?this.featuresRtree_.forEachInExtent(t,e,n):this.featuresCollection_?this.featuresCollection_.forEach(e,n):void 0},Lc.prototype.forEachFeatureIntersectingExtent=function(t,e,n){return this.forEachFeatureInExtent(t,function(i){if(i.getGeometry().intersectsExtent(t)){var r=e.call(n,i);if(r)return r}})},Lc.prototype.getFeaturesCollection=function(){return this.featuresCollection_},Lc.prototype.getFeatures=function(){var t;return this.featuresCollection_?t=this.featuresCollection_.getArray():this.featuresRtree_&&(t=this.featuresRtree_.getAll(),Ea.isEmpty(this.nullGeometryFeatures_)||Ha.extend(t,Ea.getValues(this.nullGeometryFeatures_))),t},Lc.prototype.getFeaturesAtCoordinate=function(t){var e=[];return this.forEachFeatureAtCoordinateDirect(t,function(t){e.push(t)}),e},Lc.prototype.getFeaturesInExtent=function(t){return this.featuresRtree_.getInExtent(t)},Lc.prototype.getClosestFeatureToCoordinate=function(t,e){var n=t[0],i=t[1],r=null,o=[NaN,NaN],a=1/0,s=[-1/0,-1/0,1/0,1/0],l=e||ps.TRUE;return this.featuresRtree_.forEachInExtent(s,function(t){if(l(t)){var e=t.getGeometry(),u=a;if((a=e.closestPointXY(n,i,o,a))<u){r=t;var c=Math.sqrt(a);s[0]=n-c,s[1]=i-c,s[2]=n+c,s[3]=i+c}}}),r},Lc.prototype.getExtent=function(t){return this.featuresRtree_.getExtent(t)},Lc.prototype.getFeatureById=function(t){var e=this.idIndex_[t.toString()];return void 0!==e?e:null},Lc.prototype.getFormat=function(){return this.format_},Lc.prototype.getOverlaps=function(){return this.overlaps_},Lc.prototype.getResolutions=function(){},Lc.prototype.getUrl=function(){return this.url_},Lc.prototype.handleFeatureChange_=function(t){var e=t.target,n=ya.getUid(e).toString(),i=e.getGeometry();if(i){var r=i.getExtent();n in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[n],this.featuresRtree_&&this.featuresRtree_.insert(r,e)):this.featuresRtree_&&this.featuresRtree_.update(r,e)}else n in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(e),this.nullGeometryFeatures_[n]=e);var o=e.getId();if(void 0!==o){var a=o.toString();n in this.undefIdIndex_?(delete this.undefIdIndex_[n],this.idIndex_[a]=e):this.idIndex_[a]!==e&&(this.removeFromIdIndex_(e),this.idIndex_[a]=e)}else n in this.undefIdIndex_||(this.removeFromIdIndex_(e),this.undefIdIndex_[n]=e);this.changed(),this.dispatchEvent(new Lc.Event(Rc.CHANGEFEATURE,e))},Lc.prototype.isEmpty=function(){return this.featuresRtree_.isEmpty()&&Ea.isEmpty(this.nullGeometryFeatures_)},Lc.prototype.loadFeatures=function(t,e,n){var i,r,o=this.loadedExtentsRtree_,a=this.strategy_(t,e);for(i=0,r=a.length;i<r;++i){var s=a[i];o.forEachInExtent(s,function(t){return hs.containsExtent(t.extent,s)})||(this.loader_.call(this,s,e,n),o.insert(s,{extent:s.slice()}))}},Lc.prototype.removeFeature=function(t){var e=ya.getUid(t).toString();e in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[e]:this.featuresRtree_&&this.featuresRtree_.remove(t),this.removeFeatureInternal(t),this.changed()},Lc.prototype.removeFeatureInternal=function(t){var e=ya.getUid(t).toString();this.featureChangeKeys_[e].forEach(Ta.unlistenByKey),delete this.featureChangeKeys_[e];var n=t.getId();void 0!==n?delete this.idIndex_[n.toString()]:delete this.undefIdIndex_[e],this.dispatchEvent(new Lc.Event(Rc.REMOVEFEATURE,t))},Lc.prototype.removeFromIdIndex_=function(t){var e=!1;for(var n in this.idIndex_)if(this.idIndex_[n]===t){delete this.idIndex_[n],e=!0;break}return e},Lc.prototype.setLoader=function(t){this.loader_=t},Lc.Event=function(t,e){Ca.call(this,t),this.feature=e},ya.inherits(Lc.Event,Ca);var Ic=function(t,e){As.call(this),this.setCoordinates(t,e)};ya.inherits(Ic,As),Ic.prototype.appendPoint=function(t){this.flatCoordinates?Ha.extend(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.changed()},Ic.prototype.clone=function(){var t=new Ic(null);return t.setFlatCoordinates(this.layout,this.flatCoordinates.slice()),t},Ic.prototype.closestPointXY=function(t,e,n,i){if(i<hs.closestSquaredDistanceXY(this.getExtent(),t,e))return i;var r,o,a,s=this.flatCoordinates,l=this.stride;for(r=0,o=s.length;r<o;r+=l){var u=ts.squaredDistance(t,e,s[r],s[r+1]);if(u<i){for(i=u,a=0;a<l;++a)n[a]=s[r+a];n.length=l}}return i},Ic.prototype.getCoordinates=function(){return Ps.coordinates(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)},Ic.prototype.getPoint=function(t){var e=this.flatCoordinates?this.flatCoordinates.length/this.stride:0;if(t<0||e<=t)return null;var n=new Ds(null);return n.setFlatCoordinates(this.layout,this.flatCoordinates.slice(t*this.stride,(t+1)*this.stride)),n},Ic.prototype.getPoints=function(){var t,e,n=this.flatCoordinates,i=this.layout,r=this.stride,o=[];for(t=0,e=n.length;t<e;t+=r){var a=new Ds(null);a.setFlatCoordinates(i,n.slice(t,t+r)),o.push(a)}return o},Ic.prototype.getType=function(){return ds.MULTI_POINT},Ic.prototype.intersectsExtent=function(t){var e,n,i,r,o=this.flatCoordinates,a=this.stride;for(e=0,n=o.length;e<n;e+=a)if(i=o[e],r=o[e+1],hs.containsXY(t,i,r))return!0;return!1},Ic.prototype.setCoordinates=function(t,e){t?(this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Is.coordinates(this.flatCoordinates,0,t,this.stride),this.changed()):this.setFlatCoordinates(fs.XY,null)},Ic.prototype.setFlatCoordinates=function(t,e){this.setFlatCoordinatesInternal(t,e),this.changed()};var Pc=function(t,e,n){ba.call(this);var i=n||{};this.tileCoord=t,this.state=e,this.interimTile=null,this.key="",this.transition_=void 0===i.transition?250:i.transition,this.transitionStarts_={}};ya.inherits(Pc,ba),Pc.prototype.changed=function(){this.dispatchEvent(Aa.CHANGE)},Pc.prototype.getKey=function(){return this.key+"/"+this.tileCoord},Pc.prototype.getInterimTile=function(){if(!this.interimTile)return this;var t=this.interimTile;do{if(t.getState()==Za.LOADED)return t;t=t.interimTile}while(t);return this},Pc.prototype.refreshInterimChain=function(){if(this.interimTile){var t=this.interimTile,e=this;do{if(t.getState()==Za.LOADED){t.interimTile=null;break}t.getState()==Za.LOADING?e=t:t.getState()==Za.IDLE?e.interimTile=t.interimTile:e=t,t=e.interimTile}while(t)}},Pc.prototype.getTileCoord=function(){return this.tileCoord},Pc.prototype.getState=function(){return this.state},Pc.prototype.setState=function(t){this.state=t,this.changed()},Pc.prototype.load=function(){},Pc.prototype.getAlpha=function(t,e){if(!this.transition_)return 1;var n=this.transitionStarts_[t];if(n){if(-1===n)return 1}else n=e,this.transitionStarts_[t]=n;var i=e-n+1e3/60;return i>=this.transition_?1:ls.easeIn(i/this.transition_)},Pc.prototype.inTransition=function(t){return!!this.transition_&&-1!==this.transitionStarts_[t]},Pc.prototype.endTransition=function(t){this.transition_&&(this.transitionStarts_[t]=-1)};var Mc=function(t,e,n,i,r,o){Pc.call(this,t,e,o),this.src_=n,this.image_=new Image,null!==i&&(this.image_.crossOrigin=i),this.imageListenerKeys_=null,this.tileLoadFunction_=r};ya.inherits(Mc,Pc),Mc.prototype.disposeInternal=function(){this.state==Za.LOADING&&(this.unlistenImage_(),this.image_=Mc.getBlankImage()),this.interimTile&&this.interimTile.dispose(),this.state=Za.ABORT,this.changed(),Pc.prototype.disposeInternal.call(this)},Mc.prototype.getImage=function(){return this.image_},Mc.prototype.getKey=function(){return this.src_},Mc.prototype.handleImageError_=function(){this.state=Za.ERROR,this.unlistenImage_(),this.image_=Mc.getBlankImage(),this.changed()},Mc.prototype.handleImageLoad_=function(){this.image_.naturalWidth&&this.image_.naturalHeight?this.state=Za.LOADED:this.state=Za.EMPTY,this.unlistenImage_(),this.changed()},Mc.prototype.load=function(){this.state!=Za.IDLE&&this.state!=Za.ERROR||(this.state=Za.LOADING,this.changed(),this.imageListenerKeys_=[Ta.listenOnce(this.image_,Aa.ERROR,this.handleImageError_,this),Ta.listenOnce(this.image_,Aa.LOAD,this.handleImageLoad_,this)],this.tileLoadFunction_(this,this.src_))},Mc.prototype.unlistenImage_=function(){this.imageListenerKeys_.forEach(Ta.unlistenByKey),this.imageListenerKeys_=null},Mc.getBlankImage=function(){var t=Xs.createCanvasContext2D(1,1);return t.fillStyle="rgba(0,0,0,0)",t.fillRect(0,0,1,1),t.canvas};var Oc=function(t){Al.call(this,t)};ya.inherits(Oc,Al),Oc.prototype.expireCache=function(t){for(var e,n;this.canExpireCache()&&(e=this.peekLast(),!((n=e.tileCoord[0].toString())in t&&t[n].contains(e.tileCoord)));)this.pop().dispose()},Oc.prototype.pruneExceptNewestZ=function(){if(0!==this.getCount()){var t=this.peekFirstKey(),e=qu.fromKey(t)[0];this.forEach(function(t){t.tileCoord[0]!==e&&(this.remove(qu.getKey(t.tileCoord)),t.dispose())},this)}};var Dc=function(t,e,n,i,r,o,a,s,l,u,c){Pc.call(this,r,Za.IDLE),this.renderEdges_=void 0!==c&&c,this.pixelRatio_=a,this.gutter_=s,this.canvas_=null,this.sourceTileGrid_=e,this.targetTileGrid_=i,this.wrappedTileCoord_=o||r,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0;var h=i.getTileCoordExtent(this.wrappedTileCoord_),d=this.targetTileGrid_.getExtent(),f=this.sourceTileGrid_.getExtent(),p=d?hs.getIntersection(h,d):h;if(0!==hs.getArea(p)){var g=t.getExtent();g&&(f=f?hs.getIntersection(f,g):g);var _=i.getResolution(this.wrappedTileCoord_[0]),v=hs.getCenter(p),y=Yu.calculateSourceResolution(t,n,v,_);if(!isFinite(y)||y<=0)this.state=Za.EMPTY;else{var m=void 0!==u?u:ya.DEFAULT_RASTER_REPROJECTION_ERROR_THRESHOLD;if(this.triangulation_=new ju(t,n,p,f,y*m),0!==this.triangulation_.getTriangles().length){this.sourceZ_=e.getZForResolution(y);var x=this.triangulation_.calculateSourceExtent();if(f&&(t.canWrapX()?(x[1]=ts.clamp(x[1],f[1],f[3]),x[3]=ts.clamp(x[3],f[1],f[3])):x=hs.getIntersection(x,f)),hs.getArea(x)){for(var S=e.getTileRangeForExtentAndZ(x,this.sourceZ_),E=S.minX;E<=S.maxX;E++)for(var T=S.minY;T<=S.maxY;T++){var w=l(this.sourceZ_,E,T,a);w&&this.sourceTiles_.push(w)}0===this.sourceTiles_.length&&(this.state=Za.EMPTY)}else this.state=Za.EMPTY}else this.state=Za.EMPTY}}else this.state=Za.EMPTY};ya.inherits(Dc,Pc),Dc.prototype.disposeInternal=function(){this.state==Za.LOADING&&this.unlistenSources_(),Pc.prototype.disposeInternal.call(this)},Dc.prototype.getImage=function(){return this.canvas_},Dc.prototype.reproject_=function(){var t=[];if(this.sourceTiles_.forEach(function(e,n,i){e&&e.getState()==Za.LOADED&&t.push({extent:this.sourceTileGrid_.getTileCoordExtent(e.tileCoord),image:e.getImage()})},this),this.sourceTiles_.length=0,0===t.length)this.state=Za.ERROR;else{var e=this.wrappedTileCoord_[0],n=this.targetTileGrid_.getTileSize(e),i="number"==typeof n?n:n[0],r="number"==typeof n?n:n[1],o=this.targetTileGrid_.getResolution(e),a=this.sourceTileGrid_.getResolution(this.sourceZ_),s=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=Yu.render(i,r,this.pixelRatio_,a,this.sourceTileGrid_.getExtent(),o,s,this.triangulation_,t,this.gutter_,this.renderEdges_),this.state=Za.LOADED}this.changed()},Dc.prototype.load=function(){if(this.state==Za.IDLE){this.state=Za.LOADING,this.changed();var t=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(function(e,n,i){var r=e.getState();if(r==Za.IDLE||r==Za.LOADING){t++;var o;o=Ta.listen(e,Aa.CHANGE,function(n){var i=e.getState();i!=Za.LOADED&&i!=Za.ERROR&&i!=Za.EMPTY||(Ta.unlistenByKey(o),0===--t&&(this.unlistenSources_(),this.reproject_()))},this),this.sourcesListenerKeys_.push(o)}},this),this.sourceTiles_.forEach(function(t,e,n){t.getState()==Za.IDLE&&t.load()}),0===t&&setTimeout(this.reproject_.bind(this),0)}},Dc.prototype.unlistenSources_=function(){this.sourcesListenerKeys_.forEach(Ta.unlistenByKey),this.sourcesListenerKeys_=null};var Fc={};Fc.createFromTemplate=function(t,e){var n=/\{z\}/g,i=/\{x\}/g,r=/\{y\}/g,o=/\{-y\}/g;return function(a,s,l){return a?t.replace(n,a[0].toString()).replace(i,a[1].toString()).replace(r,function(){return(-a[2]-1).toString()}).replace(o,function(){var t=a[0],n=e.getFullTileRange(t);return Qa.assert(n,55),(n.getHeight()+a[2]).toString()}):void 0}},Fc.createFromTemplates=function(t,e){for(var n=t.length,i=new Array(n),r=0;r<n;++r)i[r]=Fc.createFromTemplate(t[r],e);return Fc.createFromTileUrlFunctions(i)},Fc.createFromTileUrlFunctions=function(t){return 1===t.length?t[0]:function(e,n,i){if(e){var r=qu.hash(e),o=ts.modulo(r,t.length);return t[o](e,n,i)}}},Fc.nullTileUrlFunction=function(t,e,n){},Fc.expandUrl=function(t){var e=[],n=/\{([a-z])-([a-z])\}/.exec(t);if(n){var i,r=n[1].charCodeAt(0),o=n[2].charCodeAt(0);for(i=r;i<=o;++i)e.push(t.replace(n[0],String.fromCharCode(i)));return e}if(n=n=/\{(\d+)-(\d+)\}/.exec(t)){for(var a=parseInt(n[2],10),s=parseInt(n[1],10);s<=a;s++)e.push(t.replace(n[0],s.toString()));return e}return e.push(t),e};var kc=function(t){$u.call(this,{attributions:t.attributions,extent:t.extent,logo:t.logo,projection:t.projection,state:t.state,wrapX:t.wrapX}),this.opaque_=void 0!==t.opaque&&t.opaque,this.tilePixelRatio_=void 0!==t.tilePixelRatio?t.tilePixelRatio:1,this.tileGrid=void 0!==t.tileGrid?t.tileGrid:null,this.tileCache=new Oc(t.cacheSize),this.tmpSize=[0,0],this.key_="",this.tileOptions={transition:t.transition}};ya.inherits(kc,$u),kc.prototype.canExpireCache=function(){return this.tileCache.canExpireCache()},kc.prototype.expireCache=function(t,e){var n=this.getTileCacheForProjection(t);n&&n.expireCache(e)},kc.prototype.forEachLoadedTile=function(t,e,n,i){var r=this.getTileCacheForProjection(t);if(!r)return!1;for(var o,a,s,l=!0,u=n.minX;u<=n.maxX;++u)for(var c=n.minY;c<=n.maxY;++c)a=qu.getKeyZXY(e,u,c),s=!1,r.containsKey(a)&&(s=(o=r.get(a)).getState()===Za.LOADED)&&(s=!1!==i(o)),s||(l=!1);return l},kc.prototype.getGutter=function(t){return 0},kc.prototype.getKey=function(){return this.key_},kc.prototype.setKey=function(t){this.key_!==t&&(this.key_=t,this.changed())},kc.prototype.getOpaque=function(t){return this.opaque_},kc.prototype.getResolutions=function(){return this.tileGrid.getResolutions()},kc.prototype.getTile=function(t,e,n,i,r){},kc.prototype.getTileGrid=function(){return this.tileGrid},kc.prototype.getTileGridForProjection=function(t){return this.tileGrid?this.tileGrid:Qu.getForProjection(t)},kc.prototype.getTileCacheForProjection=function(t){var e=this.getProjection();return e&&!ws.equivalent(e,t)?null:this.tileCache},kc.prototype.getTilePixelRatio=function(t){return this.tilePixelRatio_},kc.prototype.getTilePixelSize=function(t,e,n){var i=this.getTileGridForProjection(n),r=this.getTilePixelRatio(e),o=Qs.toSize(i.getTileSize(t),this.tmpSize);return 1==r?o:Qs.scale(o,r,this.tmpSize)},kc.prototype.getTileCoordForTileUrlFunction=function(t,e){var n=void 0!==e?e:this.getProjection(),i=this.getTileGridForProjection(n);return this.getWrapX()&&n.isGlobal()&&(t=Qu.wrapX(i,t,n)),qu.withinExtentAndZ(t,i)?t:null},kc.prototype.refresh=function(){this.tileCache.clear(),this.changed()},kc.prototype.useTile=ya.nullFunction,kc.Event=function(t,e){Ca.call(this,t),this.tile=e},ya.inherits(kc.Event,Ca);var Nc={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"},Gc=function(t){kc.call(this,{attributions:t.attributions,cacheSize:t.cacheSize,extent:t.extent,logo:t.logo,opaque:t.opaque,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tilePixelRatio:t.tilePixelRatio,wrapX:t.wrapX,transition:t.transition}),this.tileLoadFunction=t.tileLoadFunction,this.tileUrlFunction=this.fixedTileUrlFunction?this.fixedTileUrlFunction.bind(this):Fc.nullTileUrlFunction,this.urls=null,t.urls?this.setUrls(t.urls):t.url&&this.setUrl(t.url),t.tileUrlFunction&&this.setTileUrlFunction(t.tileUrlFunction),this.tileLoadingKeys_={}};ya.inherits(Gc,kc),Gc.prototype.fixedTileUrlFunction,Gc.prototype.getTileLoadFunction=function(){return this.tileLoadFunction},Gc.prototype.getTileUrlFunction=function(){return this.tileUrlFunction},Gc.prototype.getUrls=function(){return this.urls},Gc.prototype.handleTileChange=function(t){var e,n=t.target,i=ya.getUid(n),r=n.getState();r==Za.LOADING?(this.tileLoadingKeys_[i]=!0,e=Nc.TILELOADSTART):i in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[i],e=r==Za.ERROR?Nc.TILELOADERROR:r==Za.LOADED||r==Za.ABORT?Nc.TILELOADEND:void 0),void 0!=e&&this.dispatchEvent(new kc.Event(e,n))},Gc.prototype.setTileLoadFunction=function(t){this.tileCache.clear(),this.tileLoadFunction=t,this.changed()},Gc.prototype.setTileUrlFunction=function(t,e){this.tileUrlFunction=t,this.tileCache.pruneExceptNewestZ(),void 0!==e?this.setKey(e):this.changed()},Gc.prototype.setUrl=function(t){var e=this.urls=Fc.expandUrl(t);this.setTileUrlFunction(this.fixedTileUrlFunction?this.fixedTileUrlFunction.bind(this):Fc.createFromTemplates(e,this.tileGrid),t)},Gc.prototype.setUrls=function(t){this.urls=t;var e=t.join("\n");this.setTileUrlFunction(this.fixedTileUrlFunction?this.fixedTileUrlFunction.bind(this):Fc.createFromTemplates(t,this.tileGrid),e)},Gc.prototype.useTile=function(t,e,n){var i=qu.getKeyZXY(t,e,n);this.tileCache.containsKey(i)&&this.tileCache.get(i)};var Vc=function(t){Gc.call(this,{attributions:t.attributions,cacheSize:t.cacheSize,extent:t.extent,logo:t.logo,opaque:t.opaque,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tileLoadFunction:t.tileLoadFunction?t.tileLoadFunction:Vc.defaultTileLoadFunction,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:t.wrapX,transition:t.transition}),this.crossOrigin=void 0!==t.crossOrigin?t.crossOrigin:null,this.tileClass=void 0!==t.tileClass?t.tileClass:Mc,this.tileCacheForProjection={},this.tileGridForProjection={},this.reprojectionErrorThreshold_=t.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1};ya.inherits(Vc,Gc),Vc.prototype.canExpireCache=function(){if(!ya.ENABLE_RASTER_REPROJECTION)return Gc.prototype.canExpireCache.call(this);if(this.tileCache.canExpireCache())return!0;for(var t in this.tileCacheForProjection)if(this.tileCacheForProjection[t].canExpireCache())return!0;return!1},Vc.prototype.expireCache=function(t,e){if(ya.ENABLE_RASTER_REPROJECTION){var n=this.getTileCacheForProjection(t);this.tileCache.expireCache(this.tileCache==n?e:{});for(var i in this.tileCacheForProjection){var r=this.tileCacheForProjection[i];r.expireCache(r==n?e:{})}}else Gc.prototype.expireCache.call(this,t,e)},Vc.prototype.getGutter=function(t){return ya.ENABLE_RASTER_REPROJECTION&&this.getProjection()&&t&&!ws.equivalent(this.getProjection(),t)?0:this.getGutterInternal()},Vc.prototype.getGutterInternal=function(){return 0},Vc.prototype.getOpaque=function(t){return!(ya.ENABLE_RASTER_REPROJECTION&&this.getProjection()&&t&&!ws.equivalent(this.getProjection(),t))&&Gc.prototype.getOpaque.call(this,t)},Vc.prototype.getTileGridForProjection=function(t){if(!ya.ENABLE_RASTER_REPROJECTION)return Gc.prototype.getTileGridForProjection.call(this,t);var e=this.getProjection();if(!this.tileGrid||e&&!ws.equivalent(e,t)){var n=ya.getUid(t).toString();return n in this.tileGridForProjection||(this.tileGridForProjection[n]=Qu.getForProjection(t)),this.tileGridForProjection[n]}return this.tileGrid},Vc.prototype.getTileCacheForProjection=function(t){if(!ya.ENABLE_RASTER_REPROJECTION)return Gc.prototype.getTileCacheForProjection.call(this,t);var e=this.getProjection();if(!e||ws.equivalent(e,t))return this.tileCache;var n=ya.getUid(t).toString();return n in this.tileCacheForProjection||(this.tileCacheForProjection[n]=new Oc(this.tileCache.highWaterMark)),this.tileCacheForProjection[n]},Vc.prototype.createTile_=function(t,e,n,i,r,o){var a=[t,e,n],s=this.getTileCoordForTileUrlFunction(a,r),l=s?this.tileUrlFunction(s,i,r):void 0,u=new this.tileClass(a,void 0!==l?Za.IDLE:Za.EMPTY,void 0!==l?l:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return u.key=o,Ta.listen(u,Aa.CHANGE,this.handleTileChange,this),u},Vc.prototype.getTile=function(t,e,n,i,r){var o=this.getProjection();if(ya.ENABLE_RASTER_REPROJECTION&&o&&r&&!ws.equivalent(o,r)){var a,s=this.getTileCacheForProjection(r),l=[t,e,n],u=qu.getKey(l);s.containsKey(u)&&(a=s.get(u));var c=this.getKey();if(a&&a.key==c)return a;var h=this.getTileGridForProjection(o),d=this.getTileGridForProjection(r),f=this.getTileCoordForTileUrlFunction(l,r),p=new Dc(o,h,r,d,l,f,this.getTilePixelRatio(i),this.getGutterInternal(),function(t,e,n,i){return this.getTileInternal(t,e,n,i,o)}.bind(this),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_);return p.key=c,a?(p.interimTile=a,p.refreshInterimChain(),s.replace(u,p)):s.set(u,p),p}return this.getTileInternal(t,e,n,i,o||r)},Vc.prototype.getTileInternal=function(t,e,n,i,r){var o=null,a=qu.getKeyZXY(t,e,n),s=this.getKey();if(this.tileCache.containsKey(a)){if((o=this.tileCache.get(a)).key!=s){var l=o;o=this.createTile_(t,e,n,i,r,s),l.getState()==Za.IDLE?o.interimTile=l.interimTile:o.interimTile=l,o.refreshInterimChain(),this.tileCache.replace(a,o)}}else o=this.createTile_(t,e,n,i,r,s),this.tileCache.set(a,o);return o},Vc.prototype.setRenderReprojectionEdges=function(t){if(ya.ENABLE_RASTER_REPROJECTION&&this.renderReprojectionEdges_!=t){this.renderReprojectionEdges_=t;for(var e in this.tileCacheForProjection)this.tileCacheForProjection[e].clear();this.changed()}},Vc.prototype.setTileGridForProjection=function(t,e){if(ya.ENABLE_RASTER_REPROJECTION){var n=ws.get(t);if(n){var i=ya.getUid(n).toString();i in this.tileGridForProjection||(this.tileGridForProjection[i]=e)}}},Vc.defaultTileLoadFunction=function(t,e){t.getImage().src=e};var Uc=function(t){var e=t||{},n=void 0!==e.projection?e.projection:"EPSG:3857",i=void 0!==e.tileGrid?e.tileGrid:Qu.createXYZ({extent:Qu.extentFromProjection(n),maxZoom:e.maxZoom,minZoom:e.minZoom,tileSize:e.tileSize});Vc.call(this,{attributions:e.attributions,cacheSize:e.cacheSize,crossOrigin:e.crossOrigin,logo:e.logo,opaque:e.opaque,projection:n,reprojectionErrorThreshold:e.reprojectionErrorThreshold,tileGrid:i,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:e.tilePixelRatio,tileUrlFunction:e.tileUrlFunction,url:e.url,urls:e.urls,wrapX:void 0===e.wrapX||e.wrapX,transition:e.transition})};ya.inherits(Uc,Vc);var Bc=function(t){var e,n=t||{};e=void 0!==n.attributions?n.attributions:[Bc.ATTRIBUTION],Uc.call(this,{attributions:e,cacheSize:n.cacheSize,crossOrigin:void 0!==n.crossOrigin?n.crossOrigin:"anonymous",opaque:void 0===n.opaque||n.opaque,maxZoom:void 0!==n.maxZoom?n.maxZoom:19,reprojectionErrorThreshold:n.reprojectionErrorThreshold,tileLoadFunction:n.tileLoadFunction,url:void 0!==n.url?n.url:"https://{a-c}.tile.openstreetmap.org/{z}/{x}/{y}.png",wrapX:n.wrapX})};ya.inherits(Bc,Uc),Bc.ATTRIBUTION='&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors.';!function(){function t(t){this.value=t}function e(e){function n(r,o){try{var a=e[r](o),s=a.value;s instanceof t?Promise.resolve(s.value).then(function(t){n("next",t)},function(t){n("throw",t)}):i(a.done?"return":"normal",a.value)}catch(t){i("throw",t)}}function i(t,e){switch(t){case"return":r.resolve({value:e,done:!0});break;case"throw":r.reject(e);break;default:r.resolve({value:e,done:!1})}(r=r.next)?n(r.key,r.arg):o=null}var r,o;this._invoke=function(t,e){return new Promise(function(i,a){var s={key:t,arg:e,resolve:i,reject:a,next:null};o?o=o.next=s:(r=o=s,n(t,e))})},"function"!=typeof e.return&&(this.return=void 0)}"function"==typeof Symbol&&Symbol.asyncIterator&&(e.prototype[Symbol.asyncIterator]=function(){return this}),e.prototype.next=function(t){return this._invoke("next",t)},e.prototype.throw=function(t){return this._invoke("throw",t)},e.prototype.return=function(t){return this._invoke("return",t)}}();var zc=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},Xc=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),Hc=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},Wc=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e},Yc=function(){function t(e){zc(this,t),this.map=new pc({target:"map",layers:[new _c({source:new Bc})],view:new zs({center:[-36500,6673712],zoom:18})}),this.cb=e}return Xc(t,[{key:"createHeatmap",value:function(){function t(){r.getLayers().getArray().some(function(t,e,n){t instanceof Tc&&t.getSource().clear()},this);var t=new Ic(n),e=new vc({geometry:t,weight:1});i.addFeature(e);var o=new Tc({source:i,radius:15,blur:35});r.addLayer(o)}var e=this,n=[],i=new Lc,r=this.map;r.on("click",function(i){n.push(i.coordinate),t(),e.queryLocation(i.coordinate),document.querySelector(".MainHeader").classList.add("bounceOutLeft")})}},{key:"queryLocation",value:function(t){var e=this,n=ws.transform(t,"EPSG:3857","EPSG:4326"),i=n[0],r="https://www.overpass-api.de/api/interpreter?data=[out:json];(node(around:12,"+n[1]+","+i+')["amenity"~"bar|pub|restaurant"]);out%20meta;';fetch(r).then(function(t){t.json().then(function(t){t.elements[0]&&e.cb(t.elements[0].tags.name)})}).catch(function(t){console.log(t)})}}]),t}(),jc=function(t){function e(t){zc(this,e);var n=Wc(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.state={active:!1},n}return Hc(e,t),Xc(e,[{key:"componentWillUpdate",value:function(t){t.locations!==this.props.locations&&this.props.locations.length>0&&this.setState({active:!0})}},{key:"render",value:function(){if(this.props.locations.length>1)c3.generate({bindto:".Stats",data:{columns:this.props.locations,type:"pie"}});return Ei.createElement("div",{className:this.state.active?"Stats animated bounceInDown":"Stats"})}}]),e}(Ei.Component),Kc=function(t){function e(t){zc(this,e);var n=Wc(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.locationsList=[],n.winningLocation=[],n.leaderboardHeader="",n}return Hc(e,t),Xc(e,[{key:"render",value:function(){return this.winningLocation=this.props.winner.map(function(t){return Ei.createElement("tr",{key:t},Ei.createElement("td",null,t[0]),Ei.createElement("td",null,t[1]))}),this.props.locations.length>0&&(this.leaderboardHeader=Ei.createElement("h4",null,"Leaderboard"),this.locationsList=this.props.locations.map(function(t){return Ei.createElement("tr",{key:t},Ei.createElement("td",null,t[0]),Ei.createElement("td",null,t[1]))})),Ei.createElement("div",{className:"VisitTable"},Ei.createElement("h3",null,"Current winner"),Ei.createElement("table",null,Ei.createElement("tr",null,Ei.createElement("th",null,"Name"),Ei.createElement("th",null,"Visits")),this.winningLocation),this.leaderboardHeader,Ei.createElement("table",null,this.locationsList))}}]),e}(Ei.Component),qc=function(t){function e(t){zc(this,e);var n=Wc(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.state={active:!1,locations:[]},n.sortedLocations=[],n.allSortedLocations=[],n.winningArray=[],n}return Hc(e,t),Xc(e,[{key:"sortLocationVisits",value:function(){this.sortedLocations=[];for(var t in this.props.locations)this.props.locations.hasOwnProperty(t)&&this.sortedLocations.push([t,this.props.locations[t]]);this.sortedLocations.sort(function(t,e){return e[1]-t[1]}),this.allSortedLocations=this.sortedLocations.slice(),this.winningArray=this.sortedLocations.splice(0,1)}},{key:"componentWillUpdate",value:function(t){this.sortLocationVisits(),t.locations!==this.props.locations&&this.setState({locations:this.locationsList,active:!0})}},{key:"render",value:function(){return Ei.createElement("div",{className:this.state.active?"SideBar animated bounceInRight":"SideBar"},Ei.createElement(jc,{locations:this.allSortedLocations}),Ei.createElement(Kc,{winner:this.winningArray,locations:this.sortedLocations}))}}]),e}(Ei.Component),Zc=function(t){function e(t){zc(this,e);var n=Wc(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return n.state={locations:[]},n}return Hc(e,t),Xc(e,[{key:"componentDidMount",value:function(){var t=this,e={};new Yc(function(n){e[n]=e[n]||0,e[n]+=1,t.setState({locations:e})}).createHeatmap()}},{key:"render",value:function(){return Ei.createElement("div",{id:"map",className:"MapHolder"},Ei.createElement(qc,{locations:this.state.locations}))}}]),e}(Ei.Component);va.render(Ei.createElement(Zc,null),document.querySelector("#app"))}();
//# sourceMappingURL=script.js.map
